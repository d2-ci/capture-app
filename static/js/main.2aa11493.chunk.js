(window.webpackJsonp=window.webpackJsonp||[]).push([[256],{1290:function(e,t){},133:function(e,t,n){"use strict";t.a={prod:"production",dev:"development",test:"test",devDebug:"dev-debug"}},1443:function(e){e.exports={"Please provide a valid date":"","Columns to show in table":"",Column:"","This value is validating":"","Async field update failed":"","A value is required":"","Please provide a valid number":"","Please provide a valid integer":"","Please provide a positive integer":"","Please provide zero or a positive integer":"","Please provide a negative integer":"","Please provide a valid date and time":"","Please provide a valid time":"","Please provide a valid percentage":"","Please provide a valid url":"","Please provide a valid email address":"","Please provide a valid age":"","Please provide a valid phone number":"","Please provide a valid organisation unit":"","Please provide valid coordinates":"","Please provide a valid username":"","This value already exists":"",'"From" cannot be greater than "To"':"","Checking...":"",Area:"",Coordinate:"",Enrollment:"","A future date is not allowed":"","An error has occured. See log for details":"",Cancel:"","Unsaved changes":"","Leaving this page will discard the changes you made to this event.":"","Yes, discard":"","No, stay here":"","validation failed":"",Errors:"",Feedback:"",Indicators:"",Warnings:"","search group result could not be retrieved":"",Complete:"","Warnings found":"",Abort:"","Add comment":"","Write comment":"","Back to form":"","Save anyway":"","Validation errors and warnings":"","Validation errors":"","Validation warnings":"","Some operations are still runnning. Please wait..":"","Operations running":"",Sort:"","No events to display":"","Data for offline list not present":"",Close:"","Last week":"","Last month":"","Last 3 months":"","Custom range":"",to:"","after or equal to":"","before or equal to":"",From:"",To:"",Max:"",Min:"","greater than or equal to":"","less than or equal to":"","Contains text":"",Yes:"","mm/dd/yyyy":"",Years:"",Months:"",Days:"","Uploading file":"",selected:"",Delete:"","Select file":"",No:"","Uploading image":"","Select image":"",Search:"",Clear:"","No results":"","No items to display":"",Online:"",Offline:"",Syncing:"","You dont have access to write comments":"","Basic info":"",Status:"",Comments:"","Please add or cancel comment before saving the event":"","No write access":"",Save:"","Show all events":"","Edit event":"","Event could not be loaded. Are you sure it exists?":"","Event could not be loaded":"","Organisation unit could not be loaded":"","View event info":"","Delete event":"",Update:"","More filters":"","Rows per page":"",Active:"",Completed:"","Could not get organisation unit":"","Program doesn't exist":"","Selected program is invalid for registering unit":"","Creating a new {{TET}} in {{program}} in {{orgUnit}}":"","Save and add another":"","Save and exit":"",Finish:"","Switch to form view":"","Switch to row view":"","New {{TET}}":"","Working Lists":"","Program with programid {{programId}} isn't a tracker program. Enrollments can only be done in tracker programs.":"","Selected program is invalid for selected registering unit":"",Relationships:"","Saving to":"",in:"","This is not an event program or the metadata is corrupt. See log for details.":"","This event":"","Relationship of type {{relationshipTypeName}} to {{entityName}} already exists":"","New event":"","New event relationship":"","Adding relationship to event.":"","Go back to event without saving relationship":"","Leaving this page will discard the selections you made for a new relationship":"","events added":"","No events added":"","Select a registering unit and program above to get started":"","Select a program to start reporting":"","Select a registering unit to start reporting":"","Select a category option to start reporting":"","You dont have access to create an event in the current selections":"","A duplicate exists (but there were some errors, see log for details":"","An item with this {{attributeName}} is already registered, but you don't have access to it":"","You have already registered this {{attributeName}}":"","A {{trackedEntityTypeName}} with this {{attributeName}} is already registered":"","Show registered {{trackedEntityTypeName}}":"","Registered person":"",Link:"","Metadata error. see log for details":"","Review Duplicates":"","Create {{trackedEntityTypeName}} and link":"","Possible duplicates found":"","An error occured loading possible duplicates":"",Hide:"","Save as new {{tetName}}":"","Some programs are being filtered.":"","Show all":"",Program:"","Organisation Unit":"",Registration:"","Search results":"","No {{trackedEntityTypeName}} found.":"","{{teiCount}} results found for":"","New search":"","Edit search":"","Link to an existing {{trackedEntityType}}":"","Create new {{trackedEntityType}}":"",Register:"","You dont have access to edit this event":"","Leaving this page will discard any selections you made for a new relationship":"",Feedbacks:"","New {{typeName}}":"",New:"","Start again":"",Find:"","Selected registering unit":"","Start Again":"","Registering Organisation Unit":"","Selected Program":"",Select:"","Select program":"","No programs available.":"","You dont have access to delete this relationship":"","You dont have access to create any relationships":"","Add relationship":"","Selected program":"","Search {{uniqueAttrName}}":"","Search by attributes":"","Fill in at least {{minAttributesRequired}} attributes to search":"","Program not found":"","Program is not a tracker program":"",Profile:"","Error saving event":"","Could not save event. See log for details":"","Organisation unit search failed. See log for details":"","tracked entity instance":"","Set coordinate":"",Date:"",Time:"","From date":"","From time":"","To date":"","To time":"","error encountered during field validation":"",error:"","Delete polygon":"","Set area":"","Choose one or more dates...":"","Choose a date...":"",Today:"","Compatibility mode":""}},1444:function(e){e.exports={"Please provide a valid date":"","Columns to show in table":"",Column:"",Cancel:"","Discard event?":"","Leaving this page will discard the changes you made to this event.":"",Discard:"","Back to event":"","Add comment":"","Write comment":"","Linked to ":"",Remove:"","Add link":"",Errors:"",Feedback:"",Indicators:"",Warnings:"",Complete:"","Warnings found":"",Abort:"","Your data is uploading. Please wait untill this message disappears":"","No write access":"",Save:"","Uploading data":"",Sort:"","No events to display":"","Data for offline list not present":"","Last week":"","Last month":"","Last 3 months":"","Custom range":"",to:"","after or equal to":"","before or equal to":"",From:"",To:"",Max:"",Min:"","greater than or equal to":"","less than or equal to":"","Contains text":"",Yes:"","mm/dd/yyyy":"",Years:"",Months:"",Days:"","Uploading file":"",selected:"",Delete:"","Select file":"",No:"","Uploading image":"","Select image":"",Search:"",Clear:"","No results":"","No items to display":"",Online:"",Offline:"",Syncing:"","Basic info":"",Status:"",Comments:"",Field:"","could not be updated":"","Please add or cancel comment before saving the event":"","Show all events":"","Edit event":"","Event could not be loaded. Are you sure it exists?":"","Event could not be loaded":"","Organisation unit could not be loaded":"","Delete event":"",Update:"",Close:"","More filters":"","Rows per page":"","Could not get organisation unit":"","Program doesn't exist":"","Selected program is invalid for registering unit":"","Link to":"","Saving to":"",in:"","This is not an event program or the metadata is corrupt. See log for details.":"","A value is required":"","Save and add another":"","Save and exit":"",Finish:"","events added":"","No events added":"","Switch to form view":"","Switch to row view":"","New event":"","Select a registering unit and program above to get started":"","Select a program to start reporting":"","Select a registering unit to start reporting":"","Select a category option to start reporting":"","Start again":"",New:"",Find:"","Selected registering unit":"","Start Again":"","Registering Organisation Unit":"","Selected Program":"",Select:"","Some programs are being filtered.":"","Show all":"",Program:"","Select program":"","No programs available.":"","An error has occured. See log for details":"","Error saving event":"","Could not save event. See log for details":"","Choose one or more dates...":"","Choose a date...":"",Today:"Hello"}},1445:function(e){e.exports={"Please provide a valid date":"Xin vui l\xf2ng cung c\u1ea5p ng\xe0y \u0111\xfang","Columns to show in table":"C\u1ed9t hi\u1ec3n th\u1ecb trong b\u1ea3ng",Column:"C\u1ed9t",Cancel:"H\u1ee7y","Discard event?":"H\u1ee7y s\u1ef1 ki\u1ec7n?","Leaving this page will discard the changes you made to this event.":"R\u1eddi kh\u1ecfi trang ng\xe0y s\u1ebd h\u1ee7y c\xe1c thay \u0111\u1ed5i b\u1ea1n \u0111\xe3 th\u1ef1c hi\u1ec7n cho s\u1ef1 ki\u1ec7n n\xe0y.",Discard:"H\u1ee7y","Back to event":"Quay l\u1ea1i s\u1ef1 ki\u1ec7n","Add comment":"Th\xeam b\xecnh lu\u1eadn","Write comment":"Vi\u1ebft b\xecnh lu\u1eadn",Errors:"L\u1ed7i",Feedback:"Ph\u1ea3n h\u1ed3i",Indicators:"Ch\u1ec9 s\u1ed1",Warnings:"C\u1ea3nh b\xe1o",Complete:"Ho\xe0n t\u1ea5t","Warnings found":"C\u1ea3nh b\xe1o \u0111\xe3 t\xecm th\u1ea5y",Abort:"H\u1ee7y b\u1ecf","Your data is uploading. Please wait untill this message disappears":"D\u1eef li\u1ec7u c\u1ee7a b\u1ea1n \u0111ang \u0111\u01b0\u1ee3c t\u1ea3i l\xean. Xin vui l\xf2ng \u0111\u1ee3i \u0111\u1ebfn khi tin nh\u1eafn n\xe0y bi\u1ebfn m\u1ea5t","No write access":"Kh\xf4ng c\xf3 quy\u1ec1n vi\u1ebft",Save:"L\u01b0u","Uploading data":"\u0110ang t\u1ea3i d\u1eef li\u1ec7u l\xean",Sort:"S\u1eafp x\u1ebfp","No events to display":"Kh\xf4ng c\xf3 s\u1ef1 ki\u1ec7n \u0111\u1ec3 hi\u1ec3n th\u1ecb","Data for offline list not present":"D\u1eef li\u1ec7u cho danh s\xe1ch ngo\u1ea1i tuy\u1ebfn kh\xf4ng hi\u1ec3n th\u1ecb","Last week":"Tu\u1ea7n tr\u01b0\u1edbc","Last month":"Th\xe1ng tr\u01b0\u1edbc","Last 3 months":"3 Th\xe1ng tr\u01b0\u1edbc","Custom range":"T\xf9y ch\u1ec9nh kho\u1ea3n",to:"\u0111\u1ebfn","after or equal to":"sau ho\u1eb7c b\u1eb1ng","before or equal to":"tr\u01b0\u1edbc ho\u1eb7c b\u1eb1ng",From:"T\u1eeb",To:"\u0110\u1ebfn",Max:"T\u1ed1i \u0111a",Min:"T\u1ed1i thi\u1ec3u","greater than or equal to":"l\u1edbn h\u01a1n ho\u1eb7c b\u1eb1ng","less than or equal to":"nh\u1ecf h\u01a1n ho\u1eb7c b\u1eb1ng","Contains text":"Ch\u1ee9a v\u0103n b\u1ea3n",Yes:"C\xf3","mm/dd/yyyy":"",Years:"N\u0103m",Months:"Th\xe1ng",Days:"Ng\xe0y","Uploading file":"\u0110ang t\u1ea3i t\u1eadp tin l\xean",selected:"\u0111\xe3 ch\u1ecdn",Delete:"X\xf3a","Select file":"Ch\u1ecdn t\u1eadp tin",No:"Kh\xf4ng","Uploading image":"\u0110ang t\u1ea3i \u1ea3nh l\xean","Select image":"Ch\u1ecdn \u1ea3nh",Search:"T\xecm ki\u1ebfm",Clear:"X\xf3a","No results":"Kh\xf4ng c\xf3 k\u1ebft qu\u1ea3","No items to display":"Kh\xf4ng c\xf3 m\u1ee5c \u0111\u1ec3 hi\u1ec3n th\u1ecb",Online:"Tr\u1ef1c tuy\u1ebfn",Offline:"Ngo\u1ea1i tuy\u1ebfn",Syncing:"\u0110ang \u0111\u1ed3ng b\u1ed9","Basic info":"Th\xf4ng tin c\u01a1 b\u1ea3n",Status:"Tr\u1ea1ng th\xe1i",Comments:"B\xecnh lu\u1eadn",Field:"Tr\u01b0\u1eddng","could not be updated":"kh\xf4ng th\u1ec3 c\u1eadp nh\u1eadt","Please add or cancel comment before saving the event":"Xin vui l\xf2ng th\xeam ho\u1eb7c x\xf3a b\xecnh lu\u1eadn tr\u01b0\u1edbc khi l\u01b0u s\u1ef1 ki\u1ec7n","Show all events":"Hi\u1ec7n t\u1ea5t c\u1ea3 s\u1ef1 ki\u1ec7n","Edit event":"S\u1eeda s\u1ef1 ki\u1ec7n","Event could not be loaded. Are you sure it exists?":"Kh\xf4ng th\u1ec3 t\u1ea3i s\u1ef1 ki\u1ec7n. B\u1ea1n c\xf3 ch\u1eafc n\xf3 t\u1ed3n t\u1ea1i?","Event could not be loaded":"Kh\xf4ng th\u1ec3 t\u1ea3i s\u1ef1 ki\u1ec7n","Organisation unit could not be loaded":"Kh\xf4ng th\u1ec3 t\u1ea3i \u0111\u01a1n v\u1ecb","Delete event":"X\xf3a s\u1ef1 ki\u1ec7n",Update:"C\u1eadp nh\u1eadt",Close:"\u0110\xf3ng","More filters":"Th\xeam b\u1ed9 l\u1ecdc","Rows per page":"D\xf2ng m\u1ed7i trang","Could not get organisation unit":"Kh\xf4ng th\u1ec3 l\u1ea5y \u0111\u01a1n v\u1ecb","Program doesn't exist":"Ch\u01b0\u01a1ng tr\xecnh kh\xf4ng t\u1ed3n t\u1ea1i","Selected program is invalid for registering unit":"Ch\u01b0\u01a1ng tr\xecnh \u0111\xe3 ch\u1ecdn kh\xf4ng \u0111\xfang \u0111\u1ec3 \u0111\u0103ng k\xfd \u0111\u01a1n v\u1ecb","Saving to":"\u0110ang l\u01b0u v\xe0o",in:"trong","This is not an event program or the metadata is corrupt. See log for details.":"\u0110\xe2y kh\xf4ng ph\u1ea3i l\xe0 ch\u01b0\u01a1ng tr\xecnh s\u1ef1 ki\u1ec7n ho\u1eb7c d\u1eef li\u1ec7u mi\xeau t\u1ea3 b\u1ecb h\u1ecfng. Xem log \u0111\u1ec3 bi\u1ebft th\xeam chi ti\u1ebft.","A value is required":"Y\xeau c\u1ea7u c\xf3 gi\xe1 tr\u1ecb","Save and add another":"L\u01b0u v\xe0 th\xeam s\u1ef1 ki\u1ec7n kh\xe1c","Save and exit":"L\u01b0u v\xe0 \u0111\xf3ng",Finish:"Ho\xe0n t\u1ea5t","events added":"s\u1ef1 ki\u1ec7n \u0111\xe3 \u0111\u01b0\u1ee3c th\xeam","No events added":"Kh\xf4ng c\xf3 s\u1ef1 ki\u1ec7n \u0111\u01b0\u1ee3c th\xeam","Switch to form view":"Chuy\u1ec3n sang xem bi\u1ec3u nh\u1eadp","Switch to row view":"Chuy\u1ec3n sang xem d\xf2ng","New event":"S\u1ef1 ki\u1ec7n m\u1edbi","Select a registering unit and program above to get started":"Ch\u1ecdn m\u1ed9t \u0111\u01a1n v\u1ecb \u0111\u0103ng k\xfd v\xe0 ch\u01b0\u01a1ng tr\xecnh tr\xean \u0111\u1ec3 b\u1eaft \u0111\u1ea7u","Select a program to start reporting":"Ch\u1ecdn ch\u01b0\u01a1ng tr\xecnh \u0111\u1ec3 b\u1eaft \u0111\u1ea7u b\xe1o c\xe1o","Select a registering unit to start reporting":"Ch\u1ecdn \u0111\u01a1n v\u1ecb \u0111\u0103ng k\xfd \u0111\u1ec3 b\u1eaft \u0111\u1ea7u b\xe1o c\xe1o","Select a category option to start reporting":"Ch\u1ecdn T\xf9y Ch\u1ecdn Ph\xe2n Lo\u1ea1i \u0111\u1ec3 b\u1eaft \u0111\u1ea7u b\xe1o c\xe1o","Start again":"Kh\u1edfi \u0111\u1ea7u l\u1ea1i",New:"M\u1edbi",Find:"T\xecm","Selected registering unit":"\u0110\u01a1n v\u1ecb \u0111\u0103ng k\xfd \u0111\xe3 ch\u1ecdn","Start Again":"Kh\u1edfi \u0110\u1ea7u L\u1ea1i","Registering Organisation Unit":"\u0110\u01a1n V\u1ecb \u0110\u0103ng K\xfd","Selected Program":"Ch\u01b0\u01a1ng Tr\xecnh \u0110\xe3 Ch\u1ecdn",Select:"Ch\u1ecdn","Some programs are being filtered.":"Ch\u01b0\u01a1ng tr\xecnh \u0111ang \u0111\u01b0\u1ee3c l\u1ecdc","Show all":"Hi\u1ec7n t\u1ea5t c\u1ea3",Program:"Ch\u01b0\u01a1ng Tr\xecnh","Select program":"Ch\u1ecdn ch\u01b0\u01a1ng tr\xecnh","No programs available.":"Kh\xf4ng c\xf3 ch\u01b0\u01a1ng tr\xecnh","An error has occured. See log for details":"C\xf3 l\u1ed7i. Xem log \u0111\u1ec3 bi\u1ebft th\xeam chi ti\u1ebft.","Error saving event":"C\xf3 l\u1ed7i khi \u0111ang l\u01b0u s\u1ef1 ki\u1ec7n","Could not save event. See log for details":"Kh\xf4ng th\u1ec3 l\u01b0u s\u1ef1 ki\u1ec7n. Xem log \u0111\u1ec3 bi\u1ebft th\xeam chi ti\u1ebft","Choose one or more dates...":"Ch\u1ecdn m\u1ed9t ho\u1eb7c nhi\u1ec1u ng\xe0y...","Choose a date...":"Ch\u1ecdn m\u1ed9t ng\xe0y...",Today:"H\xf4m nay\n"}},1455:function(e,t,n){e.exports={container:"withShrinkLabel_container__3Y884"}},1467:function(e,t,n){e.exports={icon:"svgIcon_icon__3bl7y"}},1471:function(e,t,n){e.exports={container:"textField_container__2rFeQ"}},1472:function(e,t,n){e.exports={horizontal:"divider_horizontal__1QuON"}},1473:function(e,t,n){e.exports={inputWrapper:"selectField_inputWrapper__45DHN"}},1475:function(e,t,n){e.exports={fieldOuterContainer:"formBuilder_fieldOuterContainer__3BPN7"}},1476:function(module,__webpack_exports__,__webpack_require__){"use strict";var _home_travis_build_dhis2_capture_app_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_defineProperty__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(1),_home_travis_build_dhis2_capture_app_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_toConsumableArray__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(12),_home_travis_build_dhis2_capture_app_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_objectSpread__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(2),_home_travis_build_dhis2_capture_app_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_classCallCheck__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__(5),_home_travis_build_dhis2_capture_app_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_possibleConstructorReturn__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__(8),_home_travis_build_dhis2_capture_app_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_getPrototypeOf__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__(7),_home_travis_build_dhis2_capture_app_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_createClass__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__(3),_home_travis_build_dhis2_capture_app_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_inherits__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__(9),react__WEBPACK_IMPORTED_MODULE_8__=__webpack_require__(0),react__WEBPACK_IMPORTED_MODULE_8___default=__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_8__),loglevel__WEBPACK_IMPORTED_MODULE_9__=__webpack_require__(13),loglevel__WEBPACK_IMPORTED_MODULE_9___default=__webpack_require__.n(loglevel__WEBPACK_IMPORTED_MODULE_9__),react_transform_tree__WEBPACK_IMPORTED_MODULE_10__=__webpack_require__(402),react_transform_tree__WEBPACK_IMPORTED_MODULE_10___default=__webpack_require__.n(react_transform_tree__WEBPACK_IMPORTED_MODULE_10__),capture_core_utils__WEBPACK_IMPORTED_MODULE_11__=__webpack_require__(16),_metaData_RenderFoundation_CustomForm__WEBPACK_IMPORTED_MODULE_12__=__webpack_require__(225),D2CustomForm=function(_React$Component){function D2CustomForm(e){var t;return Object(_home_travis_build_dhis2_capture_app_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_classCallCheck__WEBPACK_IMPORTED_MODULE_3__.a)(this,D2CustomForm),(t=Object(_home_travis_build_dhis2_capture_app_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_possibleConstructorReturn__WEBPACK_IMPORTED_MODULE_4__.a)(this,Object(_home_travis_build_dhis2_capture_app_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_getPrototypeOf__WEBPACK_IMPORTED_MODULE_5__.a)(D2CustomForm).call(this,e))).preProcessSourceTree(),t}return Object(_home_travis_build_dhis2_capture_app_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_inherits__WEBPACK_IMPORTED_MODULE_7__.a)(D2CustomForm,_React$Component),Object(_home_travis_build_dhis2_capture_app_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_createClass__WEBPACK_IMPORTED_MODULE_6__.a)(D2CustomForm,null,[{key:"getEventListenersForCurrentNode",value:function(e){return Object.keys(e).filter(function(e){return e.startsWith("on")})}},{key:"getEventListenerSpecsForCurrentNode",value:function(e,t,n){return e.map(function(e){var a=t[e],r=e.replace(/^on/,"");return{id:n,type:r,handler:a}})}},{key:"renderField",value:function(e,t,n){return n(Object(_home_travis_build_dhis2_capture_app_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_objectSpread__WEBPACK_IMPORTED_MODULE_2__.a)({},e,{props:Object(_home_travis_build_dhis2_capture_app_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_objectSpread__WEBPACK_IMPORTED_MODULE_2__.a)({},e.props,{customFormElementProps:t})}))}}]),Object(_home_travis_build_dhis2_capture_app_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_createClass__WEBPACK_IMPORTED_MODULE_6__.a)(D2CustomForm,[{key:"componentDidMount",value:function(){this.addScripts(),this.addEventListeners()}},{key:"componentWillUnmount",value:function(){this.removeEventListeners()}},{key:"preProcessSourceTree",value:function(){var e=this.props.specs.data.elements,t=1,n=[],a=[];try{a=Object(react_transform_tree__WEBPACK_IMPORTED_MODULE_10__.walk)(e,Object(_home_travis_build_dhis2_capture_app_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_defineProperty__WEBPACK_IMPORTED_MODULE_0__.a)({},react_transform_tree__WEBPACK_IMPORTED_MODULE_10__.kinds.DOM_ELEMENT,function(e){var a=e.node,r=a.props;if(r){var o=D2CustomForm.getEventListenersForCurrentNode(r);if(o.length>0){var i=D2CustomForm.getEventListenerSpecsForCurrentNode(o,r,t);n=[].concat(Object(_home_travis_build_dhis2_capture_app_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_toConsumableArray__WEBPACK_IMPORTED_MODULE_1__.a)(n),Object(_home_travis_build_dhis2_capture_app_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_toConsumableArray__WEBPACK_IMPORTED_MODULE_1__.a)(i));var c=Object.keys(r).reduce(function(e,t){return o.includes(t)||(e[t]=r[t]),e},{}),s=react__WEBPACK_IMPORTED_MODULE_8__.cloneElement.apply(react__WEBPACK_IMPORTED_MODULE_8__,[a,Object(_home_travis_build_dhis2_capture_app_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_objectSpread__WEBPACK_IMPORTED_MODULE_2__.a)({},c,{"data-custom-form-id":t})].concat(Object(_home_travis_build_dhis2_capture_app_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_toConsumableArray__WEBPACK_IMPORTED_MODULE_1__.a)(e.walkChildren())));return t+=1,s}}return react__WEBPACK_IMPORTED_MODULE_8__.cloneElement.apply(react__WEBPACK_IMPORTED_MODULE_8__,[a,a.props].concat(Object(_home_travis_build_dhis2_capture_app_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_toConsumableArray__WEBPACK_IMPORTED_MODULE_1__.a)(e.walkChildren())))}))}catch(r){loglevel__WEBPACK_IMPORTED_MODULE_9___default.a.error(Object(capture_core_utils__WEBPACK_IMPORTED_MODULE_11__.b)(D2CustomForm.errorMessages.PRE_PROCESS_FAILED)({sourceTree:e,error:r})),n=[],a=[]}this.eventListenerSpecs=n,this.preProcessedSourceTree=a}},{key:"addScripts",value:function(){this.props.specs.data.scripts.forEach(function(e){var t=document.createElement("script");t.type="text/javascript",t.async=!0,t.innerHTML=e,document.body.appendChild(t)})}},{key:"addEventListeners",value:function addEventListeners(){var eventListenerSpecs=this.eventListenerSpecs,specsWithHandlerRef=eventListenerSpecs.map(function(spec){var handlerRef=function handlerRef(){eval(spec.handler)};return document.querySelector('[data-custom-form-id="'.concat(spec.id,'"]')).addEventListener(spec.type,handlerRef),Object(_home_travis_build_dhis2_capture_app_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_objectSpread__WEBPACK_IMPORTED_MODULE_2__.a)({},spec,{handlerRef:handlerRef})});this.eventListenerSpecs=specsWithHandlerRef}},{key:"removeEventListeners",value:function(){this.eventListenerSpecs.forEach(function(e){document.querySelector('[data-custom-form-id="'.concat(e.id,'"]')).removeEventListener(e.type,e.handlerRef)})}},{key:"transform",value:function(){var e=this.props,t=e.fields,n=e.onRenderField,a=this.preProcessedSourceTree;return Object(react_transform_tree__WEBPACK_IMPORTED_MODULE_10__.walk)(a,Object(_home_travis_build_dhis2_capture_app_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_defineProperty__WEBPACK_IMPORTED_MODULE_0__.a)({},react_transform_tree__WEBPACK_IMPORTED_MODULE_10__.kinds.DOM_ELEMENT,function(e){var a=e.node;if("FormField"===a.type){var r=a.props.id,o=t.find(function(e){return e.id===r});return o?D2CustomForm.renderField(o,a.props.customFormElementProps,n):null}return e.defaultHandler()}))}},{key:"render",value:function(){var e=this.transform();return react__WEBPACK_IMPORTED_MODULE_8__.createElement("div",null,e)}}]),D2CustomForm}(react__WEBPACK_IMPORTED_MODULE_8__.Component);D2CustomForm.errorMessages={PRE_PROCESS_FAILED:"Could not pre process custom form source tree"},__webpack_exports__.a=D2CustomForm},1480:function(e,t,n){e.exports={defaultCustomContainer:"coordinateFieldCustomForm_defaultCustomContainer__C-QNL"}},1481:function(e,t,n){e.exports={defaultCustomContainer:"optionSetSelectFieldForCustomForm_defaultCustomContainer__2WIYV"}},1482:function(e,t,n){e.exports={defaultCustomContainer:"polygonFieldCustomForm_defaultCustomContainer__2KAiO"}},1483:function(e,t,n){e.exports={defaultCustomContainer:"textFieldCustomForm_defaultCustomContainer__1ThJg"}},1484:function(e,t,n){e.exports={defaultCustomContainer:"userNameFieldCustomForm_defaultCustomContainer__3k9Wy"}},1485:function(e,t,n){e.exports={defaultCustomContainer:"ViewModeFieldCustomForm_defaultCustomContainer__tp84F"}},1486:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"a",function(){return getExecutionService});var _home_travis_build_dhis2_capture_app_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_toConsumableArray__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(12),_home_travis_build_dhis2_capture_app_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_defineProperty__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(1),loglevel__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(13),loglevel__WEBPACK_IMPORTED_MODULE_2___default=__webpack_require__.n(loglevel__WEBPACK_IMPORTED_MODULE_2__),d2_utilizr_lib_isDefined__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__(70),d2_utilizr_lib_isDefined__WEBPACK_IMPORTED_MODULE_3___default=__webpack_require__.n(d2_utilizr_lib_isDefined__WEBPACK_IMPORTED_MODULE_3__),d2_utilizr_lib_isNumber__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__(1487),d2_utilizr_lib_isNumber__WEBPACK_IMPORTED_MODULE_4___default=__webpack_require__.n(d2_utilizr_lib_isNumber__WEBPACK_IMPORTED_MODULE_4__),d2_utilizr_lib_isObject__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__(150),d2_utilizr_lib_isObject__WEBPACK_IMPORTED_MODULE_5___default=__webpack_require__.n(d2_utilizr_lib_isObject__WEBPACK_IMPORTED_MODULE_5__),d2_utilizr_lib_isArray__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__(111),d2_utilizr_lib_isArray__WEBPACK_IMPORTED_MODULE_6___default=__webpack_require__.n(d2_utilizr_lib_isArray__WEBPACK_IMPORTED_MODULE_6__),d2_utilizr_lib_isString__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__(100),d2_utilizr_lib_isString__WEBPACK_IMPORTED_MODULE_7___default=__webpack_require__.n(d2_utilizr_lib_isString__WEBPACK_IMPORTED_MODULE_7__),_zScoreWFA__WEBPACK_IMPORTED_MODULE_8__=__webpack_require__(1488),_OptionSetHelper_OptionSetHelper__WEBPACK_IMPORTED_MODULE_9__=__webpack_require__(565),_commonUtils_trimQuotes__WEBPACK_IMPORTED_MODULE_10__=__webpack_require__(207),_typeKeys_const__WEBPACK_IMPORTED_MODULE_11__=__webpack_require__(46);function getExecutionService(onTranslate,variableService,dateUtils){var _ruleEffectDataConver,NUMBER_OF_EVENTS_IN_SCOPE=10,programRulesContainer=!1,crossEventRulesExist=!1,lastEventId=null,lastEventDate=null,lastProgramId=null,eventScopeExceptCurrent=!1,replaceVariables=function(e,t){-1!==e.indexOf("{")&&e.match(/[A#CV]\{[\w -_.]+}/g).forEach(function(n){n=n.replace("#{","").replace("A{","").replace("C{","").replace("V{","").replace("}",""),d2_utilizr_lib_isDefined__WEBPACK_IMPORTED_MODULE_3___default()(t[n])?e=e.replace(new RegExp(t[n].variablePrefix+"\\{"+n+"\\}","g"),t[n].variableValue):loglevel__WEBPACK_IMPORTED_MODULE_2___default.a.warn("Expression "+e+" contains variable "+n+" - but this variable is not defined.")});-1!==e.indexOf("V{")&&e.match(/V{\w+.?\w*}/g).forEach(function(n){n=n.replace("V{","").replace("}",""),d2_utilizr_lib_isDefined__WEBPACK_IMPORTED_MODULE_3___default()(t[n])&&"V"===t[n].variablePrefix?e=e.replace(new RegExp("V{"+n+"}","g"),t[n].variableValue):loglevel__WEBPACK_IMPORTED_MODULE_2___default.a.warn("Expression "+e+" conains context variable "+n+" - but this variable is not defined.")});-1!==e.indexOf("A{")&&e.match(/A{\w+.?\w*}/g).forEach(function(n){n=n.replace("A{","").replace("}",""),d2_utilizr_lib_isDefined__WEBPACK_IMPORTED_MODULE_3___default()(t[n])&&"A"===t[n].variablePrefix?e=e.replace(new RegExp("A{"+n+"}","g"),t[n].variableValue):loglevel__WEBPACK_IMPORTED_MODULE_2___default.a.warn("Expression "+e+" conains attribute "+n+" - but this attribute is not defined.")});-1!==e.indexOf("C{")&&e.match(/C{\w+.?\w*}/g).forEach(function(n){n=n.replace("C{","").replace("}",""),d2_utilizr_lib_isDefined__WEBPACK_IMPORTED_MODULE_3___default()(t[n])&&"C"===t[n].variablePrefix?e=e.replace(new RegExp("C{"+n+"}","g"),t[n].variableValue):loglevel__WEBPACK_IMPORTED_MODULE_2___default.a.warn("Expression "+e+" conains constant "+n+" - but this constant is not defined.")});return e},runDhisFunctions=function(e,t,n){if(d2_utilizr_lib_isDefined__WEBPACK_IMPORTED_MODULE_3___default()(e)&&-1!==e.indexOf("d2:"))for(var a=[{name:"d2:daysBetween",parameters:2},{name:"d2:weeksBetween",parameters:2},{name:"d2:monthsBetween",parameters:2},{name:"d2:yearsBetween",parameters:2},{name:"d2:floor",parameters:1},{name:"d2:modulus",parameters:2},{name:"d2:concatenate"},{name:"d2:addDays",parameters:2},{name:"d2:zing",parameters:1},{name:"d2:oizp",parameters:1},{name:"d2:count",parameters:1},{name:"d2:countIfZeroPos",parameters:1},{name:"d2:countIfValue",parameters:2},{name:"d2:ceil",parameters:1},{name:"d2:round",parameters:1},{name:"d2:hasValue",parameters:1},{name:"d2:lastEventDate",parameters:1},{name:"d2:validatePattern",parameters:2},{name:"d2:addControlDigits",parameters:1},{name:"d2:checkControlDigits",parameters:1},{name:"d2:left",parameters:2},{name:"d2:right",parameters:2},{name:"d2:substring",parameters:3},{name:"d2:split",parameters:3},{name:"d2:zScoreWFA",parameters:3},{name:"d2:length",parameters:1}],r=!0,o=0;o<10&&r;o++){var i=!1,c=!1;a.forEach(function(a){var r=new RegExp(a.name+"\\( *(([\\d/\\*\\+\\-%. ]+)|( *'[^']*'))*( *, *(([\\d/\\*\\+\\-%. ]+)|'[^']*'))* *\\)","g"),o=e.match(r);o&&o.forEach(function(r){var o=r.replace(/(^[^\(]+\()|\)$/g,""),s=(o=o.trim()).match(/(('[^']+')|([^,]+))/g);d2_utilizr_lib_isDefined__WEBPACK_IMPORTED_MODULE_3___default()(a.parameters)&&((s?s.length:0)!==a.parameters&&(loglevel__WEBPACK_IMPORTED_MODULE_2___default.a.warn(a.name+" was called with the incorrect number of parameters"),c=!0));if(!c&&d2_utilizr_lib_isDefined__WEBPACK_IMPORTED_MODULE_3___default()(s)&&null!==s)for(var l=0;l<s.length;l++)s[l]=runExpression(s[l],a.name,"parameter:"+l,n,t);if(c)e=e.replace(r,"false"),i=!0;else if("d2:daysBetween"===a.name){var u=dateUtils.daysBetween(s[0],s[1]);e=e.replace(r,u),i=!0}else if("d2:weeksBetween"===a.name){var d=dateUtils.weeksBetween(s[0],s[1]);e=e.replace(r,d),i=!0}else if("d2:monthsBetween"===a.name){var p=dateUtils.monthsBetween(s[0],s[1]);e=e.replace(r,p),i=!0}else if("d2:yearsBetween"===a.name){var f=dateUtils.yearsBetween(s[0],s[1]);e=e.replace(r,f),i=!0}else if("d2:floor"===a.name){var m=Math.floor(s[0]);e=e.replace(r,m),i=!0}else if("d2:modulus"===a.name){var h=Number(s[0])%Number(s[1]);e=e.replace(r,h),i=!0}else if("d2:concatenate"===a.name){var b="'";for(l=0;l<s.length;l++)b+=s[l];b+="'",e=e.replace(r,b),i=!0}else if("d2:addDays"===a.name){var g=dateUtils.addDays(date,daysToAdd);e=e.replace(r,g),i=!0}else if("d2:zing"===a.name){(O=s[0])<0&&(O=0),e=e.replace(r,O),i=!0}else if("d2:oizp"===a.name){var O,v=1;(O=s[0])<0&&(v=0),e=e.replace(r,v),i=!0}else if("d2:count"===a.name){var y=s[0],E=0;(_=t[y])?_.hasValue&&(E=_.allValues?_.allValues.length:1):loglevel__WEBPACK_IMPORTED_MODULE_2___default.a.warn("could not find variable to count: "+y),e=e.replace(r,E),i=!0}else if("d2:countIfZeroPos"===a.name){y=$filter("trimvariablequalifiers")(s[0]),E=0;if(_=t[y]){if(_.hasValue)if(_.allValues&&_.allValues.length>0)for(l=0;l<_.allValues.length;l++)_.allValues[l]>=0&&E++;else _.variableValue>=0&&(E=1)}else loglevel__WEBPACK_IMPORTED_MODULE_2___default.a.warn("could not find variable to countifzeropos: "+y);e=e.replace(r,E),i=!0}else if("d2:countIfValue"===a.name){y=s[0];var _=t[y],j=variableService.processValue(s[1],_.variableType);E=0;if(_){if(_.hasValue)if(_.allValues)for(l=0;l<_.allValues.length;l++)j===_.allValues[l]&&E++;else j===_.variableValue&&(E=1)}else loglevel__WEBPACK_IMPORTED_MODULE_2___default.a.warn("could not find variable to countifvalue: "+y);e=e.replace(r,E),i=!0}else if("d2:ceil"===a.name){var I=Math.ceil(s[0]);e=e.replace(r,I),i=!0}else if("d2:round"===a.name){var C=Math.round(s[0]);e=e.replace(r,C),i=!0}else if("d2:hasValue"===a.name){y=s[0];var T=!1;(_=t[y])?_.hasValue&&(T=!0):loglevel__WEBPACK_IMPORTED_MODULE_2___default.a.warn("could not find variable to check if has value: "+y),e=e.replace(r,T),i=!0}else if("d2:lastEventDate"===a.name){y=s[0],T="''";(_=t[y])?_.variableEventDate?T=variableService.processValue(_.variableEventDate,"DATE"):loglevel__WEBPACK_IMPORTED_MODULE_2___default.a.warn("no last event date found for variable: "+y):loglevel__WEBPACK_IMPORTED_MODULE_2___default.a.warn("could not find variable to check last event date: "+y),e=e.replace(r,T),i=!0}else if("d2:validatePattern"===a.name){var S=s[0].toString(),R=s[1],k=new RegExp(R,"g"),N=S.match(k),A=!1;null!==N&&S===N[0]&&(A=!0),e=e.replace(r,A),i=!0}else if("d2:addControlDigits"===a.name){var w=s[0],F=w.split(""),x=0,P=0;if(F&&F.length<10){var D=0,U=F.length,L=[3,7,6,1,8,9,4,5,2];for(l=0;l<U;l++)D+=parseInt(F[l])*L[l];x=D%11,F.push(x);var M=[5,4,3,2,7,6,5,4,3,2],B=0;for(l=0;l<U+1;l++)B+=parseInt(F[l])*M[l];P=B%11,10===x&&(loglevel__WEBPACK_IMPORTED_MODULE_2___default.a.warn("First control digit became 10, replacing with 0"),x=0),10===P&&(loglevel__WEBPACK_IMPORTED_MODULE_2___default.a.warn("Second control digit became 10, replacing with 0"),P=0)}else loglevel__WEBPACK_IMPORTED_MODULE_2___default.a.warn("Base nuber not well formed("+U+" digits): "+w);e=e.replace(r,w+x+P),i=!0}else if("d2:checkControlDigits"===a.name)loglevel__WEBPACK_IMPORTED_MODULE_2___default.a.warn("checkControlDigits not implemented yet"),e=e.replace(r,s[0]),i=!0;else if("d2:left"===a.name){var V=(H=String(s[0])).length<s[1]?H.length:s[1];b=H.substring(0,V);b=variableService.processValue(b,"TEXT"),e=e.replace(r,b),i=!0}else if("d2:right"===a.name){V=(H=String(s[0])).length<s[1]?H.length:s[1],b=H.substring(H.length-V,H.length);b=variableService.processValue(b,"TEXT"),e=e.replace(r,b),i=!0}else if("d2:substring"===a.name){var G=(H=String(s[0])).length<s[1]-1?-1:s[1],W=H.length<s[2]?-1:s[2];if(G<0||W<0)e=e.replace(r,"''"),i=!0;else{b=H.substring(G,W);b=variableService.processValue(b,"TEXT"),e=e.replace(r,b),i=!0}}else if("d2:split"===a.name){var H,z=(H=String(s[0])).split(s[1]),K="";z.length>=s[2]&&(K=z[s[2]]),K=variableService.processValue(K,"TEXT"),e=e.replace(r,K),i=!0}else"d2:zScoreWFA"===a.name?(e=e.replace(r,Object(_zScoreWFA__WEBPACK_IMPORTED_MODULE_8__.a)(s[0],s[1],s[2])),i=!0):"d2:length"===a.name&&(e=e.replace(r,String(s[0]).length),i=!0)})}),r=!(!i||-1===e.indexOf("d2:"))}return e},runExpression=function runExpression(expression,beforereplacement,identifier,flag,variablesHash){var answer=!1;if(flag&&flag.debug)try{var dhisfunctionsevaluated=runDhisFunctions(expression,variablesHash,flag);answer=eval(dhisfunctionsevaluated),flag.verbose&&loglevel__WEBPACK_IMPORTED_MODULE_2___default.a.info("Expression with id "+identifier+" was successfully run. Original condition was: "+beforereplacement+" - Evaluation ended up as:"+expression+" - Result of evaluation was:"+answer)}catch(e){loglevel__WEBPACK_IMPORTED_MODULE_2___default.a.warn("Expression with id "+identifier+" could not be run. Original condition was: "+beforereplacement+" - Evaluation ended up as:"+expression+" - error message:"+e)}else{var dhisfunctionsevaluated=runDhisFunctions(expression,variablesHash,flag);answer=eval(dhisfunctionsevaluated)}return answer},determineValueType=function(e){var t="TEXT";return"true"===e||"false"===e?t="BOOLEAN":!d2_utilizr_lib_isNumber__WEBPACK_IMPORTED_MODULE_4___default()(e)&&isNaN(e)||(t=e%1!==0?"NUMBER":"INTEGER"),t},orderRulesByPriority=function(e){return e.sort(function(e,t){return e.priority||t.priority?e.priority?t.priority?e.priority-t.priority:-1:1:0})},convertNumber=function(e){return d2_utilizr_lib_isString__WEBPACK_IMPORTED_MODULE_7___default()(e)?isNaN(e)?(loglevel__WEBPACK_IMPORTED_MODULE_2___default.a.warn("rule execution service could not convert "+e+" to number"),null):Number(e):e},ruleEffectDataConvertersByType=(_ruleEffectDataConver={},Object(_home_travis_build_dhis2_capture_app_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_defineProperty__WEBPACK_IMPORTED_MODULE_1__.a)(_ruleEffectDataConver,_typeKeys_const__WEBPACK_IMPORTED_MODULE_11__.a.BOOLEAN,function(e){return d2_utilizr_lib_isString__WEBPACK_IMPORTED_MODULE_7___default()(e)?"true"===e:e}),Object(_home_travis_build_dhis2_capture_app_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_defineProperty__WEBPACK_IMPORTED_MODULE_1__.a)(_ruleEffectDataConver,_typeKeys_const__WEBPACK_IMPORTED_MODULE_11__.a.INTEGER,convertNumber),Object(_home_travis_build_dhis2_capture_app_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_defineProperty__WEBPACK_IMPORTED_MODULE_1__.a)(_ruleEffectDataConver,_typeKeys_const__WEBPACK_IMPORTED_MODULE_11__.a.INTEGER_NEGATIVE,convertNumber),Object(_home_travis_build_dhis2_capture_app_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_defineProperty__WEBPACK_IMPORTED_MODULE_1__.a)(_ruleEffectDataConver,_typeKeys_const__WEBPACK_IMPORTED_MODULE_11__.a.INTEGER_POSITIVE,convertNumber),Object(_home_travis_build_dhis2_capture_app_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_defineProperty__WEBPACK_IMPORTED_MODULE_1__.a)(_ruleEffectDataConver,_typeKeys_const__WEBPACK_IMPORTED_MODULE_11__.a.INTEGER_ZERO_OR_POSITIVE,convertNumber),Object(_home_travis_build_dhis2_capture_app_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_defineProperty__WEBPACK_IMPORTED_MODULE_1__.a)(_ruleEffectDataConver,_typeKeys_const__WEBPACK_IMPORTED_MODULE_11__.a.NUMBER,convertNumber),Object(_home_travis_build_dhis2_capture_app_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_defineProperty__WEBPACK_IMPORTED_MODULE_1__.a)(_ruleEffectDataConver,_typeKeys_const__WEBPACK_IMPORTED_MODULE_11__.a.TRUE_ONLY,function(e){return!0}),_ruleEffectDataConver),convertRuleEffectDataToOutputBaseValue=function(e,t){return e||0===e||!1===e?ruleEffectDataConvertersByType[t]?ruleEffectDataConvertersByType[t](e):e:null},getRuleEffectData=function(e,t,n){var a=e.data,r=a,o=a.replace("#{","").replace("}","");return t[o]?r=t[o].variableValue:-1===a.indexOf("{")&&-1===a.indexOf("d2:")||(r=replaceVariables(a,t),r=runExpression(r,a,"action:"+e.id,n,t)),r&&d2_utilizr_lib_isString__WEBPACK_IMPORTED_MODULE_7___default()(r)&&(r=Object(_commonUtils_trimQuotes__WEBPACK_IMPORTED_MODULE_10__.a)(r)),r},buildAssignVariable=function(e,t){var n=e.variableType,a=convertRuleEffectDataToOutputBaseValue(t,n);return d2_utilizr_lib_isString__WEBPACK_IMPORTED_MODULE_7___default()(a)&&(a="'"+a+"'"),{variableValue:a,variableType:n,hasValue:!0,variableEventDate:"",variablePrefix:e.variablePrefix?e.variablePrefix:"#",allValues:[a]}},buildRuleEffect=function(e,t,n){var a={id:e.id,location:e.location,action:e.programRuleActionType,dataElementId:e.dataElementId,trackedEntityAttributeId:e.trackedEntityAttributeId,programStageId:e.programStageId,programStageSectionId:e.programStageSectionId,optionGroupId:e.optionGroupId,optionId:e.optionId,content:e.content,data:e.data?getRuleEffectData(e,t,n):e.data,ineffect:!0};if("ASSIGN"===a.action&&a.content){var r=a.content?a.content.replace("#{","").replace("A{","").replace("}",""):null,o=t[r];o?t[r]=buildAssignVariable(o,a.data):loglevel__WEBPACK_IMPORTED_MODULE_2___default.a.warn("Variable "+r+" was not defined.")}return a},internalExecuteRules=function(e,t,n,a,r,o,i,c,s,l){var u=e.programRules;if(0===u.length)return null;u=orderRulesByPriority(u);var d=variableService.getVariables(e,t,n,a,r,o,i,c,s);return u.map(function(e){var t,n=!1,a=e.condition;return a?(-1!==a.indexOf("{")&&(a=replaceVariables(a,d)),n=runExpression(a,e.condition,"rule:"+e.id,l,d)):loglevel__WEBPACK_IMPORTED_MODULE_2___default.a.warn("Rule id:'"+e.id+"'' and name:'"+e.name+"' had no condition specified. Please check rule configuration."),n&&(t=e.programRuleActions.map(function(e){return buildRuleEffect(e,d,l)})),t}).filter(function(e){return e}).reduce(function(e,t){return[].concat(Object(_home_travis_build_dhis2_capture_app_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_toConsumableArray__WEBPACK_IMPORTED_MODULE_0__.a)(e),Object(_home_travis_build_dhis2_capture_app_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_toConsumableArray__WEBPACK_IMPORTED_MODULE_0__.a)(t))},[])};return{executeRules:function(e,t,n,a,r,o,i,c,s,l){return e.programRules?internalExecuteRules(e,t,n,a,r,o,i,c,s,l):null},convertDataToBaseOutputValue:convertRuleEffectDataToOutputBaseValue}}},1488:function(e,t,n){"use strict";n.d(t,"a",function(){return i});var a={male:1,MALE:1,Male:1,ma:1,m:1,M:1,0:1,false:1},r={0:[2,2.4,2.8,3.2,3.7,4.2,4.8],1:[2.7,3.2,3.6,4.2,4.8,5.5,6.2],2:[3.4,3.9,4.5,5.1,5.8,6.6,7.5],3:[4,4.5,5.2,5.8,6.6,7.5,8.5],4:[4.4,5,5.7,6.4,7.3,8.2,9.3],5:[4.8,5.4,6.1,6.9,7.8,8.8,10],6:[5.1,5.7,6.5,7.3,8.2,9.3,10.6],7:[5.3,6,6.8,7.6,8.6,9.8,11.1],8:[5.6,6.3,7,7.9,9,10.2,11.6],9:[5.8,6.5,7.3,8.2,9.3,10.5,12],10:[5.9,6.7,7.5,8.5,9.6,10.9,12.4],11:[6.1,6.9,7.7,8.7,9.9,11.2,12.8],12:[6.3,7,7.9,8.9,10.1,11.5,13.1],13:[6.4,7.2,8.1,9.2,10.4,11.8,13.5],14:[6.6,7.4,8.3,9.4,10.6,12.1,13.8],15:[6.7,7.6,8.5,9.6,10.9,12.4,14.1],16:[6.9,7.7,8.7,9.8,11.1,12.6,14.5],17:[7,7.9,8.9,10,11.4,12.9,14.8],18:[7.2,8.1,9.1,10.2,11.6,13.2,15.1],19:[7.3,8.2,9.2,10.4,11.8,13.5,15.4],20:[7.5,8.4,9.4,10.6,12.1,13.7,15.7],21:[7.6,8.6,9.6,10.9,12.3,14,16],22:[7.8,8.7,9.8,11.1,12.5,14.3,16.4],23:[7.9,8.9,10,11.3,12.8,14.6,16.7],24:[8.1,9,10.2,11.5,13,14.8,17],25:[8.2,9.2,10.3,11.7,13.3,15.1,17.3],26:[8.4,9.4,10.5,11.9,13.5,15.4,17.7],27:[8.5,9.5,10.7,12.1,13.7,15.7,18],28:[8.6,9.7,10.9,12.3,14,16,18.3],29:[8.8,9.8,11.1,12.5,14.2,16.2,18.7],30:[8.9,10,11.2,12.7,14.4,16.5,19],31:[9,10.1,11.4,12.9,14.7,16.8,19.3],32:[9.1,10.3,11.6,13.1,14.9,17.1,19.6],33:[9.3,10.4,11.7,13.3,15.1,17.3,20],34:[9.4,10.5,11.9,13.5,15.4,17.6,20.3],35:[9.5,10.7,12,13.7,15.6,17.9,20.6],36:[9.6,10.8,12.2,13.9,15.8,18.1,20.9],37:[9.7,10.9,12.4,14,16,18.4,21.3],38:[9.8,11.1,12.5,14.2,16.3,18.7,21.6],39:[9.9,11.2,12.7,14.4,16.5,19,22],40:[10.1,11.3,12.8,14.6,16.7,19.2,22.3],41:[10.2,11.5,13,14.8,16.9,19.5,22.7],42:[10.3,11.6,13.1,15,17.2,19.8,23],43:[10.4,11.7,13.3,15.2,17.4,20.1,23.4],44:[10.5,11.8,13.4,15.3,17.6,20.4,23.7],45:[10.6,12,13.6,15.5,17.8,20.7,24.1],46:[10.7,12.1,13.7,15.7,18.1,20.9,24.5],47:[10.8,12.2,13.9,15.9,18.3,21.2,24.8],48:[10.9,12.3,14,16.1,18.5,21.5,25.2],49:[11,12.4,14.2,16.3,18.8,21.8,25.5],50:[11.1,12.6,14.3,16.4,19,22.1,25.9],51:[11.2,12.7,14.5,16.6,19.2,22.4,26.3],52:[11.3,12.8,14.6,16.8,19.4,22.6,26.6],53:[11.4,12.9,14.8,17,19.7,22.9,27],54:[11.5,13,14.9,17.2,19.9,23.2,27.4],55:[11.6,13.2,15.1,17.3,20.1,23.5,27.7],56:[11.7,13.3,15.2,17.5,20.3,23.8,28.1],57:[11.8,13.4,15.3,17.7,20.6,24.1,28.5],58:[11.9,13.5,15.5,17.9,20.8,24.4,28.8],59:[12,13.6,15.6,18,21,24.6,29.2],60:[12.1,13.7,15.8,18.2,21.2,24.9,29.5]},o={0:[2.1,2.5,2.9,3.3,3.9,4.4,5],1:[2.9,3.4,3.9,4.5,5.1,5.8,6.6],2:[3.8,4.3,4.9,5.6,6.3,7.1,8],3:[4.4,5,5.7,6.4,7.2,8,9],4:[4.9,5.6,6.2,7,7.8,8.7,9.7],5:[5.3,6,6.7,7.5,8.4,9.3,10.4],6:[5.7,6.4,7.1,7.9,8.8,9.8,10.9],7:[5.9,6.7,7.4,8.3,9.2,10.3,11.4],8:[6.2,6.9,7.7,8.6,9.6,10.7,11.9],9:[6.4,7.1,8,8.9,9.9,11,12.3],10:[6.6,7.4,8.2,9.2,10.2,11.4,12.7],11:[6.8,7.6,8.4,9.4,10.5,11.7,13],12:[6.9,7.7,8.6,9.6,10.8,12,13.3],13:[7.1,7.9,8.8,9.9,11,12.3,13.7],14:[7.2,8.1,9,10.1,11.3,12.6,14],15:[7.4,8.3,9.2,10.3,11.5,12.8,14.3],16:[7.5,8.4,9.4,10.5,11.7,13.1,14.6],17:[7.7,8.6,9.6,10.7,12,13.4,14.9],18:[7.8,8.8,9.8,10.9,12.2,13.7,15.3],19:[8,8.9,10,11.1,12.5,13.9,15.6],20:[8.1,9.1,10.1,11.3,12.7,14.2,15.9],21:[8.2,9.2,10.3,11.5,12.9,14.5,16.2],22:[8.4,9.4,10.5,11.8,13.2,14.7,16.5],23:[8.5,9.5,10.7,12,13.4,15,16.8],24:[8.6,9.7,10.8,12.2,13.6,15.3,17.1],25:[8.8,9.8,11,12.4,13.9,15.5,17.5],26:[8.9,10,11.2,12.5,14.1,15.8,17.8],27:[9,10.1,11.3,12.7,14.3,16.1,18.1],28:[9.1,10.2,11.5,12.9,14.5,16.3,18.4],29:[9.2,10.4,11.7,13.1,14.8,16.6,18.7],30:[9.4,10.5,11.8,13.3,15,16.9,19],31:[9.5,10.7,12,13.5,15.2,17.1,19.3],32:[9.6,10.8,12.1,13.7,15.4,17.4,19.6],33:[9.7,10.9,12.3,13.8,15.6,17.6,19.9],34:[9.8,11,12.4,14,15.8,17.8,20.2],35:[9.9,11.2,12.6,14.2,16,18.1,20.4],36:[10,11.3,12.7,14.3,16.2,18.3,20.7],37:[10.1,11.4,12.9,14.5,16.4,18.6,21],38:[10.2,11.5,13,14.7,16.6,18.8,21.3],39:[10.3,11.6,13.1,14.8,16.8,19,21.6],40:[10.4,11.8,13.3,15,17,19.3,21.9],41:[10.5,11.9,13.4,15.2,17.2,19.5,22.1],42:[10.6,12,13.6,15.3,17.4,19.7,22.4],43:[10.7,12.1,13.7,15.5,17.6,20,22.7],44:[10.8,12.2,13.8,15.7,17.8,20.2,23],45:[10.9,12.4,14,15.8,18,20.5,23.3],46:[11,12.5,14.1,16,18.2,20.7,23.6],47:[11.1,12.6,14.3,16.2,18.4,20.9,23.9],48:[11.2,12.7,14.4,16.3,18.6,21.2,24.2],49:[11.3,12.8,14.5,16.5,18.8,21.4,24.5],50:[11.4,12.9,14.7,16.7,19,21.7,24.8],51:[11.5,13.1,14.8,16.8,19.2,21.9,25.1],52:[11.6,13.2,15,17,19.4,22.2,25.4],53:[11.7,13.3,15.1,17.2,19.6,22.4,25.7],54:[11.8,13.4,15.2,17.3,19.8,22.7,26],55:[11.9,13.5,15.4,17.5,20,22.9,26.3],56:[12,13.6,15.5,17.7,20.2,23.2,26.6],57:[12.1,13.7,15.6,17.8,20.4,23.4,26.9],58:[12.2,13.8,15.8,18,20.6,23.7,27.2],59:[12.3,14,15.9,18.2,20.8,23.9,27.6],60:[12.4,14.1,16,18.3,21,24.2,27.9]};function i(e,t,n){var i=r;1===a[n]&&(i=o);var c=i[Number(e)];if(t<c[0])return-3.5;if(t>c[6])return 3.5;var s=function(e,t){for(var n,a,r=0;r<7;r++)if(!(e>=t[r]&&(n=r,e>t[r]))){a=r;break}return{lowerLimitIn:n,higherLimitIn:a}}(t,c),l=s.higherLimitIn,u=s.lowerLimitIn,d=c[l]-c[u],p=c[l]-t;return(l-3-(d>0?p/d:0)).toFixed(2)}},1492:function(e,t,n){e.exports={fieldLabelMediaBased:"enrollment_fieldLabelMediaBased__3YEY0"}},1493:function(e,t,n){e.exports={fieldLabelMediaBased:"trackedEntityInstance_fieldLabelMediaBased__1p2kP"}},1497:function(e,t,n){e.exports={booleanLabel:"viewEventDataEntryFieldLabels_booleanLabel__10B8J",trueOnlyLabel:"viewEventDataEntryFieldLabels_trueOnlyLabel__3cqEx",noteLabel:"viewEventDataEntryFieldLabels_noteLabel__2Jm54",textLabel:"viewEventDataEntryFieldLabels_textLabel__3m3cP",ageLabel:"viewEventDataEntryFieldLabels_ageLabel__3bsig",coordinateLabel:"viewEventDataEntryFieldLabels_coordinateLabel__392KM",polygonLabel:"viewEventDataEntryFieldLabels_polygonLabel__131NA",dateLabel:"viewEventDataEntryFieldLabels_dateLabel__16LeY",dateTimeLabel:"viewEventDataEntryFieldLabels_dateTimeLabel__32KuY",imageLabel:"viewEventDataEntryFieldLabels_imageLabel__131uG",fileLabel:"viewEventDataEntryFieldLabels_fileLabel__3Oljl",orgUnitLabel:"viewEventDataEntryFieldLabels_orgUnitLabel__2b0fM",defaultViewLabel:"viewEventDataEntryFieldLabels_defaultViewLabel__2cEYk"}},152:function(e,t,n){e.exports={container:"polygonField_container__3oQkC",statusContainer:"polygonField_statusContainer__1j0z-",mapIcon:"polygonField_mapIcon__2i-qm",statusText:"polygonField_statusText__k6Roe",checkIcon:"polygonField_checkIcon__2vpgF",dialogActionOuterContainer:"polygonField_dialogActionOuterContainer__u9Goe",dialogActionInnerContainer:"polygonField_dialogActionInnerContainer__3w3vo",mapContainer:"polygonField_mapContainer__1XYaY",map:"polygonField_map__11WB0",dialogContent:"polygonField_dialogContent__3jo6F"}},16:function(e,t,n){"use strict";var a=n(40),r=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return function(e){for(var n=arguments.length,a=new Array(n>1?n-1:0),r=1;r<n;r++)a[r-1]=arguments[r];return t.reduce(function(e,t){return t.apply(void 0,[e].concat(a))},e)}},o=function(e){var t=!1;return{promise:new Promise(function(n,a){e.then(function(e){return t?a({isCanceled:!0}):n(e)},function(e){return a(t?{isCanceled:!0}:e)})}),cancel:function(){t=!0}}};function i(e,t){return e&&0!==e.length?!t||t<1?[e]:function(e,t,n){for(var a=[],r=0,o=0;r<e;r+=1,o+=n)a[r]=t.slice(o,o+n);return a}(Math.ceil(e.length/t),e,t):[]}n.d(t,"b",function(){return a.a}),n.d(t,"d",function(){return r}),n.d(t,"c",function(){return o}),n.d(t,"a",function(){return i})},187:function(e,t,n){e.exports={booleanLabel:"dataEntryFieldLabels_booleanLabel__3AS-_",trueOnlyLabel:"dataEntryFieldLabels_trueOnlyLabel__nZ9WA",noteLabel:"dataEntryFieldLabels_noteLabel__3Rbrn",textLabel:"dataEntryFieldLabels_textLabel__3OQWc",ageLabel:"dataEntryFieldLabels_ageLabel__1wkeF",coordinateLabel:"dataEntryFieldLabels_coordinateLabel__2pREh",polygonLabel:"dataEntryFieldLabels_polygonLabel__3ULxn",dateLabel:"dataEntryFieldLabels_dateLabel__8LmlJ",dateTimeLabel:"dataEntryFieldLabels_dateTimeLabel__YXXLp",imageLabel:"dataEntryFieldLabels_imageLabel__1_PkI",fileLabel:"dataEntryFieldLabels_fileLabel__LPfZK",orgUnitLabel:"dataEntryFieldLabels_orgUnitLabel__uTm18"}},207:function(e,t,n){"use strict";function a(e){for(var t=!1,n=e;!t;){var a=n;n=(n=n.replace(/^'/,"").replace(/'$/,"")).replace(/^"/,"").replace(/"$/,""),a.length===n.length&&(t=!0)}return n}n.d(t,"a",function(){return a})},225:function(e,t,n){"use strict";n.d(t,"a",function(){return c});var a=n(5),r=n(3),o=n(0),i=n(1452),c=function(){function e(t){Object(a.a)(this,e),this.transformNode=function(e,t,n){if("input"===e.name){var a=e.attribs&&e.attribs.id,r=a&&/-[^-]+/.exec(a);if(r){var i=r[0].replace("-",""),c=n(e,t),s={id:a,style:c.props&&c.props.style,className:c.props&&c.props.className};return o.createElement("FormField",{customFormElementProps:s,id:i})}}},this._id="",t&&t(this)}return Object(r.a)(e,[{key:"id",set:function(e){this._id=e},get:function(){return this._id}},{key:"data",set:function(e){var t=Object(i.parseHtml)(e,{onTransform:this.transformNode,allowScript:!0});this._data=t},get:function(){return this._data}}]),e}()},237:function(e,t,n){e.exports={input:"singleSelectBox_input__1Zrx9",iconContainer:"singleSelectBox_iconContainer__3OPYp",iconFocusContainer:"singleSelectBox_iconFocusContainer__3oaYC",label:"singleSelectBox_label__1O330",name:"singleSelectBox_name__NXvPQ",inFocus:"singleSelectBox_inFocus__1K0EV","focus-pulsate":"singleSelectBox_focus-pulsate__1oHtv",labelDisabled:"singleSelectBox_labelDisabled__2Sc3k"}},321:function(e,t,n){e.exports={container:"ageField_container__3fJcP",containerVertical:"ageField_containerVertical__2CE5f",containerHorizontal:"ageField_containerHorizontal__3yYZP",ageNumberInputContainer:"ageField_ageNumberInputContainer__1h9Hq",ageDateInputContainerHorizontal:"ageField_ageDateInputContainerHorizontal__2AZUO",ageClearHorizontal:"ageField_ageClearHorizontal__39CWV"}},322:function(e,t,n){e.exports={container:"withLabel_container__3Cump",containerVertical:"withLabel_containerVertical__1_7Ph",labelContainer:"withLabel_labelContainer__3zr5W",labelContainerVertical:"withLabel_labelContainerVertical__FS1cE",inputContainer:"withLabel_inputContainer__QUgb0"}},35:function(e,t,n){"use strict";(function(e){n.d(t,"a",function(){return m}),n.d(t,"b",function(){return h});var a=n(2),r=n(70),o=n.n(r),i=n(111),c=n.n(i),s=n(13),l=n.n(s),u=n(133);var d=function(e){return function(t,n){return function(e,t,n,a){return o()(e)&&null!==e||(e=a),n[t.type]?n[t.type](e,t):e}(t,n,e.updaters,e.initValue)}},p=function(e){var t=function(e){return function(t,n){l.a.trace("Updater for ".concat(n.type," started in ").concat(e.name,". \n                Starting state is: ").concat(JSON.stringify(t)))}}(e),n=function(e){return function(t,n){l.a.trace("Updater for ".concat(n.type," executed in ").concat(e.name,". \n                New state is: ").concat(JSON.stringify(t)))}}(e);return function(r,i){var c=function(e){var t=e.meta&&e.meta.skipLogging&&e.meta.skipLogging.reduce(function(e,t){return e[t]=null,e},{});return Object(a.a)({},e,{payload:Object(a.a)({},e.payload,t)})}(i);l.a.trace("reducer ".concat(e.name," starting. Action is: ").concat(JSON.stringify(c)));var s=function(e,t,n,a,r,i){if(o()(e)&&null!==e||(e=a),n[t.type]){r(e,t);var c=n[t.type](e,t);return i(e,t),c}return e}(r,i,e.updaters,e.initValue,t,n);return l.a.trace("reducer ".concat(e.name," finished")),s}};function f(t){var n=(e&&Object({NODE_ENV:"production",PUBLIC_URL:".",REACT_APP_DHIS2_BASE_URL:"..",REACT_APP_DHIS2_AUTHORIZATION:"",REACT_APP_CACHE_VERSION:"6"})&&"production")===u.a.prod?d(t):p(t);return t.reducerWrappers&&(n=function(e,t){return c()(t)?t.reduceRight(function(e,t){return t(e)},e):t(e)}(n,t.reducerWrappers)),n}function m(e){return e.reduce(function(e,t){return e[t.name]=f(t),e},{})}function h(e,t){return{initValue:arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},name:t,updaters:e,reducerWrappers:arguments.length>3?arguments[3]:void 0}}}).call(this,n(1158))},394:function(e,t,n){e.exports={input:"textInput_input__ds2wD",inputWrapper:"textInput_inputWrapper__1MKHf",textArea:"textInput_textArea__Svl82"}},40:function(e,t,n){"use strict";var a=n(2),r=function(e){return function(t){return Object(a.a)({},t,{message:e})}};n.d(t,"a",function(){return r})},400:function(e,t,n){e.exports={containerAbsolute:"datePopup_containerAbsolute__2B9uo",calendarAbsolute:"datePopup_calendarAbsolute__2r7gO"}},401:function(e,t,n){e.exports={containerHorizontal:"singleSelectionBoxes_containerHorizontal__1zV1v",containerVertical:"singleSelectionBoxes_containerVertical__13cIB",optionContainerHorizontal:"singleSelectionBoxes_optionContainerHorizontal__1VV6f",optionContainerVertical:"singleSelectionBoxes_optionContainerVertical__3lwWT",disabledIcon:"singleSelectionBoxes_disabledIcon__3q8eE"}},403:function(e,t,n){e.exports={booleanLabel:"dataEntryFieldLabels_booleanLabel__3f6q0",trueOnlyLabel:"dataEntryFieldLabels_trueOnlyLabel__33SvC",noteLabel:"dataEntryFieldLabels_noteLabel__1bTp6",textLabel:"dataEntryFieldLabels_textLabel__3jiBV",ageLabel:"dataEntryFieldLabels_ageLabel__3ggJ_",coordinateLabel:"dataEntryFieldLabels_coordinateLabel__30luq",polygonLabel:"dataEntryFieldLabels_polygonLabel__3wUex",dateLabel:"dataEntryFieldLabels_dateLabel__StF4b",dateTimeLabel:"dataEntryFieldLabels_dateTimeLabel__7i_PB",imageLabel:"dataEntryFieldLabels_imageLabel__2eMYd",fileLabel:"dataEntryFieldLabels_fileLabel__1KwqS",orgUnitLabel:"dataEntryFieldLabels_orgUnitLabel__3XQFX"}},404:function(e,t,n){e.exports={booleanLabel:"fieldLabels_booleanLabel__2h4s1",trueOnlyLabel:"fieldLabels_trueOnlyLabel__2AXjc",noteLabel:"fieldLabels_noteLabel__1Q8eH",textLabel:"fieldLabels_textLabel__8zqci",ageLabel:"fieldLabels_ageLabel__28quC",coordinateLabel:"fieldLabels_coordinateLabel__2TYfu",polygonLabel:"fieldLabels_polygonLabel__nBBf6",dateLabel:"fieldLabels_dateLabel__3Ic7u",dateTimeLabel:"fieldLabels_dateTimeLabel__Fwt-H",imageLabel:"fieldLabels_imageLabel__3fcZo",fileLabel:"fieldLabels_fileLabel__oyoTh",orgUnitLabel:"fieldLabels_orgUnitLabel__21Rqy"}},46:function(e,t,n){"use strict";t.a={TEXT:"TEXT",LONG_TEXT:"LONG_TEXT",LETTER:"LETTER",PHONE_NUMBER:"PHONE_NUMBER",EMAIL:"EMAIL",BOOLEAN:"BOOLEAN",TRUE_ONLY:"TRUE_ONLY",DATE:"DATE",DATETIME:"DATETIME",TIME:"TIME",NUMBER:"NUMBER",INTEGER:"INTEGER",INTEGER_POSITIVE:"INTEGER_POSITIVE",INTEGER_NEGATIVE:"INTEGER_NEGATIVE",INTEGER_ZERO_OR_POSITIVE:"INTEGER_ZERO_OR_POSITIVE",PERCENTAGE:"PERCENTAGE",URL:"URL",AGE:"AGE",ORGANISATION_UNIT:"ORGANISATION_UNIT",COORDINATE:"COORDINATE",USERNAME:"USERNAME"}},565:function(e,t,n){"use strict";n.d(t,"a",function(){return o});var a=n(5),r=n(3),o=function(){function e(){Object(a.a)(this,e)}return Object(r.a)(e,null,[{key:"getCode",value:function(e,t){if(e){var n=e.find(function(e){return e.displayName===t});return n&&n.code||t}return t}},{key:"getName",value:function(e,t){if(e){var n=e.find(function(e){return e.code===t});return n&&n.displayName||t}return t}}]),e}()},576:function(e,t,n){e.exports={label:"shrinkLabel_label__36OfO",labelUnshrinked:"shrinkLabel_labelUnshrinked__1UpsD",labelShrinked:"shrinkLabel_labelShrinked__LxOYT"}},577:function(e,t,n){e.exports={fieldsContainer:"dateTime_fieldsContainer__36n7Y",fieldsContainerVertical:"dateTime_fieldsContainerVertical__1MbUi",formControl:"dateTime_formControl__62gFJ",root:"dateTime_root__3eYC5"}},578:function(e,t,n){e.exports={container:"textRangeField_container__1BXo6"}},579:function(e,t,n){e.exports={container:"dateRangeField_container__3_YtY"}},580:function(e,t,n){},63:function(e,t,n){e.exports={booleanLabel:"buildField_booleanLabel__3dor9",trueOnlyLabel:"buildField_trueOnlyLabel__2-zcY",textLabel:"buildField_textLabel__1cDlu",ageLabel:"buildField_ageLabel__ZsDnV",coordinateLabel:"buildField_coordinateLabel__1cOeH",polygonLabel:"buildField_polygonLabel__16JAW",dateLabel:"buildField_dateLabel__sZrrS",dateTimeLabel:"buildField_dateTimeLabel__Kz7L7",imageLabel:"buildField_imageLabel__23Idm",fileLabel:"buildField_fileLabel__jaDN8",orgUnitLabel:"buildField_orgUnitLabel__3fJto",optionSetBoxesLabel:"buildField_optionSetBoxesLabel__Gtc5V"}},6891:function(e,t,n){e.exports=n(8457)},6893:function(e,t){Object.defineProperty(Array.prototype,"toHashMap",{enumerable:!1,value:function(e){return this.reduce(function(t,n){return t[n[e]]=n,t},{})}})},6974:function(e,t,n){},72:function(e,t,n){e.exports={table:"table_table__x6PK0",tableRow:"table_tableRow__ZPxu7",tableRowBody:"table_tableRowBody__2lMyg",tableRowHeader:"table_tableRowHeader__1kF-y",tableRowFooter:"table_tableRowFooter__r5tTo",tableCell:"table_tableCell__3ba4L",tableCellBody:"table_tableCellBody__1PUit",tableCellHeader:"table_tableCellHeader__1od-6",tableCellFooter:"table_tableCellFooter__dvM7q",pagination:"table_pagination__3HVOc",paginationRowsPerPageElementContainer:"table_paginationRowsPerPageElementContainer__2rJop",paginationRowsPerPageElement:"table_paginationRowsPerPageElement__2U_EM",paginationDisplayRowsContainer:"table_paginationDisplayRowsContainer__1IPYP",sortLabelContainer:"table_sortLabelContainer__2DEo0",sortLabelChildren:"table_sortLabelChildren__14ADQ",sortLabelChildrenEnabled:"table_sortLabelChildrenEnabled__64-XS",sortLabelChildrenFirst:"table_sortLabelChildrenFirst__ymisK",sortLabelChildrenLast:"table_sortLabelChildrenLast__1MU6N",sortLabelRight:"table_sortLabelRight__2cJvj",sortLabelIcon:"table_sortLabelIcon__LUws7"}},7858:function(e,t){},7945:function(e,t,n){},7951:function(e,t,n){},7973:function(e,t,n){},7982:function(e,t,n){},8057:function(e,t,n){},8113:function(e,t,n){},8116:function(e,t,n){},8117:function(e,t,n){},8455:function(e,t,n){var a={"./af":[1505,135],"./af.js":[1505,135],"./ar":[1512,142],"./ar-dz":[1506,136],"./ar-dz.js":[1506,136],"./ar-kw":[1507,137],"./ar-kw.js":[1507,137],"./ar-ly":[1508,138],"./ar-ly.js":[1508,138],"./ar-ma":[1509,139],"./ar-ma.js":[1509,139],"./ar-sa":[1510,140],"./ar-sa.js":[1510,140],"./ar-tn":[1511,141],"./ar-tn.js":[1511,141],"./ar.js":[1512,142],"./az":[1513,143],"./az.js":[1513,143],"./be":[1514,144],"./be.js":[1514,144],"./bg":[1515,145],"./bg.js":[1515,145],"./bm":[1516,146],"./bm.js":[1516,146],"./bn":[1517,147],"./bn.js":[1517,147],"./bo":[1518,148],"./bo.js":[1518,148],"./br":[1519,149],"./br.js":[1519,149],"./bs":[1520,150],"./bs.js":[1520,150],"./ca":[1521,151],"./ca.js":[1521,151],"./cs":[1522,152],"./cs.js":[1522,152],"./cv":[1523,153],"./cv.js":[1523,153],"./cy":[1524,154],"./cy.js":[1524,154],"./da":[1525,155],"./da.js":[1525,155],"./de":[1528,158],"./de-at":[1526,156],"./de-at.js":[1526,156],"./de-ch":[1527,157],"./de-ch.js":[1527,157],"./de.js":[1528,158],"./dv":[1529,159],"./dv.js":[1529,159],"./el":[1530,160],"./el.js":[1530,160],"./en-au":[1531,161],"./en-au.js":[1531,161],"./en-ca":[1532,162],"./en-ca.js":[1532,162],"./en-gb":[1533,163],"./en-gb.js":[1533,163],"./en-ie":[1534,164],"./en-ie.js":[1534,164],"./en-il":[1535,165],"./en-il.js":[1535,165],"./en-nz":[1536,166],"./en-nz.js":[1536,166],"./eo":[1537,167],"./eo.js":[1537,167],"./es":[1540,170],"./es-do":[1538,168],"./es-do.js":[1538,168],"./es-us":[1539,169],"./es-us.js":[1539,169],"./es.js":[1540,170],"./et":[1541,171],"./et.js":[1541,171],"./eu":[1542,172],"./eu.js":[1542,172],"./fa":[1543,173],"./fa.js":[1543,173],"./fi":[1544,174],"./fi.js":[1544,174],"./fo":[1545,175],"./fo.js":[1545,175],"./fr":[1548,178],"./fr-ca":[1546,176],"./fr-ca.js":[1546,176],"./fr-ch":[1547,177],"./fr-ch.js":[1547,177],"./fr.js":[1548,178],"./fy":[1549,179],"./fy.js":[1549,179],"./gd":[1550,180],"./gd.js":[1550,180],"./gl":[1551,181],"./gl.js":[1551,181],"./gom-latn":[1552,182],"./gom-latn.js":[1552,182],"./gu":[1553,183],"./gu.js":[1553,183],"./he":[1554,184],"./he.js":[1554,184],"./hi":[1555,185],"./hi.js":[1555,185],"./hr":[1556,186],"./hr.js":[1556,186],"./hu":[1557,187],"./hu.js":[1557,187],"./hy-am":[1558,188],"./hy-am.js":[1558,188],"./id":[1559,189],"./id.js":[1559,189],"./is":[1560,190],"./is.js":[1560,190],"./it":[1561,191],"./it.js":[1561,191],"./ja":[1562,192],"./ja.js":[1562,192],"./jv":[1563,193],"./jv.js":[1563,193],"./ka":[1564,194],"./ka.js":[1564,194],"./kk":[1565,195],"./kk.js":[1565,195],"./km":[1566,196],"./km.js":[1566,196],"./kn":[1567,197],"./kn.js":[1567,197],"./ko":[1568,198],"./ko.js":[1568,198],"./ky":[1569,199],"./ky.js":[1569,199],"./lb":[1570,200],"./lb.js":[1570,200],"./lo":[1571,201],"./lo.js":[1571,201],"./lt":[1572,202],"./lt.js":[1572,202],"./lv":[1573,203],"./lv.js":[1573,203],"./me":[1574,204],"./me.js":[1574,204],"./mi":[1575,205],"./mi.js":[1575,205],"./mk":[1576,206],"./mk.js":[1576,206],"./ml":[1577,207],"./ml.js":[1577,207],"./mn":[1578,208],"./mn.js":[1578,208],"./mr":[1579,209],"./mr.js":[1579,209],"./ms":[1581,211],"./ms-my":[1580,210],"./ms-my.js":[1580,210],"./ms.js":[1581,211],"./mt":[1582,212],"./mt.js":[1582,212],"./my":[1583,213],"./my.js":[1583,213],"./nb":[1584,214],"./nb.js":[1584,214],"./ne":[1585,215],"./ne.js":[1585,215],"./nl":[1587,217],"./nl-be":[1586,216],"./nl-be.js":[1586,216],"./nl.js":[1587,217],"./nn":[1588,218],"./nn.js":[1588,218],"./pa-in":[1589,219],"./pa-in.js":[1589,219],"./pl":[1590,220],"./pl.js":[1590,220],"./pt":[1592,222],"./pt-br":[1591,221],"./pt-br.js":[1591,221],"./pt.js":[1592,222],"./ro":[1593,223],"./ro.js":[1593,223],"./ru":[1594,224],"./ru.js":[1594,224],"./sd":[1595,225],"./sd.js":[1595,225],"./se":[1596,226],"./se.js":[1596,226],"./si":[1597,227],"./si.js":[1597,227],"./sk":[1598,228],"./sk.js":[1598,228],"./sl":[1599,229],"./sl.js":[1599,229],"./sq":[1600,230],"./sq.js":[1600,230],"./sr":[1602,232],"./sr-cyrl":[1601,231],"./sr-cyrl.js":[1601,231],"./sr.js":[1602,232],"./ss":[1603,233],"./ss.js":[1603,233],"./sv":[1604,234],"./sv.js":[1604,234],"./sw":[1605,235],"./sw.js":[1605,235],"./ta":[1606,236],"./ta.js":[1606,236],"./te":[1607,237],"./te.js":[1607,237],"./tet":[1608,238],"./tet.js":[1608,238],"./tg":[1609,239],"./tg.js":[1609,239],"./th":[1610,240],"./th.js":[1610,240],"./tl-ph":[1611,241],"./tl-ph.js":[1611,241],"./tlh":[1612,242],"./tlh.js":[1612,242],"./tr":[1613,243],"./tr.js":[1613,243],"./tzl":[1614,244],"./tzl.js":[1614,244],"./tzm":[1616,246],"./tzm-latn":[1615,245],"./tzm-latn.js":[1615,245],"./tzm.js":[1616,246],"./ug-cn":[1617,247],"./ug-cn.js":[1617,247],"./uk":[1618,248],"./uk.js":[1618,248],"./ur":[680],"./ur.js":[680],"./uz":[1620,250],"./uz-latn":[1619,249],"./uz-latn.js":[1619,249],"./uz.js":[1620,250],"./vi":[681],"./vi.js":[681],"./x-pseudo":[1621,251],"./x-pseudo.js":[1621,251],"./yo":[1622,252],"./yo.js":[1622,252],"./zh-cn":[1623,253],"./zh-cn.js":[1623,253],"./zh-hk":[1624,254],"./zh-hk.js":[1624,254],"./zh-tw":[1625,255],"./zh-tw.js":[1625,255]};function r(e){if(!n.o(a,e))return Promise.resolve().then(function(){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t});var t=a[e],r=t[0];return Promise.all(t.slice(1).map(n.e)).then(function(){return n.t(r,7)})}r.keys=function(){return Object.keys(a)},r.id=8455,e.exports=r},8456:function(e,t,n){var a={"./_lib/build_formatting_tokens_reg_exp":[323,7],"./_lib/build_formatting_tokens_reg_exp/":[323,7],"./_lib/build_formatting_tokens_reg_exp/index":[323,7],"./_lib/build_formatting_tokens_reg_exp/index.js":[323,7],"./_lib/package":[1626,3,99],"./_lib/package.json":[1626,3,99],"./ar":[647,7,0],"./ar/":[647,7,0],"./ar/build_distance_in_words_locale":[581,7,33],"./ar/build_distance_in_words_locale/":[581,7,33],"./ar/build_distance_in_words_locale/index":[581,7,33],"./ar/build_distance_in_words_locale/index.js":[581,7,33],"./ar/build_format_locale":[582,7,34],"./ar/build_format_locale/":[582,7,34],"./ar/build_format_locale/index":[582,7,34],"./ar/build_format_locale/index.js":[582,7,34],"./ar/index":[647,7,0],"./ar/index.js":[647,7,0],"./ar/package":[1627,3,100],"./ar/package.json":[1627,3,100],"./bg":[648,7,1],"./bg/":[648,7,1],"./bg/build_distance_in_words_locale":[583,7,35],"./bg/build_distance_in_words_locale/":[583,7,35],"./bg/build_distance_in_words_locale/index":[583,7,35],"./bg/build_distance_in_words_locale/index.js":[583,7,35],"./bg/build_format_locale":[584,7,36],"./bg/build_format_locale/":[584,7,36],"./bg/build_format_locale/index":[584,7,36],"./bg/build_format_locale/index.js":[584,7,36],"./bg/index":[648,7,1],"./bg/index.js":[648,7,1],"./bg/package":[1628,3,101],"./bg/package.json":[1628,3,101],"./ca":[649,7,2],"./ca/":[649,7,2],"./ca/build_distance_in_words_locale":[585,7,37],"./ca/build_distance_in_words_locale/":[585,7,37],"./ca/build_distance_in_words_locale/index":[585,7,37],"./ca/build_distance_in_words_locale/index.js":[585,7,37],"./ca/build_format_locale":[586,7,38],"./ca/build_format_locale/":[586,7,38],"./ca/build_format_locale/index":[586,7,38],"./ca/build_format_locale/index.js":[586,7,38],"./ca/index":[649,7,2],"./ca/index.js":[649,7,2],"./ca/package":[1629,3,102],"./ca/package.json":[1629,3,102],"./cs":[650,7,3],"./cs/":[650,7,3],"./cs/build_distance_in_words_locale":[587,7,39],"./cs/build_distance_in_words_locale/":[587,7,39],"./cs/build_distance_in_words_locale/index":[587,7,39],"./cs/build_distance_in_words_locale/index.js":[587,7,39],"./cs/build_format_locale":[588,7,40],"./cs/build_format_locale/":[588,7,40],"./cs/build_format_locale/index":[588,7,40],"./cs/build_format_locale/index.js":[588,7,40],"./cs/index":[650,7,3],"./cs/index.js":[650,7,3],"./cs/package":[1630,3,103],"./cs/package.json":[1630,3,103],"./da":[651,7,4],"./da/":[651,7,4],"./da/build_distance_in_words_locale":[589,7,41],"./da/build_distance_in_words_locale/":[589,7,41],"./da/build_distance_in_words_locale/index":[589,7,41],"./da/build_distance_in_words_locale/index.js":[589,7,41],"./da/build_format_locale":[590,7,42],"./da/build_format_locale/":[590,7,42],"./da/build_format_locale/index":[590,7,42],"./da/build_format_locale/index.js":[590,7,42],"./da/index":[651,7,4],"./da/index.js":[651,7,4],"./da/package":[1631,3,104],"./da/package.json":[1631,3,104],"./de":[652,7,5],"./de/":[652,7,5],"./de/build_distance_in_words_locale":[591,7,43],"./de/build_distance_in_words_locale/":[591,7,43],"./de/build_distance_in_words_locale/index":[591,7,43],"./de/build_distance_in_words_locale/index.js":[591,7,43],"./de/build_format_locale":[592,7,44],"./de/build_format_locale/":[592,7,44],"./de/build_format_locale/index":[592,7,44],"./de/build_format_locale/index.js":[592,7,44],"./de/index":[652,7,5],"./de/index.js":[652,7,5],"./de/package":[1632,3,105],"./de/package.json":[1632,3,105],"./el":[653,7,6],"./el/":[653,7,6],"./el/build_distance_in_words_locale":[593,7,45],"./el/build_distance_in_words_locale/":[593,7,45],"./el/build_distance_in_words_locale/index":[593,7,45],"./el/build_distance_in_words_locale/index.js":[593,7,45],"./el/build_format_locale":[594,7,46],"./el/build_format_locale/":[594,7,46],"./el/build_format_locale/index":[594,7,46],"./el/build_format_locale/index.js":[594,7,46],"./el/index":[653,7,6],"./el/index.js":[653,7,6],"./el/package":[1633,3,106],"./el/package.json":[1633,3,106],"./en":[368,7],"./en/":[368,7],"./en/build_distance_in_words_locale":[369,7],"./en/build_distance_in_words_locale/":[369,7],"./en/build_distance_in_words_locale/index":[369,7],"./en/build_distance_in_words_locale/index.js":[369,7],"./en/build_format_locale":[370,7],"./en/build_format_locale/":[370,7],"./en/build_format_locale/index":[370,7],"./en/build_format_locale/index.js":[370,7],"./en/index":[368,7],"./en/index.js":[368,7],"./en/package":[1634,3,107],"./en/package.json":[1634,3,107],"./eo":[654,7,7],"./eo/":[654,7,7],"./eo/build_distance_in_words_locale":[595,7,47],"./eo/build_distance_in_words_locale/":[595,7,47],"./eo/build_distance_in_words_locale/index":[595,7,47],"./eo/build_distance_in_words_locale/index.js":[595,7,47],"./eo/build_format_locale":[596,7,48],"./eo/build_format_locale/":[596,7,48],"./eo/build_format_locale/index":[596,7,48],"./eo/build_format_locale/index.js":[596,7,48],"./eo/index":[654,7,7],"./eo/index.js":[654,7,7],"./eo/package":[1635,3,108],"./eo/package.json":[1635,3,108],"./es":[655,7,8],"./es/":[655,7,8],"./es/build_distance_in_words_locale":[597,7,49],"./es/build_distance_in_words_locale/":[597,7,49],"./es/build_distance_in_words_locale/index":[597,7,49],"./es/build_distance_in_words_locale/index.js":[597,7,49],"./es/build_format_locale":[598,7,50],"./es/build_format_locale/":[598,7,50],"./es/build_format_locale/index":[598,7,50],"./es/build_format_locale/index.js":[598,7,50],"./es/index":[655,7,8],"./es/index.js":[655,7,8],"./es/package":[1636,3,109],"./es/package.json":[1636,3,109],"./fi":[656,7,9],"./fi/":[656,7,9],"./fi/build_distance_in_words_locale":[599,7,51],"./fi/build_distance_in_words_locale/":[599,7,51],"./fi/build_distance_in_words_locale/index":[599,7,51],"./fi/build_distance_in_words_locale/index.js":[599,7,51],"./fi/build_format_locale":[600,7,52],"./fi/build_format_locale/":[600,7,52],"./fi/build_format_locale/index":[600,7,52],"./fi/build_format_locale/index.js":[600,7,52],"./fi/index":[656,7,9],"./fi/index.js":[656,7,9],"./fi/package":[1637,3,110],"./fi/package.json":[1637,3,110],"./fil":[657,7,10],"./fil/":[657,7,10],"./fil/build_distance_in_words_locale":[601,7,53],"./fil/build_distance_in_words_locale/":[601,7,53],"./fil/build_distance_in_words_locale/index":[601,7,53],"./fil/build_distance_in_words_locale/index.js":[601,7,53],"./fil/build_format_locale":[602,7,54],"./fil/build_format_locale/":[602,7,54],"./fil/build_format_locale/index":[602,7,54],"./fil/build_format_locale/index.js":[602,7,54],"./fil/index":[657,7,10],"./fil/index.js":[657,7,10],"./fil/package":[1638,3,111],"./fil/package.json":[1638,3,111],"./fr":[658,7,11],"./fr/":[658,7,11],"./fr/build_distance_in_words_locale":[603,7,55],"./fr/build_distance_in_words_locale/":[603,7,55],"./fr/build_distance_in_words_locale/index":[603,7,55],"./fr/build_distance_in_words_locale/index.js":[603,7,55],"./fr/build_format_locale":[604,7,56],"./fr/build_format_locale/":[604,7,56],"./fr/build_format_locale/index":[604,7,56],"./fr/build_format_locale/index.js":[604,7,56],"./fr/index":[658,7,11],"./fr/index.js":[658,7,11],"./fr/package":[1639,3,112],"./fr/package.json":[1639,3,112],"./hr":[659,7,12],"./hr/":[659,7,12],"./hr/build_distance_in_words_locale":[605,7,57],"./hr/build_distance_in_words_locale/":[605,7,57],"./hr/build_distance_in_words_locale/index":[605,7,57],"./hr/build_distance_in_words_locale/index.js":[605,7,57],"./hr/build_format_locale":[606,7,58],"./hr/build_format_locale/":[606,7,58],"./hr/build_format_locale/index":[606,7,58],"./hr/build_format_locale/index.js":[606,7,58],"./hr/index":[659,7,12],"./hr/index.js":[659,7,12],"./hr/package":[1640,3,113],"./hr/package.json":[1640,3,113],"./hu":[660,7,13],"./hu/":[660,7,13],"./hu/build_distance_in_words_locale":[607,7,59],"./hu/build_distance_in_words_locale/":[607,7,59],"./hu/build_distance_in_words_locale/index":[607,7,59],"./hu/build_distance_in_words_locale/index.js":[607,7,59],"./hu/build_format_locale":[608,7,60],"./hu/build_format_locale/":[608,7,60],"./hu/build_format_locale/index":[608,7,60],"./hu/build_format_locale/index.js":[608,7,60],"./hu/index":[660,7,13],"./hu/index.js":[660,7,13],"./hu/package":[1641,3,114],"./hu/package.json":[1641,3,114],"./id":[661,7,14],"./id/":[661,7,14],"./id/build_distance_in_words_locale":[609,7,61],"./id/build_distance_in_words_locale/":[609,7,61],"./id/build_distance_in_words_locale/index":[609,7,61],"./id/build_distance_in_words_locale/index.js":[609,7,61],"./id/build_format_locale":[610,7,62],"./id/build_format_locale/":[610,7,62],"./id/build_format_locale/index":[610,7,62],"./id/build_format_locale/index.js":[610,7,62],"./id/index":[661,7,14],"./id/index.js":[661,7,14],"./id/package":[1642,3,115],"./id/package.json":[1642,3,115],"./is":[662,7,15],"./is/":[662,7,15],"./is/build_distance_in_words_locale":[611,7,63],"./is/build_distance_in_words_locale/":[611,7,63],"./is/build_distance_in_words_locale/index":[611,7,63],"./is/build_distance_in_words_locale/index.js":[611,7,63],"./is/build_format_locale":[612,7,64],"./is/build_format_locale/":[612,7,64],"./is/build_format_locale/index":[612,7,64],"./is/build_format_locale/index.js":[612,7,64],"./is/index":[662,7,15],"./is/index.js":[662,7,15],"./is/package":[1643,3,116],"./is/package.json":[1643,3,116],"./it":[663,7,16],"./it/":[663,7,16],"./it/build_distance_in_words_locale":[613,7,65],"./it/build_distance_in_words_locale/":[613,7,65],"./it/build_distance_in_words_locale/index":[613,7,65],"./it/build_distance_in_words_locale/index.js":[613,7,65],"./it/build_format_locale":[614,7,66],"./it/build_format_locale/":[614,7,66],"./it/build_format_locale/index":[614,7,66],"./it/build_format_locale/index.js":[614,7,66],"./it/index":[663,7,16],"./it/index.js":[663,7,16],"./it/package":[1644,3,117],"./it/package.json":[1644,3,117],"./ja":[664,7,17],"./ja/":[664,7,17],"./ja/build_distance_in_words_locale":[615,7,67],"./ja/build_distance_in_words_locale/":[615,7,67],"./ja/build_distance_in_words_locale/index":[615,7,67],"./ja/build_distance_in_words_locale/index.js":[615,7,67],"./ja/build_format_locale":[616,7,68],"./ja/build_format_locale/":[616,7,68],"./ja/build_format_locale/index":[616,7,68],"./ja/build_format_locale/index.js":[616,7,68],"./ja/index":[664,7,17],"./ja/index.js":[664,7,17],"./ja/package":[1645,3,118],"./ja/package.json":[1645,3,118],"./ko":[665,7,18],"./ko/":[665,7,18],"./ko/build_distance_in_words_locale":[617,7,69],"./ko/build_distance_in_words_locale/":[617,7,69],"./ko/build_distance_in_words_locale/index":[617,7,69],"./ko/build_distance_in_words_locale/index.js":[617,7,69],"./ko/build_format_locale":[618,7,70],"./ko/build_format_locale/":[618,7,70],"./ko/build_format_locale/index":[618,7,70],"./ko/build_format_locale/index.js":[618,7,70],"./ko/index":[665,7,18],"./ko/index.js":[665,7,18],"./ko/package":[1646,3,119],"./ko/package.json":[1646,3,119],"./mk":[666,7,19],"./mk/":[666,7,19],"./mk/build_distance_in_words_locale":[619,7,71],"./mk/build_distance_in_words_locale/":[619,7,71],"./mk/build_distance_in_words_locale/index":[619,7,71],"./mk/build_distance_in_words_locale/index.js":[619,7,71],"./mk/build_format_locale":[620,7,72],"./mk/build_format_locale/":[620,7,72],"./mk/build_format_locale/index":[620,7,72],"./mk/build_format_locale/index.js":[620,7,72],"./mk/index":[666,7,19],"./mk/index.js":[666,7,19],"./mk/package":[1647,3,120],"./mk/package.json":[1647,3,120],"./nb":[667,7,20],"./nb/":[667,7,20],"./nb/build_distance_in_words_locale":[621,7,73],"./nb/build_distance_in_words_locale/":[621,7,73],"./nb/build_distance_in_words_locale/index":[621,7,73],"./nb/build_distance_in_words_locale/index.js":[621,7,73],"./nb/build_format_locale":[622,7,74],"./nb/build_format_locale/":[622,7,74],"./nb/build_format_locale/index":[622,7,74],"./nb/build_format_locale/index.js":[622,7,74],"./nb/index":[667,7,20],"./nb/index.js":[667,7,20],"./nb/package":[1648,3,121],"./nb/package.json":[1648,3,121],"./nl":[668,7,21],"./nl/":[668,7,21],"./nl/build_distance_in_words_locale":[623,7,75],"./nl/build_distance_in_words_locale/":[623,7,75],"./nl/build_distance_in_words_locale/index":[623,7,75],"./nl/build_distance_in_words_locale/index.js":[623,7,75],"./nl/build_format_locale":[624,7,76],"./nl/build_format_locale/":[624,7,76],"./nl/build_format_locale/index":[624,7,76],"./nl/build_format_locale/index.js":[624,7,76],"./nl/index":[668,7,21],"./nl/index.js":[668,7,21],"./nl/package":[1649,3,122],"./nl/package.json":[1649,3,122],"./package":[1650,3,123],"./package.json":[1650,3,123],"./pl":[669,7,22],"./pl/":[669,7,22],"./pl/build_distance_in_words_locale":[625,7,77],"./pl/build_distance_in_words_locale/":[625,7,77],"./pl/build_distance_in_words_locale/index":[625,7,77],"./pl/build_distance_in_words_locale/index.js":[625,7,77],"./pl/build_format_locale":[626,7,78],"./pl/build_format_locale/":[626,7,78],"./pl/build_format_locale/index":[626,7,78],"./pl/build_format_locale/index.js":[626,7,78],"./pl/index":[669,7,22],"./pl/index.js":[669,7,22],"./pl/package":[1651,3,124],"./pl/package.json":[1651,3,124],"./pt":[670,7,23],"./pt/":[670,7,23],"./pt/build_distance_in_words_locale":[627,7,79],"./pt/build_distance_in_words_locale/":[627,7,79],"./pt/build_distance_in_words_locale/index":[627,7,79],"./pt/build_distance_in_words_locale/index.js":[627,7,79],"./pt/build_format_locale":[628,7,80],"./pt/build_format_locale/":[628,7,80],"./pt/build_format_locale/index":[628,7,80],"./pt/build_format_locale/index.js":[628,7,80],"./pt/index":[670,7,23],"./pt/index.js":[670,7,23],"./pt/package":[1652,3,125],"./pt/package.json":[1652,3,125],"./ro":[671,7,24],"./ro/":[671,7,24],"./ro/build_distance_in_words_locale":[629,7,81],"./ro/build_distance_in_words_locale/":[629,7,81],"./ro/build_distance_in_words_locale/index":[629,7,81],"./ro/build_distance_in_words_locale/index.js":[629,7,81],"./ro/build_format_locale":[630,7,82],"./ro/build_format_locale/":[630,7,82],"./ro/build_format_locale/index":[630,7,82],"./ro/build_format_locale/index.js":[630,7,82],"./ro/index":[671,7,24],"./ro/index.js":[671,7,24],"./ro/package":[1653,3,126],"./ro/package.json":[1653,3,126],"./ru":[672,7,25],"./ru/":[672,7,25],"./ru/build_distance_in_words_locale":[631,7,83],"./ru/build_distance_in_words_locale/":[631,7,83],"./ru/build_distance_in_words_locale/index":[631,7,83],"./ru/build_distance_in_words_locale/index.js":[631,7,83],"./ru/build_format_locale":[632,7,84],"./ru/build_format_locale/":[632,7,84],"./ru/build_format_locale/index":[632,7,84],"./ru/build_format_locale/index.js":[632,7,84],"./ru/index":[672,7,25],"./ru/index.js":[672,7,25],"./ru/package":[1654,3,127],"./ru/package.json":[1654,3,127],"./sk":[673,7,26],"./sk/":[673,7,26],"./sk/build_distance_in_words_locale":[633,7,85],"./sk/build_distance_in_words_locale/":[633,7,85],"./sk/build_distance_in_words_locale/index":[633,7,85],"./sk/build_distance_in_words_locale/index.js":[633,7,85],"./sk/build_format_locale":[634,7,86],"./sk/build_format_locale/":[634,7,86],"./sk/build_format_locale/index":[634,7,86],"./sk/build_format_locale/index.js":[634,7,86],"./sk/index":[673,7,26],"./sk/index.js":[673,7,26],"./sk/package":[1655,3,128],"./sk/package.json":[1655,3,128],"./sl":[674,7,27],"./sl/":[674,7,27],"./sl/build_distance_in_words_locale":[635,7,87],"./sl/build_distance_in_words_locale/":[635,7,87],"./sl/build_distance_in_words_locale/index":[635,7,87],"./sl/build_distance_in_words_locale/index.js":[635,7,87],"./sl/build_format_locale":[636,7,88],"./sl/build_format_locale/":[636,7,88],"./sl/build_format_locale/index":[636,7,88],"./sl/build_format_locale/index.js":[636,7,88],"./sl/index":[674,7,27],"./sl/index.js":[674,7,27],"./sl/package":[1656,3,129],"./sl/package.json":[1656,3,129],"./sv":[675,7,28],"./sv/":[675,7,28],"./sv/build_distance_in_words_locale":[637,7,89],"./sv/build_distance_in_words_locale/":[637,7,89],"./sv/build_distance_in_words_locale/index":[637,7,89],"./sv/build_distance_in_words_locale/index.js":[637,7,89],"./sv/build_format_locale":[638,7,90],"./sv/build_format_locale/":[638,7,90],"./sv/build_format_locale/index":[638,7,90],"./sv/build_format_locale/index.js":[638,7,90],"./sv/index":[675,7,28],"./sv/index.js":[675,7,28],"./sv/package":[1657,3,130],"./sv/package.json":[1657,3,130],"./th":[676,7,29],"./th/":[676,7,29],"./th/build_distance_in_words_locale":[639,7,91],"./th/build_distance_in_words_locale/":[639,7,91],"./th/build_distance_in_words_locale/index":[639,7,91],"./th/build_distance_in_words_locale/index.js":[639,7,91],"./th/build_format_locale":[640,7,92],"./th/build_format_locale/":[640,7,92],"./th/build_format_locale/index":[640,7,92],"./th/build_format_locale/index.js":[640,7,92],"./th/index":[676,7,29],"./th/index.js":[676,7,29],"./th/package":[1658,3,131],"./th/package.json":[1658,3,131],"./tr":[677,7,30],"./tr/":[677,7,30],"./tr/build_distance_in_words_locale":[641,7,93],"./tr/build_distance_in_words_locale/":[641,7,93],"./tr/build_distance_in_words_locale/index":[641,7,93],"./tr/build_distance_in_words_locale/index.js":[641,7,93],"./tr/build_format_locale":[642,7,94],"./tr/build_format_locale/":[642,7,94],"./tr/build_format_locale/index":[642,7,94],"./tr/build_format_locale/index.js":[642,7,94],"./tr/index":[677,7,30],"./tr/index.js":[677,7,30],"./tr/package":[1659,3,132],"./tr/package.json":[1659,3,132],"./zh_cn":[678,7,31],"./zh_cn/":[678,7,31],"./zh_cn/build_distance_in_words_locale":[643,7,95],"./zh_cn/build_distance_in_words_locale/":[643,7,95],"./zh_cn/build_distance_in_words_locale/index":[643,7,95],"./zh_cn/build_distance_in_words_locale/index.js":[643,7,95],"./zh_cn/build_format_locale":[644,7,96],"./zh_cn/build_format_locale/":[644,7,96],"./zh_cn/build_format_locale/index":[644,7,96],"./zh_cn/build_format_locale/index.js":[644,7,96],"./zh_cn/index":[678,7,31],"./zh_cn/index.js":[678,7,31],"./zh_cn/package":[1660,3,133],"./zh_cn/package.json":[1660,3,133],"./zh_tw":[679,7,32],"./zh_tw/":[679,7,32],"./zh_tw/build_distance_in_words_locale":[645,7,97],"./zh_tw/build_distance_in_words_locale/":[645,7,97],"./zh_tw/build_distance_in_words_locale/index":[645,7,97],"./zh_tw/build_distance_in_words_locale/index.js":[645,7,97],"./zh_tw/build_format_locale":[646,7,98],"./zh_tw/build_format_locale/":[646,7,98],"./zh_tw/build_format_locale/index":[646,7,98],"./zh_tw/build_format_locale/index.js":[646,7,98],"./zh_tw/index":[679,7,32],"./zh_tw/index.js":[679,7,32],"./zh_tw/package":[1661,3,134],"./zh_tw/package.json":[1661,3,134]};function r(e){if(!n.o(a,e))return Promise.resolve().then(function(){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t});var t=a[e],r=t[0];return Promise.all(t.slice(2).map(n.e)).then(function(){return n.t(r,t[1])})}r.keys=function(){return Object.keys(a)},r.id=8456,e.exports=r},8457:function(e,t,n){"use strict";n.r(t);var a=n(11),r=n.n(a),o=n(26);Object.defineProperty(Array.prototype,"asyncForEach",{enumerable:!1,value:function(){var e=Object(o.a)(r.a.mark(function e(t,n,a){var o;return r.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:o=0;case 1:if(!(o<this.length)){e.next=7;break}return e.next=4,t(this[o],o,this);case 4:o++,e.next=1;break;case 7:case"end":return e.stop()}},e,this)}));return function(t,n,a){return e.apply(this,arguments)}}()});n(6893);var i=n(6),c=n.n(i),s=n(60),l=n.n(s),u=(n(680),n(681),n(1443)),d=n(1444),p=n(1445);l.a.locale("en"),c.a.addResources("en","NAMESPACE",u),c.a.addResources("ur","NAMESPACE",d),c.a.addResources("vi","NAMESPACE",p),c.a.setDefaultNamespace("NAMESPACE"),c.a.changeLanguage("en");c.a;var f=n(0),m=n.n(f),h=n(45),b=n.n(h),g=n(13),O=n.n(g),v=(n(6902),n(1446)),y=n.n(v),E=n(14),_=n(74),j=n(507),I=n.n(j),C=function(e){var t=Object(_.a)({},e);return m.a.createElement(I.a,t)},T=Object(E.withStyles)(function(){return{container:{left:"45%",position:"fixed",top:"45%"}}})(function(e){return m.a.createElement("div",{className:e.classes.container},m.a.createElement(C,{size:50}))}),S=n(1448),R=n.n(S),k=n(378),N=n(133),A=(n(690),n(693),n(1002),n(416),n(1003),n(697),n(1006),n(5)),w=n(3),F=n(8),x=n(7),P=n(9),D=(n(6974),n(17)),U=n(543),L=n.n(U),M=n(58),B=n(8459),V=n(28),G=n(510),W=n.n(G),H=n(86),z=n.n(H),K=n(89),Y=n.n(K),q=n(80),X=n.n(q),Z=n(79),J=n.n(Z),Q=n(69),$=n.n(Q),ee=n(71),te=n.n(ee),ne=n(508),ae=n.n(ne),re=n(70),oe=n.n(re),ie=function(e){function t(e){var n;return Object(A.a)(this,t),(n=Object(F.a)(this,Object(x.a)(t).call(this,e))).handleClose=function(e,a){a!==t.CLICKAWAY_KEY&&n.props.onClose()},n.handleClose=n.handleClose.bind(Object(V.a)(n)),n}return Object(P.a)(t,e),Object(w.a)(t,[{key:"getAction",value:function(){var e=this.props,t=e.feedback,n=e.classes;return f.createElement("span",null,t.action?f.createElement("span",{className:n.actionContainer},t.action):null,f.createElement(te.a,{key:"close","aria-label":"Close",color:"inherit",className:n.closeButton,onClick:this.handleClose},f.createElement(ae.a,null)))}},{key:"render",value:function(){var e=this.props.feedback,n=e.message,a=e.displayType,r=oe()(n)&&!a,o=oe()(n)&&"dialog"===a;return f.createElement(f.Fragment,null,f.createElement(W.a,{open:r,anchorOrigin:t.ANCHOR_ORIGION,autoHideDuration:5e3,onClose:this.handleClose,message:f.createElement("span",null,n),action:this.getAction()}),f.createElement(z.a,{open:oe()(n)&&"dialog"===a},f.createElement(J.a,null,o?n&&n.title:""),f.createElement(X.a,null,o?n&&n.content:""),f.createElement(Y.a,null,f.createElement($.a,{onClick:this.handleClose,color:"primary",autoFocus:!0},c.a.t("Close")))))}}]),t}(f.Component);ie.CLICKAWAY_KEY="clickaway",ie.ANCHOR_ORIGION={vertical:"bottom",horizontal:"center"},ie.defaultProps={feedback:{}};var ce=Object(E.withStyles)(function(e){return{closeButton:{width:4*e.spacing.unit,height:4*e.spacing.unit},actionContainer:{paddingRight:2}}})(ie),se=n(2);function le(e){return function(t,n,a){return{type:e,payload:t,meta:n,error:a}}}function ue(e){return function(t){return Object(se.a)({},e,{payload:Object(se.a)({},e.payload,t)})}}var de,pe="CloseFeedback",fe=Object(D.b)(function(e){return{feedback:e.feedbacks&&e.feedbacks[0]?e.feedbacks[0]:void 0}},function(e){return{onClose:function(){e(le(pe)())}}})(ce),me=n(8460),he=n(1491),be=n(1450),ge=n.n(be);function Oe(e){de=e}var ve=function(){return de||O.a.error("please set d2 before using it"),de},ye=function(){return ve().Api.getApi()},Ee=function(){return ve().currentUser},_e=ve,je=n(519),Ie=n.n(je),Ce=n(176),Te=n.n(Ce),Se=l.a,Re=function(e){return m.a.createElement("div",{className:"".concat(e.classes.flex," ").concat(e.classes.badgeSection)},m.a.createElement(Ne,{status:e.status?e.classes.onlineIcon:e.classes.offlineIcon}),m.a.createElement("p",{className:e.classes.text},e.status?c.a.t("Online"):c.a.t("Offline")))},ke=function(e){function t(e){var n;return Object(A.a)(this,t),(n=Object(F.a)(this,Object(x.a)(t).call(this,e))).state={offlineTimer:Se(Date.now()).fromNow()},n}return Object(P.a)(t,e),Object(w.a)(t,[{key:"componentDidUpdate",value:function(e,t){var n=this;if(0===this.props.statusTimer)return clearInterval(this.timer),this.timer=null,void this.setState({offlineTimer:Se(Date.now()).fromNow()});this.props.statusTimer>0&&!this.timer&&(this.timer=setInterval(function(){var e=Se(n.props.statusTimer).fromNow();n.setState({offlineTimer:e})},6e4))}},{key:"render",value:function(){var e,t=this.props;if(t.status&&0===t.syncList.length)return null;t.status&&t.syncList.length>0&&(e=m.a.createElement("div",{className:t.classes.flex},m.a.createElement(Ie.a,{className:t.classes.icon}),m.a.createElement("p",{className:t.classes.text},c.a.t("Syncing")))),t.status||(e=m.a.createElement("span",null,t.syncList.length," ",c.a.t("offline events. Last synced:")," ",this.state.offlineTimer));var n=!!e;return m.a.createElement(Te.a,{in:n,style:{transformOrigin:"right 50%"}},m.a.createElement("div",{className:"".concat(t.classes.badgeSection," ").concat(t.classes.smallText," ").concat(t.classes.badgeSeparator),style:t.style},e))}}]),t}(f.PureComponent),Ne=function(e){return m.a.createElement("span",{className:e.status})},Ae=function(e){function t(){return Object(A.a)(this,t),Object(F.a)(this,Object(x.a)(t).apply(this,arguments))}return Object(P.a)(t,e),Object(w.a)(t,[{key:"render",value:function(){var e=this.props.offline||{},t=this.props.classes,n=e.outbox;return m.a.createElement("div",{className:"".concat(t.flex," ").concat(t.badgeContainer)},m.a.createElement(ke,{status:e.online,syncList:n,classes:t,statusTimer:this.props.networkStatus.offlineSince}),m.a.createElement(Re,{status:e.online,syncList:n,classes:t}))}}]),t}(f.PureComponent),we=Object(D.b)(function(e){return{offline:e.offline,networkStatus:e.networkStatus}})(Object(E.withStyles)(function(e){return{offlineIcon:{backgroundColor:"#9e9e9e",width:"8px",height:"8px",borderRadius:"4px",display:"inline-block",marginRight:"6px"},onlineIcon:{backgroundColor:"#48a999",width:"8px",height:"8px",borderRadius:"4px",display:"inline-block",marginRight:"6px"},badgeContainer:{backgroundColor:"#16486e",color:"white",borderRadius:"4px",whiteSpace:"nowrap"},badgeSection:{padding:"8px"},badgeSeparator:{borderRight:"1px solid #0b3b60"},flex:{display:"flex",flexWrap:"nowrap",alignItems:"center",justifyContent:"space-between"},icon:{animationName:"Sync-spin",animationDuration:"1.5s",animationIterationCount:"infinite",animationDelay:"250ms",animationDirection:"reverse",width:"16px",height:"16px"},text:{margin:0,padding:0},smallText:{fontSize:"14px"},"@keyframes Sync-spin":{from:{transform:"rotate(0deg)"},to:{transform:"rotate(360deg)"}}}})(Ae)),Fe=n(10),xe=function(e){return{errorContainer:{margin:20,color:e.palette.error.main}}},Pe=function(){return function(e){return Object(E.withStyles)(xe)(function(t){var n=t.error,a=t.classes,r=Object(Fe.a)(t,["error","classes"]);return n?f.createElement("div",{className:a.errorContainer},n):f.createElement(e,r)})}},De=Object(E.withStyles)(function(){return{container:{display:"flex",alignItems:"center",justifyContent:"center"}}})(function(e){var t=e.containerStyle,n=e.classes,a=Object(Fe.a)(e,["containerStyle","classes"]);return m.a.createElement("div",{className:n.container,style:t},m.a.createElement(C,a))}),Ue=function(e,t,n){return function(a){return function(r){var o=r.ready,i=Object(Fe.a)(r,["ready"]);if(!(n?n(r):o)){var c=e?e(r):null,s=t?t(r):null;return f.createElement(De,Object.assign({containerStyle:c},s))}return f.createElement(a,i)}}},Le=n(31),Me=n(50),Be=n.n(Me),Ve=n(166),Ge=n.n(Ve),We=n(12),He=n(51),ze=n(16),Ke=function(){function e(t){Object(A.a)(this,e),this.name="",this.id="",this._access={},t&&Object(He.a)(t)&&t(this)}return Object(w.a)(e,[{key:"name",get:function(){return this._name},set:function(e){this._name=e}},{key:"id",get:function(){return this._id},set:function(e){this._id=e}},{key:"access",get:function(){return this._access},set:function(e){this._access=e}},{key:"organisationUnitIds",get:function(){return this._organisationUnitIds},set:function(e){this._organisationUnitIds=e}}]),e}(),Ye=function(){function e(t){Object(A.a)(this,e),this.name="",this.id="",this._options=new Map,t&&Object(He.a)(t)&&t(this)}return Object(w.a)(e,[{key:"getOptionThrowIfNotFound",value:function(t){var n=this.categoryOptions.get(t);if(!n)throw new Error(Object(ze.b)(e.errorMessages.CATEGORY_OPTION_NOT_FOUND)({category:this,categoryOptionId:t}));return n}},{key:"getOption",value:function(e){return this.categoryOptions.get(e)}},{key:"name",get:function(){return this._name},set:function(e){this._name=e}},{key:"id",get:function(){return this._id},set:function(e){this._id=e}},{key:"categoryOptions",get:function(){return this._options},set:function(e){this._options=e}}]),e}();Ye.errorMessages={CATEGORY_OPTION_NOT_FOUND:"Category option was not found"};var qe=function(){function e(t){Object(A.a)(this,e),this.name="",this.id="",this.categories=new Map,t&&Object(He.a)(t)&&t(this)}return Object(w.a)(e,[{key:"getCategoryThrowIfNotFound",value:function(t){var n=this.categories.get(t);if(!n)throw new Error(Object(ze.b)(e.errorMessages.CATEGORY_NOT_FOUND)({categoryCombination:this,categoryId:t}));return n}},{key:"getCategoryForOptionId",value:function(e){return Array.from(this.categories.values()).find(function(t){return!!t.getOption(e)})}},{key:"name",get:function(){return this._name},set:function(e){this._name=e}},{key:"id",get:function(){return this._id},set:function(e){this._id=e}},{key:"categories",get:function(){return this._categories},set:function(e){this._categories=e}}]),e}();qe.errorMessages={CATEGORY_NOT_FOUND:"Category was not found"};var Xe=function(){function e(t){Object(A.a)(this,e),this.color="white",t&&Object(He.a)(t)&&t(this)}return Object(w.a)(e,[{key:"color",set:function(e){this._color=e},get:function(){return this._color}},{key:"data",set:function(e){this._data=e},get:function(){return this._data}}]),e}(),Ze=function(){function e(t){Object(A.a)(this,e),this.programRules=[],this.programRuleVariables=[],this.organisationUnits={},t&&Object(He.a)(t)&&t(this)}return Object(w.a)(e,[{key:"addProgramRuleVariable",value:function(e){this.programRuleVariables.push(e)}},{key:"addProgramRule",value:function(e){this.programRules.push(e)}},{key:"addProgramRuleVariables",value:function(e){this.programRuleVariables=[].concat(Object(We.a)(this.programRuleVariables),Object(We.a)(e))}},{key:"addProgramRules",value:function(e){this.programRules=[].concat(Object(We.a)(this.programRules),Object(We.a)(e))}},{key:"id",set:function(e){this._id=e},get:function(){return this._id}},{key:"access",set:function(e){this._access=e},get:function(){return this._access}},{key:"name",set:function(e){this._name=e},get:function(){return this._name}},{key:"shortName",set:function(e){this._shortName=e},get:function(){return this._shortName}},{key:"organisationUnits",set:function(e){this._organisationUnits=e},get:function(){return this._organisationUnits}},{key:"categoryCombination",set:function(e){this._categoryCombination=e},get:function(){return this._categoryCombination}},{key:"programRules",set:function(e){this._programRules=e},get:function(){return this._programRules}},{key:"programRuleVariables",set:function(e){this._programRuleVariables=e},get:function(){return this._programRuleVariables}},{key:"icon",set:function(e){this._icon=e},get:function(){return this._icon}}]),e}(),Je=new Map,Qe=n(128),$e=n.n(Qe),et=(n(1290),n(112)),tt=function(){function e(t){Object(A.a)(this,e),t&&Object(He.a)(t)&&t(this)}return Object(w.a)(e,[{key:"id",set:function(e){this._id=e},get:function(){return this._id}},{key:"value",set:function(e){this._value=e},get:function(){return this._value}},{key:"text",set:function(e){this._text=e},get:function(){return this._text}},{key:"description",set:function(e){this._description=e},get:function(){return this._description}},{key:"icon",set:function(e){this._icon=e},get:function(){return this._icon}}]),e}(),nt=function(){function e(t){Object(A.a)(this,e),t&&Object(He.a)(t)&&t(this)}return Object(w.a)(e,[{key:"id",set:function(e){this._id=e},get:function(){return this._id}},{key:"optionIds",set:function(e){this._optionIds=e},get:function(){return this._optionIds}}]),e}(),at={DROPDOWN:"dropdown",VERTICAL_RADIOBUTTONS:"verticalRadiobuttons",HORIZONTAL_RADIOBUTTONS:"horizontalRadiobuttons"},rt=Object.keys(at).map(function(e){return at[e]}),ot={ICON:"ICON",ICON_WITH_COLOR:"ICON_WITH_COLOR"},it=function(){function e(t,n,a,r,o){var i=this;Object(A.a)(this,e),this._options=n?n.reduce(function(e,t){return t.value||!1===t.value||0===t.value?(t.value=o&&r?o(t.value,r.type,r):t.value,e.push(t)):i._emptyText=t.text,e},[]):[],this._optionGroups=a||new Map,this._id=t,this._dataElement=r,this._inputType=at.DROPDOWN}return Object(w.a)(e,[{key:"addOption",value:function(e){e.value||!1===e.value||0===e.value?this._options.push(e):this._emptyText=e.text}},{key:"getOptionThrowIfNotFound",value:function(t){var n=this.options.find(function(e){return e.value===t});if(!n)throw new Error(Object(ze.b)(e.errorMessages.OPTION_NOT_FOUND)({OptionSet:this,value:t}));return n}},{key:"getOption",value:function(t){var n=this.options.find(function(e){return e.value===t});return n||O.a.warn(Object(ze.b)(e.errorMessages.OPTION_NOT_FOUND)({OptionSet:this,value:t})),n}},{key:"getOptionsThrowIfNotFound",value:function(t){var n=this;return t.map(function(t){var a=n.options.find(function(e){return e.value===t});if(!a)throw new Error(Object(ze.b)(e.errorMessages.OPTION_NOT_FOUND)({OptionSet:n,value:t}));return a})}},{key:"getOptions",value:function(t){var n=this;return t.reduce(function(t,a){var r=n.options.find(function(e){return e.value===a});return r?t.push(r):O.a.warn(Object(ze.b)(e.errorMessages.OPTION_NOT_FOUND)({OptionSet:n,value:a})),t},[])}},{key:"getOptionText",value:function(e){var t=this.getOption(e);return t&&t.text}},{key:"getOptionsText",value:function(e){return this.getOptions(e).map(function(e){return e.text})}},{key:"getOptionsTextAsString",value:function(e){return this.getOptionsText(e).toString()}},{key:"resolveTextsAsString",value:function(e){return Object(et.a)(e)?this.getOptionsTextAsString(e):this.getOptionText(e)}},{key:"id",set:function(e){this._id=e},get:function(){return this._id}},{key:"inputType",set:function(t){t&&(rt.includes(t)?this._inputType=t:O.a.warn(Object(ze.b)(e.errorMessages.UNSUPPORTED_INPUTTYPE)({optionSet:this,inputType:t})))},get:function(){return this._inputType}},{key:"viewType",set:function(t){t&&(ot[t]?this._viewType=t:O.a.warn(Object(ze.b)(e.errorMessages.UNSUPPORTED_VIEWTYPE)({optionSet:this,viewType:t})))},get:function(){return this._viewType}},{key:"emptyText",get:function(){return this._emptyText},set:function(e){this._emptyText=e}},{key:"options",get:function(){return this._options}},{key:"optionGroups",get:function(){return this._optionGroups},set:function(e){this._optionGroups=e}},{key:"dataElement",get:function(){return this._dataElement}}]),e}();it.errorMessages={OPTION_NOT_FOUND:"Option not found",UNSUPPORTED_VIEWTYPE:"Tried to set an unsupported viewType",UNSUPPORTED_INPUTTYPE:"Tried to set an unsuported inputType"};var ct=["TEXT","LONG_TEXT","NUMBER","NUMBER_RANGE","INTEGER","INTEGER_RANGE","INTEGER_POSITIVE","INTEGER_POSITIVE_RANGE","INTEGER_NEGATIVE","INTEGER_NEGATIVE_RANGE","INTEGER_ZERO_OR_POSITIVE","INTEGER_ZERO_OR_POSITIVE_RANGE","PERCENTAGE","DATE","DATE_RANGE","DATETIME","DATETIME_RANGE","TIME","TIME_RANGE","TRUE_ONLY","BOOLEAN","PHONE_NUMBER","EMAIL","FILE_RESOURCE","URL","ORGANISATION_UNIT","IMAGE","AGE","COORDINATE","POLYGON","USERNAME","UNKNOWN"].reduce(function(e,t){return e[t]=t,e},{}),st={ENTIRE_SYSTEM:"entireSystem",ORGANISATION_UNIT:"organisationUnit"},lt=function(){function e(t){Object(A.a)(this,e),this._scope=st.ENTIRE_SYSTEM,this._generatable=!1,t&&t(this)}return Object(w.a)(e,[{key:"generatable",set:function(e){this._generatable=e},get:function(){return this._generatable}},{key:"scope",set:function(e){this._scope=e},get:function(){return this._scope}},{key:"onValidate",set:function(e){this._onValidate=e},get:function(){return this._onValidate}}]),e}(),ut=function(){function e(t){Object(A.a)(this,e),this._displayInReports=!0,this._displayInForms=!0,this.disabled=!1,this.compulsory=!1,t&&Object(He.a)(t)&&t(this)}return Object(w.a)(e,[{key:"getPropertyNames",value:r.a.mark(function e(){var t,n,a,o,i,c,s;return r.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:t=["getPropertyNames","constructor","copyPropertiesTo","getConvertedOptionSet","convertValue"],n=!0,a=!1,o=void 0,e.prev=4,i=Object.getOwnPropertyNames(Object.getPrototypeOf(this))[Symbol.iterator]();case 6:if(n=(c=i.next()).done){e.next=14;break}if(s=c.value,t.includes(s)){e.next=11;break}return e.next=11,s;case 11:n=!0,e.next=6;break;case 14:e.next=20;break;case 16:e.prev=16,e.t0=e.catch(4),a=!0,o=e.t0;case 20:e.prev=20,e.prev=21,n||null==i.return||i.return();case 23:if(e.prev=23,!a){e.next=26;break}throw o;case 26:return e.finish(23);case 27:return e.finish(20);case 28:case"end":return e.stop()}},e,this,[[4,16,20,28],[21,,23,27]])})},{key:"copyPropertiesTo",value:function(e){var t=!0,n=!1,a=void 0;try{for(var r,o=this.getPropertyNames()[Symbol.iterator]();!(t=(r=o.next()).done);t=!0){var i=r.value;e[i]=this[i]}}catch(c){n=!0,a=c}finally{try{t||null==o.return||o.return()}finally{if(n)throw a}}return e}},{key:"getConvertedOptionSet",value:function(e){if(this.optionSet){var t=Object(We.a)(this.optionSet.options),n=new it(this.optionSet.id,t,null,this,e);return n.inputType=this.optionSet.inputType,n.viewType=this.optionSet.viewType,n.emptyText=this.optionSet.emptyText,n}return null}},{key:"convertValue",value:function(e,t){var n=this;return Object(et.a)(e)?e.map(function(e){return t(e,n.type,n)}):t(e,this.type,this)}},{key:"id",set:function(e){this._id=e},get:function(){return this._id}},{key:"name",set:function(e){this._name=e},get:function(){return this._name}},{key:"shortName",set:function(e){this._shortName=e},get:function(){return this._shortName}},{key:"formName",set:function(e){this._formName=e},get:function(){return this._formName}},{key:"displayInForms",set:function(e){this._displayInForms=null==e||e},get:function(){return this._displayInForms}},{key:"displayInReports",set:function(e){this._displayInReports=null==e||e},get:function(){return this._displayInReports}},{key:"disabled",set:function(e){this._disabled=!!e},get:function(){return this._disabled}},{key:"compulsory",set:function(e){this._compulsory=!!e},get:function(){return this._compulsory}},{key:"description",set:function(e){this._description=e},get:function(){return this._description}},{key:"type",set:function(t){ct[t]?this._type=t:(O.a.warn(Object(ze.b)(e.errorMessages.TYPE_NOT_FOUND)({dataElement:this,type:t})),this._type=ct.UNKNOWN)},get:function(){return this._type}},{key:"optionSet",set:function(e){this._optionSet=e},get:function(){return this._optionSet}},{key:"icon",set:function(e){this._icon=e},get:function(){return this._icon}},{key:"unique",set:function(e){this._unique=e},get:function(){return this._unique}}]),e}();ut.errorMessages={TYPE_NOT_FOUND:"type not supported"};var dt={NONE:"none",ON_UPDATE_AND_INSERT:"onUpdateAndInsert",ON_COMPLETE:"onComplete"},pt=Object.keys(dt).map(function(e){return dt[e]}),ft=n(205),mt=function(){function e(t){Object(A.a)(this,e),this._visible=!0,this._open=!0,this._collapsible=!1,this._elements=new Map,this._showContainer=!0,t&&Object(He.a)(t)&&t(this)}return Object(w.a)(e,[{key:"addElement",value:function(e){this.elements.has(e.id)||this.elements.set(e.id,e)}},{key:"getElement",value:function(t){var n=this.elements.get(t);if(!n)throw new Error(Object(ze.b)(e.errorMessages.DATA_ELEMENT_NOT_FOUND)({section:this,requestId:t}));return n}},{key:"getElementIfFound",value:function(e){return this.elements.get(e)}},{key:"getPropertyNames",value:r.a.mark(function e(){var t,n,a,o,i,c,s;return r.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:t=["getPropertyNames","constructor","copyPropertiesTo"],n=!0,a=!1,o=void 0,e.prev=4,i=Object.getOwnPropertyNames(Object.getPrototypeOf(this))[Symbol.iterator]();case 6:if(n=(c=i.next()).done){e.next=14;break}if(s=c.value,t.includes(s)){e.next=11;break}return e.next=11,s;case 11:n=!0,e.next=6;break;case 14:e.next=20;break;case 16:e.prev=16,e.t0=e.catch(4),a=!0,o=e.t0;case 20:e.prev=20,e.prev=21,n||null==i.return||i.return();case 23:if(e.prev=23,!a){e.next=26;break}throw o;case 26:return e.finish(23);case 27:return e.finish(20);case 28:case"end":return e.stop()}},e,this,[[4,16,20,28],[21,,23,27]])})},{key:"copyPropertiesTo",value:function(e){var t=!0,n=!1,a=void 0;try{for(var r,o=this.getPropertyNames()[Symbol.iterator]();!(t=(r=o.next()).done);t=!0){var i=r.value;e[i]=this[i]}}catch(c){n=!0,a=c}finally{try{t||null==o.return||o.return()}finally{if(n)throw a}}return e}},{key:"id",set:function(e){this._id=e},get:function(){return this._id}},{key:"name",set:function(e){this._name=e},get:function(){return this._name}},{key:"open",set:function(e){this._open=!Object(ft.a)(e)||e},get:function(){return this._open}},{key:"visible",set:function(e){this._visible=!Object(ft.a)(e)||e},get:function(){return this._visible}},{key:"collapsible",set:function(e){this._collapsible=!Object(ft.a)(e)||e},get:function(){return this._collapsible}},{key:"showContainer",set:function(e){this._showContainer=!Object(ft.a)(e)||e},get:function(){return this._showContainer}},{key:"elements",get:function(){return this._elements}}]),e}();mt.MAIN_SECTION_ID="#MAIN#",mt.MAIN_SECTION_NAME="MAIN",mt.errorMessages={DATA_ELEMENT_NOT_FOUND:"Data element was not found"};var ht=n(225),bt={PROGRAM_NOT_FOUND:"Program not found",STAGE_NOT_FOUND:"Stage not found",GENERIC_ERROR:"An error has occured. See log for details"};function gt(e){var t=Je.get(e);if(!t)return O.a.error(Object(ze.b)(bt.PROGRAM_NOT_FOUND)({programId:e})),{error:c.a.t(bt.GENERIC_ERROR),stage:null,program:null};var n=t.getStage();return n?{stage:n,program:t,error:null}:(O.a.error(Object(ze.b)(bt.STAGE_NOT_FOUND)({program:t,programId:e})),{error:c.a.t(bt.GENERIC_ERROR),stage:null,program:null})}var Ot={PROGRAM_NOT_FOUND:"Program not found",STAGE_NOT_FOUND:"Stage not found",GENERIC_ERROR:"An error has occured. See log for details"};function vt(e){var t=Je.get(e);if(!t)return O.a.error(Object(ze.b)(Ot.PROGRAM_NOT_FOUND)({programId:e})),{error:c.a.t(Ot.GENERIC_ERROR),stage:null};var n=t.getStage();return n?{stage:n,error:null}:(O.a.error(Object(ze.b)(Ot.STAGE_NOT_FOUND)({programId:e})),{error:c.a.t(Ot.GENERIC_ERROR),stage:null})}var yt={PROGRAM_NOT_FOUND:"Program not found or program not an event program",GENERIC_ERROR:"An error has occured. See log for details"};function Et(e){var t=Je.get(e);if(!t||!(t instanceof Ht))throw O.a.error(Object(ze.b)(yt.PROGRAM_NOT_FOUND)({programId:e})),Error(c.a.t(yt.GENERIC_ERROR));return t}var _t=function(e,t){var n=Et(e),a=n.getStageThrowIfNull(),r={read:a.stageForm.access.data.read,write:a.stageForm.access.data.write};return t&&n.categoryCombination&&Object.keys(t).forEach(function(e){var a=n.categoryCombination.getCategoryThrowIfNotFound(e).getOptionThrowIfNotFound(t[e]);r={read:!!r.read&&a.access.data.read,write:!!r.write&&a.access.data.write}}),r},jt={PROGRAM_NOT_FOUND:"Program not found",PROGRAM_NOT_FOUND_DISPLAY:c.a.t("Program not found"),NOT_TRACKER_PROGRAM:"Program is not a tracker program",NOT_TRACKER_PROGRAM_DISPLAY:c.a.t("Program is not a tracker program")};function It(e){var t=Je.get(e);if(!t)throw O.a.error(Object(ze.b)(jt.PROGRAM_NOT_FOUND)({programId:e})),Error(jt.PROGRAM_NOT_FOUND_DISPLAY);if(!(t instanceof Xt))throw O.a.error(Object(ze.b)(jt.NOT_TRACKER_PROGRAM)({programId:e})),Error(jt.NOT_TRACKER_PROGRAM_DISPLAY);return t}var Ct={PROGRAM_NOT_FOUND:"Program not found",STAGE_NOT_FOUND:"Stage not found",GENERIC_ERROR:"An error has occured. See log for details"};function Tt(e){var t=e.eventId,n=Je.get(e.programId);if(!n)return O.a.error(Object(ze.b)(Ct.PROGRAM_NOT_FOUND)({eventId:t,event:e})),{error:c.a.t(Ct.GENERIC_ERROR),stage:null,program:null};var a=n.getStage(e.programStageId);return a?{stage:a,program:n,error:null}:(O.a.error(Object(ze.b)(Ct.STAGE_NOT_FOUND)({eventId:t,event:e})),{error:c.a.t(Ct.GENERIC_ERROR),stage:null,program:null})}var St={PROGRAM_NOT_FOUND:"Program not found",STAGE_NOT_FOUND:"Stage not found",GENERIC_ERROR:"An error has occured. See log for details"};function Rt(e){var t=e.eventId,n=Je.get(e.programId);if(!n)return O.a.error(Object(ze.b)(St.PROGRAM_NOT_FOUND)({eventId:t,event:e})),{error:c.a.t(St.GENERIC_ERROR),stage:null};var a=n.getStage(e.programStageId);return a?{stage:a,error:null}:(O.a.error(Object(ze.b)(St.STAGE_NOT_FOUND)({eventId:t,event:e})),{error:c.a.t(St.GENERIC_ERROR),stage:null})}var kt={PROGRAM_NOT_FOUND:"Program not found",GENERIC_ERROR:"An error has occured. See log for details"};function Nt(e){var t=Je.get(e);if(!t)throw O.a.error(Object(ze.b)(kt.PROGRAM_NOT_FOUND)({programId:e})),Error(c.a.t(kt.GENERIC_ERROR));return t}var At=function(){function e(t){Object(A.a)(this,e),this._minAttributesRequiredToSearch=0,this._unique=!1,t&&Object(He.a)(t)&&t(this)}return Object(w.a)(e,[{key:"id",set:function(e){this._id=e},get:function(){return this._id}},{key:"minAttributesRequiredToSearch",set:function(e){this._minAttributesRequiredToSearch=e},get:function(){return this._minAttributesRequiredToSearch}},{key:"searchForm",set:function(e){this._searchForm=e},get:function(){return this._searchForm}},{key:"unique",set:function(e){this._unique=e},get:function(){return this._unique}}]),e}(),wt=function(){function e(t){Object(A.a)(this,e),this._minAttributesRequiredToSearch=0,t&&Object(He.a)(t)&&t(this)}return Object(w.a)(e,[{key:"id",set:function(e){this._id=e},get:function(){return this._id}},{key:"minAttributesRequiredToSearch",set:function(e){this._minAttributesRequiredToSearch=e},get:function(){return this._minAttributesRequiredToSearch}},{key:"searchFoundation",set:function(e){this._searchFoundation=e},get:function(){return this._searchFoundation}},{key:"onSearch",set:function(e){this._onSearch=e},get:function(){return this._onSearch}}]),e}(),Ft=function(){function e(t){Object(A.a)(this,e),t&&Object(He.a)(t)&&t(this)}return Object(w.a)(e,[{key:"form",set:function(e){this._form=e},get:function(){return this._form}},{key:"inputSearchGroups",set:function(e){this._inputSearchGroups=e},get:function(){return this._inputSearchGroups}},{key:"trackedEntityType",set:function(e){this._trackedEntityType=e},get:function(){return this._trackedEntityType}}]),e}(),xt=function(){function e(t){Object(A.a)(this,e),this._attributes=[],t&&Object(He.a)(t)&&t(this)}return Object(w.a)(e,[{key:"id",set:function(e){this._id=e},get:function(){return this._id}},{key:"name",set:function(e){this._name=e},get:function(){return this._name}},{key:"teiRegistration",set:function(e){this._teiRegistration=e},get:function(){return this._teiRegistration}},{key:"searchGroups",set:function(e){this._searchGroups=e},get:function(){return this._searchGroups}},{key:"attributes",set:function(e){this._attributes=e},get:function(){return this._attributes}}]),e}(),Pt={TRACKED_ENTITY_TYPE_NOT_FOUND:"Tracked entity type not found",GENERIC_ERROR:"An error has occured. See log for details"};function Dt(e){var t=Zt.get(e);if(!t)throw O.a.error(Object(ze.b)(Pt.TRACKED_ENTITY_TYPE_NOT_FOUND)({trackedEntityTypeId:e})),Error(c.a.t(Pt.GENERIC_ERROR));return t}var Ut=n(1),Lt=n(549),Mt={CONVERT_VALUES_STRUCTURE:"Values can not be converted, data is neither an array or an object"};function Bt(e,t,n){if(e){var a=function(e){return e.toHashMap("id")}(t);if(Object(et.a)(e))return function(e,t,n){var a=this;return e.map(function(e){return a.convertObjectValues(e,t,n)})}(e,a,n);if(Object(Lt.a)(e))return function(e,t,n){return Object.keys(e).reduce(function(a,r){var o=t[r],i=e[r],c=o?o.convertValue(i,n):i;return Object(se.a)({},a,Object(Ut.a)({},r,c))},{})}(e,a,n);O.a.error(Object(ze.b)(Mt.CONVERT_VALUES_STRUCTURE)({values:e}))}return e}var Vt=function(){function e(t){Object(A.a)(this,e),this._sections=new Map,this._labels={},this.programRules=[],this._validationStrategy=dt.ON_UPDATE_AND_INSERT,t&&Object(He.a)(t)&&t(this)}return Object(w.a)(e,[{key:"addLabel",value:function(e){var t=e.id,n=e.label;this._labels[t]=n}},{key:"getLabel",value:function(e){return this._labels[e]}},{key:"addSection",value:function(e){this._sections.set(e.id,e)}},{key:"getSection",value:function(e){return this._sections.get(e)}},{key:"getElement",value:function(e){return this.getElementsById()[e]}},{key:"addProgramRule",value:function(e){this.programRules.push(e)}},{key:"addProgramRules",value:function(e){this.programRules=[].concat(Object(We.a)(this.programRules),Object(We.a)(e))}},{key:"getElements",value:function(){return Array.from(this.sections.entries()).map(function(e){return e[1]}).reduce(function(e,t){var n=Array.from(t.elements.entries()).map(function(e){return e[1]});return[].concat(Object(We.a)(e),Object(We.a)(n))},[])}},{key:"getElementsById",value:function(){return Array.from(this.sections.entries()).map(function(e){return e[1]}).reduce(function(e,t){var n=Array.from(t.elements.entries()).reduce(function(e,t){return e[t[0]]=t[1],e},{});return Object(se.a)({},e,n)},{})}},{key:"convertValues",value:function(e,t){return Bt(e,this.getElements(),t)}},{key:"id",set:function(e){this._id=e},get:function(){return this._id}},{key:"access",set:function(e){this._access=e},get:function(){return this._access}},{key:"name",set:function(e){this._name=e},get:function(){return this._name}},{key:"description",set:function(e){this._description=e},get:function(){return this._description}},{key:"programId",set:function(e){this._programId=e},get:function(){return this._programId}},{key:"programRules",set:function(e){this._programRules=e},get:function(){return this._programRules}},{key:"sections",get:function(){return this._sections}},{key:"customForm",set:function(e){this._customForm=e},get:function(){return this._customForm}},{key:"featureType",set:function(e){this._featureType=e},get:function(){return this._featureType}},{key:"validationStrategy",set:function(t){t&&(pt.includes(t)?this._validationStrategy=t:O.a.warn(Object(ze.b)(e.errorMessages.UNSUPPORTED_VALIDATION_STRATEGY)({renderFoundation:this,strategy:t})))},get:function(){return this._validationStrategy}}]),e}();Vt.errorMessages={UNSUPPORTED_VALIDATION_STRATEGY:"Tried to set an unsupported validation strategy"};var Gt=function(){function e(t){Object(A.a)(this,e),t&&Object(He.a)(t)&&t(this)}return Object(w.a)(e,[{key:"id",set:function(e){this._id=e},get:function(){return this._id}},{key:"name",set:function(e){this._name=e},get:function(){return this._name}},{key:"access",set:function(e){this._access=e},get:function(){return this._access}},{key:"from",set:function(e){this._from=e},get:function(){return this._from}},{key:"to",set:function(e){this._to=e},get:function(){return this._to}}]),e}(),Wt=function(){function e(t){Object(A.a)(this,e),t&&Object(He.a)(t)&&t(this)}return Object(w.a)(e,[{key:"stageForm",get:function(){return this._stageForm},set:function(e){this._stageForm=e}},{key:"id",get:function(){return this._id},set:function(e){this._id=e}},{key:"name",get:function(){return this._name},set:function(e){this._name=e}},{key:"relationshipTypes",get:function(){return this._relationshipTypes},set:function(e){this._relationshipTypes=e}},{key:"relationshipTypesWhereStageIsFrom",get:function(){var e=this;return this._relationshipTypes?this._relationshipTypes.filter(function(t){return t.from.programStageId&&t.from.programStageId===e.id}):[]}}]),e}(),Ht=function(e){function t(e){var n;return Object(A.a)(this,t),n=Object(F.a)(this,Object(x.a)(t).call(this)),e&&Object(He.a)(e)&&e(Object(V.a)(n)),n}return Object(P.a)(t,e),Object(w.a)(t,[{key:"getStage",value:function(){return this._stage}},{key:"getStageThrowIfNull",value:function(){if(!this._stage)throw new Error(Object(ze.b)(t.errorMessages.STAGE_NOT_FOUND)({program:this}));return this._stage}},{key:"stage",get:function(){return this._stage},set:function(e){this._stage=e}}]),t}(Ze);Ht.errorMessages={STAGE_NOT_FOUND:"Stage was not found"};var zt={INCIDENT_DATE:"incidentDate",ENROLLMENT_DATE:"enrollmentDate"},Kt={INCIDENT_DATE:"Incident date",ENROLLMENT_DATE:"Enrollment date"},Yt=function(){function e(t){var n;Object(A.a)(this,e),this._labels=(n={},Object(Ut.a)(n,zt.INCIDENT_DATE,Kt.INCIDENT_DATE),Object(Ut.a)(n,zt.ENROLLMENT_DATE,Kt.ENROLLMENT_DATE),n),this._optionFlags={allowFutureEnrollmentDate:!1,allowFutureIncidentDate:!1,showIncidentDate:!0},t&&Object(He.a)(t)&&t(this)}return Object(w.a)(e,[{key:"enrollmentForm",set:function(e){this._enrollmentForm=e},get:function(){return this._enrollmentForm}},{key:"incidentDateLabel",set:function(e){this._labels[zt.INCIDENT_DATE]=e},get:function(){return this._labels[zt.INCIDENT_DATE]}},{key:"enrollmentDateLabel",set:function(e){this._labels[zt.ENROLLMENT_DATE]=e},get:function(){return this._labels[zt.ENROLLMENT_DATE]}},{key:"allowFutureEnrollmentDate",set:function(e){this._optionFlags.allowFutureEnrollmentDate=e},get:function(){return this._optionFlags.allowFutureEnrollmentDate}},{key:"allowFutureIncidentDate",set:function(e){this._optionFlags.allowFutureIncidentDate=e},get:function(){return this._optionFlags.allowFutureIncidentDate}},{key:"showIncidentDate",set:function(e){this._optionFlags.showIncidentDate=e},get:function(){return this._optionFlags.showIncidentDate}},{key:"inputSearchGroups",set:function(e){this._inputSearchGroups=e},get:function(){return this._inputSearchGroups}},{key:"trackedEntityType",set:function(e){this._trackedEntityType=e},get:function(){return this._trackedEntityType}}]),e}(),qt=Symbol.iterator,Xt=function(e){function t(e){var n;return Object(A.a)(this,t),(n=Object(F.a)(this,Object(x.a)(t).call(this)))._attributes=[],n._stages=new Map,e&&Object(He.a)(e)&&e(Object(V.a)(n)),n}return Object(P.a)(t,e),Object(w.a)(t,[{key:qt,value:r.a.mark(function e(){var t,n,a,o,i,c;return r.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:t=!0,n=!1,a=void 0,e.prev=3,o=this._stages.values()[Symbol.iterator]();case 5:if(t=(i=o.next()).done){e.next=12;break}return c=i.value,e.next=9,c;case 9:t=!0,e.next=5;break;case 12:e.next=18;break;case 14:e.prev=14,e.t0=e.catch(3),n=!0,a=e.t0;case 18:e.prev=18,e.prev=19,t||null==o.return||o.return();case 21:if(e.prev=21,!n){e.next=24;break}throw a;case 24:return e.finish(21);case 25:return e.finish(18);case 26:case"end":return e.stop()}},e,this,[[3,14,18,26],[19,,21,25]])})},{key:"addStage",value:function(e){this.stages.set(e.id,e)}},{key:"getStage",value:function(e){return this.stages.get(e)}},{key:"getStageThrowIfNotFound",value:function(e){var n=this.stages.get(e);if(!n)throw new Error(Object(ze.b)(t.errorMessages.STAGE_NOT_FOUND)({program:this,stageId:e}));return n}},{key:"getStageFromIndex",value:function(e){var n=this.stages.entries()[e];if(!n)throw new Error(Object(ze.b)(t.errorMessages.STAGE_INDEX_NOT_FOUND)({program:this,stageIndex:e}));return n}},{key:"stages",get:function(){return this._stages}},{key:"searchGroups",get:function(){return this._searchGroups},set:function(e){this._searchGroups=e}},{key:"trackedEntityType",get:function(){return this._trackedEntityType},set:function(e){this._trackedEntityType=e}},{key:"enrollment",get:function(){return this._enrollment},set:function(e){this._enrollment=e}},{key:"attributes",get:function(){return this._attributes},set:function(e){this._attributes=e}}]),t}(Ze);Xt.errorMessages={STAGE_NOT_FOUND:"Stage was not found",STAGE_INDEX_NOT_FOUND:"No stage found on index"};var Zt=new Map,Jt=new(function(){function e(){Object(A.a)(this,e),this._optionSets={}}return Object(w.a)(e,[{key:"set",value:function(e){var t=this;e.forEach(function(e,n){t._optionSets[n]=e})}},{key:"get",value:function(){return this._optionSets}}]),e}()),Qt=new(function(){function e(){Object(A.a)(this,e)}return Object(w.a)(e,[{key:"set",value:function(e){this._constants=e}},{key:"get",value:function(){return this._constants}}]),e}()),$t=n(550),en=n(1453),tn=n.n(en),nn=(n(7942),n(7943),n(7944),n(7945),n(117)),an=n.n(nn),rn=function(e){function t(){return Object(A.a)(this,t),Object(F.a)(this,Object(x.a)(t).apply(this,arguments))}return Object(P.a)(t,e),Object(w.a)(t,[{key:"render",value:function(){var e=this.props,n=e.option,a=e.style,r=e.onSelect,o=e.currentlySelectedValues,i=e.classes,c=e.inFocus,s=e.onFocusOption,l=n.label,u=n.iconLeft,d=n.iconRight,p=!!o&&o.includes(n),f=Object.assign({},t.defaultContainerStyle,a,o&&o.includes(n)?t.selectedStyle:null,c?t.inFocusStyle:null);return m.a.createElement(an.a,{title:n.label,placement:"bottom",classes:{popper:i.popper},enterDelay:800},m.a.createElement("div",{className:"virtualized-select-option",style:f,onClick:function(){r(n)},role:"option","aria-selected":p,tabIndex:-1,onMouseOver:function(){return s(n)}},u?m.a.createElement("div",{className:i.iconLeftContainer},u):null,m.a.createElement("div",null,l),d?m.a.createElement("div",{className:i.iconRightContainer},d):null))}}]),t}(f.Component);rn.defaultContainerStyle={display:"flex",alignItems:"center",cursor:"pointer",paddingLeft:5,overflow:"hidden",paddingTop:4,paddingBottom:2,whiteSpace:"nowrap",textOverflow:"ellipsis"},rn.selectedStyle={fontWeight:"bold"},rn.inFocusStyle={backgroundColor:"rgba(0,0,0,0.1)"};var on=Object(E.withStyles)(function(){return{popper:{zIndex:9999},iconLeftContainer:{paddingRight:5},iconRightContainer:{paddingLeft:5}}})(rn),cn=function(e){function t(e){var n;return Object(A.a)(this,t),(n=Object(F.a)(this,Object(x.a)(t).call(this,e))).filterOptions=function(){return n.state.filterValue?n.prevFilterValue===n.state.filterValue?n.prevFilteredOptions:(n.state.filterValue&&n.prevFilterValue&&n.state.filterValue.indexOf(n.prevFilterValue)>-1&&(n.prevFilteredOptions=t.getFilteredOptions(n.prevFilteredOptions,n.state.filterValue)),n.prevFilteredOptions=t.getFilteredOptions(n.props.options,n.state.filterValue),n.prevFilterValue=n.state.filterValue,n.prevFilteredOptions):n.props.options},n.handleInputChange=function(e){n.setState({filterValue:e})},n.renderValue=function(e){var t=n.props.classes,a=e.iconLeft,r=e.iconRight,o=e.label;return f.createElement("div",{className:t.selectedOptionContainer},a?f.createElement("div",{className:t.selectedIconLeftContainer},a):null,f.createElement("div",null,o),r?f.createElement("div",{className:t.selectedIconRightContainer},r):null)},n.handleChange=n.handleChange.bind(Object(V.a)(n)),n.renderOption=n.renderOption.bind(Object(V.a)(n)),n.handleInputChange=Object($t.debounce)(n.handleInputChange,500),n.prevFilteredOptions=[],n.state={},n}return Object(P.a)(t,e),Object(w.a)(t,null,[{key:"getFilteredOptions",value:function(e,t){var n=t.toLowerCase();return e&&e.filter(function(e){return e.label.toLowerCase().indexOf(n)>-1})||[]}}]),Object(w.a)(t,[{key:"componentWillReceiveProps",value:function(e){e.options!==this.props.options&&(this.prevFilterValue=null)}},{key:"handleChange",value:function(e){var t=e&&e.value;t!==this.props.value&&this.props.onSelect(""===t?null:t)}},{key:"getValue",value:function(){var e=this.props.options,t=this.props.value;return e&&t?e.find(function(e){return e.value===t}):null}},{key:"renderOption",value:function(e){var t=e.option===e.focusedOption;return f.createElement(on,{key:e.option.value,option:e.option,inFocus:t,onFocusOption:e.focusOption,style:e.style,onSelect:e.selectValue,currentlySelectedValues:e.valueArray})}},{key:"render",value:function(){var e=this,n=this.props,a=n.options,r=n.label,o=n.value,i=n.nullable,c=n.style,s=n.menuStyle,l=n.maxHeight,u=n.disabled,d=(n.required,n.useHintLabel),p=n.translations,m=(n.withoutUnderline,n.classes,Object(Fe.a)(n,["options","label","value","nullable","style","menuStyle","maxHeight","disabled","required","useHintLabel","translations","withoutUnderline","classes"])),h=m.multi?o:this.getValue(),b=Object(se.a)({},t.defaultSelectStyle,c),g=Object(se.a)({},t.defaultMenuContainerStyle,s);return f.createElement("div",{ref:function(t){e.materialUIContainerInstance=t}},f.createElement("div",null,f.createElement(tn.a,Object.assign({disabled:u,options:a,onChange:this.handleChange,value:h,valueRenderer:this.renderValue,clearable:i,style:b,menuContainerStyle:g,className:"virtualized-select",placeholder:d?r:"",maxHeight:l||200,optionRenderer:this.renderOption,clearValueText:p.clearText,noResultsText:p.noResults,filterOptions:this.filterOptions,onInputChange:this.handleInputChange},m)),f.createElement("div",null)))}}]),t}(f.Component);cn.defaultSelectStyle={},cn.defaultMenuContainerStyle={},cn.defaultProps={translations:{clearText:"",noResults:""}};var sn=Object(E.withStyles)(function(){return{selectedOptionContainer:{display:"flex",alignItems:"center"},selectedIconLeftContainer:{paddingRight:5},selectedIconRightContainer:{paddingLeft:5}}})(cn),ln=n(163),un=n.n(ln),dn=n(137),pn=n.n(dn),fn=n(520),mn=n.n(fn),hn=Object(E.withStyles)(function(){return{list:{padding:0},item:{wordBreak:"break-word",hyphens:"auto",backgroundColor:"#ffffff",borderRadius:5,marginBottom:5,padding:5,border:"1px solid lightGrey","&:hover":{backgroundColor:"white",borderColor:"#71a4f8"}},itemContents:{display:"flex",alignItems:"center"}}})(function(e){var t=e.items,n=e.onSelect,a=e.classes;return f.createElement(un.a,{className:a.list},t.map(function(e){return f.createElement(pn.a,{className:a.item,button:!0,onClick:function(){return n(e.value)},key:e.value},f.createElement(mn.a,{primary:f.createElement("div",{className:a.itemContents},e.iconLeft,e.label)}))}))}),bn="setOrgUnitId",gn="storeOrgUnitObject",On="setProgramId",vn="setCategoryId",yn="resetCategorySelections",En="goBackToListContext",_n="resetProgramIdBase",jn=function(){return le(_n)()},In=(n(7951),n(18)),Cn=n.n(In),Tn=Object(E.withStyles)(function(e){return{button:{border:"none",fontSize:e.typography.pxToRem(16),display:"inline-block",textDecoration:"underline",cursor:"pointer","&:disabled":{color:"rgba(0, 0, 0, 0.26)",cursor:"default"}}}})(function(e){var t=e.classes,n=e.children,a=(e.muiClasses,e.muiButtonRef,e.className),r=Object(Fe.a)(e,["classes","children","muiClasses","muiButtonRef","className"]);return f.createElement("button",Object.assign({className:Cn()(t.button,a)},r),n)}),Sn=function(e){function t(e){var n;return Object(A.a)(this,t),(n=Object(F.a)(this,Object(x.a)(t).call(this,e))).handleClick=n.handleClick.bind(Object(V.a)(n)),n.handleClickCategoryOption=n.handleClickCategoryOption.bind(Object(V.a)(n)),n.buildProgramsArray(),n}return Object(P.a)(t,e),Object(w.a)(t,[{key:"buildProgramsArray",value:function(){this.programsArray=Array.from(Je.values())}},{key:"getProgramIcon",value:function(e){var t=this.props.classes;return e.icon.data?m.a.createElement("div",{className:t.iconContainer},m.a.createElement("img",{style:{backgroundColor:e.icon.color},className:t.icon,src:e.icon.data,alt:e.name})):null}},{key:"getOptionsFromPrograms",value:function(e){var t=this;return e.map(function(e){return{label:e.name,value:e.id,iconLeft:t.getProgramIcon(e)}})}},{key:"handleClick",value:function(e){this.props.handleClickProgram(e.value)}},{key:"handleClickCategoryOption",value:function(e,t){this.props.handleSetCatergoryCombo(e,t)}},{key:"handleResetProgram",value:function(){this.props.onResetProgramId(jn())}},{key:"handleResetCategoryOption",value:function(e){this.props.onResetCategoryOption(e)}},{key:"handleResetOrgUnit",value:function(){this.props.onResetOrgUnit()}},{key:"getOptions",value:function(){var e=this;return this.props.selectedOrgUnitId?this.getOptionsFromPrograms(this.programsArray.filter(function(t){return t instanceof Ht&&t.organisationUnits[e.props.selectedOrgUnitId]&&t.access.data.read})):this.getOptionsFromPrograms(this.programsArray.filter(function(e){return e instanceof Ht&&e.access.data.read}))}},{key:"areAllProgramsAvailable",value:function(e){return e.length===this.programsArray.filter(function(e){return e instanceof Ht&&e.access.data.read}).length}},{key:"renderSelectedProgram",value:function(e){var t=this;return m.a.createElement(m.a.Fragment,null,m.a.createElement("h4",{className:this.props.classes.title},c.a.t("Selected Program")),m.a.createElement("div",{className:this.props.classes.selectedText},m.a.createElement("div",{className:this.props.classes.selectedTextAndIconContainer},this.getProgramIcon(e),m.a.createElement("div",{className:this.props.classes.selectedProgramNameContainer},e.name)),m.a.createElement(te.a,{className:this.props.classes.selectedButton,onClick:function(){return t.handleResetProgram()}},m.a.createElement($e.a,{className:this.props.classes.selectedButtonIcon}))))}},{key:"getCategoryOptions",value:function(e){var t=this.props.selectedOrgUnitId;return(t?e.filter(function(e){return!e.organisationUnitIds||e.organisationUnitIds[t]}):e).map(function(e){return{label:e.name,value:e.id}})}},{key:"renderWithSelectedProgram",value:function(e){var t=this;return e.categoryCombination?m.a.createElement("div",null,m.a.createElement(Be.a,{elevation:0,className:this.props.classes.selectedPaper},m.a.createElement(Ge.a,{container:!0,spacing:8},m.a.createElement(Ge.a,{item:!0,xs:12,sm:6},this.renderSelectedProgram(e)),Array.from(e.categoryCombination.categories.values()).map(function(e){return m.a.createElement(Ge.a,{key:e.id,item:!0,xs:12,sm:6},m.a.createElement("h4",{className:t.props.classes.title},e.name),function(){if(t.props.selectedCategories&&t.props.selectedCategories[e.id])return m.a.createElement("div",{className:t.props.classes.selectedText},m.a.createElement("div",{className:t.props.classes.selectedCategoryNameContainer},e.getOptionThrowIfNotFound(t.props.selectedCategories[e.id]).name),m.a.createElement(te.a,{className:t.props.classes.selectedButton,onClick:function(){return t.handleResetCategoryOption(e.id)}},m.a.createElement($e.a,{className:t.props.classes.selectedButtonIcon})));var n=t.getCategoryOptions(Object(We.a)(e.categoryOptions.values()));return m.a.createElement(sn,{options:n,onSelect:function(n){t.handleClickCategoryOption(n,e.id)},value:"",placeholder:c.a.t("Select")})}())})))):m.a.createElement("div",null,m.a.createElement(Be.a,{elevation:0,className:this.props.classes.selectedPaper},this.renderSelectedProgram(e)))}},{key:"renderWithoutSelectedProgram",value:function(e){var t=this,n=this.props,a=n.handleClickProgram,r=n.classes,o=this.areAllProgramsAvailable(e)?null:m.a.createElement("div",{className:this.props.classes.programsHiddenText},c.a.t("Some programs are being filtered."),m.a.createElement(Tn,{className:this.props.classes.programsHiddenTextResetOrgUnit,onClick:function(){return t.handleResetOrgUnit()}},c.a.t("Show all")));return m.a.createElement(Be.a,{elevation:0,className:r.paper},m.a.createElement("h4",{className:r.title},c.a.t("Program")),e.length<=t.props.buttonModeMaxLength?m.a.createElement(hn,{items:e,onSelect:a}):m.a.createElement("div",null,m.a.createElement("div",{id:"program-selector"},m.a.createElement(sn,{options:e,onSelect:a,placeholder:c.a.t("Select program"),value:""}))),o)}},{key:"renderEmpty",value:function(){var e=this;return m.a.createElement("div",null,m.a.createElement(Be.a,{elevation:0,className:this.props.classes.paper},m.a.createElement("h4",{className:this.props.classes.title},c.a.t("Program")),m.a.createElement("div",{className:this.props.classes.noProgramsContainer},c.a.t("No programs available."),m.a.createElement(Tn,{className:this.props.classes.programsHiddenTextResetOrgUnit,onClick:function(){return e.handleResetOrgUnit()}},c.a.t("Show all")))))}},{key:"render",value:function(){var e=this.getOptions();if(0===e.length)return this.renderEmpty();var t=this.props.selectedProgram?Je.get(this.props.selectedProgram):null;return t?this.renderWithSelectedProgram(t):this.renderWithoutSelectedProgram(e)}}]),t}(f.Component),Rn=Object(E.withStyles)(function(e){return{paper:{padding:8,backgroundColor:e.palette.grey.lighter,borderRadius:8},title:{margin:0,fontWeight:425,fontSize:15,paddingBottom:5},form:{width:"100%"},selectedText:{marginTop:5,marginBottom:5,marginLeft:5,padding:5,borderLeft:"2px solid #71a4f8",display:"flex",alignItems:"center",justifyContent:"space-between"},selectedTextContainer:{display:"flex",alignItems:"center",overflow:"hidden"},selectedTextAndIconContainer:{display:"flex",alignItems:"center",overflow:"hidden"},selectedProgramNameContainer:{whiteSpace:"nowrap",textOverflow:"ellipsis",overflow:"hidden"},selectedCategoryNameContainer:{whiteSpace:"nowrap",textOverflow:"ellipsis",overflow:"hidden"},selectedPaper:{backgroundColor:e.palette.grey.lighter,borderRadius:8,padding:8},selectedButton:{float:"right",width:20,height:20},selectedButtonIcon:{width:20,height:20},programsHiddenText:{fontSize:12,color:e.palette.grey.dark,paddingTop:5},programsHiddenTextResetOrgUnit:{cursor:"pointer",color:"inherit",paddingLeft:2},noProgramsContainer:{fontSize:14,textAlign:"center",backgroundColor:"white",padding:10,borderRadius:5,border:"1px solid lightGrey"},iconContainer:{display:"flex",alignItems:"center",paddingRight:5},icon:{width:22,height:22,borderRadius:2}}})(Sn),kn=n(130),Nn=n.n(kn);function An(e){return Boolean(e)||0===e||!1===e}var wn=function(e){return{momentDate:e,isValid:!!e&&e.isValid()}};function Fn(e,t,n){var a=t.match(n),r=a&&a[0],o=e.replace(n,r),i=t.replace(n,r),c=Se(o,i,!0);return c.isValid()?wn(c):function(e,t,n){var a=e.split(n),r=t.split(n);if(a.length===r.length){var o=r.map(function(e,t){var n="",r=a[t];if(e&&r){var o=e.charAt(0);"M"===o?1===r.length?n="M":2===r.length&&(n="MM"):"D"===o?1===r.length?n="D":2===r.length&&(n="DD"):"Y"===o&&(2===r.length?n="YY":4===r.length&&(n="YYYY"))}return n||e}).join(n),i=Se(e,o,!0);return wn(i)}return wn(null)}(o,i,r)}function xn(e,t,n){var a=e.replace(n,""),r=t.replace(n,""),o=Se(a,r,!0);return o.isValid()?wn(o):wn(null)}function Pn(e){var t=Se.localeData()._longDateFormat.L;if(!t)return O.a.error("could not get locale format for ".concat(Se.locale())),wn(null);var n=/[^\w\s]/g;return n.test(e)&&n.test(t)?Fn(e,t,n):xn(e,t,n)}function Dn(e){return Pn(e).isValid}var Un=function(e){return/^(([0-1]*[0-9])|(2[0-3]))([:.])*([0-5][0-9])$/.test(e)};function Ln(e){if(!e)return!1;var t=e.date,n=e.time;return!(!t||!n)&&(Dn(t)&&Un(n))}var Mn=/^[a-zA-Z0-9.!#$%&'*+\/=?^_`{|}~-]+@[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)*$/,Bn=function(e){return Mn.test(e)},Vn=function(e){if(isNaN(e))return!1;var t=Number(e);return Number.isSafeInteger(t)},Gn=function(e){if(isNaN(e))return!1;var t=Number(e);return Number.isSafeInteger(t)&&t>0},Wn=function(e){if(isNaN(e))return!1;var t=Number(e);return Number.isSafeInteger(t)&&t<0},Hn=function(e){return"0"===e||Gn(e)},zn=function(e){return!(isNaN(e)||Number(e)===1/0)},Kn=function(e){var t=e.replace("%","");return!(isNaN(t)||Number(t)===1/0)},Yn=function(e){return null!==e.match(/^(http|https):\/\/[a-z0-9]+([-.]{1}[a-z0-9]+)*\.[a-z]{2,6}(:[0-9]{1,5})?(\/.*)?$/)},qn={date:"Please provide a valid date",years:"Please provide a valid positive integer",months:"Please provide a valid positive integer",days:"Please provide a valid positive integer"};function Xn(e){return e||""}function Zn(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(!e||!e.date&&!e.years&&!e.months&&!e.days)return t;var n=function(e,t,n){var a=[];return Hn(e,!0)||a.push({years:qn.years}),Hn(t,!0)||a.push({months:qn.years}),Hn(n,!0)||a.push({days:qn.years}),a.length>0?{valid:!1,errorMessage:a.reduce(function(e,t){return Object(se.a)({},e,t)},{})}:{valid:!0}}(Xn(e.years),Xn(e.months),Xn(e.days));return n.valid?Dn(Xn(e.date))?{valid:!0}:{valid:!1,errorMessage:{date:qn.date}}:n}var Jn=function(e){return/^[^a-zA-Z]+$/.test(e)},Qn=function(e){return!!(e&&e.id&&e.name)};function $n(e){return"number"===typeof e||"string"===typeof e&&null===e.match(/[^0-9.,-]+/)}var ea=function(e){if(!e)return!1;var t=e.longitude,n=e.latitude;if(!$n(n)||!$n(t))return!1;var a=parseInt(t,10),r=parseInt(n,10);return a>=-180&&a<=180&&r>=-90&&r<=90};function ta(e){return e.length>3}function na(e){return e=(e=(e=e.replace(/[ ]/g,"")).replace(",",".")).replace(/^[+]$/,""),Number(e)}function aa(e,t){return e&&t.validator(e)}var ra=function(e){return function(t){var n=[];return aa(t.from,e)||n.push({from:e.message}),aa(t.to,e)||n.push({to:e.message}),n.length>0?{valid:!1,errorMessage:n.reduce(function(e,t){return Object(se.a)({},e,t)},{})}:na(t.from)<=na(t.to)}};function oa(e){return e&&Dn(e)}var ia=function(e){return function(t){var n=[];return oa(t.from)||n.push({from:e}),oa(t.to)||n.push({to:e}),n.length>0?{valid:!1,errorMessage:n.reduce(function(e,t){return Object(se.a)({},e,t)},{})}:Pn(t.from).momentDate<=Pn(t.to).momentDate}},ca=n(185);function sa(e){return e&&Ln(e)}var la=function(e){var t,n,a=e.date,r=e.time;if(/[:.]/.test(r)){var o=r.split(/[:.]/),i=Object(ca.a)(o,2);t=i[0],n=i[1]}else 3===r.length?(t=r.substring(0,1),n=r.substring(2,3)):(t=r.substring(0,2),n=r.substring(3,4));var c=Pn(a).momentDate;return c.hour(t),c.minute(n),c},ua=function(e){return function(t){var n=[];return sa(t.from)||n.push({from:e}),sa(t.to)||n.push({to:e}),n.length>0?{valid:!1,errorMessage:n.reduce(function(e,t){return Object(se.a)({},e,t)},{})}:la(t.from)<=la(t.to)}};function da(e){return e&&Un(e)}var pa=function(e,t){var n,a;if(/[:.]/.test(e)){var r=e.split(/[:.]/),o=Object(ca.a)(r,2);n=o[0],a=o[1]}else 3===e.length?(n=e.substring(0,1),a=e.substring(2,3)):(n=e.substring(0,2),a=e.substring(3,4));var i=Se(t);return i.hour(n),i.minute(a),i},fa=function(e){return function(t){var n=[];if(da(t.from)||n.push({from:e}),da(t.to)||n.push({to:e}),n.length>0)return{valid:!1,errorMessage:n.reduce(function(e,t){return Object(se.a)({},e,t)},{})};var a=Se();return pa(t.from,a)<=pa(t.to,a)}},ma=n(394),ha=n.n(ma),ba=function(e){var t=e.multiLine,n=e.classes,a=e.inputRef,r=(e.style,Object(Fe.a)(e,["multiLine","classes","inputRef","style"]));return m.a.createElement(m.a.Fragment,null,t?m.a.createElement("textarea",Object.assign({ref:a,className:Cn()(ha.a.textArea,n.input)},r)):m.a.createElement("input",Object.assign({ref:a,className:Cn()(ha.a.input,n.input)},r)))};ba.defaultProps={classes:{}};var ga=ba,Oa=n(576),va=n.n(Oa);var ya=function(e){var t=e.children,n=e.shrink,a=Cn()(va.a.label,n?va.a.labelShrinked:va.a.labelUnshrinked);return m.a.createElement("div",{className:a},t)},Ea=n(1455),_a=n.n(Ea),ja=function(){return function(e){return function(t){function n(){var t,a;Object(A.a)(this,n);for(var r=arguments.length,o=new Array(r),i=0;i<r;i++)o[i]=arguments[i];return(a=Object(F.a)(this,(t=Object(x.a)(n)).call.apply(t,[this].concat(o)))).renderDisabled=function(t){return f.createElement(e,Object.assign({placeholder:a.props.label},t))},a}return Object(P.a)(n,t),Object(w.a)(n,[{key:"render",value:function(){var t=this.props,n=t.shrinkDisabled,a=Object(Fe.a)(t,["shrinkDisabled"]),r=!!this.props.inFocus||!!this.props.value;return n?this.renderDisabled(a):f.createElement("div",{className:_a.a.container},f.createElement(ya,{shrink:r},this.props.label),f.createElement(e,a))}}]),n}(f.Component)}},Ia=function(){return function(e){return function(t){function n(e){var t;return Object(A.a)(this,n),(t=Object(F.a)(this,Object(x.a)(n).call(this,e))).setFocus=function(){t.setState({inFocus:!0}),t.props.onSetFocus&&t.props.onSetFocus()},t.removeFocus=function(){t.setState({inFocus:!1}),t.props.onRemoveFocus&&t.props.onRemoveFocus()},t.state={inFocus:!1},t}return Object(P.a)(n,t),Object(w.a)(n,[{key:"render",value:function(){var t=this.state.inFocus,n=this.props,a=(n.inFocus,n.onSetFocus,n.onRemoveFocus,Object(Fe.a)(n,["inFocus","onSetFocus","onRemoveFocus"]));return f.createElement(e,Object.assign({inFocus:t,onSetFocus:this.setFocus,onRemoveFocus:this.removeFocus},a))}}]),n}(f.Component)}},Ca=function(){return function(e){return function(t){function n(){var e,t;Object(A.a)(this,n);for(var a=arguments.length,r=new Array(a),o=0;o<a;o++)r[o]=arguments[o];return(t=Object(F.a)(this,(e=Object(x.a)(n)).call.apply(e,[this].concat(r)))).handleBlur=function(e){t.props.onRemoveFocus(),t.props.onBlur&&t.props.onBlur(e)},t.handleFocus=function(){t.props.onSetFocus(),t.props.onFocus&&t.props.onFocus()},t}return Object(P.a)(n,t),Object(w.a)(n,[{key:"render",value:function(){var t=this.props,n=(t.onSetFocus,t.onRemoveFocus,t.onFocus,t.inFocus),a=(t.onBlur,t.classes),r=Object(Fe.a)(t,["onSetFocus","onRemoveFocus","onFocus","inFocus","onBlur","classes"]),o=a.inputWrapperFocused,i=a.inputWrapperUnfocused,c=Object(Fe.a)(a,["inputWrapperFocused","inputWrapperUnfocused"]),s=n?o:i;return f.createElement("div",{className:Cn()(ha.a.inputWrapper,s)},f.createElement(e,Object.assign({onFocus:this.handleFocus,onBlur:this.handleBlur},r,{classes:c})))}}]),n}(f.Component)}},Ta=function(e){function t(e){var n;return Object(A.a)(this,t),(n=Object(F.a)(this,Object(x.a)(t).call(this,e))).handleBlur=function(e){n.props.onBlur(e.currentTarget.value),n.setState({focus:!1})},n.handleChange=function(e){n.props.onChange&&n.props.onChange(e.currentTarget.value)},n.handleFocus=function(){n.setState({focus:!0})},n.state={},n}return Object(P.a)(t,e),Object(w.a)(t,[{key:"render",value:function(){var e=this.props,t=(e.onBlur,e.onChange,e.value),n=(e.classes,Object(Fe.a)(e,["onBlur","onChange","value","classes"]));return m.a.createElement(ga,Object.assign({classes:{},onBlur:this.handleBlur,onChange:this.handleChange,onFocus:this.handleFocus,value:t||""},n))}}]),t}(f.Component),Sa=Ia()(ja()(Ca()(Ta))),Ra="right",ka="center",Na="up",Aa={ABSOLUTE:"absolute",INLINE:"inline"},wa=n(400),Fa=n.n(wa),xa=function(e){function t(){var e,n;Object(A.a)(this,t);for(var a=arguments.length,r=new Array(a),o=0;o<a;o++)r[o]=arguments[o];return(n=Object(F.a)(this,(e=Object(x.a)(t)).call.apply(e,[this].concat(r)))).getRightCalendarStyle=function(e){return e===Aa.INLINE?{marginLeft:"-".concat(n.calculateMarginLeftInline(),"px")}:Object(se.a)({},n.getAbsoluteVerticalPosition(),{right:0})},n.getLeftCalendarStyle=function(e){return e===Aa.INLINE?{}:Object(se.a)({},n.getAbsoluteVerticalPosition(),{left:0})},n.getCenterCalendarStyle=function(e){return e===Aa.INLINE?{marginLeft:"-".concat(n.calculateMarginLeftInline()/2,"px")}:Object(se.a)({},n.getAbsoluteVerticalPosition(),{left:"50%",transform:"translate(-50%, 0)"})},n}return Object(P.a)(t,e),Object(w.a)(t,[{key:"getAbsoluteBottom",value:function(){return this.props.inputUsesFloatingLabel?60:40}},{key:"getAbsoluteVerticalPosition",value:function(){return this.props.absoluteDirection===Na?{bottom:this.getAbsoluteBottom()}:{top:0}}},{key:"calculateMarginLeftInline",value:function(){var e=this.props,t=e.inputWidth;return e.calendarWidth-t}},{key:"getPopupStyle",value:function(){var e=this.props,t=e.anchorPosition,n=e.mode;return t===Ra?this.getRightCalendarStyle(n):t===ka?this.getCenterCalendarStyle(n):this.getLeftCalendarStyle(n)}},{key:"render",value:function(){var e=this.props,t=e.open,n=e.mode,a=(e.anchorPosition,e.absoluteDirection,e.children);if(!t)return null;var r=n===Aa.INLINE?Fa.a.containerInline:Fa.a.containerAbsolute,o=n===Aa.INLINE?Fa.a.calendarInline:Fa.a.calendarAbsolute,i=this.getPopupStyle();return f.createElement("div",{className:r},f.createElement("div",{className:o,style:i},a))}}]),t}(f.Component),Pa=n(566),Da=(n(1331),n(7973),function(e){function t(e){var n;return Object(A.a)(this,t),(n=Object(F.a)(this,Object(x.a)(t).call(this,e))).handleChange=n.handleChange.bind(Object(V.a)(n)),n.displayOptions=Object(se.a)({},t.displayOptions,n.props.displayOptions),n}return Object(P.a)(t,e),Object(w.a)(t,[{key:"shouldComponentUpdate",value:function(){return!1}},{key:"handleChange",value:function(e){var t=this.props.onConvertValueOut(e);this.props.onDateSelected(t)}},{key:"getValue",value:function(e){return this.props.onConvertValueIn(e)}},{key:"getMinMaxProps",value:function(){var e={},t=this.props.minMoment,n=this.props.maxMoment;if(t){var a=t.toDate();e.min=a,e.minDate=a}if(n){var r=n.toDate();e.max=r,e.maxDate=r}return e}},{key:"render",value:function(){var e=this.props,t=e.value,n=(e.classes,e.currentWidth),a=e.height,r=(e.minMoment,e.maxMoment,e.onDateSelected,e.displayOptions,Object(Fe.a)(e,["value","classes","currentWidth","height","minMoment","maxMoment","onDateSelected","displayOptions"]));return m.a.createElement("div",null,m.a.createElement(Pa.a,Object.assign({},this.getMinMaxProps(),{selected:this.getValue(t),onSelect:this.handleChange,width:n,height:a,autoFocus:!1,displayOptions:this.displayOptions},r)))}}]),t}(f.Component));Da.displayOptions={showHeader:!1};var Ua=Da;var La=function(e){function t(){var e,n;Object(A.a)(this,t);for(var a=arguments.length,r=new Array(a),o=0;o<a;o++)r[o]=arguments[o];return(n=Object(F.a)(this,(e=Object(x.a)(t)).call.apply(e,[this].concat(r)))).handleBlur=function(e){n.props.onBlur(e)},n.handleChange=function(e){n.props.onChange&&n.props.onChange(e.currentTarget.value)},n}return Object(P.a)(t,e),Object(w.a)(t,[{key:"render",value:function(){var e=this.props,t=(e.onBlur,e.onChange,e.value),n=Object(Fe.a)(e,["onBlur","onChange","value"]);return m.a.createElement(ga,Object.assign({value:t||"",onBlur:this.handleBlur,onChange:this.handleChange},n))}}]),t}(m.a.Component),Ma=Ca()(La),Ba=function(e){function t(e){var n;return Object(A.a)(this,t),(n=Object(F.a)(this,Object(x.a)(t).call(this,e))).state={popoverOpen:!1},n.handleTextFieldFocus=n.handleTextFieldFocus.bind(Object(V.a)(n)),n.handleDateSelected=n.handleDateSelected.bind(Object(V.a)(n)),n.handleTextFieldBlur=n.handleTextFieldBlur.bind(Object(V.a)(n)),n.hidePopover=n.hidePopover.bind(Object(V.a)(n)),n.handleDocumentClick=n.handleDocumentClick.bind(Object(V.a)(n)),n}return Object(P.a)(t,e),Object(w.a)(t,null,[{key:"splitPassOnProps",value:function(e){var n={input:{},popup:{},calendar:{}};return e?Object.keys(e).reduce(function(n,a){var r;r=a.startsWith(t.propContainers.CALENDAR)?t.propContainers.CALENDAR:a.startsWith(t.propContainers.POPUP)?t.propContainers.POPUP:t.propContainers.INPUT;var o,i=(o=a.replace(r,"")).charAt(0).toLocaleLowerCase()+o.slice(1);return n[r][i]=e[a],n},n):n}}]),Object(w.a)(t,[{key:"componentWillUnmount",value:function(){document.removeEventListener("click",this.handleDocumentClick)}},{key:"handleTextFieldFocus",value:function(){document.removeEventListener("click",this.handleDocumentClick),this.setState({popoverOpen:!0}),this.props.onFocus&&this.props.onFocus()}},{key:"handleDateSelected",value:function(e){this.props.onBlur(e),this.hidePopover(),this.props.onDateSelectedFromCalendar&&this.props.onDateSelectedFromCalendar(),document.removeEventListener("click",this.handleDocumentClick)}},{key:"handleDocumentClick",value:function(e){e.target&&e.target.className&&e.target.className.startsWith&&e.target.className.startsWith("Cal__")||e.target&&e.target.className&&e.target.className.baseVal&&e.target.className.baseVal.startsWith("Cal__")||(this.hidePopover(),document.removeEventListener("click",this.handleDocumentClick))}},{key:"handleTextFieldBlur",value:function(e){this.props.onBlur(e.currentTarget.value),e.relatedTarget&&"Cal__Container__root"===e.relatedTarget.className?document.addEventListener("click",this.handleDocumentClick):this.hidePopover()}},{key:"hidePopover",value:function(){this.setState({popoverOpen:!1})}},{key:"render",value:function(){var e=this,n=this.props,a=n.width,r=n.maxWidth,o=n.calendarWidth,i=n.calendarHeight,c=n.inputWidth,s=(n.onBlur,n.onFocus,n.onDateSelectedFromCalendar,n.textFieldRef),l=Object(Fe.a)(n,["width","maxWidth","calendarWidth","calendarHeight","inputWidth","onBlur","onFocus","onDateSelectedFromCalendar","textFieldRef"]),u=this.state.popoverOpen,d=s?{ref:s}:null,p=c||a,m=o||a,h=t.splitPassOnProps(l),b=i||350;return f.createElement("div",{ref:function(t){e.containerInstance=t},style:{width:a,maxWidth:r}},f.createElement(Ma,Object.assign({},d,{onFocus:this.handleTextFieldFocus,onBlur:this.handleTextFieldBlur,classes:{},width:p},h.input)),f.createElement(xa,Object.assign({open:u,onClose:this.hidePopover,width:m,height:b,inputWidth:p,inputUsesFloatingLabel:!!h.input.label},h.popup),f.createElement(Ua,Object.assign({onDateSelected:this.handleDateSelected,value:this.props.value,currentWidth:m,height:b},h.calendar))))}}]),t}(f.Component);Ba.propContainers={CALENDAR:"calendar",POPUP:"popup",INPUT:"input"};var Va=Ba,Ga={HORIZONTAL:"horizontal",VERTICAL:"vertical"},Wa=function(e){function t(){return Object(A.a)(this,t),Object(F.a)(this,Object(x.a)(t).apply(this,arguments))}return Object(P.a)(t,e),Object(w.a)(t,[{key:"render",value:function(){var e=this.props,t=e.value,n=(e.orientation,Object(Fe.a)(e,["value","orientation"]));return m.a.createElement(Va,Object.assign({value:t||"",placeholder:c.a.t("mm/dd/yyyy"),calendarMaxMoment:l()(),width:150,calendarWidth:350},n))}}]),t}(f.Component),Ha=Ia()(Wa),za=n(321),Ka=n.n(za),Ya=function(){return function(e){return function(t){function n(e){var t;Object(A.a)(this,n),(t=Object(F.a)(this,Object(x.a)(n).call(this,e))).handleChange=t.handleChange.bind(Object(V.a)(t));var a=t.props.value;return t.state={value:a},t}return Object(P.a)(n,t),Object(w.a)(n,[{key:"componentWillReceiveProps",value:function(e){e.value!==this.props.value&&this.setState({value:e.value})}},{key:"handleChange",value:function(e){this.setState({value:e})}},{key:"render",value:function(){var t=this.props,n=(t.onChange,t.value,Object(Fe.a)(t,["onChange","value"])),a=this.state.value;return f.createElement(e,Object.assign({onChange:this.handleChange,value:a},n))}}]),n}(f.Component)}};function qa(e,t,n){var a=t(e);if(!a.isValid)return{date:e,years:"",months:"",days:""};var r=n(),o=n(a.momentDate),i=r.diff(o,"years");o.add(i,"years");var c=r.diff(o,"months");o.add(c,"months");var s=r.diff(o,"days");return{date:a.momentDate.format("L"),years:i.toString(),months:c.toString(),days:s.toString()}}var Xa={error:"innerInputError",info:"innerInputInfo",warning:"innerInputWarning",validating:"innerInputValidating"},Za=function(e){function t(){var e,n;Object(A.a)(this,t);for(var a=arguments.length,r=new Array(a),o=0;o<a;o++)r[o]=arguments[o];return(n=Object(F.a)(this,(e=Object(x.a)(t)).call.apply(e,[this].concat(r)))).onClear=function(){n.props.onBlur(null)},n.handleNumberBlur=function(e){var a=n.props.moment;if(n.props.onRemoveFocus&&n.props.onRemoveFocus(),t.isEmptyNumbers(e))n.props.onBlur(e.date?{date:e.date}:null);else if(t.isValidNumbers(e)){var r=a(void 0,void 0,!0);r.subtract(t.getNumberOrZero(e.years),"years"),r.subtract(t.getNumberOrZero(e.months),"months"),r.subtract(t.getNumberOrZero(e.days),"days");var o=qa(r.format("L"),n.props.onParseDate,a);n.props.onBlur(o)}else n.props.onBlur(Object(se.a)({},e,{date:""}))},n.handleDateBlur=function(e){n.props.onRemoveFocus&&n.props.onRemoveFocus();var t=e?qa(e,n.props.onParseDate,n.props.moment):null;n.props.onBlur(t)},n.renderMessage=function(e){var t=n.props,a=t.classes,r=t.innerMessage;if(r){var o=r.message&&r.message[e],i=a&&a[Xa[r.messageType]]||"";return o&&m.a.createElement("div",{className:i},o)}return null},n.renderNumberInput=function(e,t,a){var r=n.props,o=r.innerMessage,i=r.onChange,s=(r.inFocus,r.value,r.onBlur,r.dateCalendarOnConvertValueIn,r.dateCalendarOnConvertValueOut,r.dateCalendarWidth,r.datePopupAnchorPosition,r.dateCalendarTheme,r.dateCalendarLocale,r.moment,r.onParseDate,Object(Fe.a)(r,["innerMessage","onChange","inFocus","value","onBlur","dateCalendarOnConvertValueIn","dateCalendarOnConvertValueOut","dateCalendarWidth","datePopupAnchorPosition","dateCalendarTheme","dateCalendarLocale","moment","onParseDate"]));return m.a.createElement("div",{className:Ka.a.ageNumberInputContainer},m.a.createElement(Sa,Object.assign({label:c.a.t(a),value:e[t],onBlur:function(a){return n.handleNumberBlur(Object(se.a)({},e,Object(Ut.a)({},t,a)))},onChange:function(n){return i(Object(se.a)({},e,Object(Ut.a)({},t,n)))}},s)),o&&n.renderMessage(t))},n.renderDateInput=function(e,t){var a=n.props,r=a.onChange,o=a.innerMessage,i=(a.inFocus,a.value,a.onBlur,a.shrinkDisabled,a.dateCalendarOnConvertValueIn),c=a.dateCalendarOnConvertValueOut,s=a.dateCalendarWidth,l=a.datePopupAnchorPosition,u=a.dateCalendarTheme,d=a.dateCalendarLocale,p=(a.moment,a.onParseDate,Object(Fe.a)(a,["onChange","innerMessage","inFocus","value","onBlur","shrinkDisabled","dateCalendarOnConvertValueIn","dateCalendarOnConvertValueOut","dateCalendarWidth","datePopupAnchorPosition","dateCalendarTheme","dateCalendarLocale","moment","onParseDate"])),f=Cn()(Object(Ut.a)({},Ka.a.ageDateInputContainerHorizontal,!t));return m.a.createElement("div",{className:f},m.a.createElement(Ha,Object.assign({onBlur:n.handleDateBlur,value:e.date,onChange:function(t){return r(Object(se.a)({},e,{date:t}))},calendarWidth:s,popupAnchorPosition:l,calendarTheme:u,calendarLocale:d,calendarOnConvertValueIn:i,calendarOnConvertValueOut:c},p)),o&&n.renderMessage("date"))},n}return Object(P.a)(t,e),Object(w.a)(t,[{key:"render",value:function(){var e=this.props,t=e.value,n=e.orientation,a=e.disabled,r=t||{},o=n===Ga.VERTICAL,i=o?Ka.a.containerVertical:Ka.a.containerHorizontal,c=o?null:Ka.a.ageClearHorizontal;return m.a.createElement("div",{className:i},this.renderDateInput(r,o),this.renderNumberInput(r,"years","Years"),this.renderNumberInput(r,"months","Months"),this.renderNumberInput(r,"days","Days"),m.a.createElement("div",{className:c},m.a.createElement(te.a,{style:{width:42,height:42},disabled:a},m.a.createElement($e.a,{onClick:this.onClear}))))}}],[{key:"isEmptyNumbers",value:function(e){return!e.years&&!e.months&&!e.days}},{key:"isPositiveOrZeroNumber",value:function(e){return Gn(e)||0===Number(e)}},{key:"isValidNumbers",value:function(e){return t.isPositiveOrZeroNumber(e.years||0)&&t.isPositiveOrZeroNumber(e.months||0)&&t.isPositiveOrZeroNumber(e.days||0)}},{key:"getNumberOrZero",value:function(e){return e||0}}]),t}(f.Component),Ja=Ya()(Za),Qa=function(e){function t(){return Object(A.a)(this,t),Object(F.a)(this,Object(x.a)(t).apply(this,arguments))}return Object(P.a)(t,e),Object(w.a)(t,[{key:"render",value:function(){return m.a.createElement("div",null,"Multi")}}]),t}(m.a.Component),$a=n(1467),er=n.n($a),tr=function(e){e.className;var t=Object(Fe.a)(e,["className"]);return m.a.createElement("svg",Object.assign({className:Cn()(er.a.icon,e.className)},t))},nr=function(e){return m.a.createElement(tr,e,m.a.createElement("path",{d:"M12 7c-2.76 0-5 2.24-5 5s2.24 5 5 5 5-2.24 5-5-2.24-5-5-5zm0-5C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm0 18c-4.42 0-8-3.58-8-8s3.58-8 8-8 8 3.58 8 8-3.58 8-8 8z"}))},ar=function(e){return m.a.createElement(tr,e,m.a.createElement("path",{d:"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm0 18c-4.42 0-8-3.58-8-8s3.58-8 8-8 8 3.58 8 8-3.58 8-8 8z"}))},rr=n(237),or=n.n(rr),ir={SPACE:" ",ENTER:"Enter"},cr=function(e){function t(){var e,n;Object(A.a)(this,t);for(var a=arguments.length,r=new Array(a),o=0;o<a;o++)r[o]=arguments[o];return(n=Object(F.a)(this,(e=Object(x.a)(t)).call.apply(e,[this].concat(r)))).handleSelect=function(){if(n.isSpaceClickWhenSelected)n.isSpaceClickWhenSelected=!1;else{var e=n.props,t=e.onSelect,a=e.optionData;t(e.isSelected?null:a.value)}},n.handleKeyPress=function(e){if([ir.SPACE,ir.ENTER].includes(e.key)){var t=n.props,a=t.onSelect,r=t.optionData;if(t.isSelected)return n.isSpaceClickWhenSelected=e.key===ir.SPACE,void a(null);n.isSpaceClickWhenSelected=!1,a(r.value)}},n}return Object(P.a)(t,e),Object(w.a)(t,[{key:"render",value:function(){var e=this.props,t=e.optionData,n=e.isSelected,a=e.groupId,r=e.children,o=e.inFocus,i=e.inputRef,c=e.focusClass,s=e.unFocusClass,l=(e.onSelect,e.disabled),u=Object(Fe.a)(e,["optionData","isSelected","groupId","children","inFocus","inputRef","focusClass","unFocusClass","onSelect","disabled"]),d=a+(t.id||t.name);return f.createElement("div",null,f.createElement("label",{htmlFor:d,className:Cn()(or.a.label,Object(Ut.a)({},or.a.labelDisabled,l))},f.createElement("input",Object.assign({ref:i,type:"radio",className:or.a.input,name:a,id:d,checked:n,value:t.value,onClick:this.handleSelect,onKeyPress:this.handleKeyPress,disabled:l},u)),f.createElement("div",{className:or.a.iconFocusContainer},f.createElement("div",{className:o?Cn()(or.a.inFocus,c):Cn()(s)}),f.createElement("div",{className:or.a.iconContainer},r)),f.createElement("span",{className:or.a.name},t.name)))}}]),t}(f.Component),sr=function(){return function(e){return function(t){function n(e){var t;return Object(A.a)(this,n),(t=Object(F.a)(this,Object(x.a)(n).call(this,e))).handleInputMouseDown=function(){t.isMouseClick=!0},t.handleInputFocus=function(){t.props.onSetFocus&&t.props.onSetFocus(),t.isMouseClick?t.isMouseClick=!1:t.setState({inFocus:!0})},t.handleInputBlur=function(){t.props.onRemoveFocus&&t.props.onRemoveFocus(),t.state.inFocus&&t.setState({inFocus:!1}),t.isMouseClick=!1},t.setInputInstance=function(e){t.inputInstance=e},t.state={inFocus:!1,isMouseClick:!1},t}return Object(P.a)(n,t),Object(w.a)(n,[{key:"componentDidMount",value:function(){this.inputInstance.addEventListener("mousedown",this.handleInputMouseDown),this.inputInstance.addEventListener("focus",this.handleInputFocus),this.inputInstance.addEventListener("blur",this.handleInputBlur)}},{key:"componentWillUnmount",value:function(){this.inputInstance.removeEventListener("mousedown",this.handleInputMouseDown),this.inputInstance.removeEventListener("focus",this.handleInputFocus),this.inputInstance.removeEventListener("blur",this.handleInputBlur)}},{key:"render",value:function(){var t=this.props,n=(t.onSetFocus,t.onRemoveFocus,t.inFocus,Object(Fe.a)(t,["onSetFocus","onRemoveFocus","inFocus"]));return f.createElement(e,Object.assign({inputRef:this.setInputInstance,inFocus:this.state.inFocus},n))}}]),n}(f.Component)}},lr=n(401),ur=n.n(lr),dr=sr()(cr),pr=function(e){function t(){var e,n;Object(A.a)(this,t);for(var a=arguments.length,r=new Array(a),o=0;o<a;o++)r[o]=arguments[o];return(n=Object(F.a)(this,(e=Object(x.a)(t)).call.apply(e,[this].concat(r)))).getCheckedClass=function(e,t,n){return Cn()(e,t&&Object(Ut.a)({},t,n))},n.getUncheckedClass=function(e,t,n){return Cn()(e,t&&Object(Ut.a)({},t,n))},n}return Object(P.a)(t,e),Object(w.a)(t,[{key:"getCheckedIcon",value:function(){var e=this.props,t=e.classes,n=e.disabled,a=t||{},r=a.iconDisabled,o=a.iconSelected;return f.createElement(nr,{className:this.getCheckedClass(o,r,n)})}},{key:"getUncheckedIcon",value:function(){var e=this.props,t=e.classes,n=e.disabled,a=t||{},r=a.iconDisabled,o=a.iconDeselected;return f.createElement(ar,{className:this.getUncheckedClass(o,r,n)})}},{key:"getPostProcessedCustomIcon",value:function(e,t){var n=this.props,a=n.classes,r=n.disabled,o=a||{},i=o.iconSelected,c=o.iconDeselected,s=o.iconDisabled;return f.cloneElement(e,t?{className:this.getCheckedClass(i,s,r)}:{className:this.getUncheckedClass(c,s,r)},null)}},{key:"getIconElement",value:function(e,t){var n=this.props.children,a=n?n(e,t):null;return a?this.getPostProcessedCustomIcon(a,t):t?this.getCheckedIcon():this.getUncheckedIcon()}},{key:"getOption",value:function(e,n,a){var r=this.props,o=r.orientation,i=r.id,c=r.value,s=r.onSelect,l=r.classes,u=r.onSetFocus,d=r.onRemoveFocus,p=r.disabled,m=o===Ga.HORIZONTAL?ur.a.optionContainerHorizontal:ur.a.optionContainerVertical,h=n||0===a&&!c&&!1!==c&&0!==c?0:-1,b=this.getIconElement(e,n);return f.createElement("div",{className:m,key:e.id||e.name},f.createElement(dr,{optionData:e,isSelected:n,tabIndex:h,groupId:i,onSelect:s,focusClass:l&&t.getFocusClass(l,n),unFocusClass:l&&l.unFocus,onSetFocus:u,onRemoveFocus:d,disabled:p},b))}},{key:"getSelectionOptions",value:function(){var e=this,t=this.props,n=t.options,a=t.onGetOptionData,r=t.value;return n.map(function(t,n){var o=a?a(t):t,i=o.value===r;return e.getOption(o,i,n)})}},{key:"render",value:function(){var e=this.props.orientation===Ga.HORIZONTAL?ur.a.containerHorizontal:ur.a.containerVertical;return f.createElement("div",{className:e},this.getSelectionOptions())}}],[{key:"getFocusClass",value:function(e,t){return t?e.focusSelected:e.focusUnselected}}]),t}(f.Component),fr=function(e){var t=e.multiSelect,n=Object(Fe.a)(e,["multiSelect"]);return t?f.createElement(Qa,Object.assign({orientation:Ga.HORIZONTAL},n)):f.createElement(pr,Object.assign({orientation:Ga.HORIZONTAL},n))},mr=function(e){function t(e){var n;return Object(A.a)(this,t),(n=Object(F.a)(this,Object(x.a)(t).call(this,e))).options=t.getOptions(!!n.props.useRealBooleanValues),n}return Object(P.a)(t,e),Object(w.a)(t,null,[{key:"getOptions",value:function(e){return[{name:c.a.t("Yes"),value:!!e||"true"},{name:c.a.t("No"),value:!e&&"false"}]}}]),Object(w.a)(t,[{key:"render",value:function(){var e=this.props,t=e.allowMultiple,n=(e.useRealBooleanValues,Object(Fe.a)(e,["allowMultiple","useRealBooleanValues"]));return m.a.createElement("div",null,m.a.createElement(fr,Object.assign({options:this.options,multiSelect:t},n)))}}]),t}(f.Component),hr=n(1442),br=n(1334),gr=n(1333),Or=n(555),vr=function(e){return m.a.createElement(tr,e,m.a.createElement("path",{fill:"none",d:"M0 0h24v24H0V0z"}),m.a.createElement("path",{d:"M12 2C8.14 2 5 5.14 5 9c0 5.25 7 13 7 13s7-7.75 7-13c0-3.86-3.14-7-7-7zm4 8h-3v3h-2v-3H8V8h3V5h2v3h3v2z"}))},yr=function(e){function t(){var e,n;Object(A.a)(this,t);for(var a=arguments.length,r=new Array(a),o=0;o<a;o++)r[o]=arguments[o];return(n=Object(F.a)(this,(e=Object(x.a)(t)).call.apply(e,[this].concat(r)))).handleBlur=function(e){n.props.onBlur(e.currentTarget.value)},n.handleChange=function(e){n.props.onChange&&n.props.onChange(e.currentTarget.value)},n}return Object(P.a)(t,e),Object(w.a)(t,[{key:"render",value:function(){var e=this.props,t=(e.onBlur,e.onChange,e.value),n=(e.classes,e.className),a=Object(Fe.a)(e,["onBlur","onChange","value","classes","className"]);return m.a.createElement(ga,Object.assign({classes:{input:n},onBlur:this.handleBlur,onChange:this.handleChange,value:t||""},a))}}]),t}(f.Component),Er=Ia()(ja()(Ca()(yr))),_r=n(87),jr=n.n(_r),Ir={basic:{color:"primary",variant:"text"},primary:{color:"primary",variant:"raised"},secondary:{color:"secondary",variant:"raised"},destructive:{color:void 0,variant:"raised"}},Cr=function(e){function t(){return Object(A.a)(this,t),Object(F.a)(this,Object(x.a)(t).apply(this,arguments))}return Object(P.a)(t,e),Object(w.a)(t,[{key:"render",value:function(){var e=this.props,t=e.kind,n=e.size,a=e.disabled,r=e.onClick,o=e.children,i=e.className;return f.createElement($.a,{className:i,size:n,onClick:r,disabled:a,color:Ir[t].color,variant:Ir[t].variant},o)}}]),t}(f.Component);Cr.defaultProps={size:"medium",kind:"basic",disabled:!1};var Tr=Cr,Sr={LATITUDE:"latitude",LONGITUDE:"longitude"},Rr=function(e){function t(e){var n;return Object(A.a)(this,t),(n=Object(F.a)(this,Object(x.a)(t).call(this,e))).handleBlur=function(e,t){var a=Object(se.a)({},n.props.value,Object(Ut.a)({},e,t));a.latitude||a.longitude?n.props.onBlur(a):n.props.onBlur(null)},n.handleChange=function(e,t){n.props.onChange&&n.props.onChange(Object(se.a)({},n.props.value,Object(Ut.a)({},e,t)))},n.handleClear=function(){n.props.onBlur(null)},n.getPosition=function(){var e=n.props.value,t=null;return e&&e.latitude&&e.longitude&&!isNaN(parseFloat(e.latitude))&&!isNaN(parseFloat(e.longitude))&&(t=[parseFloat(e.latitude),parseFloat(e.longitude)]),t},n.closeMap=function(){n.setState({showMap:!1})},n.openMap=function(){n.setState({showMap:!0,position:n.getPosition()})},n.onMapPositionChange=function(e){var t=e.latlng;n.setMapPosition([t.lat,t.lng],e.target.getZoom())},n.setMapPosition=function(e,t){n.setState({position:e,zoom:t})},n.onSetCoordinate=function(){var e=n.state.position,t=e&&2===e.length?{latitude:e[0],longitude:e[1]}:null;n.props.onBlur(t),n.setState({showMap:!1})},n.renderMapIcon=function(){var e=n.props,t=e.classes,a=e.shrinkDisabled,r=e.disabled,o=t||{},i=o.mapIconContainer,c=o.mapIcon,s=o.mapIconContainerDisabled,l=Cn()(Object(Ut.a)({},jr.a.mapIconContainer,a),Object(Ut.a)({},jr.a.mapIconContainerWithMargin,!a),i,Object(Ut.a)({},s,r));return f.createElement("div",{className:l},f.createElement(te.a,{disabled:!!r,style:{height:42,width:42,borderRadius:0},classes:{root:Cn()(jr.a.mapIcon,c)}},f.createElement(vr,{onClick:n.openMap})))},n.renderMapDialog=function(){return f.cloneElement(n.props.mapDialog,{open:n.state.showMap,onClose:n.closeMap},[].concat(Object(We.a)(f.Children.toArray(n.props.mapDialog.props.children)),[f.createElement("div",{className:jr.a.dialogContent,key:"dialogContent"},n.renderMap(),n.renderDialogActions())]))},n.setMapInstance=function(e){n.mapInstance=e},n.search=function(e){var t=n.mapInstance&&n.mapInstance.leafletElement?n.mapInstance.leafletElement.getZoom():13;n.setMapPosition(Object(We.a)(e),t)},n.renderMap=function(){var e=n.state,t=e.position,a=e.zoom,r=t||n.props.mapCenter;return f.createElement("div",{className:jr.a.mapContainer},f.createElement(hr.a,{center:r,zoom:a,onClick:n.onMapPositionChange,className:jr.a.leafletContainer,key:"map",ref:function(e){n.setMapInstance(e)}},f.createElement(Or.ReactLeafletSearch,{position:"topleft",inputPlaceholder:"Search",closeResultsOnClick:!0,search:null,mapStateModifier:n.search,showMarker:!1}),f.createElement(br.a,{url:"http://{s}.tile.osm.org/{z}/{x}/{y}.png",attribution:'\xa9 <a href="http://osm.org/copyright">OpenStreetMap</a> contributors'}),t&&f.createElement(gr.a,{position:t})))},n.renderDialogActions=function(){return f.createElement("div",{className:jr.a.dialogActionOuterContainer},f.createElement("div",{className:jr.a.dialogActionInnerContainer},f.createElement(Tr,{kind:"basic",onClick:n.closeMap},c.a.t("Cancel"))),f.createElement("div",{className:jr.a.dialogActionInnerContainer},f.createElement(Tr,{kind:"primary",onClick:n.onSetCoordinate},c.a.t("Set coordinate"))))},n.renderLatitude=function(){var e=n.props,t=(e.mapCenter,e.onBlur,e.onChange,e.value),a=(e.orientation,e.shrinkDisabled),r=e.classes,o=(e.mapDialog,e.disabled),i=Object(Fe.a)(e,["mapCenter","onBlur","onChange","value","orientation","shrinkDisabled","classes","mapDialog","disabled"]),c=r||{},s=(c.mapIconContainer,c.mapIcon,Object(Fe.a)(c,["mapIconContainer","mapIcon"]));return f.createElement(Er,Object.assign({shrinkDisabled:a,label:"Latitude",value:t&&t.latitude,classes:s,className:jr.a.latitudeTextInput,onBlur:function(e){return n.handleBlur(Sr.LATITUDE,e)},onChange:function(e){return n.handleChange(Sr.LATITUDE,e)},disabled:o},i))},n.renderLongitude=function(){var e=n.props,t=(e.mapCenter,e.onBlur,e.onChange,e.value),a=(e.orientation,e.shrinkDisabled),r=e.classes,o=(e.mapDialog,e.disabled),i=Object(Fe.a)(e,["mapCenter","onBlur","onChange","value","orientation","shrinkDisabled","classes","mapDialog","disabled"]),c=r||{},s=(c.mapIconContainer,c.mapIcon,Object(Fe.a)(c,["mapIconContainer","mapIcon"]));return f.createElement(Er,Object.assign({shrinkDisabled:a,label:"Longitude",value:t&&t.longitude,className:jr.a.longitudeTextInput,classes:s,onBlur:function(e){return n.handleBlur(Sr.LONGITUDE,e)},onChange:function(e){return n.handleChange(Sr.LONGITUDE,e)},disabled:o},i))},n.renderClearButton=function(){var e=n.props,t=e.shrinkDisabled,a=e.disabled,r=t?jr.a.clearIcon:jr.a.clearIconWithMargin;return f.createElement("div",{className:r},f.createElement(te.a,{style:{height:42,width:42,borderRadius:0},disabled:!!a},f.createElement($e.a,{onClick:n.handleClear})))},n.renderVertical=function(){return f.createElement("div",null,f.createElement("div",{className:jr.a.coordinateFieldsVertical},n.renderMapDialog(),f.createElement("div",{className:jr.a.buttonsContainerVertical},n.renderMapIcon(),n.renderClearButton()),f.createElement("div",{className:jr.a.inputContainer},n.renderLatitude()),f.createElement("div",{className:jr.a.inputContainer},n.renderLongitude())))},n.renderHorizontal=function(){return f.createElement("div",null,f.createElement("div",{className:jr.a.coordinateFieldsHorizontal},n.renderMapDialog(),n.renderMapIcon(),f.createElement("div",{className:jr.a.inputContainer},n.renderLatitude()),f.createElement("div",{className:jr.a.inputContainer},n.renderLongitude()),n.renderClearButton()))},n.state={showMap:!1,zoom:13},n}return Object(P.a)(t,e),Object(w.a)(t,[{key:"render",value:function(){return this.props.orientation===Ga.VERTICAL?this.renderVertical():this.renderHorizontal()}}]),t}(f.Component);Rr.defaultProps={mapCenter:[51.505,-.09]};var kr=n(577),Nr=n.n(kr);var Ar=Ia()(ja()(function(e){var t=e.value,n=Object(Fe.a)(e,["value"]);return m.a.createElement(Va,Object.assign({value:t||""},n))})),wr=function(e){function t(){var e,n;Object(A.a)(this,t);for(var a=arguments.length,r=new Array(a),o=0;o<a;o++)r[o]=arguments[o];return(n=Object(F.a)(this,(e=Object(x.a)(t)).call.apply(e,[this].concat(r)))).handleBlur=function(e){n.props.onBlur(e.currentTarget.value)},n.handleChange=function(e){n.props.onChange&&n.props.onChange(e.currentTarget.value)},n}return Object(P.a)(t,e),Object(w.a)(t,[{key:"render",value:function(){var e=this.props,t=(e.onBlur,e.onChange,e.value),n=Object(Fe.a)(e,["onBlur","onChange","value"]);return m.a.createElement(ga,Object.assign({value:t||"",onBlur:this.handleBlur,onChange:this.handleChange},n))}}]),t}(m.a.Component),Fr=Ia()(ja()(Ca()(wr))),xr=function(e){function t(e){var n;return Object(A.a)(this,t),(n=Object(F.a)(this,Object(x.a)(t).call(this,e))).getValue=function(){return n.props.value||{}},n.handleTimeChange=n.handleTimeChange.bind(Object(V.a)(n)),n.handleDateChange=n.handleDateChange.bind(Object(V.a)(n)),n.handleTimeBlur=n.handleTimeBlur.bind(Object(V.a)(n)),n.handleDateBlur=n.handleDateBlur.bind(Object(V.a)(n)),n.touchedFields=new Set,n}return Object(P.a)(t,e),Object(w.a)(t,[{key:"handleTimeChange",value:function(e){this.props.onChange({time:e,date:this.getValue().date})}},{key:"handleDateChange",value:function(e){this.props.onChange({time:this.getValue().time,date:e})}},{key:"handleTimeBlur",value:function(e){this.touchedFields.add("timeTouched");var t=this.getValue();this.handleBlur({time:e,date:t.date},!!t.date)}},{key:"handleDateBlur",value:function(e){this.touchedFields.add("dateTouched");var t=this.getValue();this.handleBlur({time:t.time,date:e},!!t.time)}},{key:"handleBlur",value:function(e,t){var n=this.props.onBlur,a=2===this.touchedFields.size;e.date||e.time?n(e,{touched:a||t}):n(void 0,{touched:a})}},{key:"render",value:function(){var e=this.props,t=(e.value,e.dateMaxWidth),n=e.dateWidth,a=e.calendarWidth,r=e.popupAnchorPosition,o=e.calendarTheme,i=e.calendarLocale,c=e.calendarOnConvertValueIn,s=e.calendarOnConvertValueOut,l=e.classes,u=e.orientation,d=(e.onBlur,e.dateLabel),p=e.timeLabel,f=(e.onChange,Object(Fe.a)(e,["value","dateMaxWidth","dateWidth","calendarWidth","popupAnchorPosition","calendarTheme","calendarLocale","calendarOnConvertValueIn","calendarOnConvertValueOut","classes","orientation","onBlur","dateLabel","timeLabel","onChange"])),h=u===Ga.VERTICAL,b=this.getValue(),g=b.date,O=b.time,v={width:n,maxWidth:t};return m.a.createElement("div",{className:Nr.a.root},m.a.createElement("div",{className:Cn()(Nr.a.fieldsContainer,Object(Ut.a)({},Nr.a.fieldsContainerVertical,h))},m.a.createElement("div",{style:v},m.a.createElement(Ar,Object.assign({value:g,maxWidth:t,width:n,calendarWidth:a,onChange:this.handleDateChange,onBlur:this.handleDateBlur,label:d,calendarTheme:o,popupAnchorPosition:r,calendarLocale:i,calendarOnConvertValueIn:c,calendarOnConvertValueOut:s,classes:l},f))),m.a.createElement(Fr,Object.assign({value:O,onChange:this.handleTimeChange,onBlur:this.handleTimeBlur,label:p,classes:l},f))))}}]),t}(f.Component);xr.defaultProps={dateLabel:c.a.t("Date"),timeLabel:c.a.t("Time")};var Pr=xr,Dr=n(522),Ur=n.n(Dr),Lr=n(228),Mr=n.n(Lr),Br=n(38),Vr=n.n(Br),Gr=n(1332),Wr=n(1470),Hr=n.n(Wr),zr=n(152),Kr=n.n(zr),Yr=(n(7982),function(e){function t(){var e,n;Object(A.a)(this,t);for(var a=arguments.length,r=new Array(a),o=0;o<a;o++)r[o]=arguments[o];return(n=Object(F.a)(this,(e=Object(x.a)(t)).call.apply(e,[this].concat(r)))).onClick=function(){n.props.disabled||n.props.onClick()},n}return Object(P.a)(t,e),Object(w.a)(t,[{key:"componentWillMount",value:function(){var e=Vr.a.control({position:"topright"}),t=c.a.t("Delete polygon"),n=m.a.createElement("div",{className:"leaflet-draw-toolbar leaflet-bar"},m.a.createElement("a",{className:Cn()("leaflet-draw-edit-remove",{"leaflet-disabled":this.props.disabled}),onClick:this.onClick,title:t,role:"button",tabIndex:"0"}));e.onAdd=function(e){var t=Vr.a.DomUtil.create("div","");return b.a.render(n,t),t},this.leafletElement=e}},{key:"updateLeafletElement",value:function(e,t){if(t.position!==e.position&&this.leafletElement.setPosition(t.position),t.disabled!==e.disabled){var n=this.leafletElement.getContainer().getElementsByClassName("leaflet-draw-edit-remove");n&&n.length>0&&(n[0].className=Cn()("leaflet-draw-edit-remove",{"leaflet-disabled":t.disabled}))}}}]),t}(n(177).a));var qr=function(e){function t(e){var n;return Object(A.a)(this,t),(n=Object(F.a)(this,Object(x.a)(t).call(this,e))).onFeatureGroupReady=function(e,t){if(t){var n=new Vr.a.GeoJSON(t);if(e){var a=e.leafletElement;a.clearLayers(),n.eachLayer(function(e){a.addLayer(e)});var r=e.context.map,o=t.features[0].geometry.coordinates[0].map(function(e){return[e[1],e[0]]});r.fitBounds(o)}}else if(e){e.leafletElement.clearLayers()}},n.getCenter=function(e){if(!e)return n.props.mapCenter;var t=e.features[0].geometry.coordinates[0],a=Vr.a.latLngBounds(t.map(function(e){return[e[0],e[1]]})).getCenter(),r=a.lat;return[a.lng,r]},n.getFeatureCollection=function(e){return Array.isArray(e)?function(e){return e?{type:"FeatureCollection",features:[{type:"Feature",properties:{},geometry:{type:"Polygon",coordinates:[e[0].map(function(e){return[].concat(Object(We.a)(e),[0])})]}}]}:null}(e):null},n.closeMap=function(){n.setState({showMap:!1})},n.openMap=function(){n.setState({showMap:!0,mapCoordinates:n.props.value})},n.onMapPolygonCreated=function(e){var t=e.layer.toGeoJSON().geometry.coordinates;n.setState({mapCoordinates:t,zoom:e.target.getZoom()})},n.onMapPolygonEdited=function(e){var t=e.layers.getLayers()[0].toGeoJSON().geometry.coordinates;n.setState({mapCoordinates:t,zoom:e.target.getZoom()})},n.onMapPolygonDelete=function(){n.setState({mapCoordinates:null})},n.onSetPolygon=function(){n.props.onBlur(n.state.mapCoordinates),n.closeMap()},n.renderMapDialog=function(){return f.cloneElement(n.props.mapDialog,{open:n.state.showMap,onClose:n.closeMap},[].concat(Object(We.a)(f.Children.toArray(n.props.mapDialog.props.children)),[f.createElement("div",{className:Kr.a.dialogContent,key:"dialogContent"},n.renderMap(),n.renderDialogActions())]))},n.renderMap=function(){var e=n.state.zoom,t=n.getFeatureCollection(n.state.mapCoordinates),a=!!t,r=n.getCenter(t);return f.createElement("div",{className:Kr.a.mapContainer},f.createElement(hr.a,{zoom:e,center:r,className:Kr.a.map,key:"map"},f.createElement(Or.ReactLeafletSearch,{position:"topleft",inputPlaceholder:"Search",closeResultsOnClick:!0}),f.createElement(br.a,{url:"https://{s}.tile.osm.org/{z}/{x}/{y}.png",attribution:'\xa9 <a href="http://osm.org/copyright">OpenStreetMap</a> contributors'}),f.createElement(Gr.a,{ref:function(e){n.onFeatureGroupReady(e,t)}},f.createElement(Hr.a,{position:"topright",onEdited:n.onMapPolygonEdited,onCreated:n.onMapPolygonCreated,onDeleted:n.onMapPolygonDelete,draw:{rectangle:!1,polyline:!1,circle:!1,marker:!1,circlemarker:!1},edit:{remove:!1}}),f.createElement(Yr,{onClick:n.onMapPolygonDelete,disabled:!a}))))},n.renderDialogActions=function(){return f.createElement("div",{className:Kr.a.dialogActionOuterContainer},f.createElement("div",{className:Kr.a.dialogActionInnerContainer},f.createElement(Tr,{kind:"basic",onClick:n.closeMap},c.a.t("Cancel"))),f.createElement("div",{className:Kr.a.dialogActionInnerContainer},f.createElement(Tr,{kind:"primary",onClick:n.onSetPolygon},c.a.t("Set area"))))},n.state={showMap:!1,zoom:13},n}return Object(P.a)(t,e),Object(w.a)(t,[{key:"render",value:function(){var e=!!this.props.value;return f.createElement("div",{className:Kr.a.container},f.createElement("div",{className:Kr.a.statusContainer},f.createElement(Ur.a,{className:Kr.a.mapIcon,onClick:this.openMap}),f.createElement("div",{className:Kr.a.statusText},e?"Polygon captured":"No polygon captured"),e&&f.createElement(Mr.a,{className:Kr.a.checkIcon,color:"primary"})),this.renderMapDialog())}}]),t}(f.Component);qr.defaultProps={mapCenter:[51.505,-.09]};var Xr=n(1471),Zr=n.n(Xr),Jr=function(e){function t(){return Object(A.a)(this,t),Object(F.a)(this,Object(x.a)(t).apply(this,arguments))}return Object(P.a)(t,e),Object(w.a)(t,[{key:"render",value:function(){var e=this.props,t=e.classes,n=Object(Fe.a)(e,["classes"]),a=t||{};return f.createElement("div",{className:Zr.a.container},f.createElement(ga,Object.assign({classes:a},n)))}}]),t}(f.Component),Qr=Ca()(Jr),$r=function(e){return m.a.createElement(tr,e,m.a.createElement("path",{d:"M19 3H5c-1.11 0-2 .9-2 2v14c0 1.1.89 2 2 2h14c1.11 0 2-.9 2-2V5c0-1.1-.89-2-2-2zm-9 14l-5-5 1.41-1.41L10 14.17l7.59-7.59L19 8l-9 9z"}))},eo=function(e){return m.a.createElement(tr,e,m.a.createElement("path",{d:"M19 5v14H5V5h14m0-2H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2z"}))},to=function(e){function t(e){var n;return Object(A.a)(this,t),(n=Object(F.a)(this,Object(x.a)(t).call(this,e))).options=t.getOptions(!!n.props.useRealTrueValue),n}return Object(P.a)(t,e),Object(w.a)(t,null,[{key:"getOptions",value:function(e){return[{name:c.a.t("Yes"),value:!!e||"true"}]}}]),Object(w.a)(t,[{key:"render",value:function(){var e=this.props,t=(e.useRealTrueValue,Object(Fe.a)(e,["useRealTrueValue"]));return m.a.createElement("div",null,m.a.createElement(fr,Object.assign({options:this.options},t),function(e,t){return t?m.a.createElement($r,null):m.a.createElement(eo,null)}))}}]),t}(f.Component),no=function(e){function t(e){var n;return Object(A.a)(this,t),(n=Object(F.a)(this,Object(x.a)(t).call(this,e))).handleDebounced=function(e){n.props.onDebounced(e)},n.handleChange=function(e){n.setState({value:e.currentTarget.value}),n.debouncer(Object(se.a)({},e))},n.state={value:n.props.value||""},n.debouncer=Object($t.debounce)(n.handleDebounced,500),n}return Object(P.a)(t,e),Object(w.a)(t,[{key:"componentWillReceiveProps",value:function(e){e.value!==this.props.value&&this.setState({value:e.value||""})}},{key:"render",value:function(){var e=this.props,t=(e.onDebounced,e.value,Object(Fe.a)(e,["onDebounced","value"])),n=this.state.value;return f.createElement(ga,Object.assign({onChange:this.handleChange,value:n},t))}}]),t}(f.Component),ao=n(578),ro=n.n(ao),oo={error:"innerInputError",info:"innerInputInfo",warning:"innerInputWarning",validating:"innerInputValidating"};function io(e){var t=e.innerMessage,n=e.messageKey,a=e.classes;if(t){var r=t.message&&t.message[n],o=a&&a[oo[t.messageType]]||"";return r?m.a.createElement("div",{className:o},r):null}return null}var co=Ia()(ja()(Ca()(ga))),so="from",lo="to",uo=function(e){function t(e){var n;return Object(A.a)(this,t),(n=Object(F.a)(this,Object(x.a)(t).call(this,e))).getValue=function(){return n.props.value||{}},n.getNewValue=function(e,t){var a=Object(se.a)({},n.getValue(),Object(Ut.a)({},e,t));return a.from||a.to?a:null},n.handleFromChange=function(e){n.props.onChange({from:e.currentTarget.value,to:n.getValue().to})},n.handleToChange=function(e){n.props.onChange({from:n.getValue().from,to:e.currentTarget.value})},n.handleFromBlur=function(e){n.touchedFields.add("fromTouched");var t=n.getValue();n.handleBlur({from:e.currentTarget.value,to:t.to},!!t.to)},n.handleToBlur=function(e){n.touchedFields.add("toTouched");var t=n.getValue();n.handleBlur({from:t.from,to:e.currentTarget.value},!!t.from)},n.handleBlur=function(e,t){var a=2===n.touchedFields.size;e.from||e.to?n.props.onBlur(e,{touched:a||t}):n.props.onBlur(void 0,{touched:a})},n.getInnerMessage=function(e){var t=n.props,a=t.classes,r=t.innerMessage;return f.createElement(io,{classes:a,messageKey:e,innerMessage:r})},n.touchedFields=new Set,n}return Object(P.a)(t,e),Object(w.a)(t,[{key:"render",value:function(){var e=this.props,t=e.value,n=(e.onChange,e.onBlur,Object(Fe.a)(e,["value","onChange","onBlur"])),a=t&&t.from?t.from:"",r=t&&t.to?t.to:"";return f.createElement("div",{className:ro.a.container},f.createElement("div",{className:ro.a.inputContainer},f.createElement(co,Object.assign({label:c.a.t("From"),onChange:this.handleFromChange,onBlur:this.handleFromBlur,value:a},n)),this.getInnerMessage(so)),f.createElement("div",{className:ro.a.inputContainer},f.createElement(co,Object.assign({label:c.a.t("To"),onChange:this.handleToChange,onBlur:this.handleToBlur,value:r},n)),this.getInnerMessage(lo)))}}]),t}(f.Component),po=n(579),fo=n.n(po),mo=Ia()(ja()(Va)),ho="from",bo="to",go=function(e){function t(e){var n;return Object(A.a)(this,t),(n=Object(F.a)(this,Object(x.a)(t).call(this,e))).getValue=function(){return n.props.value||{}},n.handleFromChange=function(e){n.props.onChange({from:e,to:n.getValue().to})},n.handleToChange=function(e){n.props.onChange({from:n.getValue().from,to:e})},n.handleFromBlur=function(e){n.touchedFields.add("fromTouched");var t=n.getValue();n.handleBlur({from:e,to:t.to},!!t.to)},n.handleToBlur=function(e){n.touchedFields.add("toTouched");var t=n.getValue();n.handleBlur({from:t.from,to:e},!!t.from)},n.handleBlur=function(e,t){var a=2===n.touchedFields.size;e.from||e.to?n.props.onBlur(e,{touched:a||t}):n.props.onBlur(void 0,{touched:a})},n.getInnerMessage=function(e){var t=n.props,a=t.classes,r=t.innerMessage;return f.createElement(io,{classes:a,innerMessage:r,messageKey:e})},n.touchedFields=new Set,n}return Object(P.a)(t,e),Object(w.a)(t,[{key:"render",value:function(){var e=this.props,t=(e.onBlur,e.onChange,e.value),n=(e.innerMessage,Object(Fe.a)(e,["onBlur","onChange","value","innerMessage"])),a=t&&t.from?t.from:"",r=t&&t.to?t.to:"";return f.createElement("div",{className:fo.a.container},f.createElement("div",{className:fo.a.inputContainer},f.createElement(mo,Object.assign({label:c.a.t("From"),value:a,onBlur:this.handleFromBlur,onChange:this.handleFromChange},n)),this.getInnerMessage(ho)),f.createElement("div",{className:fo.a.inputContainer},f.createElement(mo,Object.assign({label:c.a.t("To"),value:r,onBlur:this.handleToBlur,onChange:this.handleToChange},n)),this.getInnerMessage(bo)))}}]),t}(f.Component),Oo=n(580),vo=n.n(Oo),yo=Ia()(Pr),Eo="from",_o="to",jo=function(e){function t(e){var n;return Object(A.a)(this,t),(n=Object(F.a)(this,Object(x.a)(t).call(this,e))).getValue=function(){return n.props.value||{}},n.getNewValue=function(e,t){var a=n.getValue(),r=Object(se.a)({},a,Object(Ut.a)({},e,t));return r.from||r.to?r:null},n.handleFromChange=function(e){n.props.onChange({from:e,to:n.getValue().to})},n.handleToChange=function(e){n.props.onChange({from:n.getValue().from,to:e})},n.toHasValue=function(){var e=n.getValue();return!!(e.to&&e.to.date&&e.to.time)},n.fromHasValue=function(){var e=n.getValue();return!!(e.to&&e.to.date&&e.to.time)},n.handleFromBlur=function(e,t){t&&t.touched&&n.touchedFields.add("fromTouched"),n.handleBlur({from:e,to:n.getValue().to},n.toHasValue())},n.handleToBlur=function(e,t){t&&t.touched&&n.touchedFields.add("toTouched"),n.handleBlur({from:n.getValue().from,to:e},n.fromHasValue())},n.handleBlur=function(e,t){var a=2===n.touchedFields.size;e.from||e.to?n.props.onBlur(e,{touched:a||t}):n.props.onBlur(void 0,{touched:a})},n.getInnerMessage=function(e){var t=n.props,a=t.classes,r=t.innerMessage;return f.createElement(io,{classes:a,innerMessage:r,messageKey:e})},n.touchedFields=new Set,n}return Object(P.a)(t,e),Object(w.a)(t,[{key:"render",value:function(){var e=this.props,t=(e.onBlur,e.onChange,e.value),n=Object(Fe.a)(e,["onBlur","onChange","value"]),a=t&&t.from?t.from:"",r=t&&t.to?t.to:"";return f.createElement("div",{className:vo.a.container},f.createElement("div",{className:vo.a.inputContainer},f.createElement(yo,Object.assign({dateLabel:c.a.t("From date"),timeLabel:c.a.t("From time"),value:a,onBlur:this.handleFromBlur,onChange:this.handleFromChange},n)),this.getInnerMessage(Eo)),f.createElement("div",{className:vo.a.inputContainer},f.createElement(yo,Object.assign({dateLabel:c.a.t("To date"),timeLabel:c.a.t("To time"),value:r,onBlur:this.handleToBlur,onChange:this.handleToChange},n)),this.getInnerMessage(_o)))}}]),t}(f.Component),Io=n(964),Co=n.n(Io),To=function(e){function t(){return Object(A.a)(this,t),Object(F.a)(this,Object(x.a)(t).apply(this,arguments))}return Object(P.a)(t,e),Object(w.a)(t,[{key:"render",value:function(){var e=this.props,t=e.classes,n=e.children,a=e.labelRef,r=e.useVerticalOrientation,o=Object(Fe.a)(e,["classes","children","labelRef","useVerticalOrientation"]),i=r?Co.a.labelContainerVertical:Co.a.labelContainer;return f.createElement("div",Object.assign({ref:a,className:Cn()(i,t.label)},o),n)}}]),t}(f.PureComponent),So=n(322),Ro=n.n(So),ko=function(e){function t(){return Object(A.a)(this,t),Object(F.a)(this,Object(x.a)(t).apply(this,arguments))}return Object(P.a)(t,e),Object(w.a)(t,[{key:"render",value:function(){return f.createElement("tbody",null,this.props.children)}}]),t}(f.Component),No=n(4),Ao=n.n(No),wo=n(72),Fo=n.n(wo),xo=function(e,t){e.children;var n,a=e.className,r=Object(Fe.a)(e,["children","className"]),o=t.table,i=Cn()(Fo.a.tableCell,(n={},Object(Ut.a)(n,Fo.a.tableCellBody,!o),Object(Ut.a)(n,Fo.a.tableCellHeader,o&&o.head),Object(Ut.a)(n,Fo.a.tableCellFooter,o&&o.footer),n),a);return f.createElement("td",Object.assign({className:i},r),e.children)};xo.contextTypes={table:Ao.a.object};var Po=xo,Do=function(e){function t(){return Object(A.a)(this,t),Object(F.a)(this,Object(x.a)(t).apply(this,arguments))}return Object(P.a)(t,e),Object(w.a)(t,[{key:"getChildContext",value:function(){return{table:{footer:!0}}}},{key:"render",value:function(){return f.createElement("tfoot",null,this.props.children)}}]),t}(f.Component);Do.childContextTypes={table:Ao.a.object};var Uo=function(e){function t(){return Object(A.a)(this,t),Object(F.a)(this,Object(x.a)(t).apply(this,arguments))}return Object(P.a)(t,e),Object(w.a)(t,[{key:"getChildContext",value:function(){return{table:{head:!0}}}},{key:"render",value:function(){return f.createElement("thead",null,this.props.children)}}]),t}(f.Component);Uo.childContextTypes={table:Ao.a.object};var Lo=Uo,Mo=function(e){e.children;var t=e.className,n=e.innerRef,a=Object(Fe.a)(e,["children","className","innerRef"]),r=Cn()(Fo.a.tableCell,Fo.a.tableCellHeader,t);return f.createElement("td",Object.assign({ref:n,className:r},a),e.children)},Bo=function(e){function t(){return Object(A.a)(this,t),Object(F.a)(this,Object(x.a)(t).apply(this,arguments))}return Object(P.a)(t,e),Object(w.a)(t,[{key:"render",value:function(){var e=this.props,n=e.rowsCount,a=e.rowsPerPage,r=e.currentPage,o=e.rowsCountSelector,i=e.rowsCountSelectorLabel,c=e.navigationElements,s=e.onGetLabelDisplayedRows,l=t.getRowsCountElement(i,o),u=s&&t.wrapDisplayedRowsElement(s(t.getFromToLabel(n,a,r),n.toString()));return f.createElement("div",{className:Fo.a.pagination},l,u,c)}}],[{key:"getFromToLabel",value:function(e,t,n){var a=t*(n-1)+1;if(a>e)return"-";var r=Math.min(t*n,e);return"".concat(a,"-").concat(r)}},{key:"getRowsCountElement",value:function(e,t){return t?e?f.createElement("div",{className:Fo.a.paginationRowsPerPageElementContainer},e,":",f.createElement("span",{className:Fo.a.paginationRowsPerPageElement},t)):t:null}},{key:"wrapDisplayedRowsElement",value:function(e){return f.createElement("div",{className:Fo.a.paginationDisplayRowsContainer},e)}}]),t}(f.Component),Vo=function(e,t){e.children;var n,a=e.className,r=Object(Fe.a)(e,["children","className"]),o=t.table,i=Cn()(Fo.a.tableRow,(n={},Object(Ut.a)(n,Fo.a.tableRowBody,!o),Object(Ut.a)(n,Fo.a.tableRowHeader,o&&o.head),Object(Ut.a)(n,Fo.a.tableRowFooter,o&&o.footer),n),a);return f.createElement("tr",Object.assign({className:i},r),e.children)};Vo.contextTypes={table:Ao.a.object};var Go=Vo,Wo={ASC:"asc",DESC:"desc"},Ho="Left",zo="Right",Ko=function(e){function t(){var e,n;Object(A.a)(this,t);for(var a=arguments.length,r=new Array(a),o=0;o<a;o++)r[o]=arguments[o];return(n=Object(F.a)(this,(e=Object(x.a)(t)).call.apply(e,[this].concat(r)))).handleSort=function(){var e=n.props,t=e.isActive,a=e.direction;e.disabled||(t?n.props.onSort(a===Wo.ASC?Wo.DESC:Wo.ASC):n.props.onSort(n.props.initialDirection||Wo.DESC))},n}return Object(P.a)(t,e),Object(w.a)(t,[{key:"renderChildrenContainer",value:function(e){var t=this.props.disabled?Fo.a.sortLabelChildren:Cn()(Fo.a.sortLabelChildren,Fo.a.sortLabelChildrenEnabled);return f.createElement("div",{className:Cn()(t,this.props.childrenClass,e),onClick:this.handleSort,role:"button",tabIndex:0},this.props.children)}},{key:"render",value:function(){var e=this,t=this.props,n=(t.children,t.isActive),a=t.direction,r=t.onSort,o=t.onGetIcons,i=t.placement,c=o&&o(n,a,r),s=Cn()(Fo.a.sortLabelContainer,Object(Ut.a)({},Fo.a.sortLabelRight,i===zo));return f.createElement("div",{className:s},i===zo?f.createElement(f.Fragment,null,f.createElement("div",{className:Fo.a.sortLabelIcon},c),e.renderChildrenContainer([Fo.a.sortLabelChildrenLast])):f.createElement(f.Fragment,null,e.renderChildrenContainer([Fo.a.sortLabelChildrenFirst]),f.createElement("div",{className:Fo.a.sortLabelIcon},c)))}}]),t}(f.Component),Yo=function(e){e.children;var t=e.className,n=Object(Fe.a)(e,["children","className"]),a=Cn()(Fo.a.table,t);return f.createElement("table",Object.assign({className:a},n),e.children)},qo=n(1472),Xo=n.n(qo),Zo=function(e){e.className;var t=Object(Fe.a)(e,["className"]),n=Cn()(Xo.a.horizontal,e.className);return m.a.createElement("div",Object.assign({className:n},t))},Jo=function(e){function t(){var e,n;Object(A.a)(this,t);for(var a=arguments.length,r=new Array(a),o=0;o<a;o++)r[o]=arguments[o];return(n=Object(F.a)(this,(e=Object(x.a)(t)).call.apply(e,[this].concat(r)))).handleChange=function(e){n.props.onChange&&n.props.onChange(e.currentTarget.value,e)},n.handleBlur=function(e){n.props.onBlur&&n.props.onBlur(e.currentTarget.value,e)},n}return Object(P.a)(t,e),Object(w.a)(t,[{key:"render",value:function(){var e=this.props,t=e.value,n=(e.onBlur,e.onChange,e.classes),a=Object(Fe.a)(e,["value","onBlur","onChange","classes"]);return m.a.createElement(Qr,Object.assign({value:t||"",onChange:this.handleChange,onBlur:this.handleBlur,classes:n},a))}}]),t}(f.Component),Qo=Object(E.withStyles)(function(e){return{inputWrapperFocused:{border:"2px solid ".concat(e.palette.primary.light),borderRadius:"5px"},inputWrapperUnfocused:{padding:2}}})(Jo),$o=n(43),ei=function(e){function t(){return Object(A.a)(this,t),Object(F.a)(this,Object(x.a)(t).apply(this,arguments))}return Object(P.a)(t,e),Object(w.a)(t,[{key:"render",value:function(){var e=this.props,t=e.onBlur,n=Object(Fe.a)(e,["onBlur"]);return f.createElement(mr,Object.assign({onSelect:t},n))}}]),t}(f.Component),ti=Object(E.withStyles)(function(e){return{iconSelected:{fill:e.palette.secondary.main},iconDeselected:{fill:e.palette.grey[700]},iconDisabled:{fill:"rgba(0,0,0,0.30)"},focusSelected:{backgroundColor:Object($o.fade)(e.palette.secondary.main,.4)}}})(ei),ni=function(e){return{accentColor:e.palette.secondary.main,floatingNav:{background:Object($o.fade)(Object($o.darken)(e.palette.primary.dark,.6),.8),chevron:Object($o.lighten)(e.palette.secondary.light,.4),color:"white"},headerColor:e.palette.primary.main,todayColor:e.palette.secondary.main,selectionColor:e.palette.primary.main,weekdayColor:e.palette.primary.main}},ai=function(){function e(){Object(A.a)(this,e)}return Object(w.a)(e,null,[{key:"set",value:function(t){e.currentData=t}},{key:"get",value:function(){return e.currentData}}]),e}();function ri(e){return e.charAt(0).toLocaleUpperCase()+e.slice(1)}var oi,ii=function(){return function(e){return function(t){function n(e){var t;Object(A.a)(this,n),(t=Object(F.a)(this,Object(x.a)(n).call(this,e))).calendarTheme=ni(t.props.theme);var a=ai.get(),r=t.props.calendarWidth||t.props.width;return t.calendarLocaleData={locale:a.dateFnsLocale,headerFormat:r>=400?a.calendarFormatHeaderLong:a.calendarFormatHeaderShort,weekdays:a.weekDaysShort.map(function(e){return ri(e)}),blank:a.selectDatesText,todayLabel:{long:a.todayLabelLong,short:a.todayLabelShort},weekStartsOn:a.weekStartsOn},t}return Object(P.a)(n,t),Object(w.a)(n,null,[{key:"convertValueIntoCalendar",value:function(e){if(!e)return null;var t=Pn(e);return t.isValid?t.momentDate.toDate():null}},{key:"convertValueOutFromCalendar",value:function(e){return Se(e).format("L")}}]),Object(w.a)(n,[{key:"render",value:function(){var t=this.props,a=(t.theme,Object(Fe.a)(t,["theme"]));return f.createElement(e,Object.assign({calendarTheme:this.calendarTheme,calendarLocale:this.calendarLocaleData,calendarOnConvertValueIn:n.convertValueIntoCalendar,calendarOnConvertValueOut:n.convertValueOutFromCalendar},a))}}]),n}(f.Component)}},ci=function(e){return Pn(e||"")},si=Object(E.withTheme)()(ii()(Object(E.withStyles)(function(e){return{inputWrapperFocused:{border:"2px solid ".concat(e.palette.primary.light),borderRadius:"5px"},inputWrapperUnfocused:{padding:2},innerInputError:{color:e.palette.error.main,padding:e.typography.pxToRem(3),fontSize:e.typography.pxToRem(12)},innerInputWarning:{color:e.palette.warning.dark,padding:e.typography.pxToRem(3),fontSize:e.typography.pxToRem(12)},innerInputInfo:{color:"green",padding:e.typography.pxToRem(3),fontSize:e.typography.pxToRem(12)},innerInputValidating:{color:"orange",padding:e.typography.pxToRem(3),fontSize:e.typography.pxToRem(12)}}})(function(e){var t=e.calendarTheme,n=e.calendarLocale,a=e.calendarOnConvertValueIn,r=e.calendarOnConvertValueOut,o=Object(Fe.a)(e,["calendarTheme","calendarLocale","calendarOnConvertValueIn","calendarOnConvertValueOut"]);return f.createElement(Ja,Object.assign({onParseDate:ci,moment:Se,dateCalendarTheme:t,dateCalendarLocale:n,dateCalendarOnConvertValueIn:a,dateCalendarOnConvertValueOut:r},o))}))),li=function(e){function t(){return Object(A.a)(this,t),Object(F.a)(this,Object(x.a)(t).apply(this,arguments))}return Object(P.a)(t,e),Object(w.a)(t,[{key:"render",value:function(){var e=this.props,t=e.onBlur,n=Object(Fe.a)(e,["onBlur"]);return m.a.createElement(to,Object.assign({onSelect:t},n))}}]),t}(m.a.Component),ui=Object(E.withStyles)(function(e){return{iconSelected:{fill:e.palette.secondary.main},iconDeselected:{fill:e.palette.grey[700]},iconDisabled:{fill:"rgba(0,0,0,0.30)"},focusSelected:{backgroundColor:Object($o.fade)(e.palette.secondary.main,.4)}}})(li),di=n(1473),pi=n.n(di),fi=(oi=sn,function(e){function t(){var e,n;Object(A.a)(this,t);for(var a=arguments.length,r=new Array(a),o=0;o<a;o++)r[o]=arguments[o];return(n=Object(F.a)(this,(e=Object(x.a)(t)).call.apply(e,[this].concat(r)))).handleBlur=function(e){n.props.onRemoveFocus(),n.props.onBlur&&n.props.onBlur(e)},n.handleFocus=function(){n.props.onSetFocus(),n.props.onFocus&&n.props.onFocus()},n}return Object(P.a)(t,e),Object(w.a)(t,[{key:"render",value:function(){var e=this.props,t=(e.onSetFocus,e.onRemoveFocus,e.onFocus,e.inFocus),n=(e.onBlur,e.classes),a=Object(Fe.a)(e,["onSetFocus","onRemoveFocus","onFocus","inFocus","onBlur","classes"]),r=n.inputWrapperFocused,o=n.inputWrapperUnfocused,i=Object(Fe.a)(n,["inputWrapperFocused","inputWrapperUnfocused"]),c=t?r:o;return f.createElement("div",{className:Cn()(pi.a.inputWrapper,c)},f.createElement(oi,Object.assign({onFocus:this.handleFocus,onBlur:this.handleBlur},a,{classes:i})))}}]),t}(f.Component)),mi=function(e){function t(){var e,n;Object(A.a)(this,t);for(var a=arguments.length,r=new Array(a),o=0;o<a;o++)r[o]=arguments[o];return(n=Object(F.a)(this,(e=Object(x.a)(t)).call.apply(e,[this].concat(r)))).handleSelect=function(e){n.props.onBlur&&n.props.onBlur(e)},n}return Object(P.a)(t,e),Object(w.a)(t,[{key:"render",value:function(){var e=this.props,t=e.value,n=(e.onBlur,e.onChange,e.classes),a=Object(Fe.a)(e,["value","onBlur","onChange","classes"]);return m.a.createElement(fi,Object.assign({value:t||"",onSelect:this.handleSelect,classes:n},a))}}]),t}(f.Component),hi=Object(E.withStyles)(function(e){return{inputWrapperFocused:{border:"2px solid ".concat(e.palette.primary.light),borderRadius:"5px"},inputWrapperUnfocused:{padding:2}}})(mi);var bi=function(){return function(e){return function(t){function n(e){var t;return Object(A.a)(this,n),(t=Object(F.a)(this,Object(x.a)(n).call(this,e))).translations={clearText:c.a.t("Clear"),noResults:c.a.t("No results")},t}return Object(P.a)(n,t),Object(w.a)(n,[{key:"render",value:function(){var t=Object(_.a)({},this.props);return f.createElement(e,Object.assign({translations:this.translations},t))}}]),n}(f.Component)}},gi=function(e){function t(){return Object(A.a)(this,t),Object(F.a)(this,Object(x.a)(t).apply(this,arguments))}return Object(P.a)(t,e),Object(w.a)(t,[{key:"render",value:function(){var e=Object(_.a)({},this.props);return f.createElement(fr,e)}}]),t}(f.Component),Oi=Object(E.withStyles)(function(e){return{iconSelected:{fill:e.palette.secondary.main},iconDisabled:{fill:"rgba(0,0,0,0.30)"},iconDeselected:{fill:e.palette.grey[700]},focusSelected:{backgroundColor:Object($o.fade)(e.palette.secondary.main,.4)}}})(gi),vi=function(e){function t(){return Object(A.a)(this,t),Object(F.a)(this,Object(x.a)(t).apply(this,arguments))}return Object(P.a)(t,e),Object(w.a)(t,[{key:"render",value:function(){var e=Object(_.a)({},this.props);return f.createElement(Va,e)}}]),t}(f.Component),yi=Object(E.withTheme)()(ii()(Object(E.withStyles)(function(e){return{inputWrapperFocused:{border:"2px solid ".concat(e.palette.primary.light),borderRadius:"5px"},inputWrapperUnfocused:{padding:2},innerInputError:{color:e.palette.error.main,padding:e.typography.pxToRem(3),fontSize:e.typography.pxToRem(12)},innerInputWarning:{color:e.palette.warning.dark,padding:e.typography.pxToRem(3),fontSize:e.typography.pxToRem(12)},innerInputInfo:{color:"green",padding:e.typography.pxToRem(3),fontSize:e.typography.pxToRem(12)},innerInputValidating:{color:"orange",padding:e.typography.pxToRem(3),fontSize:e.typography.pxToRem(12)}}})(vi))),Ei=function(e){function t(){return Object(A.a)(this,t),Object(F.a)(this,Object(x.a)(t).apply(this,arguments))}return Object(P.a)(t,e),Object(w.a)(t,[{key:"render",value:function(){var e=Object(_.a)({},this.props);return f.createElement(Pr,e)}}]),t}(f.Component),_i=Object(E.withTheme)()(ii()(Object(E.withStyles)(function(e){return{inputWrapperFocused:{border:"2px solid ".concat(e.palette.primary.light),borderRadius:"5px"},inputWrapperUnfocused:{padding:2},innerInputError:{color:e.palette.error.main,padding:e.typography.pxToRem(3),fontSize:e.typography.pxToRem(12)},innerInputWarning:{color:e.palette.warning.dark,padding:e.typography.pxToRem(3),fontSize:e.typography.pxToRem(12)},innerInputInfo:{color:"green",padding:e.typography.pxToRem(3),fontSize:e.typography.pxToRem(12)},innerInputValidating:{color:"orange",padding:e.typography.pxToRem(3),fontSize:e.typography.pxToRem(12)}}})(Ei))),ji=n(34),Ii=n.n(ji),Ci=function(e){function t(e){var n;Object(A.a)(this,t),n=Object(F.a)(this,Object(x.a)(t).call(this,e));var a=e.classes,r=(a.dialogPaper,Object(Fe.a)(a,["dialogPaper"]));return n.passOnClasses=r,n.dialogClasses={paper:e.classes.dialogPaper},n}return Object(P.a)(t,e),Object(w.a)(t,[{key:"render",value:function(){var e=this.props,t=(e.classes,e.dialogLabel),n=Object(Fe.a)(e,["classes","dialogLabel"]);return f.createElement(Rr,Object.assign({mapDialog:f.createElement(z.a,{classes:this.dialogClasses},f.createElement(J.a,{key:"title"},t))},n,{classes:this.passOnClasses}))}}]),t}(f.Component),Ti=Ii()(function(e){return{inputWrapperFocused:{position:"relative",boxShadow:"0px 0px 0px 2px ".concat(e.palette.primary.light),zIndex:10,margin:"2px 0px 2px 0px"},inputWrapperUnfocused:{margin:"2px 0px 2px 0px"},innerInputError:{color:e.palette.error.main,padding:e.typography.pxToRem(3),fontSize:e.typography.pxToRem(12)},innerInputWarning:{color:e.palette.warning.dark,padding:e.typography.pxToRem(3),fontSize:e.typography.pxToRem(12)},innerInputInfo:{color:"green",padding:e.typography.pxToRem(3),fontSize:e.typography.pxToRem(12)},innerInputValidating:{color:"orange",padding:e.typography.pxToRem(3),fontSize:e.typography.pxToRem(12)},mapIconContainer:{fill:e.palette.primary.dark},mapIconContainerDisabled:{fill:"rgba(0,0,0,0.30)"},dialogPaper:{maxWidth:"none",width:"75%",height:"75%"}}})(Ci),Si=n(54),Ri=function(e){function t(e){var n;Object(A.a)(this,t),n=Object(F.a)(this,Object(x.a)(t).call(this,e));var a=e.classes,r=(a.dialogPaper,Object(Fe.a)(a,["dialogPaper"]));return n.passOnClasses=r,n.dialogClasses={paper:e.classes.dialogPaper},n}return Object(P.a)(t,e),Object(w.a)(t,[{key:"render",value:function(){var e=this.props,t=(e.classes,e.dialogLabel),n=Object(Fe.a)(e,["classes","dialogLabel"]);return f.createElement(qr,Object.assign({mapDialog:f.createElement(Si.c,{classes:this.dialogClasses},f.createElement(Si.d,{key:"title"},t))},n))}}]),t}(f.Component),ki=Ii()(function(e){return{inputWrapperFocused:{border:"2px solid ".concat(e.palette.primary.light),borderRadius:"5px"},inputWrapperUnfocused:{padding:2},dialogPaper:{maxWidth:"none",width:"75%",height:"75%"}}})(Ri),Ni=n(1474),Ai=function(e){function t(){return Object(A.a)(this,t),Object(F.a)(this,Object(x.a)(t).apply(this,arguments))}return Object(P.a)(t,e),Object(w.a)(t,[{key:"getExpandedItems",value:function(){var e=this.props.roots;if(e&&1===e.length)return e.map(function(e){return e.path})}},{key:"render",value:function(){var e=this.props,t=e.roots,n=e.classes,a=e.treeKey,r=Object(Fe.a)(e,["roots","classes","treeKey"]);return t?f.createElement("div",{className:n.orgunitTree},f.createElement(Ni.OrgUnitTreeMultipleRoots,Object.assign({key:a,roots:t,initiallyExpanded:this.getExpandedItems(),hideCheckboxes:!0},r))):null}}]),t}(f.Component),wi=Object(E.withStyles)(function(){return{orgunitTree:{padding:5,minHeight:42,paddingTop:10,backgroundColor:"white"}}})(Ue(function(){return{margin:4}},function(){return{size:20}})(Ai)),Fi=function(e){function t(e){var n;return Object(A.a)(this,t),(n=Object(F.a)(this,Object(x.a)(t).call(this,e))).handleFilterChange=function(e){n.props.onSearch(e.currentTarget.value)},n.classes={input:n.props.classes.searchField},n}return Object(P.a)(t,e),Object(w.a)(t,[{key:"render",value:function(){var e=this.props,t=e.roots,n=e.onSelectClick,a=e.searchText,r=(e.onSearch,e.ready),o=e.treeKey,i=e.classes,s=e.selected,l=e.maxTreeHeight,u=e.disabled,d=(Object(Fe.a)(e,["roots","onSelectClick","searchText","onSearch","ready","treeKey","classes","selected","maxTreeHeight","disabled"]),l?{maxHeight:l,overflowY:"auto"}:null);return f.createElement("div",{className:i.container},f.createElement("div",{className:i.debounceFieldContainer},f.createElement(no,{onDebounced:this.handleFilterChange,value:a,placeholder:c.a.t("Search"),classes:this.classes,disabled:u})),!u&&f.createElement("div",{className:i.orgUnitTreeContainer,style:d},f.createElement(wi,{roots:t,onSelectClick:n,ready:r,treeKey:o,selected:s})))}}]),t}(f.Component);Fi.defaultProps={roots:[]};var xi,Pi=Object(E.withStyles)(function(){return{container:{border:"1px solid #C4C4C4",borderRadius:"3px",height:"100%",width:"100%",boxShadow:"0px 0px 2px 0px #C4C4C4 inset",zIndex:0,backgroundColor:"white"},searchField:{borderBottomLeftRadius:0,borderBottomRightRadius:0,boxShadow:"none",border:"none"},debounceFieldContainer:{padding:2,paddingBottom:0},orgUnitTreeContainer:{padding:2,borderTop:"1px solid #C4C4C4",overflow:"auto"}}})(Fi),Di=n(84),Ui=function(e){function t(){var e,n;Object(A.a)(this,t);for(var a=arguments.length,r=new Array(a),o=0;o<a;o++)r[o]=arguments[o];return(n=Object(F.a)(this,(e=Object(x.a)(t)).call.apply(e,[this].concat(r)))).renderSelectedOrgUnit=function(e){var t=n.props,a=t.classes,r=t.disabled,o=Cn()(a.clearSelectedOrgUnitButton,Object(Ut.a)({},a.clearSelectedOrgUnitButtonDisabled,r));return f.createElement("div",{className:a.selectedOrgUnitContainer},f.createElement("div",{className:a.selectedOrgUnitText},e.name),f.createElement(Si.f,{className:o,onClick:n.onDeselectOrgUnit},f.createElement(Di.f,{className:a.clearSelectedOrgUnitIcon})))},n.onSelectOrgUnit=function(e,t){n.props.onBlur({id:t.id,name:t.displayName,path:t.path})},n.onDeselectOrgUnit=function(){n.props.onBlur(null)},n.renderOrgUnitField=function(){var e=n.props,t=(e.classes,Object(Fe.a)(e,["classes"]));return f.createElement(Pi,Object.assign({onSelectClick:n.onSelectOrgUnit},t))},n}return Object(P.a)(t,e),Object(w.a)(t,[{key:"render",value:function(){var e=this.props.value;return e?this.renderSelectedOrgUnit(e):this.renderOrgUnitField()}}]),t}(f.Component),Li=Object(E.withStyles)(function(e){return{selectedOrgUnitContainer:{display:"flex",alignItems:"center"},clearSelectedOrgUnitButton:{height:e.typography.pxToRem(44),width:e.typography.pxToRem(44),marginLeft:e.typography.pxToRem(10)},clearSelectedOrgUnitIcon:{height:e.typography.pxToRem(20),width:e.typography.pxToRem(20)},selectedOrgUnitText:{marginRight:e.typography.pxToRem(20)}}})(Ui),Mi=Object(E.withTheme)()(Object(E.withStyles)(function(e){return{inputWrapperFocused:{border:"2px solid ".concat(e.palette.primary.light),borderRadius:"5px"},inputWrapperUnfocused:{padding:2},innerInputError:{color:e.palette.error.main,padding:e.typography.pxToRem(3),fontSize:e.typography.pxToRem(12)},innerInputWarning:{color:e.palette.warning.dark,padding:e.typography.pxToRem(3),fontSize:e.typography.pxToRem(12)},innerInputInfo:{color:"green",padding:e.typography.pxToRem(3),fontSize:e.typography.pxToRem(12)},innerInputValidating:{color:"orange",padding:e.typography.pxToRem(3),fontSize:e.typography.pxToRem(12)}}})(function(e){var t=Object(_.a)({},e);return f.createElement(uo,t)})),Bi=Object(E.withTheme)()(ii()(Object(E.withStyles)(function(e){return{inputWrapperFocused:{border:"2px solid ".concat(e.palette.primary.light),borderRadius:"5px"},inputWrapperUnfocused:{padding:2},innerInputError:{color:e.palette.error.main,padding:e.typography.pxToRem(3),fontSize:e.typography.pxToRem(12)},innerInputWarning:{color:e.palette.warning.dark,padding:e.typography.pxToRem(3),fontSize:e.typography.pxToRem(12)},innerInputInfo:{color:"green",padding:e.typography.pxToRem(3),fontSize:e.typography.pxToRem(12)},innerInputValidating:{color:"orange",padding:e.typography.pxToRem(3),fontSize:e.typography.pxToRem(12)}}})(function(e){var t=Object(_.a)({},e);return f.createElement(go,t)}))),Vi=function(e){function t(){return Object(A.a)(this,t),Object(F.a)(this,Object(x.a)(t).apply(this,arguments))}return Object(P.a)(t,e),Object(w.a)(t,[{key:"render",value:function(){var e=this.props,t=e.value,n=e.valueConverter,a=e.classes,r=n?n(t):t;return f.createElement("div",{className:a.container},r)}}]),t}(f.Component),Gi=Object(E.withStyles)(function(e){return{container:{width:"100%",fontWeight:500}}})(Vi),Wi=function(e){function t(){return Object(A.a)(this,t),Object(F.a)(this,Object(x.a)(t).apply(this,arguments))}return Object(P.a)(t,e),Object(w.a)(t,[{key:"render",value:function(){var e=Object(_.a)({},this.props);return f.createElement(jo,e)}}]),t}(f.Component),Hi=Object(E.withTheme)()(ii()(Object(E.withStyles)(function(e){return{inputWrapperFocused:{border:"2px solid ".concat(e.palette.primary.light),borderRadius:"5px"},inputWrapperUnfocused:{padding:2},innerInputError:{color:e.palette.error.main,padding:e.typography.pxToRem(3),fontSize:e.typography.pxToRem(12)},innerInputWarning:{color:e.palette.warning.dark,padding:e.typography.pxToRem(3),fontSize:e.typography.pxToRem(12)},innerInputInfo:{color:"green",padding:e.typography.pxToRem(3),fontSize:e.typography.pxToRem(12)},innerInputValidating:{color:"orange",padding:e.typography.pxToRem(3),fontSize:e.typography.pxToRem(12)}}})(Wi))),zi="validatingMessage",Ki="errorMessage",Yi="warningMessage",qi="infoMessage",Xi="errorMessage",Zi="warningMessage",Ji="infoMessage",Qi="validatingMessage",$i=function(e){return function(t){return function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return function(n){function a(){var e,n;Object(A.a)(this,a);for(var r=arguments.length,o=new Array(r),i=0;i<r;i++)o[i]=arguments[i];return(n=Object(F.a)(this,(e=Object(x.a)(a)).call.apply(e,[this].concat(o)))).getMessage=function(e){return t[e]?n.props[t[e]]:n.props[e]},n}return Object(P.a)(a,n),Object(w.a)(a,[{key:"render",value:function(){var t=this.props,n=(t.errorMessage,t.warningMessage,t.infoMessage,t.validatingMessage,t.rulesErrorMessage),r=t.rulesWarningMessage,o=t.rulesErrorMessageOnComplete,i=t.rulesWarningMessageOnComplete,c=t.rulesCompulsoryError,s=t.touched,l=t.validationAttempted,u=Object(Fe.a)(t,["errorMessage","warningMessage","infoMessage","validatingMessage","rulesErrorMessage","rulesWarningMessage","rulesErrorMessageOnComplete","rulesWarningMessageOnComplete","rulesCompulsoryError","touched","validationAttempted"]),d=s||l?a.getMessage(this.getMessage(Xi),this.getMessage(Zi),this.getMessage(Ji),this.getMessage(Qi)):{};d.message||(d=a.getRulesMessage(n,r,o,i,c,s,l));var p=d.message?Object(Ut.a)({},d.typeKey,d.message):null;return f.createElement("div",null,f.createElement(e,Object.assign({},p,u)))}}],[{key:"getMessage",value:function(e,t,n,a){var r,o;return a?(r=a,o=zi):e?(r=e,o=Ki):t?(r=t,o=Yi):n&&(r=n,o=qi),{message:r,typeKey:o}}},{key:"getRulesMessage",value:function(e,t,n,a,r,o,i){var c,s;return e?(c=e,s=Ki):n&&i?(c=n,s=Ki):t?(c=t,s=Yi):a&&i?(c=a,s=Yi):r&&(o||i)&&(c=r,s=Ki),{message:c,typeKey:s}}}]),a}(f.Component)}(t,e)}};function ec(e){return e.toString()}var tc=(xi={},Object(Ut.a)(xi,ct.NUMBER,ec),Object(Ut.a)(xi,ct.INTEGER,ec),Object(Ut.a)(xi,ct.INTEGER_POSITIVE,ec),Object(Ut.a)(xi,ct.INTEGER_ZERO_OR_POSITIVE,ec),Object(Ut.a)(xi,ct.INTEGER_NEGATIVE,ec),Object(Ut.a)(xi,ct.DATE,function(e){return Se(e).format("L")}),Object(Ut.a)(xi,ct.DATETIME,function(e){var t=Se(e);return{date:t.format("L"),time:t.format("HH:mm")}}),Object(Ut.a)(xi,ct.TRUE_ONLY,function(){return"true"}),Object(Ut.a)(xi,ct.BOOLEAN,function(e){return e?"true":"false"}),Object(Ut.a)(xi,ct.AGE,function(e){var t=Se(),n=Se(e),a=t.diff(n,"years");n.add(a,"years");var r=t.diff(n,"months");n.add(r,"months");var o=t.diff(n,"days");return{date:Se(e).format("L"),years:a.toString(),months:r.toString(),days:o.toString()}}),xi);function nc(e,t){return(e||0===e||!1===e)&&tc[t]?tc[t](e):e}var ac=n(150),rc=n.n(ac),oc=function(e){return{base:{paddingTop:10},error:{color:e.palette.error.main,fontSize:e.typography.pxToRem(14)},warning:{color:e.palette.warning.dark,fontSize:e.typography.pxToRem(14)},info:{color:"green",fontSize:e.typography.pxToRem(14)},validating:{color:e.palette.grey.dark,fontSize:e.typography.pxToRem(14)},validatingContainer:{display:"flex",alignItems:"center",color:e.palette.grey.dark},validatingIndicator:{fontSize:12,marginTop:1,marginRight:4}}},ic="error",cc="warning",sc="info",lc="validating",uc=function(){return function(e){return Object(E.withStyles)(oc)(function(e){return function(t){function n(){var e,t;Object(A.a)(this,n);for(var a=arguments.length,r=new Array(a),o=0;o<a;o++)r[o]=arguments[o];return(t=Object(F.a)(this,(e=Object(x.a)(n)).call.apply(e,[this].concat(r)))).convertMessage=function(e,a){if(rc()(e)&&!f.isValidElement(e))return{innerMessage:{message:e,messageType:a}};var r=t.props.classes;return{element:n.createMessageElement(e,r.base,r[a],{container:r.validatingContainer,indicator:r.validatingIndicator},a)}},t}return Object(P.a)(n,t),Object(w.a)(n,[{key:"getMessage",value:function(e,t,n,a){var r={};return a?r=this.convertMessage(a,lc):e?r=this.convertMessage(e,ic):t?r=this.convertMessage(t,cc):n&&(r=this.convertMessage(n,sc)),r}},{key:"render",value:function(){var t=this.props,n=(t.classes,t.errorMessage),a=t.warningMessage,r=t.infoMessage,o=t.validatingMessage,i=Object(Fe.a)(t,["classes","errorMessage","warningMessage","infoMessage","validatingMessage"]),c=this.getMessage(n,a,r,o),s=c.innerMessage?{innerMessage:c.innerMessage}:null;return f.createElement("div",null,f.createElement(e,Object.assign({},s,i)),c.element)}}],[{key:"createMessageElement",value:function(e,t,n,a,r){return r===lc?f.createElement("div",{className:t},f.createElement("div",{className:a.container},f.createElement("div",{className:a.indicator},f.createElement(C,{size:14,color:"inherit"})),f.createElement("div",{className:n},e))):f.createElement("div",{className:Cn()(t,n)},e)}}]),n}(f.Component)}(e))}},dc=function(e){return{container:{padding:8},activeContainer:{backgroundColor:e.palette.info.main},validatingContainer:{},errorContainer:{backgroundColor:e.palette.error.lighter},warningContainer:{backgroundColor:e.palette.warning.lighter},infoContainer:{}}},pc=function(e){return function(t){return Object(E.withStyles)(dc)(function(e,t){return function(n){function a(){return Object(A.a)(this,a),Object(F.a)(this,Object(x.a)(a).apply(this,arguments))}return Object(P.a)(a,n),Object(w.a)(a,[{key:"render",value:function(){var n,a=this.props,r=a.classes,o=Object(Fe.a)(a,["classes"]),i=Cn()(r.container,(n={},Object(Ut.a)(n,r.activeContainer,o.inFocus),Object(Ut.a)(n,r.validatingContainer,o.validatingMessage&&!o.inFocus),Object(Ut.a)(n,r.errorContainer,o.errorMessage&&!o.inFocus&&!o.validatingMessage),Object(Ut.a)(n,r.warningContainer,o.warningMessage&&!o.inFocus&&!o.validatingMessage&&!o.errorMessage),Object(Ut.a)(n,r.infoContainer,o.infoMessage&&!o.inFocus&&!o.validatingMessage&&!o.errorMessage&&!o.warningMessage),n));return f.createElement("div",{className:i,style:t},f.createElement(e,o))}}]),a}(f.Component)}(t,e))}},fc=function(){return function(e){return function(t){function n(){return Object(A.a)(this,n),Object(F.a)(this,Object(x.a)(n).apply(this,arguments))}return Object(P.a)(n,t),Object(w.a)(n,[{key:"shouldComponentUpdate",value:function(e){var t=this;return Object.keys(e).some(function(n){return e[n]!==t.props[n]&&!Object(He.a)(e[n])})}},{key:"render",value:function(){return f.createElement(e,this.props)}}]),n}(f.Component)}},mc=function(e){return function(t){return function(n){var a=e(n);return f.createElement(t,a)}}},hc=function(){return function(e){return function(t){function n(){return Object(A.a)(this,n),Object(F.a)(this,Object(x.a)(n).apply(this,arguments))}return Object(P.a)(n,t),Object(w.a)(n,[{key:"goto",value:function(){if(this.gotoInstance){this.gotoInstance.scrollIntoView();var e=window.scrollY;e&&window.scroll(0,e-48)}}},{key:"render",value:function(){var t=this;return f.createElement("div",{ref:function(e){t.gotoInstance=e}},f.createElement(e,this.props))}}]),n}(f.Component)}},bc=function(){return function(e){return function(t){function n(){return Object(A.a)(this,n),Object(F.a)(this,Object(x.a)(n).apply(this,arguments))}return Object(P.a)(n,t),Object(w.a)(n,[{key:"render",value:function(){var t=this.props,n=t.hidden,a=Object(Fe.a)(t,["hidden"]);return n?null:f.createElement(e,a)}}]),n}(f.Component)}},gc=function(e){return{label:{color:e.palette.text.primary,paddingBottom:4},labelVertical:{color:e.palette.text.primary}}},Oc=function(e){return{container:{display:"flex",alignItems:"center"},required:{color:e.palette.required},iconContainer:{paddingLeft:5,display:"flex",alignItems:"center"},icon:{width:22,height:22,borderRadius:2}}},vc=function(e){return function(t){var n=e&&e.onGetUseVerticalOrientation,a=e&&e.onGetCustomFieldLabeClass,r=function(e){return function(t){return function(n){function a(e){var t;return Object(A.a)(this,a),(t=Object(F.a)(this,Object(x.a)(a).call(this,e))).setClasses(e.classes),t}return Object(P.a)(a,n),Object(w.a)(a,[{key:"componentWillReceiveProps",value:function(e){var t=e.classes||{},n=this.props.classes||{};Object.keys(t).length!==Object.keys(n).length?this.setClasses(t):Object.keys(t).some(function(e){return t[e]!==n[e]})&&this.setClasses(t)}},{key:"setClasses",value:function(t){if(t)if(e&&e.onSplitClasses){var n=e.onSplitClasses(t,this.props);this.labelContainerClass=n.labelContainerClass,this.labelClasses=n.labelClasses,this.passOnClasses=n.passOnClasses}else this.passOnClasses=t}},{key:"getLabelElement",value:function(e,t,n){return f.createElement(To,{labelRef:t,classes:this.labelClasses||{},useVerticalOrientation:n},e)}},{key:"render",value:function(){var n=this.props,a=n.label,r=n.labelRef,o=(n.classes,n.styles),i=Object(Fe.a)(n,["label","labelRef","classes","styles"]),c=e&&e.onGetUseVerticalOrientation&&e.onGetUseVerticalOrientation(this.props),s=this.getLabelElement(a,r,c),l=c?Ro.a.labelContainerVertical:Ro.a.labelContainer,u=o||{};return f.createElement("div",{className:c?Ro.a.containerVertical:Ro.a.container},f.createElement("div",{className:Cn()(l,this.labelContainerClass),style:u.labelContainerStyle},s),f.createElement("div",{className:Ro.a.inputContainer,style:u.inputContainerStyle},f.createElement(t,Object.assign({},this.passOnClasses,i))))}}]),a}(f.Component)}}({onGetUseVerticalOrientation:function(e){return n&&n(e)},onSplitClasses:function(e,t){var r=e.label,o=e.labelVertical,i=Object(Fe.a)(e,["label","labelVertical"]);return{labelContainer:null,labelClasses:{label:n&&n(t)?o:Cn()(r,a&&a(t))},passOnClasses:i}}})(t),o=function(e){return f.createElement("span",null,e.label,f.createElement("span",{className:e.requiredClass},"\xa0*"))},i=function(e){var t=e.icon,n=e.label,a=e.iconClass;return t?f.createElement("img",{className:a,src:t.data,style:{backgroundColor:t.color},alt:"Icon for ".concat(n||"")}):null},c=function(e){var t=e.label;return e.required&&t?f.createElement(o,e):t},s=Object(E.withStyles)(Oc)(function(e){var t=e.label,n=e.required,a=e.icon,r=e.classes;return f.createElement("div",{className:r.container},f.createElement(c,{label:t||"",required:n,requiredClass:r.required}),f.createElement("div",{className:r.iconContainer},f.createElement(i,{icon:a,label:t,iconClass:r.icon})))});return Object(E.withStyles)(gc)(function(e){e.label,e.required,e.icon;var t=Object(Fe.a)(e,["label","required","icon"]),n=(e.classes,Object(Fe.a)(e,["classes"]));return f.createElement(r,Object.assign({label:f.createElement(s,n)},t))})}},yc="USER_CAPTURE",Ec="USER_SEARCH",_c={};function jc(e,t){_c[e]=t}function Ic(e){return _c[e]}var Cc,Tc="initRegUnitListRoots",Sc="initRegUnitListRootsFailed",Rc="searchRegisteringUnits",kc="clearOrgUnitSearch",Nc="setRegisteringUnitSearchRoots",Ac="setSearchRootsFailed",wc="showRegUnitLoadingIndicator",Fc=Object(D.b)(function(e){return{roots:Ic("regUnit")||Ic("captureRoots"),searchText:e.registeringUnitList.searchText,ready:!e.registeringUnitList.isLoading,treeKey:e.registeringUnitList.key}},function(e){return{onSearch:function(t){var n=t?function(e){return le(Rc)({searchText:e})}(t):le(kc)();e(n)}}})(Pi),xc=function(e){function t(e){var n;return Object(A.a)(this,t),(n=Object(F.a)(this,Object(x.a)(t).call(this,e))).state={open:!1},n.handleShowWarning=n.handleShowWarning.bind(Object(V.a)(n)),n.handleClose=n.handleClose.bind(Object(V.a)(n)),n.handleClick=n.handleClick.bind(Object(V.a)(n)),n.handleReset=n.handleReset.bind(Object(V.a)(n)),n}return Object(P.a)(t,e),Object(w.a)(t,[{key:"handleShowWarning",value:function(){this.props.showWarning?this.setState({open:!0}):this.handleReset()}},{key:"handleClose",value:function(){this.setState({open:!1})}},{key:"handleClick",value:function(e,t){var n={id:t.id,name:t.displayName};this.props.handleClickOrgUnit(t.id,n)}},{key:"handleReset",value:function(){this.props.handleClickOrgUnit(void 0,null)}},{key:"render",value:function(){var e=this;return this.props.selectedOrgUnitId?m.a.createElement("div",null,m.a.createElement(Be.a,{elevation:0,className:this.props.classes.selectedPaper},m.a.createElement("h4",{className:this.props.classes.title},c.a.t("Selected registering unit")),m.a.createElement("div",{className:this.props.classes.selectedItemContainer},m.a.createElement("div",null,this.props.selectedOrgUnit.name),m.a.createElement("div",{className:this.props.classes.selectedItemClear},m.a.createElement(te.a,{className:this.props.classes.selectedButton,onClick:function(){return e.props.onReset()}},m.a.createElement($e.a,{className:this.props.classes.selectedButtonIcon}))))),m.a.createElement(z.a,{open:this.state.open,onClose:this.handleClose},m.a.createElement(J.a,null,c.a.t("Start Again")),m.a.createElement(X.a,null,m.a.createElement(Nn.a,null,"Are you sure? All unsaved data will be lost.")),m.a.createElement(Y.a,null,m.a.createElement($.a,{onClick:this.handleClose,color:"secondary"},"Cancel"),m.a.createElement($.a,{onClick:this.handleReset,color:"primary",autoFocus:!0},"Accept")))):m.a.createElement("div",null,m.a.createElement(Be.a,{elevation:0,className:this.props.classes.paper},m.a.createElement("h4",{className:this.props.classes.title},c.a.t("Registering Organisation Unit")),m.a.createElement("div",null,m.a.createElement(Fc,{onSelectClick:this.handleClick}))))}}]),t}(f.Component),Pc=Object(E.withStyles)(function(e){return{paper:{padding:8,backgroundColor:e.palette.grey.lighter,borderRadius:8},title:{margin:0,fontWeight:425,fontSize:15,paddingBottom:5},form:{width:"100%"},listItem:{backgroundColor:"#ffffff",borderRadius:5,marginBottom:5,padding:5,border:"1px solid lightGrey"},selectedText:{marginTop:5,marginBottom:5,padding:5,borderLeft:"2px solid #71a4f8"},selectedPaper:{backgroundColor:e.palette.grey.lighter,borderRadius:5,padding:8},selectedButton:{width:20,height:20},selectedButtonIcon:{width:20,height:20},selectedItemContainer:{display:"flex",alignItems:"center",minHeight:28,margin:"7px 0px 7px 0px",paddingLeft:5,borderLeft:"2px solid ".concat(e.palette.primary.light)},selectedItemClear:{flexGrow:1,display:"flex",justifyContent:"flex-end"}}})(xc),Dc=n(298),Uc=n.n(Dc),Lc=function(e){function t(e){var n;return Object(A.a)(this,t),(n=Object(F.a)(this,Object(x.a)(t).call(this,e))).handleStartAgainClick=function(){n.props.onStartAgain()},n.handleNewClick=function(){n.props.onClickNew()},n.handleFindClick=function(){alert("Not implemented yet.")},n.getButtonText=function(){if(n.props.selectedProgram){var e=n.props.selectedProgram instanceof Xt?n.props.selectedProgram.trackedEntityType.name:"Event";return c.a.t("New {{typeName}}",{typeName:e})}return c.a.t("New")},n.handleStartAgainClick=n.handleStartAgainClick.bind(Object(V.a)(n)),n.handleNewClick=n.handleNewClick.bind(Object(V.a)(n)),n}return Object(P.a)(t,e),Object(w.a)(t,[{key:"render",value:function(){var e=this.props,t=e.classes,n=e.showResetButton;return m.a.createElement("div",{className:t.container},n?m.a.createElement("div",{className:t.startAgainContainer},m.a.createElement(Tn,{onClick:this.handleStartAgainClick},c.a.t("Start again"))):null,m.a.createElement($.a,{onClick:this.handleNewClick,color:"primary"},m.a.createElement(Uc.a,{className:t.rightButton}),this.getButtonText()))}}]),t}(f.Component),Mc=Object(E.withStyles)(function(){return{container:{display:"flex",justifyContent:"flex-end",flexGrow:1,padding:10},startAgainContainer:{flexGrow:1}}})(Lc),Bc=function(e){function t(e){var n;return Object(A.a)(this,t),(n=Object(F.a)(this,Object(x.a)(t).call(this,e))).handleClickProgram=n.handleClickProgram.bind(Object(V.a)(n)),n.handleSetCatergoryCombo=n.handleSetCatergoryCombo.bind(Object(V.a)(n)),n.handleClickOrgUnit=n.handleClickOrgUnit.bind(Object(V.a)(n)),n}return Object(P.a)(t,e),Object(w.a)(t,null,[{key:"getSelectedProgram",value:function(e){return Je.get(e)||{}}}]),Object(w.a)(t,[{key:"handleClickProgram",value:function(e){this.props.onSetProgramId(e)}},{key:"handleSetCatergoryCombo",value:function(e,t){this.props.onSetCategoryOption(t,e)}},{key:"handleClickOrgUnit",value:function(e,t){this.props.onSetOrgUnit(e,t)}},{key:"calculateColumnWidths",value:function(){var e=this.props.selectedProgramId,n=t.getSelectedProgram(e),a=3,r=3,o=6;return n&&n.categoryCombination&&(a=3,r=6,o=3),{orgUnitSelectorWidth:a,programSelectorWidth:r,actionButtonsWidth:o}}},{key:"render",value:function(){var e=this.calculateColumnWidths(),t=e.orgUnitSelectorWidth,n=e.programSelectorWidth,a=e.actionButtonsWidth;return m.a.createElement(Be.a,{className:this.props.classes.paper},m.a.createElement(Ge.a,{container:!0,spacing:16},m.a.createElement(Ge.a,{item:!0,xs:12,sm:t},m.a.createElement(Pc,{selectedOrgUnitId:this.props.selectedOrgUnitId,handleClickOrgUnit:this.handleClickOrgUnit,selectedOrgUnit:this.props.selectedOrgUnit,onReset:this.props.onResetOrgUnitId})),m.a.createElement(Ge.a,{item:!0,xs:12,sm:n},m.a.createElement(Rn,{selectedProgram:this.props.selectedProgramId,selectedOrgUnitId:this.props.selectedOrgUnitId,selectedCategories:this.props.selectedCategories,handleClickProgram:this.handleClickProgram,handleSetCatergoryCombo:this.handleSetCatergoryCombo,handleResetCategorySelections:this.props.onResetAllCategoryOptions,buttonModeMaxLength:5,onResetProgramId:this.props.onResetProgramId,onResetCategoryOption:this.props.onResetCategoryOption,onResetOrgUnit:this.props.onResetOrgUnitId})),m.a.createElement(Ge.a,{item:!0,xs:12,sm:a},m.a.createElement(Mc,{selectedProgram:this.props.selectedProgramId,onStartAgain:this.props.onStartAgain,onClickNew:this.props.onClickNew,selectionComplete:this.props.selectionComplete,showResetButton:!(!this.props.selectedProgramId&&!this.props.selectedOrgUnitId)}))))}}]),t}(f.Component),Vc=Object(E.withStyles)(function(){return{paper:{flexGrow:1,padding:10}}})(Bc),Gc=Object(D.b)(function(e){return{selectedProgramId:e.currentSelections.programId,selectedCategories:e.currentSelections.categories,selectedOrgUnitId:e.currentSelections.orgUnitId,selectionComplete:e.currentSelections.complete,selectedOrgUnit:e.currentSelections.orgUnitId?e.organisationUnits[e.currentSelections.orgUnitId]:null}},function(e){return{onSetOrgUnitId:function(t){e(function(e){return le(bn)(e)}(t))},onStoreOrgUnitObject:function(t){e(function(e){return le(gn)(e)}(t))},onSetCategoryOptionId:function(t,n){e(function(e,t){return le(vn)({categoryId:e,selectedCategoryOptionId:t})}(t,n))},onResetCategoryOptionSelections:function(){e(le(yn)())},onGoBackToListContext:function(){e(le(En)())}}})(Vc),Wc=n(179),Hc=n.n(Wc),zc=n(918),Kc=n.n(zc),Yc=Object(E.withStyles)(function(){return{button:{},contents:{display:"flex",alignItems:"center",justifyContent:"center"}}})(function(e){var t=e.classes,n=e.children,a=e.muiClasses,r=e.muiButtonRef,o=Object(Fe.a)(e,["classes","children","muiClasses","muiButtonRef"]),i=r?{buttonRef:r}:null;return f.createElement($.a,Object.assign({},i,{className:t.button,classes:a},o),f.createElement("div",{className:t.contents},n))}),qc=n(82),Xc=n.n(qc),Zc=n(297),Jc=n.n(Zc),Qc=function(e){function t(){return Object(A.a)(this,t),Object(F.a)(this,Object(x.a)(t).apply(this,arguments))}return Object(P.a)(t,e),Object(w.a)(t,[{key:"getHeader",value:function(){var e=this.props.header;return e&&e.type&&"SectionHeaderSimple"===e.type.name&&this.props.onChangeCollapseState?m.a.cloneElement(e,{onChangeCollapseState:this.props.onChangeCollapseState,isCollapsed:this.props.isCollapsed,extendedCollapsibility:this.props.extendedCollapsibility}):e}},{key:"renderContents",value:function(){var e=this,t=this.props,n=t.isCollapsed,a=t.contentStyle,r=t.mainActionButton,o=t.classes,i=!n,c=Object.assign({},a,n?{display:"none"}:null),s=r?m.a.createElement("div",{className:o.mainActionButton},r):null;return m.a.createElement("div",null,this.getHeader(),m.a.createElement("div",{style:c},s,i?e.props.children:null))}},{key:"render",value:function(){var e=this.props,t=e.style,n=e.className,a=Cn()(this.props.classes.container,n);return m.a.createElement("div",{className:a,style:t},this.renderContents())}}]),t}(f.Component),$c=Object(E.withStyles)(function(e){return{container:{flexGrow:1,display:"flex",flexDirection:"column",position:"relative",border:"1px solid ".concat(e.palette.grey.blueGrey)},mainActionButton:{position:"absolute",right:15,top:30}}})(Qc),es=n(527),ts=n.n(es),ns=function(e){function t(e){var n;return Object(A.a)(this,t),(n=Object(F.a)(this,Object(x.a)(t).call(this,e))).handleChangeCollapse=n.handleChangeCollapse.bind(Object(V.a)(n)),n}return Object(P.a)(t,e),Object(w.a)(t,[{key:"handleChangeCollapse",value:function(){this.props.onChangeCollapseState()}},{key:"render",value:function(){var e=this,t=this.props,n=t.titleStyle,a=t.extendedCollapsibility,r=t.containerStyle,o=t.classes,i=t.secondary,c=t.onChangeCollapseState,s=a?{onClick:this.handleChangeCollapse}:null,l=a?Object(se.a)({},r,{cursor:"pointer"}):r;return m.a.createElement("div",Object.assign({className:i?o.containerSecondary:o.container,style:l},s),m.a.createElement("div",{className:o.title,style:n},this.props.title),m.a.createElement("div",{className:o.children},this.props.children,c?m.a.createElement(te.a,{title:e.props.isCollapsed?"\xc5pne":"Lukk",onClick:e.handleChangeCollapse},m.a.createElement(ts.a,null,e.props.isCollapsed?"keyboard_arrow_down":"keyboard_arrow_up")):null))}}]),t}(f.Component),as=Object(E.withStyles)(function(e){return{container:{display:"flex"},containerSecondary:{display:"flex"},title:Object(se.a)({},e.typography.title,{fontSize:16,fontWeight:500,padding:"16px 8px 16px 8px"}),children:{flexGrow:1,display:"flex",justifyContent:"flex-end",alignItems:"center",paddingRight:5}}})(ns),rs=n(1475),os=n.n(rs),is=function(e){function t(e){var n;return Object(A.a)(this,t),(n=Object(F.a)(this,Object(x.a)(t).call(this,e))).handleUpdateAsyncState=function(e,t){n.props.onUpdateFieldUIOnly(t,e,n.props.id)},n.handleCommitAsync=function(e,t,a){n.props.onUpdateFieldAsync(e,t,n.props.id,a)},n.renderField=function(e,t,a,r){var o=n.props,i=o.fields,c=o.values,s=o.fieldsUI,l=o.validationAttempted,u=o.id,d=(o.onFieldsValidated,o.onUpdateField,o.onUpdateFieldAsync,o.onUpdateFieldUIOnly,o.validateIfNoUIData,o.children,o.onRenderDivider,o.onGetContainerProps,o.onIsValidating,o.onGetValidationContext,o.onCleanUp,o.loadNr,o.onPostProcessErrorMessage),p=Object(Fe.a)(o,["fields","values","fieldsUI","validationAttempted","id","onFieldsValidated","onUpdateField","onUpdateFieldAsync","onUpdateFieldUIOnly","validateIfNoUIData","children","onRenderDivider","onGetContainerProps","onIsValidating","onGetValidationContext","onCleanUp","loadNr","onPostProcessErrorMessage"]),m=e.props||{},h=s[e.id]||{},b=c[e.id],g=n.commitFieldUpdate.bind(Object(V.a)(n),e.id),O=e.commitEvent||"onBlur",v=Object(Ut.a)({},O,g),y={};m.async&&(y.onCommitAsync=function(t){return n.handleCommitAsync(e.id,m.label,t)},y.asyncUIState=n.asyncUIState[e.id]);var E=d&&h.errorMessage?d(h.errorMessage,h.errorType,h.errorData,"".concat(u,"-").concat(e.id),e.id):h.errorMessage;return f.createElement("div",{key:e.id,className:os.a.fieldOuterContainer},f.createElement("div",r&&r(t,i.length,e),f.createElement(e.component,Object.assign({ref:function(t){n.setFieldInstance(t,e.id)},value:b,errorMessage:E,touched:h.touched,validationAttempted:l,validatingMessage:h.validatingMessage},v,m,p,y))),a&&a(t,i.length,e))},n.fieldInstances=new Map,n.asyncUIState=t.getAsyncUIState(n.props.fieldsUI),n.fieldsValidatingPromiseContainer={},n.commitUpdateTriggeredForFields={},n.props.validateIfNoUIData&&n.validateAllFields(n.props),n}return Object(P.a)(t,e),Object(w.a)(t,null,[{key:"validateField",value:function(){var e=Object(o.a)(r.a.mark(function e(t,n,a,i){var c;return r.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t.validators&&0!==t.validators.length){e.next=2;break}return e.abrupt("return",{valid:!0});case 2:return e.next=4,t.validators.reduce(function(){var e=Object(o.a)(r.a.mark(function e(t,o){var c,s;return r.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t;case 2:if(!0!==(c=e.sent)){e.next=13;break}if(!((s=o.validator(n,a))instanceof Promise)){e.next=10;break}return s=i?i(o.validatingMessage,s):s,e.next=9,s;case 9:s=e.sent;case 10:if(!(!0===s||s&&s.valid)){e.next=12;break}return e.abrupt("return",!0);case 12:return e.abrupt("return",{message:s&&s.errorMessage||o.message,type:o.type,data:s&&s.data});case 13:return e.abrupt("return",c);case 14:case"end":return e.stop()}},e)}));return function(t,n){return e.apply(this,arguments)}}(),Promise.resolve(!0));case 4:if(!0===(c=e.sent)){e.next=7;break}return e.abrupt("return",{valid:!1,errorMessage:c.message,errorType:c.type,errorData:c.data});case 7:return e.abrupt("return",{valid:!0});case 8:case"end":return e.stop()}},e)}));return function(t,n,a,r){return e.apply(this,arguments)}}()},{key:"getAsyncUIState",value:function(e){return Object.keys(e).reduce(function(n,a){var r=e[a];return n[a]=t.getFieldAsyncUIState(r),n},{})}},{key:"getFieldAsyncUIState",value:function(e){var t=["valid","errorMessage","touched"];return Object.keys(e).reduce(function(n,a){return t.includes(a)||(n[a]=e[a]),n},{})}},{key:"updateAsyncUIState",value:function(e,n,a){return Object.keys(n).reduce(function(a,r){var o=n[r];return o!==e[r]&&(a[r]=t.getFieldAsyncUIState(o)),a},a)}},{key:"executeValidateAllFields",value:function(e,n){var a=e.id,i=e.fields,s=e.values,l=e.onGetValidationContext,u=e.onIsValidating,d=l&&l(),p=i.map(function(){var e=Object(o.a)(r.a.mark(function e(o){var i,l,p,f;return r.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return i=o.id,l=n[i]||{},n[i]=l,l.validatingCompleteUid||(l.validatingCompleteUid=Xc()()),l.cancelableValidatingPromise&&l.cancelableValidatingPromise.cancel(),p=function(e,t){return l.cancelableValidatingPromise=Object(ze.c)(t),u&&u(o.id,a,l.validatingCompleteUid,e),l.cancelableValidatingPromise.promise},e.prev=6,e.next=9,t.validateField(o,s[o.id],d,p);case 9:f=e.sent,e.next=15;break;case 12:e.prev=12,e.t0=e.catch(6),e.t0&&rc()(e.t0)&&e.t0.isCanceled?f=null:(f={valid:!1,errorMessage:c.a.t("error encountered during field validation"),errorType:c.a.t("error")},O.a.error({reason:e.t0,field:o}));case 15:return e.abrupt("return",{id:o.id,validationData:f});case 16:case"end":return e.stop()}},e,null,[[6,12]])}));return function(t){return e.apply(this,arguments)}}());return Promise.all(p).then(function(e){return e.filter(function(e){return!!e.validationData})})}}]),Object(w.a)(t,[{key:"componentWillReceiveProps",value:function(e){if(e.id!==this.props.id||e.loadNr!==this.props.loadNr){this.asyncUIState=t.getAsyncUIState(this.props.fieldsUI),this.commitUpdateTriggeredForFields={};var n=e.onCleanUp;n&&n(this.getCleanUpData()),this.props.validateIfNoUIData&&this.validateAllFields(e)}else this.asyncUIState=t.updateAsyncUIState(this.props.fieldsUI,e.fieldsUI,this.asyncUIState)}},{key:"componentWillUnmount",value:function(){var e=this.props.onCleanUp;e&&e(this.getCleanUpData())}},{key:"getCleanUpData",value:function(){var e=this,t=Object.keys(this.fieldsValidatingPromiseContainer).map(function(t){var n=e.fieldsValidatingPromiseContainer[t]||{},a=n.cancelableValidatingPromise,r=n.validatingCompleteUid;return a&&a.cancel(),r}).filter(function(e){return!!e});return this.fieldsValidatingPromiseContainer={},t}},{key:"validateAllFields",value:function(e){var n=this;this.validateAllCancelablePromise&&this.validateAllCancelablePromise.cancel(),this.validateAllCancelablePromise=Object(ze.c)(t.executeValidateAllFields(e,this.fieldsValidatingPromiseContainer)),this.validateAllCancelablePromise.promise.then(function(t){var a=t.reduce(function(e,t){return e[t.id]=t.validationData,e},{}),r=t.map(function(e){return{promises:n.fieldsValidatingPromiseContainer[e.id],id:e.id,commitUpdateTriggeredForField:n.commitUpdateTriggeredForFields[e.id]}}).filter(function(e){return!e.commitUpdateTriggeredForField});e.onFieldsValidated&&e.onFieldsValidated(a,e.id,r.map(function(e){return e.promises.validatingCompleteUid})),r.forEach(function(e){n.fieldsValidatingPromiseContainer[e.id]=null}),n.validateAllCancelablePromise=null}).catch(function(e){e&&rc()(e)&&e.isCanceled||O.a.error({reason:e,message:"formBuilder validate all fields failed"})})}},{key:"getFieldProp",value:function(e){return this.props.fields.find(function(t){return t.id===e})}},{key:"hasCommitedValueChanged",value:function(e,t){var n=!0,a=this.props.values[e.id];return rc()(t)?e.onIsEqual&&e.onIsEqual(t,a)&&(n=!1):(t||"")===(a||"")&&(n=!1),n}},{key:"commitFieldUpdate",value:function(){var e=Object(o.a)(r.a.mark(function e(n,a,o){var i,s,l,u,d,p,f,m,h,b,g,v=this;return r.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(i=this.props,s=i.onUpdateFieldUIOnly,l=i.onUpdateField,u=i.onGetValidationContext,d=i.id,p=i.onIsValidating,f=this.getFieldProp(n),m=!o||!oe()(o.touched)||o.touched,this.hasCommitedValueChanged(f,a)){e.next=6;break}return s({touched:m},n,d),e.abrupt("return");case 6:return h=this.fieldsValidatingPromiseContainer[n]||{},this.fieldsValidatingPromiseContainer[n]=h,h.validatingCompleteUid||(h.validatingCompleteUid=Xc()()),h.cancelableValidatingPromise&&h.cancelableValidatingPromise.cancel(),b=function(e,t){return h.cancelableValidatingPromise=Object(ze.c)(t),p&&p(n,d,h.validatingCompleteUid,e,{touched:!0}),h.cancelableValidatingPromise.promise},this.commitUpdateTriggeredForFields[n]=!0,g=t.validateField(f,a,u&&u(),b).then(function(e){var t=e.valid,r=e.errorMessage,o=e.errorType,i=e.errorData;l(a,{valid:t,touched:m,errorMessage:r,errorType:o,errorData:i},n,d,h.validatingCompleteUid),v.fieldsValidatingPromiseContainer[n]=null}).catch(function(e){e&&rc()(e)&&e.isCanceled||(O.a.error({reason:e,field:f,value:a}),l(a,{valid:!1,touched:!0,errorMessage:c.a.t("error encountered during field validation"),errorType:c.a.t("error")},n,d,h.validatingCompleteUid),v.fieldsValidatingPromiseContainer[n]=null)}),e.next=15,g;case 15:case"end":return e.stop()}},e,this)}));return function(t,n,a){return e.apply(this,arguments)}}()},{key:"setFieldInstance",value:function(e,t){e?this.fieldInstances.set(t,e):this.fieldInstances.has(t)&&this.fieldInstances.delete(t)}},{key:"isValid",value:function(e){var t=this;return Object.keys(this.props.fieldsUI).every(function(n){var a=t.props.fieldsUI[n];if(e&&!e.includes(a.errorType))return!0;return a.valid})}},{key:"getInvalidFields",value:function(e){var t=this;return this.props.fields.reduce(function(n,a){var r=t.props.fieldsUI[a.id];return r.valid?e&&e[a.id]&&n.push({prop:a,instance:t.fieldInstances.get(a.id),uiState:r}):n.push({prop:a,instance:t.fieldInstances.get(a.id),uiState:r}),n},[])}},{key:"renderFields",value:function(){var e=this,t=this.props,n=t.fields,a=t.children,r=t.onRenderDivider,o=t.onGetContainerProps;return a?a(this.renderField,n):n.map(function(t,n){return e.renderField(t,n,r,o)})}},{key:"render",value:function(){return f.createElement(f.Fragment,null,this.renderFields())}}]),t}(f.Component),cs="UpdateFieldUIOnly",ss=Object(D.b)(function(e,t){return{fieldsUI:e.formsSectionsFieldsUI[t.id]||{}}},function(e){return{onUpdateFieldUIOnly:function(t,n,a){e(function(e,t,n){return le(cs)({uiState:e,elementId:t,sectionId:n})}(t,n,a))}}},function(e,t,n){var a=n.formBuilderRef,r=Object(Fe.a)(n,["formBuilderRef"]);return Object(se.a)({},r,e,t,{ref:a})})(is),ls=function(e){return{dividerContainer:{},divider:{backgroundColor:e.palette.dividerForm}}},us=function(e){return{evenNumbers:{backgroundColor:e.palette.grey.lightest}}},ds=n(1476),ps=n(397),fs={COMPULSORY:c.a.t("A value is required"),NUMBER:c.a.t("Please provide a valid number"),INTEGER:c.a.t("Please provide a valid integer"),POSITIVE_INTEGER:c.a.t("Please provide a positive integer"),ZERO_OR_POSITIVE_INTEGER:c.a.t("Please provide zero or a positive integer"),NEGATIVE_INTEGER:c.a.t("Please provide a negative integer"),DATE:c.a.t("Please provide a valid date"),DATETIME:c.a.t("Please provide a valid date and time"),TIME:c.a.t("Please provide a valid time"),PERCENTAGE:c.a.t("Please provide a valid percentage"),URL:c.a.t("Please provide a valid url"),EMAIL:c.a.t("Please provide a valid email address"),AGE:c.a.t("Please provide a valid age"),PHONE_NUMBER:c.a.t("Please provide a valid phone number"),ORGANISATION_UNIT:c.a.t("Please provide a valid organisation unit"),COORDINATE:c.a.t("Please provide valid coordinates"),USERNAME:c.a.t("Please provide a valid username"),UNIQUENESS:c.a.t("This value already exists"),RANGE:c.a.t('"From" cannot be greater than "To"')},ms={UNIQUENESS:c.a.t("Checking...")},hs=function(e){return An(e&&Object(ps.a)(e)?e.trim():e)},bs=function(){return{validator:Vn,message:fs.INTEGER}},gs=function(){return{validator:Gn,message:fs.POSITIVE_INTEGER}},Os=function(){return{validator:Hn,message:fs.ZERO_OR_POSITIVE_INTEGER}},vs=function(){return{validator:Wn,message:fs.NEGATIVE_INTEGER}},ys=function(){return{validator:zn,message:fs.NUMBER}},Es=(Cc={},Object(Ut.a)(Cc,ct.NUMBER,ys),Object(Ut.a)(Cc,ct.INTEGER,bs),Object(Ut.a)(Cc,ct.INTEGER_POSITIVE,gs),Object(Ut.a)(Cc,ct.INTEGER_ZERO_OR_POSITIVE,Os),Object(Ut.a)(Cc,ct.INTEGER_NEGATIVE,vs),Object(Ut.a)(Cc,ct.TIME,function(){return{validator:Un,message:fs.TIME}}),Object(Ut.a)(Cc,ct.DATE,function(){return{validator:Dn,message:fs.DATE}}),Object(Ut.a)(Cc,ct.DATETIME,function(){return{validator:Ln,message:fs.DATETIME}}),Object(Ut.a)(Cc,ct.EMAIL,function(){return{validator:Bn,message:fs.EMAIL}}),Object(Ut.a)(Cc,ct.PERCENTAGE,function(){return{validator:Kn,message:fs.PERCENTAGE}}),Object(Ut.a)(Cc,ct.URL,function(){return{validator:Yn,message:fs.URL}}),Object(Ut.a)(Cc,ct.AGE,function(){return{validator:Zn,message:fs.AGE}}),Object(Ut.a)(Cc,ct.PHONE_NUMBER,function(){return{validator:Jn,message:fs.PHONE_NUMBER}}),Object(Ut.a)(Cc,ct.ORGANISATION_UNIT,function(){return{validator:Qn,message:fs.ORGANISATION_UNIT}}),Object(Ut.a)(Cc,ct.COORDINATE,function(){return{validator:ea,message:fs.COORDINATE}}),Object(Ut.a)(Cc,ct.USERNAME,function(){return{validator:ta,message:fs.USERNAME}}),Object(Ut.a)(Cc,ct.DATE_RANGE,function(){return{validator:ia(fs.DATE),message:fs.RANGE}}),Object(Ut.a)(Cc,ct.DATETIME_RANGE,function(){return{validator:ua(fs.DATETIME),message:fs.RANGE}}),Object(Ut.a)(Cc,ct.TIME_RANGE,function(){return{validator:fa(fs.TIME),message:fs.RANGE}}),Object(Ut.a)(Cc,ct.NUMBER_RANGE,function(){return{validator:ra(ys()),message:fs.RANGE}}),Object(Ut.a)(Cc,ct.INTEGER_RANGE,function(){return{validator:ra(bs()),message:fs.RANGE}}),Object(Ut.a)(Cc,ct.INTEGER_POSITIVE_RANGE,function(){return{validator:ra(gs()),message:fs.RANGE}}),Object(Ut.a)(Cc,ct.INTEGER_ZERO_OR_POSITIVE_RANGE,function(){return{validator:ra(Os()),message:fs.RANGE}}),Object(Ut.a)(Cc,ct.INTEGER_NEGATIVE_RANGE,function(){return{validator:ra(vs()),message:fs.RANGE}}),Cc);function _s(e){var t=Es[e.type]&&Es[e.type](e);return t?t=(t=(t=Object(et.a)(t)?t:[t]).map(function(e){return Object(se.a)({},e,{type:"dataType"})})).map(function(e){return Object(se.a)({},e,{validator:function(t){if(!t&&0!==t&&!1!==t)return!0;var n=Object(ps.a)(t)?t.trim():t;return e.validator(n)}})}):[]}function js(e){return e.compulsory?[{validator:hs,message:fs.COMPULSORY}]:[]}function Is(e){return e.unique?[{validator:function(t,n){return!t&&0!==t&&!1!==t||e.unique.onValidate(t,n)},message:fs.UNIQUENESS,validatingMessage:ms.UNIQUENESS,type:"unique"}]:[]}function Cs(e){return function(e,t){return e.reduce(function(e,n){return[].concat(Object(We.a)(e),Object(We.a)(n(t)))},[])}([js,_s,Is],e)}var Ts,Ss,Rs=function(e,t){var n=e&&e.theme&&e.theme.typography.pxToRem;return n?n(t):t},ks="onBlur",Ns=function(e){return{id:e.id,validators:Cs(e),commitEvent:ks}},As={labelContainerStyle:{flexBasis:200},inputContainerStyle:{flexBasis:150}},ws={labelContainerStyle:{width:150},inputContainerStyle:{width:150}},Fs=function(e,t,n){return Object(se.a)({},function(e){return{styles:As,label:e.formName,metaCompulsory:e.compulsory,metaDisabled:e.disabled||e.unique&&e.unique.generatable,icon:e.icon?{data:e.icon.data,color:e.icon.color}:null}}(n),t&&t.formHorizontal?function(e){return{style:{width:Rs(e,150)},styles:ws}}(t):{},e)},xs=function(e,t){return Object(se.a)({},Ns(t),e)},Ps=function(){return function(e){return function(t){function n(){return Object(A.a)(this,n),Object(F.a)(this,Object(x.a)(n).apply(this,arguments))}return Object(P.a)(n,t),Object(w.a)(n,[{key:"render",value:function(){var t=this.props,n=t.metaCompulsory,a=t.rulesCompulsory,r=Object(Fe.a)(t,["metaCompulsory","rulesCompulsory"]);return f.createElement(e,Object.assign({required:!(!n&&!a)},r))}}]),n}(f.Component)}},Ds=function(){return function(e){return function(t){function n(){return Object(A.a)(this,n),Object(F.a)(this,Object(x.a)(n).apply(this,arguments))}return Object(P.a)(n,t),Object(w.a)(n,[{key:"render",value:function(){var t=this.props,n=t.metaDisabled,a=t.rulesDisabled,r=Object(Fe.a)(t,["metaDisabled","rulesDisabled"]);return f.createElement(e,Object.assign({disabled:!(!n&&!a)},r))}}]),n}(f.Component)}},Us=n(63),Ls=n.n(Us),Ms=function(e){e.formHorizontal,e.fieldLabelMediaBasedClass;return Object(Fe.a)(e,["formHorizontal","fieldLabelMediaBasedClass"])},Bs=function(){return function(e){return hc()(bc()(fc()(Ds()(Ps()($i()(Ia()(pc()(vc({onGetUseVerticalOrientation:function(e){return e.formHorizontal},onGetCustomFieldLabeClass:function(e){return"".concat(e.fieldLabelMediaBasedClass," ").concat(Ls.a.textLabel)}})(uc()(mc(Ms)(Ya()(e))))))))))))}},Vs=function(e){return function(t){return function(n){function a(t){var n;return Object(A.a)(this,a),(n=Object(F.a)(this,Object(x.a)(a).call(this,t))).defaultClass=e&&e(n.props),n}return Object(P.a)(a,n),Object(w.a)(a,[{key:"render",value:function(){var e=this.props,n=e.customFormElementProps,a=Object(Fe.a)(e,["customFormElementProps"]),r=Cn()(n.className,this.defaultClass);return m.a.createElement("div",Object.assign({},n,{className:r}),m.a.createElement(t,a))}}]),a}(m.a.Component)}},Gs=hc()(bc()(fc()(Ds()(Ps()($i()(Ia()(pc()(vc({onGetUseVerticalOrientation:function(e){return e.formHorizontal},onGetCustomFieldLabeClass:function(e){return"".concat(e.fieldLabelMediaBasedClass," ").concat(Ls.a.ageLabel)}})(uc()(mc(function(e){e.formHorizontal,e.fieldLabelMediaBasedClass;return Object(Fe.a)(e,["formHorizontal","fieldLabelMediaBasedClass"])})(Ya()(si)))))))))))),Ws=hc()(bc()(fc()(Ds()(Ps()($i()(Ia()(pc()(vc({onGetUseVerticalOrientation:function(e){return e.formHorizontal},onGetCustomFieldLabeClass:function(e){return"".concat(e.fieldLabelMediaBasedClass," ").concat(Ls.a.booleanLabel)}})(mc(function(e){e.formHorizontal,e.fieldLabelMediaBasedClass;return Object(Fe.a)(e,["formHorizontal","fieldLabelMediaBasedClass"])})(uc()(ti))))))))))),Hs=hc()(bc()(fc()(Ds()(Ps()($i()(Ia()(pc()(vc({onGetUseVerticalOrientation:function(e){return e.formHorizontal},onGetCustomFieldLabeClass:function(e){return"".concat(e.fieldLabelMediaBasedClass," ").concat(Ls.a.coordinateLabel)}})(uc()(mc(function(e){e.formHorizontal,e.fieldLabelMediaBasedClass;return Object(Fe.a)(e,["formHorizontal","fieldLabelMediaBasedClass"])})(Ya()(Ti)))))))))))),zs=hc()(bc()(fc()(Ds()(Ps()($i()(Ia()(pc()(vc({onGetUseVerticalOrientation:function(e){return e.formHorizontal},onGetCustomFieldLabeClass:function(e){return"".concat(e.fieldLabelMediaBasedClass," ").concat(Ls.a.dateLabel)}})(uc()(mc(function(e){e.formHorizontal,e.fieldLabelMediaBasedClass;return Object(Fe.a)(e,["formHorizontal","fieldLabelMediaBasedClass"])})(Ya()(yi)))))))))))),Ks=hc()(bc()(fc()(Ds()(Ps()($i()(Ia()(pc()(vc({onGetUseVerticalOrientation:function(e){return e.formHorizontal},onGetCustomFieldLabeClass:function(e){return"".concat(e.fieldLabelMediaBasedClass," ").concat(Ls.a.dateTimeLabel)}})(uc()(mc(function(e){e.formHorizontal,e.fieldLabelMediaBasedClass;return Object(Fe.a)(e,["formHorizontal","fieldLabelMediaBasedClass"])})(Ya()(_i)))))))))))),Ys=new function e(){var t=this;Object(A.a)(this,e),this.get=function(e){return t.fileUrls[e]},this.set=function(e,n){t.fileUrls[e]=URL.createObjectURL(n)},this.clear=function(){t.fileUrls=Object.keys(t.fileUrls).reduce(function(e,n){return URL.revokeObjectURL(t.fileUrls[n]),e},{})},this.fileUrls={}},qs=function(e){function t(){var e,n;Object(A.a)(this,t);for(var a=arguments.length,r=new Array(a),o=0;o<a;o++)r[o]=arguments[o];return(n=Object(F.a)(this,(e=Object(x.a)(t)).call.apply(e,[this].concat(r)))).handleFileChange=function(e){e.preventDefault();var t=e.target.files[0];e.target.value=null,t&&n.props.onCommitAsync(function(){var e=new FormData;return e.append("file",t),ye().post("fileResources",e).then(function(e){var n=e&&e.response&&e.response.fileResource;return n?(Ys.set(n.id,t),{name:n.name,value:n.id}):null})})},n.handleButtonClick=function(){n.hiddenFileSelectorRef.click()},n.handleRemoveClick=function(){n.props.onBlur(null)},n.getFileUrl=function(){var e=n.props.value;return e?e.url||Ys.get(e.value):null},n}return Object(P.a)(t,e),Object(w.a)(t,[{key:"render",value:function(){var e=this,t=this.props,n=t.value,a=t.classes,r=t.asyncUIState,o=t.orientation,i=t.disabled,s=r&&r.loading,l=this.getFileUrl(),u=o===Ga.VERTICAL,d=u?a.verticalContainer:a.horizontalContainer,p=u?a.verticalSelectedFileTextContainer:a.horizontalSelectedFileTextContainer;return m.a.createElement("div",null,m.a.createElement("input",{className:a.input,type:"file",ref:function(t){e.hiddenFileSelectorRef=t},onChange:function(t){return e.handleFileChange(t)}}),s?m.a.createElement("div",{className:d},m.a.createElement("div",{className:a.innerContainer},m.a.createElement(C,null)),m.a.createElement("div",{className:a.innerContainer},c.a.t("Uploading file"))):n?m.a.createElement("div",{className:d},m.a.createElement("div",{className:p},m.a.createElement(Mr.a,{className:a.checkIcon}),m.a.createElement("a",{className:!u&&a.horizontalLink,target:"_blank",href:l,rel:"noopener noreferrer"},n.name)," ".concat(c.a.t("selected"),".")),m.a.createElement("div",{className:a.innerContainer},m.a.createElement(Tn,{disabled:i,onClick:e.handleRemoveClick,className:a.deleteButton},c.a.t("Delete")))):m.a.createElement("div",null,m.a.createElement(Yc,{onClick:e.handleButtonClick,color:"primary",disabled:i},c.a.t("Select file"))))}}]),t}(f.Component),Xs=Object(E.withStyles)(function(e){return{horizontalContainer:{display:"flex",alignItems:"center",flexWrap:"wrap"},verticalContainer:{display:"flex",flexWrap:"wrap",flexDirection:"column",alignItems:"flex-start"},innerContainer:{padding:e.typography.pxToRem(2),paddingRight:e.typography.pxToRem(10)},horizontalSelectedFileTextContainer:{padding:e.typography.pxToRem(2),paddingRight:e.typography.pxToRem(10),display:"flex",alignItems:"center",flexWrap:"wrap",wordBreak:"break-word"},verticalSelectedFileTextContainer:{padding:e.typography.pxToRem(2),paddingRight:e.typography.pxToRem(10),display:"flex",flexWrap:"wrap",flexDirection:"column",alignItems:"flex-start",wordBreak:"break-word"},checkIcon:{color:e.palette.success[700]},deleteButton:{color:e.palette.error.main,textDecoration:"underline",cursor:"pointer"},input:{display:"none"},horizontalLink:{paddingRight:e.typography.pxToRem(5)}}})(qs),Zs=Bs()(Xs),Js=function(e){function t(){var e,n;Object(A.a)(this,t);for(var a=arguments.length,r=new Array(a),o=0;o<a;o++)r[o]=arguments[o];return(n=Object(F.a)(this,(e=Object(x.a)(t)).call.apply(e,[this].concat(r)))).handleImageChange=function(e){e.preventDefault();var t=e.target.files[0];e.target.value=null,t&&n.props.onCommitAsync(function(){var e=new FormData;return e.append("file",t),ye().post("fileResources",e).then(function(e){var n=e&&e.response&&e.response.fileResource;return n?(Ys.set(n.id,t),{name:n.name,value:n.id}):null})})},n.handleButtonClick=function(){n.hiddenimageSelectorRef.click()},n.handleRemoveClick=function(){n.props.onBlur(null)},n.getimageUrl=function(){var e=n.props.value;return e?e.url||Ys.get(e.value):null},n.render=function(){var e=n.props,t=e.value,a=e.classes,r=e.asyncUIState,o=e.orientation,i=e.disabled,s=o===Ga.VERTICAL,l=r&&r.loading,u=n.getimageUrl(),d=s?a.verticalContainer:a.horizontalContainer,p=s?a.verticalSelectedImageTextContainer:a.horizontalSelectedImageTextContainer;return m.a.createElement("div",null,m.a.createElement("input",{className:a.input,type:"file",accept:"image/*",ref:function(e){n.hiddenimageSelectorRef=e},onChange:function(e){return n.handleImageChange(e)}}),l?m.a.createElement("div",{className:d},m.a.createElement("div",{className:a.innerContainer},m.a.createElement(C,null)),m.a.createElement("div",{className:a.innerContainer},c.a.t("Uploading image"))):t?m.a.createElement("div",{className:d},!s&&m.a.createElement("div",{className:a.innerContainer},m.a.createElement("a",{target:"_blank",href:u,rel:"noopener noreferrer"},m.a.createElement("img",{src:u,alt:"",className:a.image}))),m.a.createElement("div",{className:p},m.a.createElement(Mr.a,{className:a.checkIcon}),s?m.a.createElement("a",{target:"_blank",href:u,rel:"noopener noreferrer"},t.name):t.name," ".concat(c.a.t("selected"),".")),m.a.createElement("div",{className:a.innerContainer},m.a.createElement(Tn,{disabled:i,className:a.deleteButton,onClick:n.handleRemoveClick},c.a.t("Delete")))):m.a.createElement("div",null,m.a.createElement(Yc,{disabled:i,onClick:n.handleButtonClick,color:"primary"},c.a.t("Select image"))))},n}return Object(P.a)(t,e),t}(f.Component),Qs=Object(E.withStyles)(function(e){return{horizontalContainer:{display:"flex",alignItems:"center",flexWrap:"wrap"},verticalContainer:{display:"flex",flexWrap:"wrap",flexDirection:"column",alignItems:"flex-start"},innerContainer:{padding:e.typography.pxToRem(2),paddingRight:e.typography.pxToRem(10)},horizontalSelectedImageTextContainer:{padding:e.typography.pxToRem(2),paddingRight:e.typography.pxToRem(10),display:"flex",alignItems:"center",flexWrap:"wrap",wordBreak:"break-word"},verticalSelectedImageTextContainer:{padding:e.typography.pxToRem(2),paddingRight:e.typography.pxToRem(10),display:"flex",flexWrap:"wrap",flexDirection:"column",alignItems:"flex-start",wordBreak:"break-word"},checkIcon:{color:e.palette.success[700]},deleteButton:{color:e.palette.error.main},input:{display:"none"},image:{maxHeight:e.typography.pxToRem(52),maxWidth:e.typography.pxToRem(70)}}})(Js),$s=Bs()(Qs),el=function(){return{iconContainer:{display:"flex",alignItems:"center",paddingRight:5},icon:{width:22,height:22,borderRadius:2}}},tl=function(){return function(e){return Object(E.withStyles)(el)(function(t){function n(e){var t;return Object(A.a)(this,n),(t=Object(F.a)(this,Object(x.a)(n).call(this,e))).options=t.getOptions(),t}return Object(P.a)(n,t),Object(w.a)(n,[{key:"getIcon",value:function(e){var t=this.props,n=t.label,a=t.classes;return e?f.createElement("div",{className:a.iconContainer},f.createElement("img",{style:{backgroundColor:e.color},className:a.icon,src:e.data,alt:n})):null}},{key:"getOptions",value:function(){var e=this;return this.props.options.map(function(t){return Object(se.a)({},t,{iconRight:e.getIcon(t.icon),iconLeft:null})})}},{key:"render",value:function(){var t=this.props,n=(t.options,t.classes,Object(Fe.a)(t,["options","classes"]));return f.createElement(e,Object.assign({options:this.options},n))}}]),n}(f.Component))}},nl=n(32),al=Object(nl.createSelectorCreator)(nl.defaultMemoize,function(e,t){return Object.keys(t).every(function(n){return t[n]===e[n]})}),rl=function(e,t){var n=e.rulesEffectsOptionsVisibility[t.formId]||{};return{hideOptions:n.hideOptions&&n.hideOptions[t.id],hideOptionGroups:n.hideOptionGroups&&n.hideOptionGroups[t.id],showOptionGroups:n.showOptionGroups&&n.showOptionGroups[t.id]}},ol=[{key:"showOptionGroups",createFilter:function(e,t){var n=e.map(function(e){return t.get(e.optionGroupId)});return function(e){return n.some(function(t){return t&&!!t.optionIds.get(e.id)})}}},{key:"hideOptionGroups",createFilter:function(e,t){var n=e.map(function(e){return t.get(e.optionGroupId)});return function(e){return!n.some(function(t){return t&&!!t.optionIds.get(e.id)})}}},{key:"hideOptions",createFilter:function(e){return function(t){return!e.some(function(e){return e.optionId===t.id})}}}],il=function(){var e=al(rl,function(e){return e});return function(t,n){return{rulesOptionsVisibility:e(t,n)}}},cl=function(){return function(e){return Object(D.b)(il,function(){return{}})(function(e){var t,n;return n=t=function(t){function n(e){var t;return Object(A.a)(this,n),(t=Object(F.a)(this,Object(x.a)(n).call(this,e))).filteredOptions=n.getFilteredOptions(e),t}return Object(P.a)(n,t),Object(w.a)(n,[{key:"componentWillReceiveProps",value:function(e){e.rulesOptionsVisibility!==this.props.rulesOptionsVisibility&&(this.filteredOptions=n.getFilteredOptions(e))}},{key:"render",value:function(){var t=this.props,n=(t.options,Object(Fe.a)(t,["options"]));return f.createElement(e,Object.assign({options:this.filteredOptions},n))}}]),n}(f.Component),t.getFilteredOptions=function(e){var t=e.options,n=e.rulesOptionsVisibility,a=e.optionGroups,r=ol.filter(function(e){return n[e.key]&&n[e.key].length>0}).map(function(e){return e.createFilter(n[e.key],a)});return t.filter(function(e){return r.every(function(t){return t(e)})})},n}(e))}},sl=hc()(bc()(fc()(Ds()(Ps()(Ia()($i()(pc()(vc({onGetUseVerticalOrientation:function(e){return e.formHorizontal},onGetCustomFieldLabeClass:function(e){return"".concat(e.fieldLabelMediaBasedClass," ").concat(Ls.a.textLabel)}})(uc()(tl()(cl()(mc(function(e){e.formHorizontal,e.fieldLabelMediaBasedClass;return Object(Fe.a)(e,["formHorizontal","fieldLabelMediaBasedClass"])})(bi()(hi)))))))))))))),ll=hc()(bc()(fc()(Ds()(Ps()(Ia()($i()(pc()(vc({onGetUseVerticalOrientation:function(e){return e.formHorizontal},onGetCustomFieldLabeClass:function(e){return"".concat(e.fieldLabelMediaBasedClass," ").concat(Ls.a.optionSetBoxesLabel)}})(uc()(mc(function(e){e.formHorizontal,e.fieldLabelMediaBasedClass;return Object(Fe.a)(e,["formHorizontal","fieldLabelMediaBasedClass"])})(cl()(Oi)))))))))))),ul="RequestFilterFormFieldOrgUnits",dl="FilteredFormFieldOrgUnitsRetrieved",pl="FilterFormFieldOrgUnitsFailed",fl="ResetFormFieldOrgUnitsFilter",ml=function(e,t){return[e,t].join("-")},hl=function(e,t){var n=ml(t.formId,t.elementId),a=e.formsFieldsMisc[t.formId][t.elementId]||{},r=Ic(n)||Ic("searchRoots");return{searchText:a.orgUnitsSearchText,ready:!a.orgUnitsLoading,treeKey:a.orgUnitsSearchText||"initial",roots:r}},bl=function(e){return{filterOrgUnits:function(t,n,a){e(function(e,t,n){return le(ul)({formId:e,elementId:t,searchText:n})}(t,n,a))},resetOrgUnits:function(t,n){e(function(e,t){return le(fl)({formId:e,elementId:t})}(t,n))}}},gl=hc()(bc()(fc()(Ds()(Ps()($i()(pc()(vc({onGetUseVerticalOrientation:function(e){return e.formHorizontal},onGetCustomFieldLabeClass:function(e){return"".concat(e.fieldLabelMediaBasedClass," ").concat(Ls.a.orgUnitLabel)}})(mc(function(e){e.formHorizontal,e.fieldLabelMediaBasedClass;return Object(Fe.a)(e,["formHorizontal","fieldLabelMediaBasedClass"])})(uc()(Ya()((Ts=Li,Object(D.b)(hl,bl)(function(e){return function(t){function n(){var e,t;Object(A.a)(this,n);for(var a=arguments.length,r=new Array(a),o=0;o<a;o++)r[o]=arguments[o];return(t=Object(F.a)(this,(e=Object(x.a)(n)).call.apply(e,[this].concat(r)))).handleFilterOrgUnits=function(e){e?t.props.filterOrgUnits(t.props.formId,t.props.elementId,e):t.props.resetOrgUnits(t.props.formId,t.props.elementId)},t}return Object(P.a)(n,t),Object(w.a)(n,[{key:"componentWillUnmount",value:function(){var e=this.props,t=e.formId,n=e.elementId;jc(ml(t,n),null)}},{key:"render",value:function(){var t=this.props,n=(t.formId,t.elementId,t.filterOrgUnits,t.resetOrgUnits,Object(Fe.a)(t,["formId","elementId","filterOrgUnits","resetOrgUnits"]));return f.createElement(e,Object.assign({onSearch:this.handleFilterOrgUnits},n))}}]),n}(f.Component)}(Ts)))))))))))))),Ol=hc()(bc()(fc()(Ds()(Ps()($i()(Ia()(pc()((Ss=function(){return{paddingTop:10,paddingBottom:10}},function(e){return function(e,t){return function(n){function a(){return Object(A.a)(this,a),Object(F.a)(this,Object(x.a)(a).apply(this,arguments))}return Object(P.a)(a,n),Object(w.a)(a,[{key:"render",value:function(){var n=Object(_.a)({},this.props);return f.createElement("div",{style:t(this.props)},f.createElement(e,n))}}]),a}(f.Component)}(e,Ss)})(vc({onGetUseVerticalOrientation:function(e){return e.formHorizontal},onGetCustomFieldLabeClass:function(e){return"".concat(e.fieldLabelMediaBasedClass," ").concat(Ls.a.polygonLabel)}})(uc()(mc(function(e){e.formHorizontal,e.fieldLabelMediaBasedClass;return Object(Fe.a)(e,["formHorizontal","fieldLabelMediaBasedClass"])})(Ya()(ki))))))))))))),vl=hc()(bc()(fc()(Ds()(Ps()(Ia()($i()(pc()(vc({onGetUseVerticalOrientation:function(e){return e.formHorizontal},onGetCustomFieldLabeClass:function(e){return"".concat(e.fieldLabelMediaBasedClass," ").concat(Ls.a.textLabel)}})(mc(function(e){e.formHorizontal,e.fieldLabelMediaBasedClass;return Object(Fe.a)(e,["formHorizontal","fieldLabelMediaBasedClass"])})(uc()(Ya()(Qo)))))))))))),yl=hc()(bc()(fc()(Ds()(Ps()($i()(Ia()(pc()(vc({onGetUseVerticalOrientation:function(e){return e.formHorizontal},onGetCustomFieldLabeClass:function(e){return"".concat(e.fieldLabelMediaBasedClass," ").concat(Ls.a.trueOnlyLabel)}})(mc(function(e){e.formHorizontal,e.fieldLabelMediaBasedClass;return Object(Fe.a)(e,["formHorizontal","fieldLabelMediaBasedClass"])})(uc()(ui))))))))))),El=n(1477),_l=n.n(El),jl=n(1478),Il=n.n(jl),Cl=n(1479),Tl=n.n(Cl),Sl=n(119),Rl=n.n(Sl);function kl(e){var t=e.onChange,n=e.onBlur,a=e.ref,r=Object(Fe.a)(e,["onChange","onBlur","ref"]);return m.a.createElement(Qr,Object.assign({},r,{onChange:function(e){return t(e,{newValue:e.currentTarget.value})},onBlur:function(e){return n(e.currentTarget.value)},inputRef:a}))}function Nl(e,t){var n=t.query,a=t.isHighlighted,r=Il()(e.userCredentials.username,n),o=Tl()(e.userCredentials.username,r);return m.a.createElement(Rl.a,{selected:a,component:"div"},m.a.createElement("div",null,o.map(function(e,t){return e.highlight?m.a.createElement("span",{key:String(t),style:{fontWeight:500}},e.text):m.a.createElement("strong",{key:String(t),style:{fontWeight:300}},e.text)})))}function Al(e){var t=e.containerProps,n=e.children;return m.a.createElement(Be.a,Object.assign({},t,{square:!0}),n)}function wl(e){return e.userCredentials.username}var Fl=function(e){function t(){var e,n;Object(A.a)(this,t);for(var a=arguments.length,r=new Array(a),o=0;o<a;o++)r[o]=arguments[o];return(n=Object(F.a)(this,(e=Object(x.a)(t)).call.apply(e,[this].concat(r)))).state={value:n.props.value||"",users:[]},n.handleChange=function(e,t){var a=t.newValue;n.setState({value:a})},n.onSuggestionSelected=function(e,t){var a=t.suggestionValue;n.setState({value:a}),n.props.onBlur(a)},n}return Object(P.a)(t,e),Object(w.a)(t,[{key:"componentDidMount",value:function(){var e=this;ye().get("users",{fields:"name,id,userCredentials[username]"}).then(function(t){e.setState({users:t.users})})}},{key:"render",value:function(){var e=this.props.classes,t=this.state.value,n=this.state.users.filter(function(e){return 0===t.length||e.userCredentials.username.includes(t)}),a=Object(se.a)({},this.props,{value:t,placeholder:"search for username",onChange:this.handleChange});return m.a.createElement("div",null,m.a.createElement(_l.a,{theme:{container:e.container,suggestionsContainerOpen:e.suggestionsContainerOpen,suggestionsList:e.suggestionsList,suggestion:e.suggestion},renderInputComponent:kl,suggestions:n,onSuggestionsFetchRequested:function(){return null},onSuggestionsClearRequested:function(){return null},onSuggestionSelected:this.onSuggestionSelected,renderSuggestionsContainer:Al,getSuggestionValue:wl,renderSuggestion:Nl,inputProps:a}))}}]),t}(m.a.Component),xl=Object(E.withStyles)(function(e){return{container:{flexGrow:1,position:"relative"},suggestionsContainerOpen:{position:"absolute",zIndex:1e3,marginTop:e.spacing.unit,left:0,right:0},suggestion:{display:"block",color:"rgba(0, 0, 0, 0.87)"},suggestionsList:{margin:0,padding:0,listStyleType:"none",maxHeight:250,overflow:"hidden"},inputWrapperFocused:{border:"2px solid ".concat(e.palette.primary.light),borderRadius:"5px"},inputWrapperUnfocused:{padding:2}}})(Fl),Pl=Bs()(xl),Dl=hc()(bc()(fc()(Ds()(Ps()($i()(Ia()(pc()(vc({onGetUseVerticalOrientation:function(e){return e.formHorizontal},onGetCustomFieldLabeClass:function(e){return"".concat(e.fieldLabelMediaBasedClass," ").concat(Ls.a.ageLabel)}})(uc()(mc(function(e){e.formHorizontal,e.fieldLabelMediaBasedClass;return Object(Fe.a)(e,["formHorizontal","fieldLabelMediaBasedClass"])})(Ya()(Mi)))))))))))),Ul=hc()(bc()(fc()(Ds()(Ps()($i()(Ia()(pc()(vc({onGetUseVerticalOrientation:function(e){return e.formHorizontal},onGetCustomFieldLabeClass:function(e){return"".concat(e.fieldLabelMediaBasedClass," ").concat(Ls.a.dateLabel)}})(uc()(mc(function(e){e.formHorizontal,e.fieldLabelMediaBasedClass;return Object(Fe.a)(e,["formHorizontal","fieldLabelMediaBasedClass"])})(Ya()(Bi)))))))))))),Ll=hc()(bc()(fc()(Ds()(Ps()($i()(Ia()(pc()(vc({onGetUseVerticalOrientation:function(e){return e.formHorizontal},onGetCustomFieldLabeClass:function(e){return"".concat(e.fieldLabelMediaBasedClass," ").concat(Ls.a.dateTimeLabel)}})(uc()(mc(function(e){e.formHorizontal,e.fieldLabelMediaBasedClass;return Object(Fe.a)(e,["formHorizontal","fieldLabelMediaBasedClass"])})(Ya()(Hi)))))))))))),Ml=pc()(vc({onGetUseVerticalOrientation:function(e){return e.formHorizontal},onGetCustomFieldLabeClass:function(e){return"".concat(e.fieldLabelMediaBasedClass," ").concat(Ls.a.viewModeLabel)}})(mc(function(e){e.formHorizontal,e.fieldLabelMediaBasedClass;return Object(Fe.a)(e,["formHorizontal","fieldLabelMediaBasedClass"])})(Gi))),Bl=hc()(bc()(fc()(Ds()(Ps()($i()(Ia()(uc()(Vs()(Ya()(si)))))))))),Vl=hc()(bc()(fc()(Ds()(Ps()($i()(Ia()(uc()(Vs()(ti))))))))),Gl=n(1480),Wl=n.n(Gl),Hl=hc()(bc()(fc()(Ds()(Ps()($i()(Ia()(uc()(Vs(function(){return Wl.a.defaultCustomContainer})(Ya()(Ti)))))))))),zl=hc()(bc()(fc()(Ds()(Ps()($i()(Ia()(uc()(Vs()(Ya()(yi)))))))))),Kl=hc()(bc()(fc()(Ds()(Ps()($i()(Ia()(uc()(Vs()(Ya()(_i)))))))))),Yl=hc()(bc()(fc()(Ds()(Ps()($i()(Ia()(uc()(Vs()(Ya()(Xs)))))))))),ql=hc()(bc()(fc()(Ds()(Ps()($i()(Ia()(uc()(Vs()(Ya()(Qs)))))))))),Xl=n(1481),Zl=n.n(Xl),Jl=hc()(bc()(fc()(Ds()(Ps()(Ia()($i()(uc()(bi()(Vs(function(){return Zl.a.defaultCustomContainer})(tl()(cl()(hi)))))))))))),Ql=hc()(bc()(fc()(Ds()(Ps()(Ia()($i()(uc()(cl()(Oi))))))))),$l=n(141);n(8057);function eu(e){var t=e.label,n=e.value,a=e.open,r=e.depth,o=e.isSelected,i=e.children,c=e.onClick,s=e.onIconClick,l=i&&Array.isArray(i),u=20*r;return l||(u+=7),m.a.createElement("div",null,m.a.createElement("div",{role:"button",tabIndex:-1,className:Cn()("label",{selected:o}),onClick:function(){return c(n)}},m.a.createElement("div",{style:{minWidth:u}}),l?m.a.createElement("div",{role:"button",tabIndex:-1,className:"icon",onClick:function(e){return s(e,!a,n)}},a?"\u2212":"+"):m.a.createElement("div",{className:"icon"}),m.a.createElement("div",{className:"text"},t)),a&&i&&m.a.createElement("div",{className:"children"},i))}var tu,nu,au=function(e){function t(){var e,n;Object(A.a)(this,t);for(var a=arguments.length,r=new Array(a),o=0;o<a;o++)r[o]=arguments[o];return(n=Object(F.a)(this,(e=Object(x.a)(t)).call.apply(e,[this].concat(r)))).onIconClick=function(e,t,a){e&&e.stopPropagation();var r=n.updateState(n.props.list,t,a);n.props.onIconClick(a,t,Object(We.a)(r))},n.onClick=function(e){var t=n.props,a=t.multiple;if(t.selectable){var r=n.props.selected,o=!!r&&r.includes(e);"undefined"!==typeof a&&a?(o?r=r.filter(function(t){return t!==e}):(r=r.slice(0)).push(e),n.props.setSelected(r,!o,e)):n.props.setSelected(o?[]:[e],!o,e)}},n}return Object(P.a)(t,e),Object(w.a)(t,[{key:"updateState",value:function(e,t,n){if(!Array.isArray(e))return e;for(var a=!1,r=0;r<e.length;r+=1)e[r].value===n&&(e[r].open=t,a=!0),a||"undefined"===typeof e[r].children||this.updateState(e[r].children,t,n);return e}},{key:"node",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return Array.isArray(e)?e.map(function(e){var a=e.open,r=e.label,o=e.value,i=e.children;return m.a.createElement(eu,{key:"node-".concat(o),depth:n,open:a,label:r,value:o,onClick:t.onClick,onIconClick:t.onIconClick,isSelected:!!t.props.selected&&t.props.selected.includes(o)},i?t.node(i,n+1):null)}):null}},{key:"view",value:function(){return this.node(this.props.list)}},{key:"render",value:function(){return 0===this.props.list.length?null:m.a.createElement("div",{className:"ou-tree-container"},m.a.createElement("div",{className:"ou-tree"},this.view()))}}]),t}(m.a.Component),ru=function(e){function t(){var e,n;Object(A.a)(this,t);for(var a=arguments.length,i=new Array(a),c=0;c<a;c++)i[c]=arguments[c];return(n=Object(F.a)(this,(e=Object(x.a)(t)).call.apply(e,[this].concat(i)))).state={list:[],selected:n.props.value},n.setSelected=function(e){n.setState({selected:e}),Array.isArray(e)&&e.length>0?n.props.onBlur(e[0]):n.props.onBlur(null)},n.onIconClick=function(){var e=Object(o.a)(r.a.mark(function e(t,a,o){return r.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(n.setState({list:o}),!a){e.next=4;break}return e.next=4,n.fetchNode(t);case 4:case"end":return e.stop()}},e)}));return function(t,n,a){return e.apply(this,arguments)}}(),n.fetchRoot=Object(o.a)(r.a.mark(function e(){return r.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,Object($l.getInstance)();case 3:e.sent.models.organisationUnits.list({level:1,paging:!1,fields:"id,path,displayName,children::isNotEmpty"}).then(function(e){var t=n.props.value,a=e.toArray();n.setState({list:a.map(function(e){var a=e.path,r=e.displayName,o=t&&t.startsWith(a)&&t!==a;return o&&n.fetchNode(a,!0),{open:o,value:a,label:r,children:[]}})})}),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),console.log("OrgUnitTree root fetch failed");case 10:case"end":return e.stop()}},e,null,[[0,7]])})),n.fetchNode=function(){var e=Object(o.a)(r.a.mark(function e(t){var a,o,i=arguments;return r.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return a=i.length>1&&void 0!==i[1]&&i[1],e.prev=1,o=t.substr(t.lastIndexOf("/")+1),e.next=5,Object($l.getInstance)();case 5:e.sent.models.organisationUnits.list({paging:!1,filter:"id:in:[".concat(o,"]"),fields:":all,displayName,path,children[id,displayName,path,children]"}).then(function(e){var r=e.toArray()[0].children.valuesContainerMap,o=[],i=!0,c=!1,s=void 0;try{for(var l,u=r.entries()[Symbol.iterator]();!(i=(l=u.next()).done);i=!0){var d=l.value,p=Object(ca.a)(d,2),f=(p[0],p[1]),m=n.props.value,h=f.children.valuesContainerMap.size>0?[]:null,b=null!==h&&m&&m.startsWith(f.path);b&&a&&m.substr(f.path.length).indexOf("/")>-1?n.fetchNode(f.path,a):b=!1,o.push({open:b,children:h,value:f.path,label:f.displayName})}}catch(O){c=!0,s=O}finally{try{i||null==u.return||u.return()}finally{if(c)throw s}}o.sort(function(e,t){return e.label.localeCompare(t.label)});var g=n.state.list;n.setChildren(t,o,g),n.setState({list:Object(We.a)(g)})}),e.next=13;break;case 9:e.prev=9,e.t0=e.catch(1),console.log("OrgUnitTree fetchNode failed"),console.log(e.t0);case 13:case"end":return e.stop()}},e,null,[[1,9]])}));return function(t){return e.apply(this,arguments)}}(),n}return Object(P.a)(t,e),Object(w.a)(t,[{key:"componentWillMount",value:function(){var e=Object(o.a)(r.a.mark(function e(){return r.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.fetchRoot();case 2:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"componentWillReceiveProps",value:function(e){var t=e.value;this.setState({selected:t})}},{key:"setChildren",value:function(e,t,n){if(Array.isArray(n))for(var a=0;a<n.length;a+=1){if(n[a].value===e)return void(n[a].children=t.slice(0));n[a].children&&n[a].children.length>0&&this.setChildren(e,t,n[a].children)}}},{key:"render",value:function(){var e=this.props,t=e.label,n=e.selectable,a=e.required,r=this.state,o=r.list,i=r.selected;return m.a.createElement(au,{required:a,label:t,multiple:!1,selectable:"undefined"===typeof n||n,list:o,selected:i,onIconClick:this.onIconClick,setSelected:this.setSelected})}}]),t}(m.a.Component),ou=hc()(bc()(fc()(Ds()(Ps()($i()(uc()(Vs()(Ya()(ru))))))))),iu=n(1482),cu=n.n(iu),su=hc()(bc()(fc()(Ds()(Ps()($i()(Ia()(uc()(Vs(function(){return cu.a.defaultCustomContainer})(Ya()(ki)))))))))),lu=n(1483),uu=n.n(lu),du=hc()(bc()(fc()(Ds()(Ps()(Ia()($i()(uc()(Vs(function(){return uu.a.defaultCustomContainer})(Ya()(Qo)))))))))),pu=hc()(bc()(fc()(Ds()(Ps()($i()(Ia()(uc()(Vs()(ui))))))))),fu=n(1484),mu=n.n(fu),hu=hc()(bc()(fc()(Ds()(Ps()($i()(Ia()(uc()(Vs(function(){return mu.a.defaultCustomContainer})(Ya()(xl)))))))))),bu=n(1485),gu=n.n(bu),Ou=Vs(function(){return gu.a.defaultCustomContainer})(Gi),vu=function(e,t){var n,a=Fs({formHorizontal:t.formHorizontal,fieldLabelMediaBasedClass:t.fieldLabelMediaBasedClass,orientation:t.formHorizontal?Ga.VERTICAL:Ga.HORIZONTAL,shrinkDisabled:t.formHorizontal,dateCalendarWidth:t.formHorizontal?250:350,datePopupAnchorPosition:(n=t.formHorizontal,n?"center":"left")},t,e);return xs({component:Gs,props:a},e)},yu=function(e,t){var n=Fs({formHorizontal:t.formHorizontal,fieldLabelMediaBasedClass:t.fieldLabelMediaBasedClass,orientation:t.formHorizontal?Ga.VERTICAL:Ga.HORIZONTAL,id:e.id},t,e);return xs({component:Ws,props:n},e)},Eu=function(e,t){var n=Fs({formHorizontal:t.formHorizontal,fieldLabelMediaBasedClass:t.fieldLabelMediaBasedClass,orientation:t.formHorizontal?Ga.VERTICAL:Ga.HORIZONTAL,shrinkDisabled:t.formHorizontal,dialogLabel:e.formName},t,e);return xs({component:Hs,props:n},e)},_u=function(e,t){var n,a=Fs({formHorizontal:t.formHorizontal,fieldLabelMediaBasedClass:t.fieldLabelMediaBasedClass,width:t.formHorizontal?150:"100%",maxWidth:t.formHorizontal?150:350,calendarWidth:t.formHorizontal?250:350,popupAnchorPosition:(n=t.formHorizontal,n?"center":"left")},t,e);return xs({component:zs,props:a},e)},ju=function(e,t){var n,a=Fs({formHorizontal:t.formHorizontal,fieldLabelMediaBasedClass:t.fieldLabelMediaBasedClass,dateWidth:t.formHorizontal?150:"100%",dateMaxWidth:t.formHorizontal?150:350,orientation:t.formHorizontal?Ga.VERTICAL:Ga.HORIZONTAL,shrinkDisabled:t.formHorizontal,calendarWidth:t.formHorizontal?250:350,popupAnchorPosition:(n=t.formHorizontal,n?"center":"left")},t,e);return xs({component:Ks,props:a},e)},Iu=function(e,t){var n=Fs({formHorizontal:t.formHorizontal,fieldLabelMediaBasedClass:t.fieldLabelMediaBasedClass,async:!0,orientation:t.formHorizontal?Ga.VERTICAL:Ga.HORIZONTAL},t,e);return xs({component:Zs,props:n},e)},Cu=function(e,t){var n=Fs({formHorizontal:t.formHorizontal,fieldLabelMediaBasedClass:t.fieldLabelMediaBasedClass,async:!0,orientation:t.formHorizontal?Ga.VERTICAL:Ga.HORIZONTAL},t,e);return xs({component:$s,props:n},e)},Tu="DataElement missing",Su=function(e){return e.dataElement?e.dataElement.getConvertedOptionSet(nc):(O.a.error(Object(ze.b)(Tu)({clientOptionSet:e})),null)},Ru=function(e){return e.options.map(function(e){return{id:e.id,name:e.text,value:e.value}})},ku=function(e){return e.options.map(function(e){return{id:e.id,label:e.text,value:e.value,icon:e.icon?{data:e.icon.data,color:e.icon.color}:null}})},Nu=function(e){return Object(ze.d)(Su,Ru)(e)},Au=function(e){return Object(ze.d)(Su,ku)(e)},wu=(tu={},Object(Ut.a)(tu,at.DROPDOWN,function(e){return{options:Au(e.optionSet),nullable:!e.compulsory,style:{width:"100%"}}}),Object(Ut.a)(tu,at.HORIZONTAL_RADIOBUTTONS,function(e){return{options:Nu(e.optionSet)}}),Object(Ut.a)(tu,at.VERTICAL_RADIOBUTTONS,function(e){return{orientation:Ga.VERTICAL,options:Nu(e.optionSet)}}),tu),Fu=(nu={},Object(Ut.a)(nu,at.DROPDOWN,sl),Object(Ut.a)(nu,at.HORIZONTAL_RADIOBUTTONS,ll),Object(Ut.a)(nu,at.VERTICAL_RADIOBUTTONS,ll),nu),xu=function(e,t){var n=e.optionSet,a=n.inputType,r=wu[a](e),o=Fs(Object(se.a)({id:e.id,formId:t.formId,formHorizontal:t.formHorizontal,fieldLabelMediaBasedClass:t.fieldLabelMediaBasedClass,optionGroups:n.optionGroups},r),t,e);return xs({component:Fu[a],props:o,commitEvent:a===at.DROPDOWN?"onBlur":"onSelect"},e)},Pu=function(e,t){var n=Fs({formId:t.formId,elementId:e.id,formHorizontal:t.formHorizontal,fieldLabelMediaBasedClass:t.fieldLabelMediaBasedClass,maxTreeHeight:200},t,e);return xs({component:gl,props:n},e)},Du=function(e,t){var n=Fs({formHorizontal:t.formHorizontal,fieldLabelMediaBasedClass:t.fieldLabelMediaBasedClass,orientation:t.formHorizontal?Ga.VERTICAL:Ga.HORIZONTAL,shrinkDisabled:t.formHorizontal,dialogLabel:e.formName},t,e);return xs({component:Ol,props:n},e)},Uu=function(e,t,n,a){var r=Fs({formHorizontal:t.formHorizontal,fieldLabelMediaBasedClass:t.fieldLabelMediaBasedClass,multiLine:a&&a.multiLine},t,e);return xs({component:vl,props:r},e)},Lu=function(e,t){var n=Fs({formHorizontal:t.formHorizontal,fieldLabelMediaBasedClass:t.fieldLabelMediaBasedClass,orientation:t.formHorizontal?Ga.VERTICAL:Ga.HORIZONTAL,id:e.id},t,e);return xs({component:yl,props:n},e)},Mu=function(e,t){var n=Fs({formHorizontal:t.formHorizontal,fieldLabelMediaBasedClass:t.fieldLabelMediaBasedClass},t,e);return xs({component:Pl,props:n},e)},Bu=function(e,t,n){var a=Fs({formHorizontal:t.formHorizontal,fieldLabelMediaBasedClass:t.fieldLabelMediaBasedClass,multiLine:n&&n.multiLine},t,e);return xs({component:Dl,props:a},e)},Vu=function(e,t){var n,a=Fs({formHorizontal:t.formHorizontal,fieldLabelMediaBasedClass:t.fieldLabelMediaBasedClass,width:t.formHorizontal?150:"100%",maxWidth:t.formHorizontal?150:350,calendarWidth:t.formHorizontal?250:350,popupAnchorPosition:(n=t.formHorizontal,n?"center":"left")},t,e);return xs({component:Ul,props:a},e)},Gu=function(e,t){var n,a=Fs({formHorizontal:t.formHorizontal,fieldLabelMediaBasedClass:t.fieldLabelMediaBasedClass,dateWidth:t.formHorizontal?150:"100%",dateMaxWidth:t.formHorizontal?150:350,orientation:t.formHorizontal?Ga.VERTICAL:Ga.HORIZONTAL,shrinkDisabled:t.formHorizontal,calendarWidth:t.formHorizontal?250:350,popupAnchorPosition:(n=t.formHorizontal,n?"center":"left")},t,e);return xs({component:Ll,props:a},e)},Wu={SHORT:"short",MEDIUM:"medium",LONG:"long"};var Hu,zu=function(){var e,t=(e={},Object(Ut.a)(e,Wu.SHORT,"l"),Object(Ut.a)(e,Wu.MEDIUM,"L"),Object(Ut.a)(e,Wu.LONG,"LL"),e);return function(e,n){return Se(e).format(n&&t[n]||t[Wu.MEDIUM])}}(),Ku=function(){var e,t=(e={},Object(Ut.a)(e,Wu.SHORT,"LLL"),Object(Ut.a)(e,Wu.MEDIUM,"llll"),Object(Ut.a)(e,Wu.LONG,"LLLL"),e);return function(e,n){return Se(e).format(n&&t[n]||t[Wu.MEDIUM])}}();!function(){var e,t=(e={},Object(Ut.a)(e,Wu.SHORT,"LT"),Object(Ut.a)(e,Wu.MEDIUM,"LTS"),Object(Ut.a)(e,Wu.LONG,"LTS"),e)}();function Yu(e){return zu(e,Wu.SHORT)}function qu(e){return m.a.createElement("a",{href:e.url,target:"_blank",rel:"noopener noreferrer",onClick:function(e){e.stopPropagation()}},e.name)}var Xu,Zu=(Hu={},Object(Ut.a)(Hu,ct.NUMBER,ec),Object(Ut.a)(Hu,ct.INTEGER,ec),Object(Ut.a)(Hu,ct.INTEGER_POSITIVE,ec),Object(Ut.a)(Hu,ct.INTEGER_ZERO_OR_POSITIVE,ec),Object(Ut.a)(Hu,ct.INTEGER_NEGATIVE,ec),Object(Ut.a)(Hu,ct.DATE,Yu),Object(Ut.a)(Hu,ct.DATE_RANGE,function(e){return t=Yu,n=e,m.a.createElement("span",null,t(n.from)," ","->"," ",t(n.to));var t,n}),Object(Ut.a)(Hu,ct.DATETIME,function(e){return Ku(e,Wu.SHORT)}),Object(Ut.a)(Hu,ct.TRUE_ONLY,function(){return"Yes"}),Object(Ut.a)(Hu,ct.BOOLEAN,function(e){return e?"Yes":"No"}),Object(Ut.a)(Hu,ct.COORDINATE,function(e){return"[ ".concat(e.longitude,", ").concat(e.latitude," ]")}),Object(Ut.a)(Hu,ct.AGE,Yu),Object(Ut.a)(Hu,ct.FILE_RESOURCE,qu),Object(Ut.a)(Hu,ct.IMAGE,qu),Object(Ut.a)(Hu,ct.ORGANISATION_UNIT,function(e){return e.name}),Hu);function Ju(e,t,n){return e||0===e||!1===e?n&&n.optionSet?n.optionSet.getOptionText(e):Zu[t]?Zu[t](e):e:e}function Qu(e){return zu(e,Wu.SHORT)}function $u(e){return m.a.createElement("a",{href:e.url,target:"_blank",rel:"noopener noreferrer",onClick:function(e){e.stopPropagation()}},e.name)}var ed,td=(Xu={},Object(Ut.a)(Xu,ct.NUMBER,ec),Object(Ut.a)(Xu,ct.INTEGER,ec),Object(Ut.a)(Xu,ct.INTEGER_POSITIVE,ec),Object(Ut.a)(Xu,ct.INTEGER_ZERO_OR_POSITIVE,ec),Object(Ut.a)(Xu,ct.INTEGER_NEGATIVE,ec),Object(Ut.a)(Xu,ct.DATE,Qu),Object(Ut.a)(Xu,ct.DATETIME,function(e){return Ku(e,Wu.SHORT)}),Object(Ut.a)(Xu,ct.TRUE_ONLY,function(){return"Yes"}),Object(Ut.a)(Xu,ct.BOOLEAN,function(e){return e?"Yes":"No"}),Object(Ut.a)(Xu,ct.COORDINATE,function(e){return"[ ".concat(e.longitude,", ").concat(e.latitude," ]")}),Object(Ut.a)(Xu,ct.AGE,Qu),Object(Ut.a)(Xu,ct.FILE_RESOURCE,$u),Object(Ut.a)(Xu,ct.IMAGE,$u),Object(Ut.a)(Xu,ct.ORGANISATION_UNIT,function(e){return e.name}),Xu);function nd(e,t,n){return e||0===e||!1===e?n&&n.optionSet?n.optionSet.getOptionText(e):td[t]?td[t](e):e:e}function ad(e){return Se(e).format("YYYY-MM-DD")}function rd(e,t){return{from:e(t.from),to:e(t.to)}}var od=(ed={},Object(Ut.a)(ed,ct.NUMBER,ec),Object(Ut.a)(ed,ct.NUMBER_RANGE,function(e){return rd(ec,e)}),Object(Ut.a)(ed,ct.INTEGER,ec),Object(Ut.a)(ed,ct.INTEGER_RANGE,function(e){return rd(ec,e)}),Object(Ut.a)(ed,ct.INTEGER_POSITIVE,ec),Object(Ut.a)(ed,ct.INTEGER_POSITIVE_RANGE,function(e){return rd(ec,e)}),Object(Ut.a)(ed,ct.INTEGER_ZERO_OR_POSITIVE,ec),Object(Ut.a)(ed,ct.INTEGER_ZERO_OR_POSITIVE_RANGE,function(e){return rd(ec,e)}),Object(Ut.a)(ed,ct.INTEGER_NEGATIVE,ec),Object(Ut.a)(ed,ct.INTEGER_NEGATIVE_RANGE,function(e){return rd(ec,e)}),Object(Ut.a)(ed,ct.DATE,ad),Object(Ut.a)(ed,ct.DATE_RANGE,function(e){return rd(ad,e)}),Object(Ut.a)(ed,ct.TRUE_ONLY,function(){return"true"}),Object(Ut.a)(ed,ct.BOOLEAN,function(e){return e?"true":"false"}),Object(Ut.a)(ed,ct.FILE_RESOURCE,function(e){return e.value}),Object(Ut.a)(ed,ct.IMAGE,function(e){return e.value}),Object(Ut.a)(ed,ct.COORDINATE,function(e){return"[".concat(e.longitude,",").concat(e.latitude,"]")}),Object(Ut.a)(ed,ct.PERCENTAGE,function(e){return e.replace("%","")}),Object(Ut.a)(ed,ct.ORGANISATION_UNIT,function(e){return e.id}),ed);function id(e,t){return(e||0===e||!1===e)&&od[t]?od[t](e):e}var cd,sd=n(100),ld=n.n(sd);function ud(e){var t,n,a=e.date,r=e.time;if(/[:.]/.test(r)){var o=r.split(/[:.]/),i=Object(ca.a)(o,2);t=i[0],n=i[1]}else 3===r.length?(t=r.substring(0,1),n=r.substring(2,3)):(t=r.substring(0,2),n=r.substring(3,4));var c=Pn(a).momentDate;return c.hour(t),c.minute(n),c.toISOString()}function dd(e){return Pn(e).momentDate.toISOString()}function pd(e,t){return{from:e(t.from),to:e(t.to)}}var fd,md,hd=(cd={},Object(Ut.a)(cd,ct.NUMBER,na),Object(Ut.a)(cd,ct.NUMBER_RANGE,function(e){return pd(na,e)}),Object(Ut.a)(cd,ct.INTEGER,na),Object(Ut.a)(cd,ct.INTEGER_RANGE,function(e){return pd(na,e)}),Object(Ut.a)(cd,ct.INTEGER_POSITIVE,na),Object(Ut.a)(cd,ct.INTEGER_POSITIVE_RANGE,function(e){return pd(na,e)}),Object(Ut.a)(cd,ct.INTEGER_ZERO_OR_POSITIVE,na),Object(Ut.a)(cd,ct.INTEGER_ZERO_OR_POSITIVE_RANGE,function(e){return pd(na,e)}),Object(Ut.a)(cd,ct.INTEGER_NEGATIVE,na),Object(Ut.a)(cd,ct.INTEGER_NEGATIVE_RANGE,function(e){return pd(na,e)}),Object(Ut.a)(cd,ct.DATE,dd),Object(Ut.a)(cd,ct.DATE_RANGE,function(e){return pd(dd,e)}),Object(Ut.a)(cd,ct.DATETIME,ud),Object(Ut.a)(cd,ct.DATETIME_RANGE,function(e){return pd(ud,e)}),Object(Ut.a)(cd,ct.TRUE_ONLY,function(e){return"true"===e||null}),Object(Ut.a)(cd,ct.BOOLEAN,function(e){return"true"===e}),Object(Ut.a)(cd,ct.AGE,function(e){return dd(e.date)}),cd);function bd(e,t){if(null==e)return null;var n;if(ld()(e)){if(!(n=e.trim()))return null}else n=e;return hd[t]?hd[t](n):n}var gd=(fd={},Object(Ut.a)(fd,ct.NUMBER,na),Object(Ut.a)(fd,ct.INTEGER,na),Object(Ut.a)(fd,ct.INTEGER_POSITIVE,na),Object(Ut.a)(fd,ct.INTEGER_ZERO_OR_POSITIVE,na),Object(Ut.a)(fd,ct.INTEGER_NEGATIVE,na),Object(Ut.a)(fd,ct.DATE,function(e){return l()(e,"YYYY-MM-DD").toISOString()}),Object(Ut.a)(fd,ct.DATETIME,function(e){return l()(e,"YYYY-MM-DD HH:mm").toISOString()}),Object(Ut.a)(fd,ct.TRUE_ONLY,function(e){return"true"===e||null}),Object(Ut.a)(fd,ct.BOOLEAN,function(e){return"true"===e}),fd);function Od(e,t){return null==e?null:gd[t]?gd[t](e):e}var vd=(md={},Object(Ut.a)(md,ct.NUMBER,na),Object(Ut.a)(md,ct.INTEGER,na),Object(Ut.a)(md,ct.INTEGER_POSITIVE,na),Object(Ut.a)(md,ct.INTEGER_ZERO_OR_POSITIVE,na),Object(Ut.a)(md,ct.INTEGER_NEGATIVE,na),Object(Ut.a)(md,ct.DATE,function(e){return l()(e,"YYYY-MM-DD").toISOString()}),Object(Ut.a)(md,ct.DATETIME,function(e){return l()(e).toISOString()}),Object(Ut.a)(md,ct.TRUE_ONLY,function(e){return"true"===e||null}),Object(Ut.a)(md,ct.BOOLEAN,function(e){return"true"===e}),Object(Ut.a)(md,ct.COORDINATE,function(e){var t=JSON.parse(e);return{latitude:t[1],longitude:t[0]}}),md);function yd(e,t){return null==e?null:vd[t]?vd[t](e):e}var Ed,_d,jd,Id,Cd=Object(ze.d)(bd,nd),Td={labelContainerStyle:{flexBasis:200},inputContainerStyle:{flexBasis:150}},Sd=function(e,t){var n={valueConverter:function(t){return e.convertValue(t,Cd)},styles:Td,label:e.formName,dataElement:e,fieldLabelMediaBasedClass:t.fieldLabelMediaBasedClass};return{id:e.id,component:Ml,props:n}},Rd=function(e,t){return Object(se.a)({},function(e){return{metaCompulsory:e.compulsory}}(t),e)},kd=function(e,t){return Object(se.a)({},Ns(t),e)},Nd=function(e){var t=Rd({orientation:Ga.HORIZONTAL,shrinkDisabled:!1},e);return kd({component:Bl,props:t},e)},Ad=function(e){var t=Rd({orientation:Ga.HORIZONTAL,id:e.id},e);return kd({component:Vl,props:t},e)},wd=function(e){var t=Rd({orientation:Ga.HORIZONTAL,shrinkDisabled:!1},e);return kd({component:Hl,props:t},e)},Fd=function(e){var t=Rd({width:350,maxWidth:350,calendarWidth:350},e);return kd({component:zl,props:t},e)},xd=function(e){var t=Rd({dateWidth:"100%",dateMaxWidth:350,calendarWidth:350,orientation:Ga.HORIZONTAL,shrinkDisabled:!1},e);return kd({component:Kl,props:t},e)},Pd=function(e){var t=Rd({async:!0,orientation:Ga.HORIZONTAL},e);return kd({component:Yl,props:t},e)},Dd=function(e){var t=Rd({async:!0,orientation:Ga.HORIZONTAL},e);return kd({component:ql,props:t},e)},Ud=(Ed={},Object(Ut.a)(Ed,at.DROPDOWN,function(e){return{options:Au(e.optionSet),nullable:!e.compulsory}}),Object(Ut.a)(Ed,at.HORIZONTAL_RADIOBUTTONS,function(e){return{options:Nu(e.optionSet)}}),Object(Ut.a)(Ed,at.VERTICAL_RADIOBUTTONS,function(e){return{orientation:Ga.VERTICAL,options:Nu(e.optionSet)}}),Ed),Ld=(_d={},Object(Ut.a)(_d,at.DROPDOWN,Jl),Object(Ut.a)(_d,at.HORIZONTAL_RADIOBUTTONS,Ql),Object(Ut.a)(_d,at.VERTICAL_RADIOBUTTONS,Ql),_d),Md=function(e,t){var n=e.optionSet,a=n.inputType,r=Ud[a](e),o=Rd(Object(se.a)({id:e.id,formId:t.formId,optionGroups:n.optionGroups},r),e);return kd({component:Ld[a],props:o,commitEvent:a===at.DROPDOWN?"onBlur":"onSelect"},e)},Bd=function(e){var t=Rd({},e);return kd({component:ou,props:t},e)},Vd=function(e){var t=Rd({orientation:Ga.HORIZONTAL,shrinkDisabled:!1},e);return kd({component:su,props:t},e)},Gd=function(e,t){var n=Rd({multiLine:t&&t.multiLine},e);return kd({component:du,props:n},e)},Wd=function(e){var t=Rd({orientation:Ga.HORIZONTAL,id:e.id},e);return kd({component:pu,props:t},e)},Hd=function(e){var t=Rd({},e);return kd({component:hu,props:t},e)},zd=Object(ze.d)(bd,nd),Kd=function(e,t){var n={valueConverter:function(t){return e.convertValue(t,zd)},label:e.formName,dataElement:e,fieldLabelMediaBasedClass:t.fieldLabelMediaBasedClass};return{id:e.id,component:Ou,props:n}},Yd={NO_FORMFIELD_FOR_TYPE:"Formfield component not specified for type"},qd=(jd={},Object(Ut.a)(jd,ct.EMAIL,Uu),Object(Ut.a)(jd,ct.TEXT,Uu),Object(Ut.a)(jd,ct.PHONE_NUMBER,Uu),Object(Ut.a)(jd,ct.LONG_TEXT,function(e,t,n){return Uu(e,t,n,{multiLine:!0})}),Object(Ut.a)(jd,ct.NUMBER,Uu),Object(Ut.a)(jd,ct.NUMBER_RANGE,Bu),Object(Ut.a)(jd,ct.INTEGER,Uu),Object(Ut.a)(jd,ct.INTEGER_RANGE,Bu),Object(Ut.a)(jd,ct.INTEGER_POSITIVE,Uu),Object(Ut.a)(jd,ct.INTEGER_POSITIVE_RANGE,Bu),Object(Ut.a)(jd,ct.INTEGER_NEGATIVE,Uu),Object(Ut.a)(jd,ct.INTEGER_NEGATIVE_RANGE,Bu),Object(Ut.a)(jd,ct.INTEGER_ZERO_OR_POSITIVE,Uu),Object(Ut.a)(jd,ct.INTEGER_ZERO_OR_POSITIVE_RANGE,Bu),Object(Ut.a)(jd,ct.BOOLEAN,yu),Object(Ut.a)(jd,ct.TRUE_ONLY,Lu),Object(Ut.a)(jd,ct.DATE,_u),Object(Ut.a)(jd,ct.DATE_RANGE,Vu),Object(Ut.a)(jd,ct.DATETIME,ju),Object(Ut.a)(jd,ct.DATETIME_RANGE,Gu),Object(Ut.a)(jd,ct.TIME,Uu),Object(Ut.a)(jd,ct.TIME_RANGE,Bu),Object(Ut.a)(jd,ct.PERCENTAGE,Uu),Object(Ut.a)(jd,ct.URL,Uu),Object(Ut.a)(jd,ct.AGE,vu),Object(Ut.a)(jd,ct.ORGANISATION_UNIT,Pu),Object(Ut.a)(jd,ct.COORDINATE,Eu),Object(Ut.a)(jd,ct.POLYGON,Du),Object(Ut.a)(jd,ct.USERNAME,Mu),Object(Ut.a)(jd,ct.FILE_RESOURCE,Iu),Object(Ut.a)(jd,ct.IMAGE,Cu),Object(Ut.a)(jd,ct.UNKNOWN,function(e,t){return null}),jd);var Xd={NO_FORMFIELD_FOR_TYPE:"Formfield component not specified for type"},Zd=(Id={},Object(Ut.a)(Id,ct.EMAIL,Gd),Object(Ut.a)(Id,ct.TEXT,Gd),Object(Ut.a)(Id,ct.PHONE_NUMBER,Gd),Object(Ut.a)(Id,ct.LONG_TEXT,function(e){return Gd(e,{multiLine:!0})}),Object(Ut.a)(Id,ct.NUMBER,Gd),Object(Ut.a)(Id,ct.INTEGER,Gd),Object(Ut.a)(Id,ct.INTEGER_POSITIVE,Gd),Object(Ut.a)(Id,ct.INTEGER_NEGATIVE,Gd),Object(Ut.a)(Id,ct.INTEGER_ZERO_OR_POSITIVE,Gd),Object(Ut.a)(Id,ct.BOOLEAN,Ad),Object(Ut.a)(Id,ct.TRUE_ONLY,Wd),Object(Ut.a)(Id,ct.DATE,Fd),Object(Ut.a)(Id,ct.DATETIME,xd),Object(Ut.a)(Id,ct.TIME,Gd),Object(Ut.a)(Id,ct.PERCENTAGE,Gd),Object(Ut.a)(Id,ct.URL,Gd),Object(Ut.a)(Id,ct.AGE,Nd),Object(Ut.a)(Id,ct.ORGANISATION_UNIT,Bd),Object(Ut.a)(Id,ct.COORDINATE,wd),Object(Ut.a)(Id,ct.POLYGON,Vd),Object(Ut.a)(Id,ct.USERNAME,Hd),Object(Ut.a)(Id,ct.FILE_RESOURCE,Pd),Object(Ut.a)(Id,ct.IMAGE,Dd),Object(Ut.a)(Id,ct.UNKNOWN,function(e){return null}),Id);function Jd(e,t,n){return n?function(e,t){if(t.viewMode)return Kd(e,t);var n=e.type;return Zd[n]?e.optionSet?Md(e,t):Zd[n](e):(O.a.warn(Object(ze.b)(Xd.NO_FORMFIELD_FOR_TYPE)({metaData:e})),Zd[ct.UNKNOWN](e))}(e,t):function(e,t,n){if(t.viewMode)return Sd(e,t);var a=e.type;return qd[a]?e.optionSet?xu(e,t):qd[a](e,t,n):(O.a.warn(Object(ze.b)(Yd.NO_FORMFIELD_FOR_TYPE)({metaData:e})),qd[ct.UNKNOWN](e,t,n))}(e,t)}var Qd,$d=n(565),ep=n(46),tp="#",np="A",ap="V",rp="C",op="#",ip={DATAELEMENT_CURRENT_EVENT:"DATAELEMENT_CURRENT_EVENT",DATAELEMENT_NEWEST_EVENT_PROGRAM_STAGE:"DATAELEMENT_NEWEST_EVENT_PROGRAM_STAGE",DATAELEMENT_NEWEST_EVENT_PROGRAM:"DATAELEMENT_NEWEST_EVENT_PROGRAM",DATAELEMENT_PREVIOUS_EVENT:"DATAELEMENT_PREVIOUS_EVENT"},cp={TEI_ATTRIBUTE:"TEI_ATTRIBUTE"},sp=Object(se.a)({},ip,cp,{CALCULATED_VALUE:"CALCULATED_VALUE"}),lp=function(){function e(t,n){var a;Object(A.a)(this,e),this.onProcessValue=t,this.dateUtils=n,this.mapSourceTypeToGetterFn=(a={},Object(Ut.a)(a,sp.DATAELEMENT_CURRENT_EVENT,this.getVariableForCurrentEvent),Object(Ut.a)(a,sp.DATAELEMENT_NEWEST_EVENT_PROGRAM,this.getVariableForNewestEventProgram),Object(Ut.a)(a,sp.DATAELEMENT_NEWEST_EVENT_PROGRAM_STAGE,this.getVariableForNewestEventProgramStage),Object(Ut.a)(a,sp.DATAELEMENT_PREVIOUS_EVENT,this.getVariableForPreviousEventProgram),Object(Ut.a)(a,sp.TEI_ATTRIBUTE,this.getVariableForSelectedEntityAttributes),Object(Ut.a)(a,sp.CALCULATED_VALUE,this.getVariableForCalculatedValue),a)}return Object(w.a)(e,null,[{key:"getDataElementValueForVariable",value:function(e,t,n,a,r){return(!!e||0===e||!1===e)&&n&&a&&a[t]&&a[t].optionSetId?$d.a.getName(r[a[t].optionSetId].options,e):e}},{key:"getTrackedEntityValueForVariable",value:function(e,t,n,a,r){return(!!e||0===e||!1===e)&&n&&a&&a[t]&&a[t].optionSetId?$d.a.getName(r[a[t].optionSetId].options,e):e}}]),Object(w.a)(e,[{key:"getVariables",value:function(e,t,n,a,r,o,i,c,s){var l=this,u=e.programRulesVariables||[],d={executingEvent:t,eventsContainer:n,dataElements:a,trackedEntityAttributes:r,selectedEntity:o,selectedEnrollment:i,optionSets:s,selectedOrgUnit:c},p=u.reduce(function(e,t){var n,o=t.displayName,i=t.programRuleVariableSourceType,c=l.mapSourceTypeToGetterFn[i];return c?(ip[i]?n=l.preCheckDataElementSpecificSourceType(t,a):cp[i]&&(n=l.preCheckTrackedEntitySpecificSourceType(t,r)),n?(e[o]=n,e):((n=c.bind(l)(t,d))||ip[i]&&(n=l.postGetVariableForDataElementSpecificSourceType(t,a)),n&&(e[o]=n),e)):(O.a.error("Unknown programRuleVariableSourceType:".concat(t.programRuleVariableSourceType)),n=l.buildVariable("",null,ep.a.TEXT,!1,tp,null,t.useNameForOptionSet),e[o]=n,e)},{}),f=Object(se.a)({},p,this.getContextVariables(d));return Object(se.a)({},f,this.getConstantVariables(e.constants))}},{key:"processValue",value:function(e,t){return this.onProcessValue(e,t)}},{key:"buildVariable",value:function(e,t,n,a,r,o,i){var c=this,s=t?t.map(function(e){return c.onProcessValue(e,n)}):null;return{variableValue:this.onProcessValue(e,n),useCodeForOptionSet:!i,variableType:i?ep.a.TEXT:n,hasValue:a,variableEventDate:o,variablePrefix:r,allValues:s}}},{key:"preCheckDataElementSpecificSourceType",value:function(e,t){var n=e.dataElementId;return n&&t&&t[n]?null:(O.a.warn("Variable id:".concat(e.id," name:").concat(e.displayName," contains an invalid dataelement id (id: ").concat(n||"",")")),this.buildVariable("",null,ep.a.TEXT,!1,tp,null,e.useNameForOptionSet))}},{key:"preCheckTrackedEntitySpecificSourceType",value:function(e,t){var n=e.trackedEntityAttributeId;return n&&t&&t[n]?null:(O.a.warn("Variable id:".concat(e.id," name:").concat(e.displayName," contains an invalid trackedEntityAttribute id (id: ").concat(n||"",")")),this.buildVariable("",null,ep.a.TEXT,!1,np,null,e.useNameForOptionSet))}},{key:"postGetVariableForDataElementSpecificSourceType",value:function(e,t){var n=t[e.dataElementId];return this.buildVariable("",null,n.valueType,!1,tp,"",e.useNameForOptionSet)}},{key:"getVariableForCalculatedValue",value:function(e){return this.buildVariable("",null,ep.a.TEXT,!1,op,"",e.useNameForOptionSet)}},{key:"getVariableForSelectedEntityAttributes",value:function(t,n){if(!n.selectedEntity)return O.a.warn("Variable id:".concat(t.id," name:").concat(t.displayName," has sourcetype").concat(t.programRuleVariableSourceType,", but no selectedEntity was found")),this.buildVariable("",null,ep.a.TEXT,!1,np,null,t.useNameForOptionSet);var a=t.trackedEntityAttributeId,r=n.trackedEntityAttributes[a],o=n.selectedEntity[a];if(!(!!o||0===o||!1===o))return this.buildVariable("",null,r.valueType,!1,np,null,t.useNameForOptionSet);var i=e.getTrackedEntityValueForVariable(o,a,t.useNameForOptionSet,n.trackedEntityAttributes,n.optionSets);return this.buildVariable(i,null,r.valueType,!0,np,null,t.useNameForOptionSet)}},{key:"getVariableForCurrentEvent",value:function(t,n){var a=t.dataElementId,r=n.dataElements[a],o=n.executingEvent;if(!o)return null;var i=o&&o[a];if(!i&&0!==i&&!1!==i)return null;var c=e.getDataElementValueForVariable(i,a,t.useNameForOptionSet,n.dataElements,n.optionSets);return this.buildVariable(c,null,r.valueType,!0,tp,o.eventDate,t.useNameForOptionSet)}},{key:"getVariableForNewestEventProgramStage",value:function(t,n){var a=t.programStageId;if(!a)return O.a.warn("Variable id:".concat(t.id," name:").concat(t.displayName," does not have a programstage defined, despite that the variable has sourcetype").concat(t.programRuleVariableSourceType)),null;var r=n.eventsContainer&&n.eventsContainer.byStage[a];if(!r)return null;var o=t.dataElementId,i=n.dataElements[o],c=r.map(function(a){return e.getDataElementValueForVariable(a[o],o,t.useNameForOptionSet,n.dataElements,n.optionSets)}).filter(function(e){return!!e||!1===e||0===e}),s=Object(We.a)(r).reverse().find(function(e){var t=e[o];return!!t||0===t||!1===t});if(!s)return null;var l=s[o],u=e.getDataElementValueForVariable(l,o,t.useNameForOptionSet,n.dataElements,n.optionSets);return this.buildVariable(u,c,i.valueType,!0,tp,s.eventDate,t.useNameForOptionSet)}},{key:"getVariableForNewestEventProgram",value:function(t,n){var a=n.eventsContainer&&n.eventsContainer.all;if(!a||0===a.length)return null;var r=t.dataElementId,o=n.dataElements[r],i=a.map(function(a){return e.getDataElementValueForVariable(a[r],r,t.useNameForOptionSet,n.dataElements,n.optionSets)}).filter(function(e){return!!e||!1===e||0===e}),c=Object(We.a)(a).reverse().find(function(e){var t=e[r];return!!t||0===t||!1===t});if(!c)return null;var s=c[r],l=e.getDataElementValueForVariable(s,r,t.useNameForOptionSet,n.dataElements,n.optionSets);return this.buildVariable(l,i,o.valueType,!0,tp,c.eventDate,t.useNameForOptionSet)}},{key:"getVariableForPreviousEventProgram",value:function(t,n){var a=n.eventsContainer&&n.eventsContainer.all;if(!a||0===a.length)return null;var r=n.executingEvent;if(!r)return null;var o=a.findIndex(function(e){return e.eventId===r.eventId});if(o-1<0)return null;var i=t.dataElementId,c=n.dataElements[i],s=a.slice(0,o),l=s.map(function(a){return e.getDataElementValueForVariable(a[i],i,t.useNameForOptionSet,n.dataElements,n.optionSets)}).filter(function(e){return!!e||!1===e||0===e}),u=Object(We.a)(s).reverse().find(function(e){var t=e[i];return!!t||0===t||!1===t});if(!u)return null;var d=u[i],p=e.getDataElementValueForVariable(d,i,t.useNameForOptionSet,n.dataElements,n.optionSets);return this.buildVariable(p,l,c.valueType,!0,tp,u.eventDate,t.useNameForOptionSet)}},{key:"getContextVariables",value:function(e){var t={};return t.current_date=this.buildVariable(this.dateUtils.getToday(),null,ep.a.DATE,!0,ap,null,!1),t=Object(se.a)({},t,this.getEventContextVariables(e.executingEvent,e.eventsContainer)),t=Object(se.a)({},t,this.getEnrollmentContextVariables(e.selectedEnrollment)),t=Object(se.a)({},t,this.getOrganisationContextVariables(e.selectedOrgUnit))}},{key:"getEventContextVariables",value:function(e,t){var n={};return e&&(n.event_date=this.buildVariable(e.eventDate,null,ep.a.DATE,!0,ap,null,!1),n.due_date=this.buildVariable(e.dueDate,null,ep.a.DATE,!0,ap,null,!1),n.event_id=this.buildVariable(e.eventId||"",null,ep.a.TEXT,!!e,ap,e.eventDate,!1)),t&&(n.event_count=this.buildVariable(t.all&&t.all.length||0,null,ep.a.INTEGER,!0,ap,null,!1)),n}},{key:"getEnrollmentContextVariables",value:function(e){var t={};return e&&(t.enrollment_date=this.buildVariable(e&&e.enrollmentDate||"",null,ep.a.DATE,!(!e||!e.enrollmentDate),ap,null,!1),t.enrollment_id=this.buildVariable(e&&e.enrollment||"",null,ep.a.TEXT,!(!e||!e.enrollmentDate),ap,null,!1),t.enrollment_count=this.buildVariable(e?1:0,null,ep.a.INTEGER,!0,ap,null,!1),t.tei_count=this.buildVariable(e?1:0,null,ep.a.INTEGER,!0,ap,null,!1),t.incident_date=this.buildVariable(e&&e.incidentDate||"",null,ep.a.DATE,!!e,ap,null,!1)),t}},{key:"getOrganisationContextVariables",value:function(e){var t={};return t.orgunit_code=this.buildVariable(e.code,null,ep.a.TEXT,!!e.code,ap,null,!1),t}},{key:"getConstantVariables",value:function(e){var t=this;return e?e.reduce(function(e,n){return e[n.id]=t.buildVariable(n.value,null,ep.a.INTEGER,!0,rp,null,!1),e},{}):{}}}]),e}(),up=n(40),dp=(Qd={},Object(Ut.a)(Qd,ep.a.TEXT,"convertText"),Object(Ut.a)(Qd,ep.a.LONG_TEXT,"convertLongText"),Object(Ut.a)(Qd,ep.a.LETTER,"convertLetter"),Object(Ut.a)(Qd,ep.a.PHONE_NUMBER,"convertPhoneNumber"),Object(Ut.a)(Qd,ep.a.EMAIL,"convertEmail"),Object(Ut.a)(Qd,ep.a.BOOLEAN,"convertBoolean"),Object(Ut.a)(Qd,ep.a.TRUE_ONLY,"convertTrueOnly"),Object(Ut.a)(Qd,ep.a.DATE,"convertDate"),Object(Ut.a)(Qd,ep.a.DATETIME,"convertDateTime"),Object(Ut.a)(Qd,ep.a.TIME,"convertTime"),Object(Ut.a)(Qd,ep.a.NUMBER,"convertNumber"),Object(Ut.a)(Qd,ep.a.INTEGER,"convertInteger"),Object(Ut.a)(Qd,ep.a.INTEGER_POSITIVE,"convertIntegerPositive"),Object(Ut.a)(Qd,ep.a.INTEGER_NEGATIVE,"convertIntegerNegative"),Object(Ut.a)(Qd,ep.a.INTEGER_ZERO_OR_POSITIVE,"convertIntegerZeroOrPositive"),Object(Ut.a)(Qd,ep.a.PERCENTAGE,"convertPercentage"),Object(Ut.a)(Qd,ep.a.URL,"convertUrl"),Object(Ut.a)(Qd,ep.a.AGE,"convertAge"),Qd),pp=n(207),fp=function(){function e(t){Object(A.a)(this,e),this.converterObject=t,this.processValue=this.processValue.bind(this)}return Object(w.a)(e,null,[{key:"addQuotesToValueIfString",value:function(e){return ld()(e)?"'".concat(e,"'"):e}}]),Object(w.a)(e,[{key:"processValue",value:function(t,n){ld()(t)&&(t=Object(pp.a)(t));var a=dp[n];return a?e.addQuotesToValueIfString(this.converterObject[a](t)):(O.a.warn(Object(up.a)(e.errorMessages.CONVERTER_NOT_FOUND)({type:n})),t)}}]),e}();fp.errorMessages={CONVERTER_NOT_FOUND:"converter for type is missing"};var mp=n(1486);var hp,bp={EVENT:"event",TEI:"tei"},gp={ASSIGN_VALUE:"ASSIGN",HIDE_FIELD:"HIDEFIELD",SHOW_ERROR:"SHOWERROR",SHOW_WARNING:"SHOWWARNING",SHOW_ERROR_ONCOMPLETE:"ERRORONCOMPLETE",SHOW_WARNING_ONCOMPLETE:"WARNINGONCOMPLETE",HIDE_SECTION:"HIDESECTION",MAKE_COMPULSORY:"SETMANDATORYFIELD",DISPLAY_TEXT:"DISPLAYTEXT",DISPLAY_KEY_VALUE_PAIR:"DISPLAYKEYVALUEPAIR",HIDE_OPTION_GROUP:"HIDEOPTIONGROUP",HIDE_OPTION:"HIDEOPTION",SHOW_OPTION_GROUP:"SHOWOPTIONGROUP"},Op=(hp={},Object(Ut.a)(hp,bp.EVENT,"dataElementId"),Object(Ut.a)(hp,bp.TEI,"trackedEntityAttributeId"),hp);function vp(e,t){var n;var a=(n={},Object(Ut.a)(n,gp.ASSIGN_VALUE,function(n,a,r,o,i){if(!n[a])return null;var c=(r===bp.EVENT?o[n[a]]:i[n[a]]).valueType,s=function(e,n){var a;if(e||0===e||!1===e){var r=dp[n];a=t[r]?t[r](e):e}else a=e;return a}(e(n.data,c),c);return{type:gp.ASSIGN_VALUE,id:n[a],value:s}}),Object(Ut.a)(n,gp.HIDE_FIELD,function(e,t){return e[t]?{type:gp.HIDE_FIELD,id:e[t]}:null}),Object(Ut.a)(n,gp.SHOW_ERROR,function(e,t){return e[t]?{type:gp.SHOW_ERROR,id:e[t],message:"".concat(e.content," ").concat(e.data?e.data:"")}:{type:gp.SHOW_ERROR,id:"general",error:{id:e.id,message:"".concat(e.content," ").concat(e.data?e.data:"")}}}),Object(Ut.a)(n,gp.SHOW_WARNING,function(e,t){return e[t]?{type:gp.SHOW_WARNING,id:e[t],message:"".concat(e.content," ").concat(e.data?e.data:"")}:{type:gp.SHOW_WARNING,id:"general",warning:{id:e.id,message:"".concat(e.content," ").concat(e.data?e.data:"")}}}),Object(Ut.a)(n,gp.SHOW_ERROR_ONCOMPLETE,function(e,t){return e[t]?{type:gp.SHOW_ERROR_ONCOMPLETE,id:e[t],message:"".concat(e.content," ").concat(e.data?e.data:"")}:{type:gp.SHOW_ERROR_ONCOMPLETE,id:"general",error:{id:e.id,message:"".concat(e.content," ").concat(e.data?e.data:"")}}}),Object(Ut.a)(n,gp.SHOW_WARNING_ONCOMPLETE,function(e,t){return e[t]?{type:gp.SHOW_WARNING_ONCOMPLETE,id:e[t],message:"".concat(e.content," ").concat(e.data?e.data:"")}:{type:gp.SHOW_WARNING_ONCOMPLETE,id:"general",warning:{id:e.id,message:"".concat(e.content," ").concat(e.data?e.data:"")}}}),Object(Ut.a)(n,gp.HIDE_SECTION,function(e,t,n){return n===bp.EVENT&&e.programStageSectionId?{type:gp.HIDE_SECTION,id:e.programStageSectionId}:null}),Object(Ut.a)(n,gp.MAKE_COMPULSORY,function(e,t){return e[t]?{type:gp.MAKE_COMPULSORY,id:e[t]}:null}),Object(Ut.a)(n,gp.DISPLAY_TEXT,function(e){return{type:gp.DISPLAY_TEXT,id:e.location,displayText:{id:e.id,message:"".concat(e.content," ").concat(e.data?e.data:"")}}}),Object(Ut.a)(n,gp.DISPLAY_KEY_VALUE_PAIR,function(e){return{type:gp.DISPLAY_KEY_VALUE_PAIR,id:e.location,displayKeyValuePair:{id:e.id,key:e.content,value:e.data}}}),Object(Ut.a)(n,gp.HIDE_OPTION_GROUP,function(e,t){return e[t]?{type:gp.HIDE_OPTION_GROUP,id:e[t],optionGroupId:e.optionGroupId}:null}),Object(Ut.a)(n,gp.HIDE_OPTION,function(e,t){return e[t]?{type:gp.HIDE_OPTION,id:e[t],optionId:e.optionId}:null}),Object(Ut.a)(n,gp.SHOW_OPTION_GROUP,function(e,t){return e[t]?{type:gp.SHOW_OPTION_GROUP,id:e[t],optionGroupId:e.optionGroupId}:null}),n);return function(e,t,n,r){var o=Op[t];return e.map(function(e){var i=e.action;return a[i]?a[i](e,o,t,n,r):null}).filter(function(e){return e})}}var yp,Ep=function(){function e(t,n,a,r){Object(A.a)(this,e);var o=new fp(t),i=function(e){var t=function(t,n,a){var r=Object(pp.a)(n),o=Object(pp.a)(a),i=e.rulesDateToMoment(r);return e.rulesDateToMoment(o).diff(i,t)};return{getToday:function(){var t=l()();return e.momentToRulesDate(t)},daysBetween:function(e,n){return t("days",e,n)},weeksBetween:function(e,n){return t("weeks",e,n)},monthsBetween:function(e,n){return t("months",e,n)},yearsBetween:function(e,n){return t("years",e,n)},addDays:function(t,n){var a=Object(pp.a)(t),r=Object(pp.a)(n),o=e.rulesDateToMoment(a).add(r,"days"),i=e.momentToRulesDate(o);return"'".concat(i,"'")}}}(n),c=new lp(o.processValue,i);this.executionService=Object(mp.a)(a,c,i),this.onProcessRulesEffects=vp(this.executionService.convertDataToBaseOutputValue,r)}return Object(w.a)(e,[{key:"executeRules",value:function(e,t,n,a,r,o,i,c,s,l){var u;if(n&&n.length>0){var d=n.reduce(function(e,t){return!!t.programStageId&&(e[t.programStageId]=e[t.programStageId]||[],e[t.programStageId].push(t)),e},{});u={all:n,byStage:d}}else u=null;var p=this.executionService.executeRules(e,t,u,a,i,o,r,c,s,{debug:!0});return p?this.onProcessRulesEffects(p,l,a,i):null}}]),e}(),_p=n(35),jp="UpdateRulesEffects",Ip="UpdateFieldFromRuleEffect",Cp=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;return le(jp)({rulesEffects:e,formId:t})},Tp={ERROR:"error",WARNING:"warning",ERROR_ON_COMPLETE:"errorOnComplete",WARNING_ON_COMPLETE:"warningOnComplete"},Sp=Object(_p.b)(Object(Ut.a)({},jp,function(e,t){var n=Object(se.a)({},e),a=t.payload.rulesEffects&&t.payload.rulesEffects[gp.HIDE_FIELD];return n[t.payload.formId]=a?Object.keys(a).reduce(function(e,t){return e[t]=!0,e},{}):null,n}),"rulesEffectsHiddenFields"),Rp=Object(_p.b)(Object(Ut.a)({},jp,function(e,t){var n=Object(se.a)({},e),a=t.payload.rulesEffects&&t.payload.rulesEffects[gp.MAKE_COMPULSORY];return n[t.payload.formId]=a?Object.keys(a).reduce(function(e,t){return e[t]=!0,e},{}):null,n}),"rulesEffectsCompulsoryFields"),kp=Object(_p.b)(Object(Ut.a)({},jp,function(e,t){var n=Object(se.a)({},e),a=t.payload.rulesEffects&&t.payload.rulesEffects[gp.HIDE_SECTION];return n[t.payload.formId]=a?Object.keys(a).reduce(function(e,t){return e[t]=!0,e},{}):null,n}),"rulesEffectsHiddenSections"),Np=(yp={},Object(Ut.a)(yp,gp.SHOW_ERROR,Tp.ERROR),Object(Ut.a)(yp,gp.SHOW_WARNING,Tp.WARNING),Object(Ut.a)(yp,gp.SHOW_ERROR_ONCOMPLETE,Tp.ERROR_ON_COMPLETE),Object(Ut.a)(yp,gp.SHOW_WARNING_ONCOMPLETE,Tp.WARNING_ON_COMPLETE),yp),Ap=Object(_p.b)(Object(Ut.a)({},jp,function(e,t){var n=Object(se.a)({},e),a=[t.payload.rulesEffects&&t.payload.rulesEffects[gp.SHOW_ERROR],t.payload.rulesEffects&&t.payload.rulesEffects[gp.SHOW_WARNING],t.payload.rulesEffects&&t.payload.rulesEffects[gp.SHOW_ERROR_ONCOMPLETE],t.payload.rulesEffects&&t.payload.rulesEffects[gp.SHOW_WARNING_ONCOMPLETE]];return n[t.payload.formId]=a.reduce(function(e,t){return t?Object.keys(t).reduce(function(e,n){e[n]=e[n]||{};var a=t[n][0],r=Np[a.type];return e[n][r]=a.message,e},e):e},{}),n}),"rulesEffectsMessages"),wp=Object(_p.b)(Object(Ut.a)({},jp,function(e,t){var n=Object(se.a)({},e),a=t.payload.rulesEffects&&t.payload.rulesEffects[gp.DISPLAY_TEXT],r=t.payload.rulesEffects&&t.payload.rulesEffects[gp.DISPLAY_KEY_VALUE_PAIR];return n[t.payload.formId]={displayTexts:a&&a.feedback?a.feedback.map(function(e){return e.displayText}):null,displayKeyValuePairs:r&&r.feedback?r.feedback.map(function(e){return e.displayKeyValuePair}):null},n}),"rulesEffectsFeedback",{}),Fp=Object(_p.b)(Object(Ut.a)({},jp,function(e,t){var n=Object(se.a)({},e),a=t.payload.rulesEffects&&t.payload.rulesEffects[gp.DISPLAY_TEXT],r=t.payload.rulesEffects&&t.payload.rulesEffects[gp.DISPLAY_KEY_VALUE_PAIR];return n[t.payload.formId]={displayTexts:a&&a.indicators?a.indicators.map(function(e){return e.displayText}):null,displayKeyValuePairs:r&&r.indicators?r.indicators.map(function(e){return e.displayKeyValuePair}):null},n}),"rulesEffectsIndicators",{}),xp=Object(_p.b)(Object(Ut.a)({},jp,function(e,t){var n,a=Object(se.a)({},e),r=t.payload.rulesEffects&&t.payload.rulesEffects[gp.SHOW_ERROR],o=t.payload.rulesEffects&&t.payload.rulesEffects[gp.SHOW_ERROR_ONCOMPLETE],i=r&&r.general?r.general.map(function(e){return e.error}):null,c=o&&o.general?o.general.map(function(e){return e.error}):null;return a[t.payload.formId]=(n={},Object(Ut.a)(n,Np[gp.SHOW_ERROR],i),Object(Ut.a)(n,Np[gp.SHOW_ERROR_ONCOMPLETE],c),n),a}),"rulesEffectsGeneralErrors",{}),Pp=Object(_p.b)(Object(Ut.a)({},jp,function(e,t){var n,a=Object(se.a)({},e),r=t.payload.rulesEffects&&t.payload.rulesEffects[gp.SHOW_WARNING],o=t.payload.rulesEffects&&t.payload.rulesEffects[gp.SHOW_WARNING_ONCOMPLETE],i=r&&r.general?r.general.map(function(e){return e.warning}):null,c=o&&o.general?o.general.map(function(e){return e.warning}):null;return a[t.payload.formId]=(n={},Object(Ut.a)(n,Np[gp.SHOW_WARNING],i),Object(Ut.a)(n,Np[gp.SHOW_WARNING_ONCOMPLETE],c),n),a}),"rulesEffectsGeneralWarnings",{}),Dp=Object(_p.b)(Object(Ut.a)({},jp,function(e,t){var n=Object(se.a)({},e),a=t.payload.rulesEffects&&t.payload.rulesEffects[gp.ASSIGN_VALUE];return n[t.payload.formId]=a?Object.keys(a).reduce(function(e,t){return e[t]=!0,e},{}):null,n}),"rulesEffectsDisabledFields"),Up=Object(_p.b)(Object(Ut.a)({},jp,function(e,t){var n=Object(se.a)({},e),a=t.payload.rulesEffects;return t.payload.rulesEffects&&(n[t.payload.formId]={hideOptions:a[gp.HIDE_OPTION],hideOptionGroups:a[gp.HIDE_OPTION_GROUP],showOptionGroups:a[gp.SHOW_OPTION_GROUP]}),n}),"rulesEffectsOptionsVisibility"),Lp=function(e){return function(t){function n(){return Object(A.a)(this,n),Object(F.a)(this,Object(x.a)(n).apply(this,arguments))}return Object(P.a)(n,t),Object(w.a)(n,[{key:"render",value:function(){var t=this.props,n=t.customForm,a=Object(Fe.a)(t,["customForm"]);return f.createElement(e,a,n?function(e,t){return f.createElement(ds.a,{onRenderField:e,fields:t,specs:n})}:null)}}]),n}(f.Component)}(function(e){return Object(E.withStyles)(ls)(function(t){function n(){var e,t;Object(A.a)(this,n);for(var a=arguments.length,r=new Array(a),o=0;o<a;o++)r[o]=arguments[o];return(t=Object(F.a)(this,(e=Object(x.a)(n)).call.apply(e,[this].concat(r)))).renderDivider=function(e,n,a){if(a.props&&a.props.hidden||e+1>=n)return null;var r=t.props.classes;return f.createElement("div",{className:r.dividerContainer},f.createElement(Zo,{className:r.divider}))},t}return Object(P.a)(n,t),Object(w.a)(n,[{key:"render",value:function(){var t=this.props,n=(t.classes,Object(Fe.a)(t,["classes"])),a=this.props.formHorizontal?null:{onRenderDivider:this.renderDivider};return f.createElement(e,Object.assign({},a,n))}}]),n}(f.Component))}(function(e){return Object(E.withStyles)(us)(function(t){function n(){var e,t;Object(A.a)(this,n);for(var a=arguments.length,r=new Array(a),o=0;o<a;o++)r[o]=arguments[o];return(t=Object(F.a)(this,(e=Object(x.a)(n)).call.apply(e,[this].concat(r)))).getContainerProps=function(e,n,a){if(0===e&&(t.hiddenFieldsCount=0),a.props&&a.props.hidden)return t.hiddenFieldsCount+=1,{};var r=t.props.classes;return{className:(e-t.hiddenFieldsCount)%2===0?null:r.evenNumbers}},t}return Object(P.a)(n,t),Object(w.a)(n,[{key:"render",value:function(){var t=this.props,n=t.formHorizontal,a=(t.classes,Object(Fe.a)(t,["formHorizontal","classes"])),r=n?null:{onGetContainerProps:this.getContainerProps};return f.createElement(e,Object.assign({},r,a))}}]),n}(f.Component))}(ss))),Mp=function(e){function t(e){var n;return Object(A.a)(this,t),(n=Object(F.a)(this,Object(x.a)(t).call(this,e))).handleUpdateFieldAsync=function(e,t,a,r){n.props.onUpdateFieldAsync(e,t,a,n.props.formId,r)},n.handleUpdateField=n.handleUpdateField.bind(Object(V.a)(n)),n.formFields=t.buildFormFields(n.props),n.rulesCompulsoryErrors={},n}return Object(P.a)(t,e),Object(w.a)(t,null,[{key:"buildFormFields",value:function(e){var t=e.fieldsMetaData,n=e.customForm,a=e.fieldOptions;return Array.from(t.entries()).map(function(e){return e[1]}).map(function(t){return Jd(t,Object(se.a)({formHorizontal:e.formHorizontal,formId:e.formId,viewMode:e.viewMode},a),!!n)}).filter(function(e){return e})}}]),Object(w.a)(t,[{key:"componentWillReceiveProps",value:function(e){e.fieldsMetaData!==this.props.fieldsMetaData&&(this.formFields=t.buildFormFields(e))}},{key:"rulesIsValid",value:function(){var e=this.props.rulesMessages;return 0===Object.keys(e).map(function(t){return e[t]&&e[t][Tp.ERROR]}).filter(function(e){return e}).length&&0===Object.keys(this.rulesCompulsoryErrors).length}},{key:"validateFull",value:function(){return!(!this.formBuilderInstance||!this.formBuilderInstance.isValid())&&this.rulesIsValid()}},{key:"validateDataTypeOnly",value:function(){return!!this.formBuilderInstance&&this.formBuilderInstance.isValid(["dataType"])}},{key:"isValid",value:function(e){var t=this.props.validationStrategy;return t===dt.NONE?this.validateDataTypeOnly():t===dt.ON_COMPLETE?e&&e.isCompleting?this.validateFull():this.validateDataTypeOnly():this.validateFull()}},{key:"getInvalidFields",value:function(){var e=this,t=Object.keys(this.props.rulesMessages).reduce(function(t,n){return e.props.rulesMessages[n]&&(e.props.rulesMessages[n][Tp.ERROR]||e.props.rulesMessages[n][Tp.ERROR_ON_COMPLETE])&&(t[n]=!0),t},{}),n=Object.keys(this.rulesCompulsoryErrors).reduce(function(e,t){return e[t]=!0,e},{}),a=Object(se.a)({},t,n);return this.formBuilderInstance?this.formBuilderInstance.getInvalidFields(a):[]}},{key:"handleUpdateField",value:function(e,t,n,a,r){this.props.onUpdateField(e,t,n,a,this.props.formId,r)}},{key:"buildRulesCompulsoryErrors",value:function(){var e=this.props.rulesCompulsoryFields,t=this.props.values;this.rulesCompulsoryErrors=Object.keys(e).reduce(function(n,a){if(e[a]){var r=t[a];r||0===r||!1===r||(n[a]="This field is required")}return n},{})}},{key:"getFieldConfigWithRulesEffects",value:function(){var e=this;return this.formFields.map(function(t){return Object(se.a)({},t,{props:Object(se.a)({},t.props,{hidden:e.props.rulesHiddenFields[t.id],rulesErrorMessage:e.props.rulesMessages[t.id]&&e.props.rulesMessages[t.id][Tp.ERROR],rulesWarningMessage:e.props.rulesMessages[t.id]&&e.props.rulesMessages[t.id][Tp.WARNING],rulesErrorMessageOnComplete:e.props.rulesMessages[t.id]&&e.props.rulesMessages[t.id][Tp.ERROR_ON_COMPLETE],rulesWarningMessageOnComplete:e.props.rulesMessages[t.id]&&e.props.rulesMessages[t.id][Tp.WARNING_ON_COMPLETE],rulesCompulsory:e.props.rulesCompulsoryFields[t.id],rulesCompulsoryError:e.rulesCompulsoryErrors[t.id],rulesDisabled:e.props.rulesDisabledFields[t.id]})})})}},{key:"render",value:function(){var e=this,t=this.props,n=(t.fieldsMetaData,t.values),a=(t.onUpdateField,t.formId,t.formBuilderId),r=(t.rulesCompulsoryFields,t.rulesDisabledFields,t.rulesHiddenFields,t.rulesMessages,t.onUpdateFieldAsync,t.fieldOptions,t.validationStrategy,t.loadNr),o=Object(Fe.a)(t,["fieldsMetaData","values","onUpdateField","formId","formBuilderId","rulesCompulsoryFields","rulesDisabledFields","rulesHiddenFields","rulesMessages","onUpdateFieldAsync","fieldOptions","validationStrategy","loadNr"]);return this.buildRulesCompulsoryErrors(),m.a.createElement(Lp,Object.assign({formBuilderRef:function(t){e.formBuilderInstance=t},id:a,fields:this.getFieldConfigWithRulesEffects(),values:n,onUpdateField:this.handleUpdateField,onUpdateFieldAsync:this.handleUpdateFieldAsync,validateIfNoUIData:!0,loadNr:r},o))}}]),t}(f.Component);Mp.defaultProps={values:{}};var Bp=Mp,Vp="UpdateField",Gp=Object(nl.createSelectorCreator)(nl.defaultMemoize,function(e,t){return Object.keys(t).every(function(n){return t[n]===e[n]})}),Wp=function(e,t){var n=t.fieldsMetaData,a=e.formsValues[t.formId]||{};return Array.from(n.entries()).map(function(e){return e[1]}).reduce(function(e,t){return e[t.id]=a[t.id],e},{})},Hp=function(e,t){var n=t.fieldsMetaData,a=e.rulesEffectsCompulsoryFields[t.formId]||{};return Array.from(n.entries()).map(function(e){return e[1]}).reduce(function(e,t){return e[t.id]=a[t.id],e},{})},zp=function(e,t){var n=t.fieldsMetaData,a=e.rulesEffectsDisabledFields[t.formId]||{};return Array.from(n.entries()).map(function(e){return e[1]}).reduce(function(e,t){return e[t.id]=a[t.id],e},{})},Kp=function(e,t){var n=t.fieldsMetaData,a=e.rulesEffectsHiddenFields[t.formId]||{};return Array.from(n.entries()).map(function(e){return e[1]}).reduce(function(e,t){return e[t.id]=a[t.id],e},{})},Yp=Object(nl.createSelectorCreator)(nl.defaultMemoize,function(e,t){return Object.keys(t).every(function(n){var a=t[n]||{},r=e[n]||{};return[Tp.ERROR,Tp.WARNING,Tp.ERROR_ON_COMPLETE,Tp.WARNING_ON_COMPLETE].every(function(e){return a[e]===r[e]})})}),qp=function(e,t){var n=t.fieldsMetaData,a=e.rulesEffectsMessages[t.formId]||{};return Array.from(n.entries()).map(function(e){return e[1]}).reduce(function(e,t){return e[t.id]=a[t.id],e},{})},Xp=Object(D.b)(function(){var e=Gp(Wp,function(e){return e}),t=Gp(Kp,function(e){return e}),n=Yp(qp,function(e){return e}),a=Gp(Hp,function(e){return e}),r=Gp(zp,function(e){return e});return function(o,i){return{values:e(o,i),rulesHiddenFields:t(o,i),rulesMessages:n(o,i),rulesCompulsoryFields:a(o,i),rulesDisabledFields:r(o,i),loadNr:o.forms[i.formId].loadNr}}},function(e){return{onUpdateField:function(t,n,a,r,o){e(function(e,t,n,a,r){return le(Vp)({value:e,uiState:t,formId:r,sectionId:a,elementId:n})}(t,n,a,r,o))}}},function(e,t,n){var a=Object.assign({},n,e,t);return n.onUpdateField?Object(se.a)({},a,{onUpdateField:n.onUpdateField}):a},{withRef:!0})(Bp),Zp=function(e){function t(){return Object(A.a)(this,t),Object(F.a)(this,Object(x.a)(t).apply(this,arguments))}return Object(P.a)(t,e),Object(w.a)(t,[{key:"renderSectionHeader",value:function(){var e=this.props.sectionMetaData.name;return e?m.a.createElement(as,{title:e}):null}},{key:"render",value:function(){var e=this,t=this.props,n=t.sectionMetaData,a=t.isHidden,r=t.classes,o=(t.sectionId,Object(Fe.a)(t,["sectionMetaData","isHidden","classes","sectionId"]));return a?null:!n.showContainer||this.props.formHorizontal?m.a.createElement(Xp,Object.assign({ref:function(t){e.sectionFieldsInstance=t},fieldsMetaData:n.elements},o)):m.a.createElement("div",null,m.a.createElement($c,{header:this.renderSectionHeader(),elevation:2,className:r.section},m.a.createElement("div",{className:r.sectionFieldsInSection},m.a.createElement(Xp,Object.assign({ref:function(t){e.sectionFieldsInstance=t},fieldsMetaData:n.elements},o)))))}}]),t}(m.a.PureComponent),Jp=Object(E.withStyles)(function(e){return{sectionFieldsInSection:{margin:e.spacing.unit},section:{backgroundColor:"white",maxWidth:e.typography.pxToRem(892)}}})(Zp),Qp=Object(D.b)(function(e,t){return{isHidden:!(!e.rulesEffectsHiddenSections[t.formId]||!e.rulesEffectsHiddenSections[t.formId][t.sectionMetaData.id])}},function(){return{}},null,{withRef:!0})(Jp),$p="FieldsValidated",ef="FieldIsValidating",tf="CleanUpFormBuilder",nf="StartUpdateFieldAsync",af="UpdateFieldFromAsync",rf="AsyncUpdateFieldFailed",of=function(){return{}},cf=function(e){return{onIsValidating:function(t,n,a,r,o,i){var s=function(e,t,n,a,r,o){return le(ef)({fieldId:e,formBuilderId:t,formId:n,message:a||c.a.t("This value is validating"),fieldUIUpdates:r,validatingUid:o})}(t,n,i,r,o,a);e(s)},onFieldsValidated:function(t,n,a,r){var o=function(e,t,n,a){return le($p)({fieldsUI:e,formBuilderId:t,formId:n,validatingUids:a})}(t,n,r,a);e(o)},onCleanUp:function(t,n){e(function(e,t){return le(tf)({remainingUids:e,formId:t})}(t,n))},onUpdateFieldAsyncInner:function(t,n,a,r,o,i){var c=function(e,t,n,a,r,o){return le(nf)({elementId:e,fieldLabel:t,formBuilderId:n,formId:a,uid:r,callback:o})}(t,n,a,r,Xc()(),o);i?i(c):e(c)}}};function sf(e){return e?{message:Object(ps.a)(e)?e:e.message,details:Object(Lt.a)(e)?e:null}:{message:null,details:null}}var lf=function(e){function t(e){var n;return Object(A.a)(this,t),(n=Object(F.a)(this,Object(x.a)(t).call(this,e))).renderHorizontal=function(e,t){return m.a.createElement(Qp,Object.assign({key:e.id,innerRef:function(t){n.setSectionInstance(t,e.id)},sectionMetaData:e,customForm:n.props.formFoundation.customForm,formId:n.getFormId(),formBuilderId:n.getFormBuilderId(e.id),sectionId:e.id},t))},n.renderVertical=function(e,t,a){return m.a.createElement("div",{className:n.props.formFoundation.customForm?a.containerCustomForm:a.container,key:e.id},m.a.createElement(Qp,Object.assign({innerRef:function(t){n.setSectionInstance(t,e.id)},sectionMetaData:e,customForm:n.props.formFoundation.customForm,validationStrategy:n.props.formFoundation.validationStrategy,formId:n.getFormId(),formBuilderId:n.getFormBuilderId(e.id),sectionId:e.id},t)))},n.name="D2Form",n.validateForm=n.validateForm.bind(Object(V.a)(n)),n.sectionInstances=new Map,n}return Object(P.a)(t,e),Object(w.a)(t,[{key:"validateForm",value:function(){var e=this;return Array.from(this.sectionInstances.entries()).map(function(e){return e[1]}).every(function(t){try{return t.sectionFieldsInstance.getWrappedInstance().isValid()}catch(n){return O.a.error(Object(ze.b)("could not get section fields instance")({method:"validateForm",object:e})),!0}})}},{key:"validateFormReturningFailedFields",value:function(e){var t=this;return Array.from(this.sectionInstances.entries()).map(function(e){return e[1]}).reduce(function(n,a){try{var r=a.sectionFieldsInstance.getWrappedInstance();r.isValid(e)||(n=[].concat(Object(We.a)(n),Object(We.a)(r.getInvalidFields())))}catch(o){O.a.error(Object(ze.b)("could not get section fields instance")({method:"validateFormReturningFailedFields",object:t,error:o}))}return n},[])}},{key:"validateFormScrollToFirstFailedField",value:function(e){var t=this.validateFormReturningFailedFields(e);if(!t||0===t.length)return!0;var n=t[0].instance;return n.goto&&n.goto(),!1}},{key:"setSectionInstance",value:function(e,t){e?this.sectionInstances.set(t,e):this.sectionInstances.has(t)&&this.sectionInstances.delete(t)}},{key:"getFormId",value:function(){return this.props.id}},{key:"getFormBuilderId",value:function(e){return"".concat(this.props.id,"-").concat(e)}},{key:"render",value:function(){var e=this,t=this.props,n=t.formFoundation,a=(t.id,t.classes),r=Object(Fe.a)(t,["formFoundation","id","classes"]),o=this.props.formHorizontal,i=Array.from(n.sections.entries()).map(function(e){return e[1]}).map(function(t){return o?e.renderHorizontal(t,r):e.renderVertical(t,r,a)});return m.a.createElement(m.a.Fragment,null,i)}}]),t}(m.a.PureComponent),uf=function(e){return Object(D.b)(of,cf)(function(e){return function(t){function n(){var e,t;Object(A.a)(this,n);for(var a=arguments.length,r=new Array(a),o=0;o<a;o++)r[o]=arguments[o];return(t=Object(F.a)(this,(e=Object(x.a)(n)).call.apply(e,[this].concat(r)))).handleIsValidating=function(){for(var e,n=t.props.id,a=arguments.length,r=new Array(a),o=0;o<a;o++)r[o]=arguments[o];(e=t.props).onIsValidating.apply(e,r.concat([n]))},t.handleFieldsValidated=function(){for(var e,n=t.props.id,a=arguments.length,r=new Array(a),o=0;o<a;o++)r[o]=arguments[o];(e=t.props).onFieldsValidated.apply(e,r.concat([n]))},t.handleCleanUp=function(){for(var e,n=t.props.id,a=arguments.length,r=new Array(a),o=0;o<a;o++)r[o]=arguments[o];(e=t.props).onCleanUp.apply(e,r.concat([n]))},t.handleUpdateFieldAsyncInner=function(){for(var e=t.props,n=e.onUpdateFieldAsyncInner,a=e.onUpdateFieldAsync,r=arguments.length,o=new Array(r),i=0;i<r;i++)o[i]=arguments[i];n.apply(void 0,o.concat([a]))},t}return Object(P.a)(n,t),Object(w.a)(n,[{key:"render",value:function(){var t=this.props,n=(t.onIsValidating,t.onFieldsValidated,t.onCleanUp,t.onUpdateFieldAsyncInner,t.onUpdateFieldAsync,Object(Fe.a)(t,["onIsValidating","onFieldsValidated","onCleanUp","onUpdateFieldAsyncInner","onUpdateFieldAsync"]));return f.createElement(e,Object.assign({onIsValidating:this.handleIsValidating,onFieldsValidated:this.handleFieldsValidated,onUpdateFieldAsync:this.handleUpdateFieldAsyncInner,onCleanUp:this.handleCleanUp},n))}}]),n}(f.Component)}(e))}(Object(E.withStyles)(function(){return{container:{},containerCustomForm:{paddingTop:10,paddingBottom:10}}})(function(e){var t=e.formRef,n=Object(Fe.a)(e,["formRef"]);return m.a.createElement(lf,Object.assign({ref:function(e){t&&t(e)}},n))})),df="top",pf="bottom";function ff(e,t){return"".concat(e,"-").concat(t)}var mf=function(e){function t(){var e,n;Object(A.a)(this,t);for(var a=arguments.length,r=new Array(a),o=0;o<a;o++)r[o]=arguments[o];return(n=Object(F.a)(this,(e=Object(x.a)(t)).call.apply(e,[this].concat(r)))).isNearTop=function(){return window.pageYOffset+n.props.offsetTop>n.stickyContainer.parentElement.offsetTop},n.isAtBottomOfContainer=function(){var e=n.stickyContainer.getBoundingClientRect(),t=n.stickyContainer.parentElement.getBoundingClientRect();return t.bottom<=e.bottom&&n.stickyContainer.offsetTop-Math.abs(t.top)<n.props.offsetTop},n.stickyDisabled=function(){var e=document.documentElement?document.documentElement.clientWidth:0;return(document.documentElement?document.documentElement.clientHeight:0)-(n.props.offsetTop+n.stickyContainer.offsetHeight)<0||e<n.props.minViewpointWidth},n.setStickyContainerInstance=function(e){n.stickyContainer=e,n.setSticky()},n.getRightMargin=function(){var e=n.stickyContainer.parentElement;return(document.documentElement?document.documentElement.clientWidth:0)-(n.stickyContainer.parentElement.offsetLeft+e.offsetWidth)},n.setSticky=function(){var e=n.props.classes;return!n.stickyContainer||!n.stickyDisabled()&&n.isNearTop()?n.stickyContainer&&n.isAtBottomOfContainer()?(n.stickyContainer.className=e.stickyContainerAtBottom,n.stickyContainer.style.top="initial",void(n.stickyContainer.style.marginRight="initial")):void(n.stickyContainer&&(n.stickyContainer.className=e.stickyContainerFixed,n.stickyContainer.style.top="".concat(n.props.offsetTop,"px"),n.stickyContainer.style.width="".concat(n.stickyContainer.parentElement.clientWidth,"px"),n.stickyContainer.style.marginRight="".concat(n.getRightMargin(),"px"))):(n.stickyContainer.className=e.stickyContainerAbsolute,n.stickyContainer.style.top="initial",n.stickyContainer.style.marginRight="initial",void(n.stickyContainer.style.width="initial"))},n.onResize=function(){n.resizeTimer&&window.clearTimeout(n.resizeTimer),n.resizeTimer=window.setTimeout(n.setSticky,250)},n.onScroll=function(){n.scrollTimer&&window.clearTimeout(n.scrollTimer),n.scrollTimer=window.setTimeout(n.setSticky,10)},n}return Object(P.a)(t,e),Object(w.a)(t,[{key:"componentDidMount",value:function(){window.addEventListener("resize",this.onResize),window.addEventListener("scroll",this.onScroll)}},{key:"componentWillUnmount",value:function(){window.removeEventListener("resize",this.onResize),window.removeEventListener("scroll",this.onScroll)}},{key:"render",value:function(){var e=this,t=this.props,n=t.classes,a=t.children,r=t.containerClass;return f.createElement("div",{className:r||n.container},f.createElement("div",{ref:function(t){e.setStickyContainerInstance(t)}},a))}}]),t}(f.Component);mf.defaultProps={offsetTop:0,minViewpointWidth:0};var hf=Object(E.withStyles)(function(){return{container:{position:"relative"},stickyContainerAbsolute:{position:"static"},stickyContainerFixed:{position:"fixed"},stickyContainerAtBottom:{position:"absolute",bottom:0}}})(mf),bf=function(e){return function(t){return t.placement===e}},gf=function(e){return function(t){return t.placement===e&&!t.section}},Of=function(e){function t(){var e,n;Object(A.a)(this,t);for(var a=arguments.length,r=new Array(a),o=0;o<a;o++)r[o]=arguments[o];return(n=Object(F.a)(this,(e=Object(x.a)(t)).call.apply(e,[this].concat(r)))).handleUpdateField=function(){for(var e,t=arguments.length,a=new Array(t),r=0;r<t;r++)a[r]=arguments[r];(e=n.props).onUpdateFieldInner.apply(e,[n.props.id,n.props.itemId,n.props.onUpdateFormField].concat(a))},n.getClasses=function(){var e=n.props,t=e.classes;return e.formHorizontal?{formInnerContainer:t.horizontalFormInnerContainer}:{dataEntryContainer:t.verticalDataEntryContainer,formContainer:t.verticalFormContainer,formInnerContainer:t.verticalFormInnerContainer}},n.handleUpdateFieldAsync=function(){for(var e,t=arguments.length,a=new Array(t),r=0;r<t;r++)a[r]=arguments[r];(e=n.props).onUpdateFormFieldAsync.apply(e,a.concat([n.props.id,n.props.itemId]))},n.renderDataEntryFieldsByPlacement=function(e){var t=n.props.fields||[],a=n.props.formHorizontal?bf(e):gf(e),r=t?t.filter(a).map(function(e){return e.field}):[];return n.props.formHorizontal?r:[].concat(Object(We.a)(r),Object(We.a)(n.getFieldSectionsWithPlacement(e)))},n.renderD2Form=function(){var e=n.props,t=e.id,a=e.classes,r=e.itemId,o=(e.completeButton,e.mainButton,e.cancelButton,e.notes,e.completionAttempted),i=e.saveAttempted,c=(e.fields,e.dataEntrySections,e.onUpdateDataEntryField,e.onUpdateFormField,e.onUpdateFieldInner,e.onUpdateFormFieldAsync,e.dataEntryOutputs,e.onAddNote,e.onOpenAddRelationship,e.dataEntryFieldRef,Object(Fe.a)(e,["id","classes","itemId","completeButton","mainButton","cancelButton","notes","completionAttempted","saveAttempted","fields","dataEntrySections","onUpdateDataEntryField","onUpdateFormField","onUpdateFieldInner","onUpdateFormFieldAsync","dataEntryOutputs","onAddNote","onOpenAddRelationship","dataEntryFieldRef"])),s=f.createElement(uf,Object.assign({innerRef:function(e){n.formInstance=e},id:ff(t,r),validationAttempted:o||i,onUpdateField:n.handleUpdateField,onUpdateFieldAsync:n.handleUpdateFieldAsync},c));return n.props.formHorizontal?s:f.createElement("div",{className:a.d2FormContainer},s)},n}return Object(P.a)(t,e),Object(w.a)(t,[{key:"getWrappedInstance",value:function(){return this.formInstance}},{key:"getFieldSectionsWithPlacement",value:function(e){var t=this,n=this.props.fields||[],a=this.props.dataEntrySections||{};return this.props.dataEntrySections?Object.keys(this.props.dataEntrySections).reduce(function(r,o){var i=a[o];if(i.placement===e){var c=n?n.filter(function(e){return e.section===o}).map(function(e,t){return f.createElement(f.Fragment,{key:t},e.field)}):null;c&&c.length>0&&r.push(f.createElement("div",{key:o,className:t.props.classes.dataEntryFieldSectionContainer},f.createElement($c,{className:t.props.classes.dataEntryFieldSection,header:f.createElement(as,{title:i.name})},c)))}return r},[]):[]}},{key:"render",value:function(){var e=this.props,n=e.classes,a=e.itemId,r=e.formFoundation,o=e.completeButton,i=e.mainButton,c=e.cancelButton,s=e.notes,l=e.dataEntryOutputs;if(!a)return f.createElement("div",null,t.errorMessages.NO_ITEM_SELECTED);if(!r)return f.createElement("div",null,t.errorMessages.FORM_FOUNDATION_MISSING);var u=this.getClasses();return f.createElement("div",{className:u.container},f.createElement("div",{className:u.dataEntryContainer},f.createElement("div",{className:u.formContainer},f.createElement("div",{className:u.formInnerContainer},this.renderDataEntryFieldsByPlacement(df),this.renderD2Form(),this.renderDataEntryFieldsByPlacement(pf),s&&f.createElement("div",{className:n.notes},s))),!this.props.formHorizontal&&l?f.createElement(hf,{offsetTop:50,minViewpointWidth:769,containerClass:n.stickyOnScroll},f.createElement("div",null,l)):f.createElement("div",{className:n.verticalOutputsContainer},l)),f.createElement("div",{className:n.footerBar},o?f.createElement("div",{className:n.button},o):null,i?f.createElement("div",{className:n.button},i):null,c?f.createElement("div",{className:n.button},c):null))}}]),t}(f.Component);Of.errorMessages={NO_ITEM_SELECTED:"No item selected",FORM_FOUNDATION_MISSING:"form foundation missing. see log for details"};var vf=Object(E.withStyles)(function(e){return{d2FormContainer:{paddingTop:10,paddingBottom:10},footerBar:{display:"flex",paddingTop:e.typography.pxToRem(10)},button:{paddingRight:2*e.spacing.unit},horizontalFormInnerContainer:{display:"flex",flexWrap:"wrap",alignItems:"flex-start"},verticalFormContainer:{flexGrow:10,maxWidth:"100%",paddingTop:e.typography.pxToRem(10)},verticalFormInnerContainer:{overflow:"auto",maxWidth:e.typography.pxToRem(892)},verticalDataEntryContainer:{display:"flex",flexDirection:"row",flexWrap:"wrap"},verticalContainer:{display:"flex",flexDirection:"column",flexWrap:"wrap"},stickyOnScroll:{position:"relative",flexGrow:1,width:e.typography.pxToRem(300),margin:e.typography.pxToRem(10),marginTop:0},verticalOutputsContainer:{marginBottom:e.typography.pxToRem(10)},dataEntryFieldSectionContainer:{paddingTop:e.typography.pxToRem(10),paddingBottom:e.typography.pxToRem(10)},dataEntryFieldSection:{padding:e.typography.pxToRem(8),maxWidth:e.typography.pxToRem(892)}}})(Of),yf=function(e){function t(){return Object(A.a)(this,t),Object(F.a)(this,Object(x.a)(t).apply(this,arguments))}return Object(P.a)(t,e),Object(w.a)(t,[{key:"getWrappedInstance",value:function(){return this.dataEntryInstance}},{key:"render",value:function(){var e=this;return f.createElement(vf,Object.assign({innerRef:function(t){e.dataEntryInstance=t}},this.props))}}]),t}(f.Component),Ef="CompleteDataEntryEvent",_f="CompleteDataEntryEventError",jf="SaveDataEntryEvent",If="SaveValidationFailedForDataEntry",Cf="SaveAbortedForDataEntry",Tf="UpdateDataEntryField",Sf="UpdateDataEntryFormField",Rf="RulesExecutedPostUpdateFieldDataEntry",kf="AddDataEntryNote",Nf="RemoveDataEntryNote",Af="SetCurrentDataEntry",wf="StartRunRulesPostUpdateFieldDataEntry",Ff="RemoveDataEntryRelationship",xf="AddDataEntryRelationship",Pf="DataEntryRelationshipAlreadyExists",Df=function(e,t,n,a,r){return le(Tf)({value:e,valueMeta:t,fieldId:n,dataEntryId:a,itemId:r})},Uf=function(e,t,n){return le(wf)({dataEntryId:e,itemId:t,uid:n})},Lf=function(e,t,n){return le(Rf)({dataEntryId:e,itemId:t,uid:n})},Mf=function(e,t,n){return le(kf)({dataEntryId:e,itemId:t,note:n})},Bf=function(e,t,n,a){return le(xf)({dataEntryId:e,itemId:t,relationship:n,newToEntity:a})},Vf=Object(D.b)(function(e,t){return{itemId:e.dataEntries[t.id]&&e.dataEntries[t.id].itemId}},function(e){return{onUpdateFieldInner:function(t,n,a,r,o,i,c,s,l){var u=function(e,t,n,a,r,o,i,c){return le(Sf)({value:e,uiState:t,formId:r,formBuilderId:a,elementId:n,dataEntryId:o,itemId:i,updateCompleteUid:c})}(r,o,i,c,s,t,n,l);a?a(u):e(u)}}},null,{withRef:!0})(yf),Gf=n(1489),Wf=n.n(Gf),Hf=function(e){return m.a.createElement(C,Object.assign({size:24},e))},zf=Object(E.withStyles)(function(){return{wrapper:{position:"relative"},progress:{position:"absolute",left:"50%",top:"50%",transform:"translate(-50% ,-50%)",color:Wf.a[600]}}})(function(e){var t=e.inProgress,n=e.children,a=e.classes,r=Object(Fe.a)(e,["inProgress","children","classes"]);return t?f.createElement("div",{className:a.wrapper},f.createElement(Yc,Object.assign({disabled:!0},r),n),f.createElement(Hf,{className:a.progress})):f.createElement(Yc,r,n)}),Kf=function(e){function t(){return Object(A.a)(this,t),Object(F.a)(this,Object(x.a)(t).apply(this,arguments))}return Object(P.a)(t,e),Object(w.a)(t,[{key:"render",value:function(){var e=this.props,t=e.open,n=e.header,a=e.text,r=e.confirmText,o=e.onConfirm,i=e.cancelText,c=e.onCancel;return m.a.createElement(z.a,{open:t,onClose:c},m.a.createElement(J.a,null,n),m.a.createElement(X.a,null,m.a.createElement(Nn.a,null,a)),m.a.createElement(Y.a,null,m.a.createElement($.a,{onClick:c,color:"primary"},i),m.a.createElement($.a,{onClick:o,color:"primary"},r)))}}]),t}(f.Component),Yf=function(e){function t(e){var n;return Object(A.a)(this,t),(n=Object(F.a)(this,Object(x.a)(t).call(this,e))).handleCancel=function(){n.props.dataEntryHasChanges?n.setState({dialogOpen:!0}):n.props.onCancel()},n.handleCancelDiscard=function(){n.setState({dialogOpen:!1})},n.state={dialogOpen:!1},n}return Object(P.a)(t,e),Object(w.a)(t,[{key:"render",value:function(){var e=this.props,t=e.finalInProgress,n=e.options;return f.createElement("div",null,f.createElement(zf,{variant:"text",onClick:this.handleCancel,color:n.color||"primary",inProgress:t},c.a.t("Cancel")),f.createElement(Kf,{header:c.a.t("Unsaved changes"),text:c.a.t("Leaving this page will discard the changes you made to this event."),confirmText:c.a.t("Yes, discard"),cancelText:c.a.t("No, stay here"),onConfirm:this.props.onCancel,open:this.state.dialogOpen,onCancel:this.handleCancelDiscard}))}}]),t}(f.Component),qf=function(e,t){if(Object.keys(e.formsSectionsFieldsUI).filter(function(e){return e.startsWith(t)}).reduce(function(t,n){return[].concat(Object(We.a)(t),Object(We.a)(Object.keys(e.formsSectionsFieldsUI[n]).map(function(t){return e.formsSectionsFieldsUI[n][t]})))},[]).some(function(e){return e.modified}))return!0;var n=e.dataEntriesFieldsUI[t];return!!n&&Object.keys(n).some(function(e){return n[e].modified})},Xf=Object(D.b)(function(e,t){var n=e.dataEntries&&e.dataEntries[t.id]&&e.dataEntries[t.id].itemId,a=ff(t.id,n);return{finalInProgress:!(!e.dataEntriesUI[a]||!e.dataEntriesUI[a].finalInProgress),dataEntryHasChanges:!!qf(e,a)}},function(){return{}},null,{withRef:!0})(Yf),Zf=function(e){return function(t){return function(e,t){return function(n){function a(){var e,t;Object(A.a)(this,a);for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return(t=Object(F.a)(this,(e=Object(x.a)(a)).call.apply(e,[this].concat(r)))).getWrappedInstance=function(){return t.innerInstance},t.getCancelButtonInstance=function(e){var n=e&&e.getWrappedInstance();t.props.cancelButtonRef&&t.props.cancelButtonRef(n)},t}return Object(P.a)(a,n),Object(w.a)(a,[{key:"render",value:function(){var n=this,a=this.props,r=a.onCancel,o=(a.cancelButtonRef,Object(Fe.a)(a,["onCancel","cancelButtonRef"])),i=t&&t(this.props)||{};return f.createElement(e,Object.assign({ref:function(e){n.innerInstance=e},cancelButton:f.createElement(Xf,{id:this.props.id,ref:this.getCancelButtonInstance,onCancel:r,options:i})},o))}}]),a}(f.Component)}(t,e)}};function Jf(e,t){return t&&t.some(function(t){var a=(0,t.validator)(e);return!(!0===a||a&&a.valid)&&(n=a&&a.message||t.message,!0)})?n||c.a.t("validation failed"):null;var n}var Qf=function(e){function t(){var e,n;Object(A.a)(this,t);for(var a=arguments.length,r=new Array(a),o=0;o<a;o++)r[o]=arguments[o];return(n=Object(F.a)(this,(e=Object(x.a)(t)).call.apply(e,[this].concat(r)))).handleBlur=function(e,t){var a=n.props,r=a.validatorContainers,o=a.onUpdateFieldInner,i=a.onUpdateField,c=Jf(e,r);o(e,{isValid:!c,validationError:c,touched:!t||null==t.touched||t.touched},n.props.propName,n.props.dataEntryId,n.props.itemId,i)},n}return Object(P.a)(t,e),Object(w.a)(t,[{key:"validateAndScrollToIfFailed",value:function(){var e=this.props.valueMeta&&this.props.valueMeta.isValid;return e||this.goto(),e}},{key:"goto",value:function(){if(this.gotoInstance){this.gotoInstance.scrollIntoView();var e=window.scrollY;e&&window.scroll(0,e-48)}}},{key:"render",value:function(){var e=this,t=this.props,n=t.completionAttempted,a=t.saveAttempted,r=t.Component,o=(t.validatorContainers,t.propName),i=(t.onUpdateField,t.onUpdateFieldInner,t.valueMeta),c=(t.itemId,t.dataEntryId,t.componentProps),s=Object(Fe.a)(t,["completionAttempted","saveAttempted","Component","validatorContainers","propName","onUpdateField","onUpdateFieldInner","valueMeta","itemId","dataEntryId","componentProps"]),l=(i.isValid,i.type,Object(Fe.a)(i,["isValid","type"]));return f.createElement("div",{ref:function(t){e.gotoInstance=t},key:o},f.createElement(r,Object.assign({onBlur:this.handleBlur,validationAttempted:!(!n&&!a)},l,s,c)))}}]),t}(f.Component),$f=Object(D.b)(function(e,t){var n=t.propName,a=e.dataEntries[t.dataEntryId].itemId,r=ff(t.dataEntryId,a);return{value:e.dataEntriesFieldsValue[r][n],valueMeta:e.dataEntriesFieldsUI[r][n],itemId:a,propName:n}},function(e){return{onUpdateFieldInner:function(t,n,a,r,o,i){var c=Df(t,n,a,r,o);i?i(c,{value:t,valueMeta:n,fieldId:a,dataEntryId:r,itemId:o}):e(Df(t,n,a,r,o))}}},function(e,t,n){var a=n.innerFieldRef,r=Object(Fe.a)(n,["innerFieldRef"]);return Object.assign({ref:a},r,e,t)})(Qf),em=Object(nl.createSelectorCreator)(nl.defaultMemoize,function(e,t){return!!Object.keys(t).every(function(n){return t[n]===e[n]})&&Object.keys(e).every(function(n){return e[n]===t[n]})}),tm=function(e){return e||{}},nm=function(){return em(tm,function(e){return e})},am=function(e){return function(t){return Object(D.b)(function(e){return function(t,n){var a,r=e.getPassOnFieldData,o=e.getPropName;if(r&&r(n)){var i=o(n),c=t.dataEntries[n.id].itemId,s=ff(n.id,c),l=t.dataEntriesFieldsValue[s][i];a=Object(Ut.a)({},"".concat(i,"DataEntryFieldValue"),l)}return Object(se.a)({},a)}}(e),function(){return{}})(function(e,t){return function(n){function a(t){var n;return Object(A.a)(this,a),(n=Object(F.a)(this,Object(x.a)(a).call(this,t))).handleRef=function(t){if(n.props.dataEntryFieldRef){var a=(0,e.getPropName)(n.props);if(!a)return void O.a.error(Object(ze.b)("data entry field needs a key, but no propName was specified")({}));n.props.dataEntryFieldRef(t,a)}},n.reselectComponentProps=nm(),n}return Object(P.a)(a,n),Object(w.a)(a,[{key:"getFieldElement",value:function(){var t=this.props,n=t.id,a=t.completionAttempted,r=t.saveAttempted,o=t.onUpdateDataEntryField,i=e.getComponent,c=e.getComponentProps,s=e.getValidatorContainers,l=e.getPropName,u=i(this.props),d=this.reselectComponentProps(c&&c(this.props)),p=s&&s(this.props)||[];return f.createElement($f,{innerFieldRef:this.handleRef,dataEntryId:n,completionAttempted:a,saveAttempted:r,Component:u,validatorContainers:p,propName:l(this.props),onUpdateField:o,componentProps:d})}},{key:"getFields",value:function(){var t=this.props.fields,n=e.getMeta,a=e.getIsHidden,r=n&&n(this.props);if(a&&a(this.props))return t?Object(We.a)(t):[];var o={field:this.getFieldElement(),placement:r&&r.placement||df,section:r&&r.section};return t?[].concat(Object(We.a)(t),[o]):[o]}},{key:"render",value:function(){var e=this.props,n=(e.fields,Object(Fe.a)(e,["fields"]));return f.createElement("div",null,f.createElement(t,Object.assign({fields:this.getFields()},n)))}}]),a}(f.Component)}(e,t))}},rm=function(e,t){var n=e.dataEntries&&e.dataEntries[t.dataEntryId]&&e.dataEntries[t.dataEntryId].itemId,a=ff(t.dataEntryId,n);return{itemId:n,notes:e.dataEntriesNotes[a]||[]}},om=function(){return function(e){return Object(D.b)(rm,function(){return{}})(function(e){return function(t){function n(){var e,t;Object(A.a)(this,n);for(var a=arguments.length,r=new Array(a),o=0;o<a;o++)r[o]=arguments[o];return(t=Object(F.a)(this,(e=Object(x.a)(n)).call.apply(e,[this].concat(r)))).handleAddNote=function(e){t.props.onAddNote(t.props.itemId,t.props.dataEntryId,e)},t}return Object(P.a)(n,t),Object(w.a)(n,[{key:"render",value:function(){var t=this.props,n=(t.onAddNote,t.itemId,t.dataEntryId,Object(Fe.a)(t,["onAddNote","itemId","dataEntryId"]));return f.createElement(e,Object.assign({},n,{onAddNote:this.handleAddNote}))}}]),n}(f.Component)}(e))}},im=n(969),cm=Ia()(Qo),sm=function(e){function t(e){var n;return Object(A.a)(this,t),(n=Object(F.a)(this,Object(x.a)(t).call(this,e))).toggleIsOpen=function(){n.setState(function(e){return{addIsOpen:!e.addIsOpen}})},n.onCancel=function(){n.props.onBlur(null,{touched:!1}),n.toggleIsOpen()},n.onNewNoteEditorBlur=function(e){n.props.onBlur(e,{touched:!1})},n.handleAddNote=function(){n.props.value&&n.props.onAddNote(n.props.value),n.toggleIsOpen(),n.props.onBlur(null,{touched:!1})},n.handleChange=function(e){n.setState({value:e})},n.renderInput=function(){var e=n.props.classes;return f.createElement("div",{className:e.newNoteFormContainer},f.createElement(im.a,{onEdit:n.handleChange},f.createElement(cm,{onBlur:n.onNewNoteEditorBlur,onChange:n.handleChange,value:n.state.value,multiLine:!0})),f.createElement("div",{className:e.newCommentButtonContainer},f.createElement(Yc,{onClick:n.handleAddNote,color:"primary"},c.a.t("Add comment")),f.createElement(Yc,{onClick:n.onCancel},c.a.t("Cancel"))))},n.renderButton=function(e){return f.createElement(Si.j,{title:e?"":c.a.t("You dont have access to write comments")},f.createElement("div",{className:n.props.classes.newNoteButtonContainer},f.createElement(Yc,{onClick:n.toggleIsOpen,disabled:!e},c.a.t("Write comment"))))},n.render=function(){var e=n.props,t=e.notes,a=e.classes,r=e.entityAccess;return f.createElement("div",{className:a.notesContainer},f.createElement(Si.g,{dense:!0,className:a.notesList},t.map(function(e){return f.createElement(Si.h,{className:a.noteItem,key:e.clientId},f.createElement("div",{className:a.noteItemHeader},f.createElement("div",{className:a.noteItemUser},e.storedBy),f.createElement("div",{className:a.noteItemDate},e.storedDate)),f.createElement("div",null,f.createElement(im.b,null,e.value)))})),f.createElement("div",{className:a.newNoteContainer},n.state.addIsOpen?n.renderInput():n.renderButton(r.write)))},n.state={addIsOpen:!!n.props.value,value:n.props.value||null},n}return Object(P.a)(t,e),Object(w.a)(t,[{key:"componentWillReceiveProps",value:function(e){e.value===this.props.value&&this.props.value===this.state.value||this.setState({value:e.value})}}]),t}(f.Component);sm.defaultProps={entityAccess:{read:!0,write:!0}};var lm=Object(E.withStyles)(function(e){return{noteItem:{display:"flex",flexDirection:"column",alignItems:"normal",background:e.palette.grey.lighter,marginBottom:e.typography.pxToRem(3),fontSize:e.typography.pxToRem(14)},commandButton:{width:e.typography.pxToRem(30),height:e.typography.pxToRem(30)},borderBoxContent:{margin:e.typography.pxToRem(10)},newCommentButtonContainer:{marginTop:e.typography.pxToRem(10)},newNoteContainer:{},newNoteFormContainer:{background:e.palette.grey.lighter,padding:e.typography.pxToRem(10)},notesContainer:{},noteItemHeader:{display:"flex"},noteItemUser:{flexGrow:1,fontWeight:"bold"},noteItemDate:{color:e.palette.grey[600]},notesList:{padding:0},newNoteButtonContainer:{display:"inline-block"}}})(sm),um=function(e,t){var n=e.dataEntries&&e.dataEntries[t.dataEntryId]&&e.dataEntries[t.dataEntryId].itemId,a=ff(t.dataEntryId,n);return{relationships:e.dataEntriesRelationships[a],itemId:n}},dm=function(e){return{onRemoveRelationship:function(t,n,a){e(function(e,t,n){return le(Ff)({dataEntryId:e,itemId:t,relationshipClientId:n})}(n,t,a))}}},pm=function(){return function(e){return Object(D.b)(um,dm)(function(e){return function(t){function n(){var e,t;Object(A.a)(this,n);for(var a=arguments.length,r=new Array(a),o=0;o<a;o++)r[o]=arguments[o];return(t=Object(F.a)(this,(e=Object(x.a)(n)).call.apply(e,[this].concat(r)))).handleOpenAddRelationship=function(){t.props.onOpenAddRelationship(t.props.itemId,t.props.dataEntryId)},t.handleRemoveRelationship=function(e){t.props.onRemoveRelationship(t.props.itemId,t.props.dataEntryId,e)},t}return Object(P.a)(n,t),Object(w.a)(n,[{key:"render",value:function(){var t=this.props,n=(t.onOpenAddRelationship,t.onRemoveRelationship,t.itemId,t.dataEntryId,Object(Fe.a)(t,["onOpenAddRelationship","onRemoveRelationship","itemId","dataEntryId"]));return f.createElement(e,Object.assign({},n,{onOpenAddRelationship:this.handleOpenAddRelationship,onRemoveRelationship:this.handleRemoveRelationship}))}}]),n}(f.Component)}(e))}},fm={PROGRAM_STAGE_INSTANCE:c.a.t("This event")},mm=function(e){function t(){var e,n;Object(A.a)(this,t);for(var a=arguments.length,r=new Array(a),o=0;o<a;o++)r[o]=arguments[o];return(n=Object(F.a)(this,(e=Object(x.a)(t)).call.apply(e,[this].concat(r)))).renderRelationships=function(){return n.props.relationships.map(function(e){return n.renderRelationship(e)})},n.renderRelationship=function(e){var t=n.props,a=t.classes,r=t.onRemoveRelationship,o=n.canDelete(e),i=Cn()(a.relationshipDetails,Object(Ut.a)({},a.relationshipHighlight,n.shouldHighlightRelationship(e)));return f.createElement("div",{className:a.relationship,key:e.clientId},f.createElement("div",{className:i},f.createElement("div",{className:a.relationshipTypeName},e.relationshipType.name),f.createElement("div",{className:a.relationshipEntities},n.getEntityName(e.from),f.createElement(Di.d,{className:a.arrowIcon}),n.getEntityName(e.to))),f.createElement("div",{className:a.relationshipActions},f.createElement(Si.j,{title:o?"":c.a.t("You dont have access to delete this relationship")},f.createElement("div",null,f.createElement(Si.f,{onClick:function(){r(e.clientId)},disabled:!o},f.createElement(Di.f,null))))))},n.shouldHighlightRelationship=function(e){var t=n.props.highlightRelationshipId;return t&&t===e.clientId},n.getEntityName=function(e){return e.id===n.props.currentEntityId?fm[e.type]:e.name},n.canDelete=function(e){var t=n.props,a=t.entityAccess,r=t.writableRelationshipTypes;return e.from.id===n.props.currentEntityId&&a.write&&r.some(function(t){return t.id===e.relationshipType.id&&t.access.data.write})},n}return Object(P.a)(t,e),Object(w.a)(t,[{key:"shouldComponentUpdate",value:function(e){var t=this,n=Object.keys(e).filter(function(n){return e[n]!==t.props[n]}),a=n.length;return!(1===a&&"highlightRelationshipId"===n[0]&&!e.highlightRelationshipId)&&a>0}},{key:"render",value:function(){var e=this.props,t=e.classes,n=e.onOpenAddRelationship,a=e.entityAccess,r=e.writableRelationshipTypes,o=e.relationshipsRef,i=a.write&&r.length>0;return f.createElement("div",{className:t.container,ref:o},f.createElement("div",{className:t.relationshipsContainer},this.renderRelationships()),f.createElement("div",null,f.createElement(Si.j,{title:i?"":c.a.t("You dont have access to create any relationships")},f.createElement("div",{className:t.addButtonContainer},f.createElement(Yc,{onClick:n,disabled:!i},c.a.t("Add relationship"))))))}}]),t}(f.Component);mm.defaultProps={entityAccess:{read:!0,write:!0}};var hm,bm=Object(E.withStyles)(function(e){return{relationship:{display:"flex",alignItems:"center",padding:5},relationshipDetails:{backgroundColor:e.palette.grey.lighter,padding:7,flexGrow:1},relationshipTypeName:{fontSize:14,fontWeight:600,color:"rgba(0,0,0,0.7)"},relationshipsContainer:{},container:{display:"flex",flexDirection:"column"},relationshipEntities:{marginTop:7,fontSize:15,display:"flex",alignItems:"center"},arrowIcon:{marginLeft:10,marginRight:10,fontSize:15},relationshipActions:{padding:7},addButtonContainer:{display:"inline-block"},"@keyframes background-fade":{"0%":{backgroundColor:e.palette.secondary.lightest},"70%":{backgroundColor:e.palette.secondary.lightest},"100%":{backgroundColor:e.palette.grey.lighter}},relationshipHighlight:{animation:"background-fade 2.5s forwards"}}})(mm),gm=function(e){return!e||Dn(e)},Om=function(){return[{validator:An,message:c.a.t("A value is required")},{validator:gm,message:c.a.t("Please provide a valid date")}]},vm={SAVEANDADDANOTHER:"SAVEANDADDANOTHER",SAVEANDEXIT:"SAVEANDEXIT",FINISH:"FINISH"},ym=n(299),Em=n.n(ym),_m=n(523),jm=n.n(_m),Im=n(524),Cm=n.n(Im),Tm=function(e){function t(e){var n;return Object(A.a)(this,t),(n=Object(F.a)(this,Object(x.a)(t).call(this,e))).onMenuItemClick=function(e){n.toggleMenu(),e.onClick()},n.toggleMenu=function(){n.setState({menuOpen:!n.state.menuOpen,anchorElement:n.buttonInstance})},n.renderMenuItems=function(){return n.props.dropDownItems.map(function(e){return f.createElement(Rl.a,{key:e.key,onClick:function(){return n.onMenuItemClick(e)}},e.text)})},n.state={menuOpen:!1,anchorElement:null},n}return Object(P.a)(t,e),Object(w.a)(t,[{key:"render",value:function(){var e=this,t=this.props,n=t.classes,a=t.color,r=t.variant,o=Object(se.a)({color:a,variant:r},this.props.arrowProps),i=Object(se.a)({color:a,variant:r},this.props.buttonProps);return f.createElement("div",null,f.createElement("div",{className:n.buttonsContainer,ref:function(t){e.buttonInstance=t}},f.createElement("div",null,"progress"===this.props.buttonType?f.createElement(zf,Object.assign({className:n.button},i),this.props.buttonText):f.createElement(Yc,Object.assign({className:n.button},i),this.props.buttonText)),f.createElement("div",{ref:function(t){e.arrowInstance=t}},f.createElement(Yc,Object.assign({onClick:this.toggleMenu,className:n.arrowButton,variant:r,color:a},o),this.state.menuOpen?f.createElement(Cm.a,null):f.createElement(jm.a,null)))),f.createElement(Em.a,{id:"simple-menu",anchorEl:this.state.anchorElement,getContentAnchorEl:null,anchorOrigin:{vertical:"bottom",horizontal:"right"},transformOrigin:{vertical:"top",horizontal:"right"},elevation:10,open:this.state.menuOpen,onClose:this.toggleMenu,MenuListProps:{className:n.menuList}},this.renderMenuItems()))}}]),t}(f.Component),Sm=Object(E.withStyles)(function(){return{buttonsContainer:{display:"flex",flexDirection:"row"},arrowButton:{padding:0,minWidth:0,borderBottomLeftRadius:0,borderTopLeftRadius:0},button:{borderBottomRightRadius:0,borderTopRightRadius:0},menuList:{paddingTop:0,paddingBottom:0}}})(Tm),Rm=function(e){var t=e.formsValues["singleEvent-newEvent"]||{};if(Object.keys(t).some(function(e){return t[e]}))return!0;var n=e.dataEntriesFieldsValue["singleEvent-newEvent"]||{};return Object.keys(n).some(function(e){return n[e]})},km=Object(se.a)({},vm,{FINISH:"FINISH"}),Nm=(hm={},Object(Ut.a)(hm,km.SAVEANDADDANOTHER,function(e){return{key:km.SAVEANDADDANOTHER,text:c.a.t("Save and add another"),onClick:function(){e.onSave(vm.SAVEANDADDANOTHER)}}}),Object(Ut.a)(hm,km.SAVEANDEXIT,function(e){return{key:km.SAVEANDEXIT,text:c.a.t("Save and exit"),onClick:function(){e.onSave(vm.SAVEANDEXIT)}}}),Object(Ut.a)(hm,km.FINISH,function(e){return{key:km.FINISH,text:c.a.t("Finish"),onClick:function(){e.onCancel()}}}),hm),Am=function(e,t){var n=e.dataEntries&&e.dataEntries[t.id]&&e.dataEntries[t.id].itemId,a=ff(t.id,n),r=Rm(e),o=e.recentlyAddedEvents&&Object.keys(e.recentlyAddedEvents).length>0;return{saveTypes:e.newEventPage.saveTypes,finalInProgress:e.dataEntriesUI[a]&&e.dataEntriesUI[a].finalInProgress,dataEntryHasChanges:r,hasRecentlyAddedEvents:o}},wm=function(){return{}},Fm=function(e){return!e},xm=function(){return[{validator:Fm,message:c.a.t("Please add or cancel comment before saving the event")}]},Pm=function(e){return function(t){return function(e,t){return function(n){function a(n){var r;Object(A.a)(this,a),r=Object(F.a)(this,Object(x.a)(a).call(this,n));var o=e.isApplicable(r.props);return r.Component=o?am(e)(t):t,r}return Object(P.a)(a,n),Object(w.a)(a,[{key:"getWrappedInstance",value:function(){return this.innerInstance}},{key:"render",value:function(){var e=this,t=this.Component;return f.createElement(t,Object.assign({ref:function(t){e.innerInstance=t}},this.props))}}]),a}(f.Component)}(e,t)}},Dm=function(e,t){var n=e.dataEntries&&e.dataEntries[t.id]&&e.dataEntries[t.id].itemId,a=ff(t.id,n);return{dataEntryHasChanges:qf(e,a)}},Um=function(){return{}},Lm=function(){return function(e){return Object(D.b)(Dm,Um)(Object(B.a)(function(e){return function(t){function n(e){var t;return Object(A.a)(this,n),(t=Object(F.a)(this,Object(x.a)(n).call(this,e))).handleDialogConfirm=function(){t.setState({dialogOpen:!1}),t.unblock()},t.handleDialogCancel=function(){t.setState({dialogOpen:!1})},t.state={dialogOpen:!1},t}return Object(P.a)(n,t),Object(w.a)(n,[{key:"componentDidMount",value:function(){var e=this,t=this.props.history;this.unblock=t.block(function(t,n){var a=e.props.dataEntryHasChanges;return"POP"!==n||!a||(e.setState({dialogOpen:!0}),!1)})}},{key:"componentWillUnmount",value:function(){this.unblock&&this.unblock()}},{key:"render",value:function(){var t=this.props,n=(t.dataEntryHasChanges,t.history,t.location,t.match,t.staticContext,Object(Fe.a)(t,["dataEntryHasChanges","history","location","match","staticContext"]));return f.createElement(f.Fragment,null,f.createElement(e,n),f.createElement(Kf,{header:c.a.t("Unsaved changes"),text:c.a.t("Leaving this page will discard the changes you made to this event."),confirmText:c.a.t("Yes, discard"),cancelText:c.a.t("No, stay here"),onConfirm:this.handleDialogConfirm,open:this.state.dialogOpen,onCancel:this.handleDialogCancel}))}}]),n}(f.Component)}(e)))}},Mm=function(e){function t(){return Object(A.a)(this,t),Object(F.a)(this,Object(x.a)(t).apply(this,arguments))}return Object(P.a)(t,e),Object(w.a)(t,[{key:"getContents",value:function(){var e=this.props,n=e.warnings,a=e.errors,r=e.classes,o=n.map(function(e){return f.createElement("li",{key:e.key},e.name?t.getItemWithName(e.name,e.warning):t.getItemWithoutName(e.warning))}),i=a.map(function(e){return f.createElement("li",{key:e.key},e.name?t.getItemWithName(e.name,e.error):t.getItemWithoutName(e.error))});return f.createElement("div",null,f.createElement("div",null,i.length>1?c.a.t("The following errors were found:"):c.a.t("The following error was found:")),f.createElement("div",{className:r.errors},i),f.createElement("div",{className:r.warningsLabel},o.length>1?c.a.t("The following warnings were found:"):c.a.t("The following warning was found:")),f.createElement("div",{className:r.warnings},o))}},{key:"getButtons",value:function(){var e=this.props,t=e.onAbort,n=e.onSave,a=e.saveEnabled;return f.createElement(f.Fragment,null,f.createElement(Yc,{onClick:t,color:"primary"},c.a.t("Back to form")),a?f.createElement(Yc,{onClick:n,color:"primary",autoFocus:!0},c.a.t("Save anyway")):null)}},{key:"render",value:function(){return f.createElement(f.Fragment,null,f.createElement(J.a,{id:"save-dialog-errors-and-warnings-title"},c.a.t("Validation errors and warnings")),f.createElement(X.a,null,f.createElement(Nn.a,null,this.getContents())),f.createElement(Y.a,null,this.getButtons()))}}],[{key:"getItemWithName",value:function(e,t){return f.createElement(f.Fragment,null,e,": ",t)}},{key:"getItemWithoutName",value:function(e){return f.createElement(f.Fragment,null,e)}}]),t}(f.Component),Bm=Object(E.withStyles)(function(e){return{errors:{border:"1px solid ".concat(e.palette.grey.light),borderRadius:e.typography.pxToRem(4),padding:5},warningsLabel:{paddingTop:20},warnings:{border:"1px solid ".concat(e.palette.grey.light),borderRadius:e.typography.pxToRem(4),padding:5}}})(Mm),Vm=function(e){function t(){return Object(A.a)(this,t),Object(F.a)(this,Object(x.a)(t).apply(this,arguments))}return Object(P.a)(t,e),Object(w.a)(t,[{key:"getContents",value:function(){return this.props.errors.map(function(e){return f.createElement("li",{key:e.key},e.name?t.getItemWithName(e.name,e.error):t.getItemWithoutName(e.error))})}},{key:"getButtons",value:function(){var e=this.props,t=e.onAbort,n=e.onSave,a=e.saveEnabled;return f.createElement(f.Fragment,null,f.createElement(Yc,{onClick:t,color:"primary"},c.a.t("Back to form")),a?f.createElement(Yc,{onClick:n,color:"primary",autoFocus:!0},c.a.t("Save anyway")):null)}},{key:"render",value:function(){return f.createElement(f.Fragment,null,f.createElement(J.a,{id:"save-dialog-errors-title"},c.a.t("Validation errors")),f.createElement(X.a,null,f.createElement(Nn.a,null,this.getContents())),f.createElement(Y.a,null,this.getButtons()))}}],[{key:"getItemWithName",value:function(e,t){return f.createElement(f.Fragment,null,e,": ",t)}},{key:"getItemWithoutName",value:function(e){return f.createElement(f.Fragment,null,e)}}]),t}(f.Component),Gm=function(e){function t(){return Object(A.a)(this,t),Object(F.a)(this,Object(x.a)(t).apply(this,arguments))}return Object(P.a)(t,e),Object(w.a)(t,[{key:"getContents",value:function(){return this.props.warnings.map(function(e){return f.createElement("li",{key:e.key},e.name?t.getItemWithName(e.name,e.warning):t.getItemWithoutName(e.warning))})}},{key:"render",value:function(){var e=this.props,t=e.onAbort,n=e.onSave;return f.createElement(f.Fragment,null,f.createElement(J.a,{id:"save-dialog-errors-and-warnings-title"},c.a.t("Validation warnings")),f.createElement(X.a,null,f.createElement(Nn.a,null,this.getContents())),f.createElement(Y.a,null,f.createElement(Yc,{onClick:t,color:"primary"},c.a.t("Back to form")),f.createElement(Yc,{onClick:n,color:"primary",autoFocus:!0},c.a.t("Save anyway"))))}}],[{key:"getItemWithName",value:function(e,t){return f.createElement(f.Fragment,null,e,": ",t)}},{key:"getItemWithoutName",value:function(e){return f.createElement(f.Fragment,null,e)}}]),t}(f.Component);function Wm(e,t){return t===dt.NONE||t===dt.ON_COMPLETE&&!e}var Hm=function(e){var t=e.open,n=e.warnings,a=e.errors,r=e.isCompleting,o=e.validationStrategy,i=Object(Fe.a)(e,["open","warnings","errors","isCompleting","validationStrategy"]);return t?n&&n.length>0&&a&&a.length>0?f.createElement(Bm,Object.assign({errors:a,warnings:n,saveEnabled:Wm(r,o)},i)):a&&a.length>0?f.createElement(Vm,Object.assign({errors:a,saveEnabled:Wm(r,o)},i)):f.createElement(Gm,Object.assign({warnings:n},i)):null},zm=function(e,t,n){return n.foundation},Km=function(e,t,n){return e.rulesEffectsMessages[n.key]},Ym=function(e,t,n){return e.rulesEffectsGeneralWarnings[n.key]?e.rulesEffectsGeneralWarnings[n.key].warningOnComplete:void 0},qm=function(e,t,n){return e.rulesEffectsGeneralErrors[n.key]?e.rulesEffectsGeneralErrors[n.key].errorOnComplete:void 0},Xm=function(e,t,n,a){var r=function(a){function r(e){var t;return Object(A.a)(this,r),(t=Object(F.a)(this,Object(x.a)(r).call(this,e))).handleSaveAttempt=function(e){t.props.inProgressList.length>0?t.setState({waitForPromisesDialogOpen:!0,saveType:e}):t.validateAndSave(e)},t.handleAbortDialog=function(){t.props.onSaveAbort(t.props.itemId,t.props.id),t.setState({messagesDialogOpen:!1})},t.handleSaveDialog=function(){t.handleSave(t.state.saveType),t.setState({messagesDialogOpen:!1})},t.handleSave=function(e){var n=t.props;(0,n.onSave)(n.itemId,n.id,n.calculatedFoundation,e)},t.getDialogWaitForUploadContents=function(){return f.createElement("div",null,c.a.t("Some operations are still runnning. Please wait.."))},t.setFormInstance=function(e){t.formInstance=e},t.setDataEntryFieldInstance=function(e,n){t.dataEntryFieldInstances.set(n,e)},t.dataEntryFieldInstances=new Map,t.state={messagesDialogOpen:!1,waitForPromisesDialogOpen:!1},t}return Object(P.a)(r,a),Object(w.a)(r,[{key:"componentDidUpdate",value:function(e){this.state.waitForPromisesDialogOpen&&0===this.props.inProgressList.length&&e.inProgressList.length>0&&(this.validateAndSave(this.state.saveType),this.setState({waitForPromisesDialogOpen:!1,saveType:null}))}},{key:"getWrappedInstance",value:function(){return this.innerInstance}},{key:"getDataEntryFieldInstances",value:function(){return Array.from(this.dataEntryFieldInstances.entries()).map(function(e){return e[1]})}},{key:"validateDataEntryFields",value:function(){for(var e=this.getDataEntryFieldInstances(),t=!0,n=0;e[n]&&t;)t=e[n].validateAndScrollToIfFailed(),n+=1;return t}},{key:"showMessagesPopup",value:function(e){this.setState({messagesDialogOpen:!0,saveType:e})}},{key:"validateGeneralErrorsFromRules",value:function(e){var t=this.props.calculatedFoundation.validationStrategy;return t===dt.NONE||(t===dt.ON_COMPLETE&&!e||!this.props.hasGeneralErrors)}},{key:"validateForm",value:function(){var e=this.formInstance;if(!e)return O.a.error(Object(ze.b)(r.errorMessages.FORM_INSTANCE_NOT_FOUND)({SaveButtonBuilder:this})),{error:!0,isValid:!1};var n=!(!t||!t(this.props));return{isValid:e.validateFormScrollToFirstFailedField({isCompleting:n})&&this.validateGeneralErrorsFromRules(n),error:!1}}},{key:"validateAndSave",value:function(e){if(this.validateDataEntryFields()){var t=this.validateForm(),n=t.error,a=t.isValid;n||this.handleSaveValidationOutcome(e,a)}else this.props.onSaveValidationFailed(this.props.itemId,this.props.id)}},{key:"handleSaveValidationOutcome",value:function(e,t){var n=this.props,a=n.onSaveValidationFailed,r=n.itemId,o=n.id,i=n.warnings,c=n.errors;t?c&&c.length>0||i&&i.length>0?this.showMessagesPopup(e):this.handleSave(e):a(r,o)}},{key:"render",value:function(){var a=this,r=this.props,o=r.itemId,i=(r.onSave,r.onSaveValidationFailed,r.onSaveAbort,r.warnings),s=r.errors,l=(r.hasGeneralErrors,r.inProgressList,r.calculatedFoundation),u=Object(Fe.a)(r,["itemId","onSave","onSaveValidationFailed","onSaveAbort","warnings","errors","hasGeneralErrors","inProgressList","calculatedFoundation"]);if(!o)return null;var d=n?n(u):u;return this.isCompleting=!(!t||!t(this.props)),f.createElement("div",null,f.createElement(e,Object.assign({ref:function(e){a.innerInstance=e},formRef:this.setFormInstance,dataEntryFieldRef:this.setDataEntryFieldInstance,onSave:this.handleSaveAttempt},d)),f.createElement(z.a,{open:this.state.messagesDialogOpen,onClose:this.handleAbortDialog},f.createElement(Hm,{open:this.state.messagesDialogOpen,onAbort:this.handleAbortDialog,onSave:this.handleSaveDialog,errors:s,warnings:i,isCompleting:this.isCompleting,validationStrategy:l.validationStrategy})),f.createElement(z.a,{open:this.state.waitForPromisesDialogOpen},f.createElement(J.a,null,c.a.t("Operations running")),f.createElement(X.a,null,f.createElement(Nn.a,null,this.getDialogWaitForUploadContents()))))}}]),r}(f.Component);r.errorMessages={INNER_INSTANCE_NOT_FOUND:"Inner instance not found",FORM_INSTANCE_NOT_FOUND:"Form instance not found"};return Object(D.b)(function(){var e=Object(nl.createSelector)(Km,Ym,zm,function(e,t,n){e=e||{},t=t||[];var a=Object.keys(e).map(function(t){var a=e[t][Tp.WARNING_ON_COMPLETE];if(!a)return null;var r=n.getElement(t);return r?{key:t,name:r.name,warning:a}:null}).filter(function(e){return e}),r=t.map(function(e){return{key:e.id,name:null,warning:e.message}});return[].concat(Object(We.a)(a),Object(We.a)(r))}),t=Object(nl.createSelector)(Km,qm,zm,function(e,t,n){e=e||{},t=t||[];var a=Object.keys(e).map(function(t){var a=e[t][Tp.ERROR_ON_COMPLETE];if(!a)return null;var r=n.getElement(t);return r?{key:t,name:r.name,error:a}:null}).filter(function(e){return e}),r=t.map(function(e){return{key:e.id,name:null,error:e.message}});return[].concat(Object(We.a)(a),Object(We.a)(r))});return function(n,r){var o=n.dataEntries&&n.dataEntries[r.id]&&n.dataEntries[r.id].itemId,i=ff(r.id,o),c=n.rulesEffectsGeneralErrors[i]&&n.rulesEffectsGeneralErrors[i].error,s=a?a(r):r.formFoundation;return{itemId:o,saveAttempted:n.dataEntriesUI&&n.dataEntriesUI[i]&&n.dataEntriesUI[i].saveAttempted,warnings:e(n,r,{key:i,foundation:s}),errors:t(n,r,{key:i,foundation:s}),hasGeneralErrors:c&&c.length>0,inProgressList:n.dataEntriesInProgressList[i]||[],calculatedFoundation:s}}},function(e){return{onSaveValidationFailed:function(t,n){e(function(e,t){return le(If)({itemId:e,id:t})}(t,n))},onSaveAbort:function(t,n){e(function(e,t){return le(Cf)({itemId:e,id:t})}(t,n))}}},null,{withRef:!0})(r)},Zm=function(e){return function(t){return Xm(t,e&&e.onIsCompleting,e&&e.onFilterProps,e&&e.onGetFormFoundation)}},Jm=n(965),Qm=n.n(Jm),$m=n(387),eh=n.n($m),th="<p><br></p>",nh=function(e){function t(e){var n;return Object(A.a)(this,t),(n=Object(F.a)(this,Object(x.a)(t).call(this,e))).updateStateFromProps=function(e){var t=n.getStringValue(),a=e.value,r=e.format,o=a||"",i=n.state.editorValue;t!==o&&n.setState({editorValue:i.setContentFromString(o,r)})},n.onChange=function(e){n.setState({editorValue:e});var t=n.props.onChange;t&&t(n.getStringValue())},n.getStringValue=function(){return n.state.editorValue.toString(n.props.format)},n.getToolbarConfig=function(){return{display:["INLINE_STYLE_BUTTONS","LINK_BUTTONS"],INLINE_STYLE_BUTTONS:[{label:"Bold",style:"BOLD",className:"custom-css-class"},{label:"Italic",style:"ITALIC"},{label:"Underline",style:"UNDERLINE"}],BLOCK_TYPE_DROPDOWN:null}},n.onBlur=function(){var e=n.props.onBlur;if(e){var t=n.getStringValue();e(t===th?null:t)}},n.state={editorValue:Qm.a.createEmptyValue()},n}return Object(P.a)(t,e),Object(w.a)(t,[{key:"componentWillMount",value:function(){this.updateStateFromProps(this.props)}},{key:"componentWillReceiveProps",value:function(e){this.updateStateFromProps(e)}},{key:"render",value:function(){var e=this.props,t=e.classes,n=e.containerClassName,a=e.label,r=e.required,o=e.disabled;return f.createElement("div",{className:n},a&&f.createElement("div",{className:t.labelContainer},f.createElement(eh.a,{classes:{root:t.label},disabled:!!o,required:!!r},a)),f.createElement(Qm.a,{className:t.textEditor,value:this.state.editorValue,onChange:this.onChange,onBlur:this.onBlur,toolbarConfig:this.getToolbarConfig()}))}}]),t}(f.Component);nh.defaultProps={format:"html"};Object(E.withStyles)(function(e){return{labelContainer:{marginBottom:e.typography.pxToRem(5)},label:e.typography.formFieldTitle,textEditor:{fontFamily:"sans-serif!important",minHeight:e.typography.pxToRem(120)}}})(nh);var ah=n(178),rh=n.n(ah),oh=n(94),ih=n.n(oh),ch=function(){return function(e,t){return function(e,t){return function(n){function a(n){var r;return Object(A.a)(this,a),(r=Object(F.a)(this,Object(x.a)(a).call(this,n))).getDataEntryOutputs=function(){var e=r.props.dataEntryOutputs,t=r.getOutput(e?e.length:0);return e?[].concat(Object(We.a)(e),[t]):[t]},r.getOutput=function(e){return f.createElement("div",{style:{marginTop:10},key:e},f.createElement(t,Object.assign({key:e},r.props)))},r.render=function(){var t=r.props,n=(t.dataEntryOutputs,Object(Fe.a)(t,["dataEntryOutputs"]));return f.createElement("div",null,f.createElement(e,Object.assign({ref:function(e){r.innerInstance=e},dataEntryOutputs:r.getDataEntryOutputs()},n)))},r.name="DataEntryOutputBuilder",r}return Object(P.a)(a,n),a}(f.Component)}(e,t)}},sh=function(e){return{listItem:{display:"flex",backgroundColor:e.palette.grey[100],paddingLeft:e.typography.pxToRem(10),marginTop:e.typography.pxToRem(8)},keyValuePairKey:{flexGrow:1},card:{padding:e.typography.pxToRem(10),borderRadius:e.typography.pxToRem(5)}}},lh=function(e,t){var n=e.dataEntries[t.id].itemId,a=ff(t.id,n);return{feedbackItems:e.rulesEffectsFeedback&&e.rulesEffectsFeedback[a]?e.rulesEffectsFeedback[a]:null}},uh=function(){return{}},dh=function(){return function(e){return ch()(e,Object(E.withStyles)(sh)(Object(D.b)(lh,uh,null,{withRef:!0})(function(e){function t(){var e,n;Object(A.a)(this,t);for(var a=arguments.length,r=new Array(a),o=0;o<a;o++)r[o]=arguments[o];return(n=Object(F.a)(this,(e=Object(x.a)(t)).call.apply(e,[this].concat(r)))).renderFeedbackItems=function(e,t){return f.createElement("div",null,e.displayTexts&&e.displayTexts.map(function(e){return f.createElement(pn.a,{key:e.id,className:t.listItem,button:!1},f.createElement(ih.a,{variant:"body1"},e.message))}),e.displayKeyValuePairs&&e.displayKeyValuePairs.map(function(e){return f.createElement(pn.a,{key:e.id,className:t.listItem,button:!1},f.createElement(ih.a,{variant:"body1",className:t.keyValuePairKey},e.key),f.createElement(ih.a,{variant:"body2"},e.value))}))},n.render=function(){var e=n.props,t=e.feedbackItems,a=e.classes,r=t&&(t.displayTexts||t.displayKeyValuePairs);return f.createElement("div",null,r&&f.createElement(rh.a,{className:a.card},c.a.t("Feedback"),f.createElement(un.a,{dense:!0},t&&n.renderFeedbackItems(t,a))))},n}return Object(P.a)(t,e),t}(f.Component))))}},ph=n(526),fh=n.n(ph),mh=function(e){return{list:{margin:0},listItem:{paddingLeft:e.typography.pxToRem(10),marginTop:e.typography.pxToRem(8)},header:{display:"flex",alignItems:"center"},headerText:{marginLeft:e.typography.pxToRem(10)},card:{borderRadius:e.typography.pxToRem(5),padding:e.typography.pxToRem(10),backgroundColor:e.palette.warning[100]}}},hh=function(e,t){var n=e.dataEntries[t.id].itemId,a=ff(t.id,n);return{warningItems:e.rulesEffectsGeneralWarnings[a]?e.rulesEffectsGeneralWarnings[a].warning:null,warningOnCompleteItems:e.rulesEffectsGeneralWarnings[a]?e.rulesEffectsGeneralWarnings[a].warningOnComplete:null}},bh=function(){return{}},gh=function(){return function(e){return ch()(e,Object(E.withStyles)(mh)(Object(D.b)(hh,bh,null,{withRef:!0})(function(){var e,t;return t=e=function(e){function t(){var e,n;Object(A.a)(this,t);for(var a=arguments.length,r=new Array(a),o=0;o<a;o++)r[o]=arguments[o];return(n=Object(F.a)(this,(e=Object(x.a)(t)).call.apply(e,[this].concat(r)))).render=function(){var e=n.props.classes,a=n.getVisibleWarningItems();return f.createElement("div",null,a&&a.length>0&&f.createElement(rh.a,{className:e.card},f.createElement("div",{className:e.header},f.createElement(fh.a,null),f.createElement("div",{className:e.headerText},c.a.t("Warnings"))),f.createElement("ul",{className:e.list},t.renderWarningItems(a,e))))},n}return Object(P.a)(t,e),Object(w.a)(t,[{key:"getVisibleWarningItems",value:function(){var e=this.props,t=e.warningItems,n=e.warningOnCompleteItems;if(e.saveAttempted){var a=t||[],r=n||[];return[].concat(Object(We.a)(a),Object(We.a)(r))}return t||[]}}]),t}(f.Component),e.renderWarningItems=function(e,t){return f.createElement("div",null,e&&e.map(function(e){return f.createElement("li",{key:e.id,className:t.listItem},f.createElement(ih.a,{variant:"body1"},e.message))}))},t}())))}},Oh=n(525),vh=n.n(Oh),yh=function(e){return{card:{padding:e.typography.pxToRem(10),backgroundColor:e.palette.error[100],borderRadius:e.typography.pxToRem(5)},list:{margin:0},listItem:{paddingLeft:e.typography.pxToRem(10),marginTop:e.typography.pxToRem(8)},header:{color:"#902c02",display:"flex",alignItems:"center"},headerText:{marginLeft:e.typography.pxToRem(10)}}},Eh=function(e,t){var n=e.dataEntries[t.id].itemId,a=ff(t.id,n);return{errorItems:e.rulesEffectsGeneralErrors[a]?e.rulesEffectsGeneralErrors[a].error:null,errorOnCompleteItems:e.rulesEffectsGeneralErrors[a]?e.rulesEffectsGeneralErrors[a].errorOnComplete:null}},_h=function(){return{}},jh=function(){return function(e){return ch()(e,Object(E.withStyles)(yh)(Object(D.b)(Eh,_h,null,{withRef:!0})(function(){var e,t;return t=e=function(e){function t(e){var n;return Object(A.a)(this,t),(n=Object(F.a)(this,Object(x.a)(t).call(this,e))).render=function(){var e=n.props.classes,a=n.getVisibleErrorItems();return f.createElement("div",null,a&&a.length>0&&f.createElement(rh.a,{className:e.card},f.createElement("div",{className:e.header},f.createElement(vh.a,null),f.createElement("div",{className:e.headerText},c.a.t("Errors"))),f.createElement("ul",{className:e.list},t.renderErrorItems(a,e))))},n.name="ErrorOutputBuilder",n}return Object(P.a)(t,e),Object(w.a)(t,[{key:"getVisibleErrorItems",value:function(){var e=this.props,t=e.errorItems,n=e.errorOnCompleteItems;if(e.saveAttempted){var a=t||[],r=n||[];return[].concat(Object(We.a)(a),Object(We.a)(r))}return t||[]}}]),t}(f.Component),e.renderErrorItems=function(e,t){return f.createElement("div",null,e.map(function(e){return f.createElement("li",{key:e.id,className:t.listItem},f.createElement(ih.a,{variant:"body1"},e.message))}))},t}())))}},Ih=function(e){return{listItem:{display:"flex",backgroundColor:e.palette.grey[100],paddingLeft:e.typography.pxToRem(10),marginTop:e.typography.pxToRem(8)},keyValuePairKey:{flexGrow:1},card:{padding:e.typography.pxToRem(10),borderRadius:e.typography.pxToRem(5)}}},Ch=function(e,t){var n=e.dataEntries[t.id].itemId,a=ff(t.id,n);return{indicatorItems:e.rulesEffectsIndicators&&e.rulesEffectsIndicators[a]?e.rulesEffectsIndicators[a]:null}},Th=function(){return{}},Sh=function(){return function(e){return ch()(e,Object(E.withStyles)(Ih)(Object(D.b)(Ch,Th,null,{withRef:!0})(function(e){function t(){var e,n;Object(A.a)(this,t);for(var a=arguments.length,r=new Array(a),o=0;o<a;o++)r[o]=arguments[o];return(n=Object(F.a)(this,(e=Object(x.a)(t)).call.apply(e,[this].concat(r)))).renderIndicatorItems=function(e,t){return f.createElement("div",null,e.displayTexts&&e.displayTexts.map(function(e){return f.createElement(pn.a,{key:e.id,className:t.listItem,button:!1},f.createElement(ih.a,{variant:"body1"},e.message))}),e.displayKeyValuePairs&&e.displayKeyValuePairs.map(function(e){return f.createElement(pn.a,{key:e.id,className:t.listItem,button:!1},f.createElement(ih.a,{variant:"body1",className:t.keyValuePairKey},e.key),f.createElement(ih.a,{variant:"body2"},e.value))}))},n.render=function(){var e=n.props,t=e.indicatorItems,a=e.classes,r=t&&(t.displayTexts||t.displayKeyValuePairs);return f.createElement("div",null,r&&f.createElement(rh.a,{className:a.card},c.a.t("Indicators"),f.createElement(un.a,{dense:!0},t&&n.renderIndicatorItems(t,a))))},n}return Object(P.a)(t,e),t}(f.Component))))}},Rh={SEARCH_GROUP_RESULT_COUNT_RETRIVED:"SearchGroupResultCountRetrieved",SEARCH_GROUP_RESULT_COUNT_RETRIEVAL_FAILED:"SearchGroupResultCountRetrievalFailed",FILTER_SEARCH_GROUP_FOR_COUNT_SEARCH:"FilterSearchGroupForCountSearch",FILTER_SEARCH_GROUP_FOR_COUNT_TO_BE_EXECUTED:"FilterSearchGroupForCountSearchToBeExecuted",START_SEARCH_GROUP_COUNT_SEARCH:"StartSearchGroupCountSearch",ABORT_SEARCH_GROUP_COUNT_SEARCH:"AbortSearchGroupCountSearch",CANCEL_SEARCH_GROUP_COUNT_SEARCH:"CancelSearchGroupCountSearch"},kh="UpdateFieldAndRunSearchGroupSearchesBatch",Nh="UpdateFieldAndRunSearchGroupSearchesFromAsyncBatch",Ah="FilteredSearchActionsForSearchBatch",wh=function(e,t,n){var a=function(t){function n(){return Object(A.a)(this,n),Object(F.a)(this,Object(x.a)(n).apply(this,arguments))}return Object(P.a)(n,t),Object(w.a)(n,[{key:"render",value:function(){return f.createElement(e,this.props)}}]),n}(f.PureComponent);return function(e){function r(e){var n;return Object(A.a)(this,r),(n=Object(F.a)(this,Object(x.a)(r).call(this,e))).handleFieldUpdate=function(e){var t=n.props,a=t.onUpdateFormField;(0,t.onUpdateFormFieldInner)(e,n.getFilterActions(),a)},n.handleAsyncFieldUpdate=function(){for(var e=n.props,t=e.onUpdateFormFieldAsync,a=e.onUpdateFormFieldInnerAsync,r=arguments.length,o=new Array(r),i=0;i<r;i++)o[i]=arguments[i];a.apply(void 0,o.concat([n.getFilterActions(),t]))},n.searchGroups=t(n.props),n}return Object(P.a)(r,e),Object(w.a)(r,[{key:"getFilterActions",value:function(){var e=this.props.dataEntryKey,t=this.searchGroups,a=n&&n(this.props)||{},r=t.map(function(){return Xc()()}),o=t.map(function(t,n){return function(e,t,n,a){return le(Rh.FILTER_SEARCH_GROUP_FOR_COUNT_SEARCH)({searchGroup:e,uid:t,dataEntryKey:n,contextProps:a})}(t,r[n],e,a)}),i=o.map(function(e){return t=e,le(Rh.FILTER_SEARCH_GROUP_FOR_COUNT_TO_BE_EXECUTED)(Object(se.a)({},t.payload));var t});return{filterActions:o,filterActionsToBeExecuted:i}}},{key:"render",value:function(){var e=this.props,t=(e.dataEntryKey,e.onUpdateFormField,e.onUpdateFormFieldInner,e.onUpdateFormFieldAsync,e.onUpdateFormFieldInnerAsync,Object(Fe.a)(e,["dataEntryKey","onUpdateFormField","onUpdateFormFieldInner","onUpdateFormFieldAsync","onUpdateFormFieldInnerAsync"]));return f.createElement(a,Object.assign({onUpdateFormField:this.handleFieldUpdate,onUpdateFormFieldAsync:this.handleAsyncFieldUpdate},t))}}]),r}(f.Component)},Fh=function(e,t){var n=e.dataEntries&&e.dataEntries[t.id]&&e.dataEntries[t.id].itemId;return{dataEntryKey:ff(t.id,n)}},xh=function(e){return{onUpdateFormFieldInner:function(t,n,a){var r=n.filterActions,o=n.filterActionsToBeExecuted;a?a(t,{filterActions:r,filterActionsToBeExecuted:o}):e(function(e,t,n){return Object(Le.batchActions)([e].concat(Object(We.a)(n),Object(We.a)(t)),kh)}(t,r,o))},onUpdateFormFieldInnerAsync:function(t,n,a,r,o){var i=r.filterActions,c=r.filterActionsToBeExecuted;if(o)o(t,{filterActions:i,filterActionsToBeExecuted:c},n,a);else{e(function(e,t,n){return ue(e)({onSuccess:t,onError:n})}(t,function(e){return function(e,t,n){return Object(Le.batchActions)([e].concat(Object(We.a)(n),Object(We.a)(t)),Nh)}(e,i,c)},function(e){return e}))}}}},Ph=function(e,t){return function(n){return Object(D.b)(Fh,xh)(wh(n,e,t))}},Dh=function(){return function(e){return function(e){return function(t){t.onSearchGroupResultCountRetrieved,t.onSearchGroupResultCountRetrievalFailed;var n=Object(Fe.a)(t,["onSearchGroupResultCountRetrieved","onSearchGroupResultCountRetrievalFailed"]);return f.createElement(e,n)}}(e)}},Uh={ADD_FORM_DATA:"AddFormData"};function Lh(e,t){return le(Uh.ADD_FORM_DATA)({formValues:t,formId:e})}function Mh(e){return e.reduce(function(e,t){return e[t.id||t.dataEntryId]=t.type?{type:t.type,clientIgnore:t.clientIgnore}:{onConvertOut:t.onConvertOut.toString(),clientId:t.clientId,clientIgnore:t.clientIgnore},e},{})}function Bh(e,t){var n=e.filter(function(e){return e.type}).map(function(e){return new ut(function(t){t.id=e.id,t.type=e.type})}).map(function(e){return{id:e.id,value:e.convertValue(t[e.id],nc)}}),a=e.filter(function(e){return e.onConvertIn}).map(function(e){return{id:e.dataEntryId,value:e.onConvertIn(t[e.clientId])}});return[].concat(Object(We.a)(n),Object(We.a)(a)).reduce(function(e,t){return e[t.id]=t.value,e},{})}function Vh(e,t){return t.convertValues(e,nc)}function Gh(e,t){return t.reduce(function(t,n){var a=n.dataEntryId||n.id,r=Jf(e[a],n.validatorContainers);return t[a]={isValid:!r,validationError:r},t},{})}var Wh={LOAD_NEW_DATA_ENTRY:"LoadNewDataEntry"};function Hh(e,t,n,a,r){var o=a||{},i=r||{},c=n?Mh(n):{},s=n?Gh(o,n):{},l=ff(e,t);return[le(Wh.LOAD_NEW_DATA_ENTRY)({key:l,itemId:t,dataEntryId:e,dataEntryMeta:c,dataEntryUI:s,dataEntryValues:o}),Lh(l,i)]}var zh={LOAD_EDIT_DATA_ENTRY:"LoadEditDataEntry"};function Kh(e,t,n,a,r,o,i){var c=r?Mh(r):{},s=r?Bh(r,n):{},l=function(e){return(e.notes||[]).map(function(e,t){return Object(se.a)({},e,{storedDate:Ju(e.storedDate,ct.DATETIME),key:t})})}(n),u=r?Gh(s,r):{},d=Vh(a,o),p=ff(e,t);return[le(zh.LOAD_EDIT_DATA_ENTRY)({key:p,itemId:t,dataEntryId:e,dataEntryMeta:c,dataEntryValues:s,dataEntryNotes:l,extraProps:i,dataEntryUI:u}),Lh(p,d)]}var Yh={LOAD_VIEW_DATA_ENTRY:"LoadViewDataEntry"};var qh=n(75),Xh=n(292),Zh=n(380),Jh=n(227);function Qh(e,t,n){var a=e.searchFoundation.getElements().reduce(function(e,n){return e[n.id]=t[n.id],e},{});return e.onSearch(function(e,t){var n=Object(ze.d)(bd,id);return t.convertValues(e,n)}(a,e.searchFoundation),n)}var $h={};function eb(e,t){$h[e]&&$h[e][t]&&($h[e][t]=null)}var tb,nb=function(e){return function(t,n){return t.ofType.apply(t,Object(We.a)(e)).map(function(e){var t=e.payload.filter(function(e){return e.type===Rh.FILTER_SEARCH_GROUP_FOR_COUNT_SEARCH});return 0===t.length?null:t.map(function(e){var t=e.payload,a=t.dataEntryKey,r=t.searchGroup,o=n.getState(),i=o.formsValues[a]||{},c=o.dataEntriesSearchGroupsPreviousValues[a]&&o.dataEntriesSearchGroupsPreviousValues[a][r.id]||{};return function(e,t,n){var a=e.searchFoundation.getElements();return!(a.filter(function(e){return n[e.id]&&"dataType"===n[e.id].errorType&&!n[e.id].valid}).length>0)&&a.filter(function(e){return t[e.id]}).length>=e.minAttributesRequiredToSearch}(r,i,Object.keys(o.formsSectionsFieldsUI).filter(function(e){return e.startsWith(a)}).reduce(function(e,t){var n=o.formsSectionsFieldsUI[t];return Object(se.a)({},e,n)},{}))?!function(e,t,n){return!!e.searchFoundation.getElements().find(function(e){var a=n[e.id];a||!1===a||0===a||(a=null);var r=t[e.id];return r||!1===r||0===r||(r=null),r!==a})}(r,i,c)?Object(se.a)({},e,{cancel:!0}):e:Object(se.a)({},e,{abort:!0})}).map(function(e){if(e.abort){var t=e.payload,a=t.dataEntryKey,r=t.searchGroup,o=t.uid,i=$h[a]&&$h[a][r.id]||[];return eb(a,r.id),function(e,t,n,a){return le(Rh.ABORT_SEARCH_GROUP_COUNT_SEARCH)({dataEntryKey:e,searchGroup:t,groupId:n,uids:a})}(a,r,r.id,[].concat(Object(We.a)(i),[o]))}if(e.cancel){var c=e.payload;return function(e,t){return le(Rh.CANCEL_SEARCH_GROUP_COUNT_SEARCH)({dataEntryKey:e,uid:t})}(c.dataEntryKey,c.uid)}var s=e.payload,l=s.dataEntryKey,u=s.searchGroup,d=s.uid,p=s.contextProps,f=n.getState().formsValues[l];return function(e,t,n,a,r,o){return le(Rh.START_SEARCH_GROUP_COUNT_SEARCH)({searchGroup:e,searchGroupId:t,uid:n,dataEntryKey:a,contextProps:r,values:o})}(u,u.id,d,l,p,f)})}).filter(function(e){return e&&e.length>0}).map(function(e){return function(e){return Object(Le.batchActions)(e,Ah)}(e)})}},ab=function(e){return function(t,n){return t.ofType(Ah).map(function(e){return e.payload.filter(function(e){return e.type===Rh.START_SEARCH_GROUP_COUNT_SEARCH})}).filter(function(e){return e&&e.length>0}).mergeMap(function(a){return a.map(function(a){var r=a.payload,o=r.dataEntryKey,i=r.contextProps,s=r.searchGroup,l=r.uid,u=n.getState().formsValues[o];return $h[o]||($h[o]={}),$h[o][s.id]||($h[o][s.id]=[]),$h[o][s.id].push(l),Object(Zh.race)(Object(qh.fromPromise)(Qh(s,u,i)).takeUntil(t.ofType(Ah).filter(function(e){return e.payload.find(function(e){return[Rh.START_SEARCH_GROUP_COUNT_SEARCH,Rh.ABORT_SEARCH_GROUP_COUNT_SEARCH].includes(e.type)&&e.payload.searchGroup===s})})).map(function(e){var t=$h[o][s.id];return eb(o,s.id),function(e,t,n,a){return le(Rh.SEARCH_GROUP_RESULT_COUNT_RETRIVED)({count:e,dataEntryKey:t,groupId:n,uids:a})}(e,o,s.id,t)}).catch(function(e){O.a.error(Object(ze.b)(e)({dataEntryKey:o,searchGroupId:s.id}));var t=$h[o][s.id];return eb(o,s.id),Object(Xh.of)(function(e,t,n,a){return le(Rh.SEARCH_GROUP_RESULT_COUNT_RETRIEVAL_FAILED)({error:e,dataEntryKey:t,groupId:n,uids:a})}(c.a.t("search group result could not be retrieved"),o,s.id,t))}),t.ofType.apply(t,Object(We.a)(e)).filter(function(e){return e.payload.find(function(e){return e.type===(Wh.LOAD_NEW_DATA_ENTRY||zh.LOAD_EDIT_DATA_ENTRY)&&e.payload.key===o})}).map(function(){return $h[o]=null,null}))})}).mergeAll().filter(function(e){return e})}},rb=n(403),ob=n.n(rb),ib=function(e){return e.currentSelections.programId},cb=function(e){return e.stage},sb="BASICINFO",lb="STATUS",ub="COMMENTS",db="RELATIONSHIPS",pb={errorMessage:"validationError"},fb={labelContainerStyle:{flexBasis:200},inputContainerStyle:{flexBasis:150}},mb={labelContainerStyle:{width:150},inputContainerStyle:{width:150}};function hb(e){e.formHorizontal,e.fieldOptions,e.validationError,e.modified;return Object(Fe.a)(e,["formHorizontal","fieldOptions","validationError","modified"])}var bb=function(e,t){return Object(se.a)({},function(e){return{fieldOptions:e.fieldOptions,formHorizontal:e.formHorizontal,styles:e.formHorizontal?mb:fb}}(e),t)},gb=$i(pb)(Ia()(pc()(fc()(vc({onGetUseVerticalOrientation:function(e){return e.formHorizontal},onGetCustomFieldLabeClass:function(e){return"".concat(e.fieldOptions.fieldLabelMediaBasedClass," ").concat(ob.a.coordinateLabel)}})(uc()(Ya()(mc(hb)(Ti)))))))),Ob=$i(pb)(Ia()(pc()(fc()(vc({onGetUseVerticalOrientation:function(e){return e.formHorizontal},onGetCustomFieldLabeClass:function(e){return"".concat(e.fieldOptions.fieldLabelMediaBasedClass," ").concat(ob.a.polygonLabel)}})(uc()(Ya()(mc(hb)(ki)))))))),vb=function(e){return e?Ga.VERTICAL:Ga.HORIZONTAL},yb={onIsCompleting:function(e){return e.completeDataEntryFieldValue},onFilterProps:function(e){e.completeDataEntryFieldValue;return Object(Fe.a)(e,["completeDataEntryFieldValue"])}},Eb=Dh()(mc(function(e){e.stage,e.onScrollToRelationships,e.recentlyAddedRelationshipId,e.relationshipsRef;return Object(Fe.a)(e,["stage","onScrollToRelationships","recentlyAddedRelationshipId","relationshipsRef"])})(Vf)),_b=Pm(function(){var e=Object(nl.createSelector)(cb,function(e){return e?e.relationshipTypesWhereStageIsFrom.filter(function(e){return e.access.data.write}):[]}),t=pc()(fc()(mc(hb)(pm()(bm))));return{isApplicable:function(e){return e.stage&&e.stage.relationshipTypesWhereStageIsFrom.length>0},getComponent:function(){return t},getComponentProps:function(t){return bb(t,{id:"relationship",dataEntryId:t.id,highlightRelationshipId:t.recentlyAddedRelationshipId,relationshipsRef:t.relationshipsRef,onOpenAddRelationship:t.onOpenAddRelationship,writableRelationshipTypes:e(t),fromEntity:"PROGRAM_STAGE_INSTANCE",currentEntityId:"newEvent"})},getValidatorContainers:function(){return[]},getPropName:function(){return"relationship"},getMeta:function(){return{placement:pf,section:db}}}}())(Eb),jb=am(function(){var e=$i(pb)(pc()(fc()(uc()(Ya()(mc(hb)(om()(lm)))))));return{getComponent:function(){return e},getComponentProps:function(e){return bb(e,{label:"Comments",onAddNote:e.onAddNote,id:"comments",dataEntryId:e.id})},getPropName:function(){return"note"},getValidatorContainers:function(){return xm()},getMeta:function(){return{placement:pf,section:ub}}}}())(_b),Ib=Pm({isApplicable:function(e){var t=e.formFoundation.featureType;return["Polygon","Point"].includes(t)},getComponent:function(e){return"Polygon"===e.formFoundation.featureType?Ob:gb},getComponentProps:function(e){var t=e.formFoundation.featureType;return bb(e,"Polygon"===t?{width:e&&e.formHorizontal?150:350,label:c.a.t("Area"),dialogLabel:c.a.t("Area"),required:!1,orientation:vb(e.formHorizontal)}:{width:e&&e.formHorizontal?150:350,label:"Coordinate",dialogLabel:"Coordinate",required:!1,orientation:vb(e.formHorizontal),shrinkDisabled:e.formHorizontal})},getPropName:function(){return"geometry"},getValidatorContainers:function(){return[]},getMeta:function(){return{placement:df,section:sb}}})(jb),Cb=am(function(){var e=$i(pb)(Ia()(pc()(fc()(vc({onGetUseVerticalOrientation:function(e){return e.formHorizontal},onGetCustomFieldLabeClass:function(e){return"".concat(e.fieldOptions.fieldLabelMediaBasedClass," ").concat(ob.a.dateLabel)}})(uc()(Ya()(mc(hb)(yi))))))));return{getComponent:function(){return e},getComponentProps:function(e){return bb(e,{width:e&&e.formHorizontal?150:"100%",label:e.formFoundation.getLabel("eventDate"),required:!0,calendarWidth:e.formHorizontal?250:350,popupAnchorPosition:(t=e.formHorizontal,t?"center":"left")});var t},getPropName:function(){return"eventDate"},getValidatorContainers:function(){return Om()},getMeta:function(){return{placement:df,section:sb}}}}())(Ib),Tb=dh()(Cb),Sb=Sh()(Tb),Rb=gh()(Sb),kb=jh()(Rb),Nb=Zf(function(){return{color:"primary"}})(kb),Ab=Zm(yb)(function(e){return Object(D.b)(Am,wm,null,{withRef:!0})(function(e){return function(t){function n(){var e,t;Object(A.a)(this,n);for(var a=arguments.length,r=new Array(a),o=0;o<a;o++)r[o]=arguments[o];return(t=Object(F.a)(this,(e=Object(x.a)(n)).call.apply(e,[this].concat(r)))).getButtonDefinition=function(e){return Nm[e](t.props)},t.getFormHorizontalButtons=function(e,n){var a=[t.getButtonDefinition(km.SAVEANDADDANOTHER),t.getButtonDefinition(km.SAVEANDEXIT)];return e||!n?a:[t.getButtonDefinition(km.FINISH)].concat(a)},t.getFormVerticalButtons=function(e,n,a){var r=a?a.map(function(e){return t.getButtonDefinition(e)}):[t.getButtonDefinition(km.SAVEANDEXIT),t.getButtonDefinition(km.SAVEANDADDANOTHER)];return e||!n?r:[t.getButtonDefinition(km.FINISH)].concat(Object(We.a)(r))},t.renderMultiButton=function(e,t,n){var a=e[0],r=e.slice(1);return f.createElement(an.a,{title:t?"":c.a.t("No write access")},f.createElement(Sm,{variant:"raised",color:"primary",buttonType:"progress",buttonText:a.text,disabled:!t,buttonProps:{onClick:a.onClick,color:"primary",inProgress:n},dropDownItems:r}))},t}return Object(P.a)(n,t),Object(w.a)(n,[{key:"getWrappedInstance",value:function(){return this.innerInstance}},{key:"render",value:function(){var t=this,n=this.props,a=n.saveTypes,r=n.dataEntryHasChanges,o=n.hasRecentlyAddedEvents,i=(n.onSave,n.finalInProgress),c=Object(Fe.a)(n,["saveTypes","dataEntryHasChanges","hasRecentlyAddedEvents","onSave","finalInProgress"]),s=this.props.formFoundation.access.data.write,l=this.props.formHorizontal?this.getFormHorizontalButtons(r,o):this.getFormVerticalButtons(r,o,a),u=this.renderMultiButton(l,s,i);return f.createElement(e,Object.assign({ref:function(e){t.innerInstance=e},mainButton:u},c))}}]),n}(f.Component)}(e))}(Nb)),wb=am(function(){var e=$i(pb)(Ia()(pc()(fc()(vc({onGetUseVerticalOrientation:function(e){return e.formHorizontal},onGetCustomFieldLabeClass:function(e){return"".concat(e.fieldOptions.fieldLabelMediaBasedClass," ").concat(ob.a.trueOnlyLabel)}})(uc()(Ya()(mc(hb)(ui))))))));return{getComponent:function(){return e},getComponentProps:function(e){return bb(e,{label:"Complete event",id:"complete"})},getPropName:function(){return"complete"},getValidatorContainers:function(){return[]},getMeta:function(){return{placement:pf,section:lb}},getPassOnFieldData:function(){return!0}}}())(Ab),Fb=(tb={},Object(Ut.a)(tb,sb,{placement:df,name:c.a.t("Basic info")}),Object(Ut.a)(tb,lb,{placement:pf,name:c.a.t("Status")}),Object(Ut.a)(tb,ub,{placement:pf,name:c.a.t("Comments")}),Object(Ut.a)(tb,db,{placement:pf,name:c.a.t("Relationships")}),tb),xb=function(e){function t(e){var n;return Object(A.a)(this,t),(n=Object(F.a)(this,Object(x.a)(t).call(this,e))).setRelationshipsInstance=function(e){n.relationshipsInstance=e},n.handleSave=function(e,t,a,r){r===vm.SAVEANDADDANOTHER?(n.props.formHorizontal||n.props.onSetSaveTypes([vm.SAVEANDADDANOTHER,vm.SAVEANDEXIT]),n.props.onSaveAndAddAnother(e,t,a)):r===vm.SAVEANDEXIT&&n.props.onSave(e,t,a)},n.renderHorizontal=function(){var e=n.props.classes;return m.a.createElement("div",{className:e.horizontal},n.renderContent())},n.renderVertical=function(){return m.a.createElement("div",{className:n.props.classes.dataEntryVerticalContainer},n.renderContent())},n.renderContent=function(){var e=n.props,t=e.onUpdateField,a=e.onStartAsyncUpdateField,r=(e.programName,e.orgUnitName,e.classes),o=(e.onSave,e.onSetSaveTypes,e.onSaveAndAddAnother,e.theme,Object(Fe.a)(e,["onUpdateField","onStartAsyncUpdateField","programName","orgUnitName","classes","onSave","onSetSaveTypes","onSaveAndAddAnother","theme"]));return m.a.createElement("div",null,m.a.createElement("div",null,m.a.createElement(wb,Object.assign({id:"singleEvent",onUpdateFormField:t,onUpdateFormFieldAsync:a,onSave:n.handleSave,fieldOptions:n.fieldOptions,dataEntrySections:n.dataEntrySections,relationshipsRef:n.setRelationshipsInstance},o))),m.a.createElement("div",{className:r.savingContextContainer},m.a.createElement(Jc.a,null),m.a.createElement("div",{className:r.savingContextText},n.getSavingText())))},n.fieldOptions={theme:e.theme,fieldLabelMediaBasedClass:e.classes.fieldLabelMediaBased},n.dataEntrySections=Fb,n}return Object(P.a)(t,e),Object(w.a)(t,[{key:"componentWillMount",value:function(){this.props.onSetSaveTypes(null)}},{key:"componentDidMount",value:function(){this.relationshipsInstance&&this.props.recentlyAddedRelationshipId&&(this.relationshipsInstance.scrollIntoView(),this.props.onScrollToRelationships())}},{key:"componentWillUnmount",value:function(){Ys.clear()}},{key:"getSavingText",value:function(){var e=this.props,t=e.classes,n=e.orgUnitName,a=e.programName,r="".concat(c.a.t("Saving to")," "),o=" ".concat(c.a.t("in")," ");return m.a.createElement("span",null,r,m.a.createElement("span",{className:t.savingContextNames},a),o,m.a.createElement("span",{className:t.savingContextNames},n))}},{key:"render",value:function(){return m.a.createElement("div",null,this.props.formHorizontal?this.renderHorizontal():this.renderVertical())}}]),t}(f.Component),Pb=Object(E.withStyles)(function(e){return{savingContextContainer:{paddingTop:e.typography.pxToRem(10),display:"flex",alignItems:"center",color:e.palette.grey.dark,fontSize:e.typography.pxToRem(13)},savingContextText:{paddingLeft:e.typography.pxToRem(10)},savingContextNames:{fontWeight:"bold"},topButtonsContainer:{display:"flex",flexFlow:"row-reverse"},horizontal:{padding:e.typography.pxToRem(10),paddingTop:e.typography.pxToRem(20),paddingBottom:e.typography.pxToRem(15)},fieldLabelMediaBased:Object(Ut.a)({},e.breakpoints.down(523),{paddingTop:"0px !important"}),dataEntryVerticalContainer:{padding:e.typography.pxToRem(8)}}})(Object(E.withTheme)()(xb)),Db="post",Ub="update",Lb="delete",Mb="UpdateDataEntryFieldForNewSingleEventActionsBatch",Bb="UpdateFieldForNewSingleEventActionsBatch",Vb="OpenNewEventInDataEntryActionsBatch",Gb="ResetDataEntryForNewEventActionsBatch",Wb="RulesEffectsForNewSingleEventActionsBatch",Hb="SaveNewEventAddAnotherBatch",zb="OpenNewEventInDataEntry",Kb="StartRunRulesOnUpdateForNewSingleEvent",Yb="RequestSaveReturnToMainPageForNewSingleEvent",qb="StartSaveAfterReturnedToMainPage",Xb="StartCancelSaveReturnToMainPageForNewSingleEvent",Zb="CancelSaveNoWorkingListUpdateNeededForSingleEvent",Jb="CancelSaveUpdateWorkingListForSingleNewEvent",Qb="SingleNewEventSavedAfterReturnedToMainPage",$b="SaveFailedForNewSingleEventAfterReturnedToMainPage",eg="SelectionsNotCompleteOpeningNewEvent",tg="RequestSaveNewEventAddAnother",ng="startSaveNewEventAddAnother",ag="NewEventSavedAddAnother",rg="SaveFailedForNewEventAddAnother",og="SetNewEventSaveTypes",ig="ResetDataEntryForNewEvent",cg="AddNewEventNote",sg="NewEventOpenNewRelationship",lg="SaveNewEventRelationshipsIfExists",ug="StartSaveNewEventRelationships",dg="NewEventRelationshipsSaved",pg="SaveFailedForNewEventRelationships",fg="StartSaveTeiForNewEventRelationships",mg="TeiForNewEventRelationshipSaved",hg="SaveFailedForNewEventRelationshipTei",bg="NewEventScrolledToRelationships",gg=function(e){return le(Kb)(e)},Og=function(e){return le(Qb)(null,{selections:e})},vg=function(){return le(Xb)()},yg=function(){return le(Zb)()},Eg=function(){return le(Jb)()},_g=function(e,t,n,a){var r=ng;return le(ng)({selections:n},{offline:{effect:{url:"events",method:Db,data:e,clientId:a},commit:{type:lg,meta:{selections:n,relationshipData:t,triggerAction:r}},rollback:{type:rg,meta:{selections:n,clientId:a}}}})},jg=function(e){return le(ag)(null,{selections:e})},Ig=Object(D.b)(function(){var e=Object(nl.createSelector)(ib,function(e){var t=Je.get(e);return t&&t.name||""});return function(t,n){return{recentlyAddedRelationshipId:t.newEventPage.recentlyAddedRelationshipId,ready:!t.newEventPage.dataEntryIsLoading,error:n.formFoundation?null:c.a.t("This is not an event program or the metadata is corrupt. See log for details."),programName:e(t),orgUnitName:t.organisationUnits[t.currentSelections.orgUnitId]&&t.organisationUnits[t.currentSelections.orgUnitId].name}}},function(e){return{onUpdateDataEntryField:function(t){var n=t.payload,a=n.dataEntryId,r=n.itemId,o=Xc()();e(Object(Le.batchActions)([t,Uf(a,r,o),gg(Object(se.a)({},t.payload,{uid:o}))],Mb))},onUpdateField:function(t){var n=t.payload,a=n.dataEntryId,r=n.itemId,o=Xc()();e(Object(Le.batchActions)([t,Uf(a,r,o),gg(Object(se.a)({},t.payload,{uid:o}))],Bb))},onStartAsyncUpdateField:function(t,n,a){e(function(e,t,n){return ue(e)({onSuccess:t,onError:n})}(t,function(e){var t=Xc()();return Object(Le.batchActions)([e,Uf(n,a,t),gg(Object(se.a)({},e.payload,{dataEntryId:n,itemId:a,uid:t}))],Bb)},function(e){return e}))},onSave:function(t,n,a){window.scrollTo(0,0),e(function(e,t,n){return le(Yb)({eventId:e,dataEntryId:t,formFoundation:n},{skipLogging:["formFoundation"]})}(t,n,a))},onAddNote:function(t,n,a){e(function(e,t,n){return le(cg)({itemId:e,dataEntryId:t,note:n})}(t,n,a))},onSetSaveTypes:function(t){e(function(e){return le(og)({saveTypes:e})}(t))},onSaveAndAddAnother:function(t,n,a){e(function(e,t,n){return le(tg)({eventId:e,dataEntryId:t,formFoundation:n},{skipLogging:["formFoundation"]})}(t,n,a))},onCancel:function(){window.scrollTo(0,0),e(vg())},onOpenAddRelationship:function(t,n){e(function(e,t){return le(sg)({eventId:e,dataEntryId:t})}(t,n))},onScrollToRelationships:function(){e(le(bg)())}}})(Ue()(Pe()(Pb))),Cg=n(529),Tg=n.n(Cg),Sg=n(528),Rg=n.n(Sg),kg=function(e){function t(){var e,n;Object(A.a)(this,t);for(var a=arguments.length,r=new Array(a),o=0;o<a;o++)r[o]=arguments[o];return(n=Object(F.a)(this,(e=Object(x.a)(t)).call.apply(e,[this].concat(r)))).getIconClickHandler=function(e,t){return function(){n.props.disabled||t(e)}},n.getActiveIcons=function(e,t){var a=n.props.disabled,r=n.props.classes,o=e===Wo.ASC?Rg.a:Tg.a,i=f.createElement(o,{className:a?r.iconBase:Cn()(r.iconBase,r.enabledIcon),onClick:n.getIconClickHandler(e===Wo.DESC?Wo.ASC:Wo.DESC,t)});return n.props.disabled?f.createElement("span",null,i):f.createElement(an.a,{title:c.a.t("Sort"),placement:"bottom",enterDelay:300},f.createElement("span",null,i))},n.getIcons=function(e,t,a){return e?n.getActiveIcons(t,a):f.createElement("div",{style:{width:14,height:14}})},n}return Object(P.a)(t,e),Object(w.a)(t,[{key:"render",value:function(){var e=this;return f.createElement(Ko,Object.assign({onGetIcons:this.getIcons},this.props),e.props.disabled?f.createElement("span",null,e.props.children):f.createElement(an.a,{title:c.a.t("Sort"),placement:"bottom",enterDelay:300},f.createElement("span",null,e.props.children)))}}]),t}(f.Component),Ng=Object(E.withStyles)(function(){return{iconBase:{width:"14px",height:"14px",color:"#3a796f"},enabledIcon:{cursor:"pointer"}}})(kg),Ag=function(e){function t(){var e,n;Object(A.a)(this,t);for(var a=arguments.length,r=new Array(a),o=0;o<a;o++)r[o]=arguments[o];return(n=Object(F.a)(this,(e=Object(x.a)(t)).call.apply(e,[this].concat(r)))).getPaginationLabelDisplayedRows=function(e,t){return"".concat(e," of ").concat(t)},n}return Object(P.a)(t,e),Object(w.a)(t,[{key:"renderHeaderRow",value:function(e){var n=this,a=this.props.sortById,r=this.props.sortByDirection,o=e.map(function(e){return m.a.createElement(Mo,{key:e.id,className:Cn()(n.props.classes.cell,n.props.classes.headerCell)},m.a.createElement(Ng,{isActive:e.id===a,initialDirection:t.typesWithAscendingInitialDirection.includes(e.type)?Wo.ASC:Wo.DESC,placement:t.typesWithRightPlacement.includes(e.type)?zo:Ho,direction:r,disabled:!0},e.header))});return m.a.createElement(Go,{className:this.props.classes.row},o)}},{key:"renderRows",value:function(e){var n=this,a=this.props.dataSource,r=this.props.classes;if(!a||0===a.length){var o=e.length;return m.a.createElement(Go,{className:r.row},m.a.createElement(Po,{colSpan:o,className:Cn()(r.cell,r.bodyCell)},this.props.noItemsText||c.a.t("No items to display")))}return a.map(function(a){var o=e.map(function(e){return m.a.createElement(Po,{key:e.id,className:Cn()(r.cell,r.bodyCell)},m.a.createElement("div",{style:t.typesWithRightPlacement.includes(e.type)?{textAlign:"right"}:null},a[e.id]))});return m.a.createElement(Go,{key:a[n.props.rowIdKey],className:Cn()(r.row,r.dataRow),onClick:function(){return n.props.onRowClick(a)}},o)})}},{key:"render",value:function(){var e=this.props,t=(e.dataSource,e.columns),n=e.classes,a=t?t.filter(function(e){return e.visible}):[];return m.a.createElement("div",{className:n.container},m.a.createElement("div",{className:n.topBarContainer}),m.a.createElement("div",{className:n.tableContainer},m.a.createElement(Yo,{className:n.table},m.a.createElement(Lo,null,this.renderHeaderRow(a)),m.a.createElement(ko,null,this.renderRows(a)))))}}]),t}(f.Component);Ag.defaultProps={rowIdKey:"id"},Ag.typesWithAscendingInitialDirection=[ct.TEXT,ct.LONG_TEXT],Ag.typesWithRightPlacement=[ct.NUMBER,ct.INTEGER,ct.INTEGER_POSITIVE,ct.INTEGER_NEGATIVE,ct.INTEGER_ZERO_OR_POSITIVE];var wg=Object(E.withStyles)(function(e){return{loaderContainer:{display:"flex",justifyContent:"center"},container:{borderColor:"light"===e.palette.type?Object($o.lighten)(Object($o.fade)(e.palette.divider,1),.88):Object($o.darken)(Object($o.fade)(e.palette.divider,1),.8),borderWidth:"1px",borderStyle:"solid"},topBarContainer:{display:"flex",justifyContent:"space-between"},tableContainer:{overflow:"auto"},optionsIcon:{color:e.palette.primary.main},table:{},row:{},dataRow:{cursor:"pointer"},cell:{padding:"".concat(e.spacing.unit/2,"px ").concat(7*e.spacing.unit,"px ").concat(e.spacing.unit/2,"px ").concat(3*e.spacing.unit,"px"),"&:last-child":{paddingRight:3*e.spacing.unit},borderBottomColor:"light"===e.palette.type?Object($o.lighten)(Object($o.fade)(e.palette.divider,1),.88):Object($o.darken)(Object($o.fade)(e.palette.divider,1),.8)},bodyCell:{fontSize:e.typography.pxToRem(13),color:e.palette.text.primary},headerCell:{fontSize:e.typography.pxToRem(12),color:e.palette.text.secondary,fontWeight:e.typography.fontWeightMedium}}})(Ag),Fg=Object(E.withStyles)(function(e){return{container:{borderColor:"light"===e.palette.type?Object($o.lighten)(Object($o.fade)(e.palette.divider,1),.88):Object($o.darken)(Object($o.fade)(e.palette.divider,1),.8),borderWidth:"1px",borderStyle:"solid",padding:10,display:"flex",alignItems:"center",justifyContent:"center"}}})(function(e){return m.a.createElement("div",{className:e.classes.container},e.emptyListText||c.a.t("Data for offline list not present"))}),xg=new ut(function(e){e.id="status",e.type=ct.TEXT}),Pg=new it("statusOptionSet",[new tt(function(e){e.text=c.a.t("Active"),e.value="ACTIVE"}),new tt(function(e){e.text=c.a.t("Completed"),e.value="COMPLETED"})],null,xg);xg.optionSet=Pg;var Dg=xg;function Ug(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},r={eventDate:a.eventDate||"eventDate",dueDate:a.dueDate||"dueDate",completedDate:a.completedDate||"completedDate",status:a.status||"status"};return Object.keys(e).reduce(function(a,o){var i=function(e,t,n,a){return t===a.eventDate||t===a.dueDate||t===a.completedDate?n(e,ct.DATE):t===a.status?n(e,ct.TEXT,Dg):e}(e[o],o,t,r);return a[n[o]||o]=i,a},{})}var Lg={eventId:"event",programId:"program",programStageId:"programStage",orgUnitId:"orgUnit",trackedEntityInstanceId:"trackedEntityInstance",enrollmentId:"enrollment"};function Mg(e){return Ug(e,id,Lg)}var Bg="eventDate",Vg="status",Gg=function(e,t){return e.workingListsContext[t.listId].programId},Wg=function(e,t){return e.workingListsColumnsOrder[t.listId]},Hg=function(e,t){return t.events},zg=function(e,t){return t.eventsValues},Kg=function(e,t){return e.workingLists[t.listId].order},Yg=function(e,t,n){return n.map(function(n){return{event:e[n],eventValues:t[n]}})},qg=Object(nl.createSelectorCreator)(nl.defaultMemoize,function(e,t){return t.every(function(t,n){return t.event===(e[n]&&e[n].event)&&t.eventValues===(e[n]&&e[n].eventValues)})&&e.every(function(e,n){return e.event===(t[n]&&t[n].event)&&e.eventValues===(t[n]&&t[n].eventValues)})}),Xg=function(e){return e},Zg=function(e){if(0===e.length)return[];var t=Rt(e[0].event),n=t.stage;return t.error||!n?null:e.map(function(e){var t=n.stageForm.convertValues(e.eventValues,Ju),a=Ug(e.event,Ju);return Object(se.a)({},a,t)})},Jg=Object(D.b)(function(){var e=Object(nl.createSelector)(Gg,Wg,function(e,t){var n=vt(e);if(n.error)return t;var a=n.stage.stageForm;return t.map(function(e){if(e.isMainProperty)return e.id===Bg?Object(se.a)({},e,{header:a.getLabel(Bg),type:ct.DATE}):t;var n=a.getElement(e.id);return Object(se.a)({},e,{header:n.formName,type:n.type})})}),t=Object(nl.createSelector)(Hg,zg,Kg,Yg),n=qg(Xg,Zg);return function(a,r){var o=e(a,r),i=t(a,r),c=a.workingListsMeta[r.listId].sortById,s=a.workingListsMeta[r.listId].sortByDirection;return{columns:o,rowIdKey:"eventId",dataSource:n(i),sortById:c,sortByDirection:s}}},{}),Qg=Object(D.b)(function(e,t){return{hasData:!!e.workingListsContext[t.listId]}},{})(function(e){var t=e?e(wg):wg;return function(e){var n=e.hasData,a=Object(Fe.a)(e,["hasData"]);return n?m.a.createElement(t,a):m.a.createElement(Fg,null)}}(Jg)),$g=function(e){function t(){return Object(A.a)(this,t),Object(F.a)(this,Object(x.a)(t).apply(this,arguments))}return Object(P.a)(t,e),Object(w.a)(t,[{key:"render",value:function(){var e=this.props,t=e.listId,n=e.noItemsText,a=e.emptyListText,r=Object(Fe.a)(e,["listId","noItemsText","emptyListText"]);return m.a.createElement(Qg,Object.assign({listId:t||"main",noItemsText:n||c.a.t("No events to display"),emptyListText:a||c.a.t("Data for offline list not present")},r))}}]),t}(m.a.Component),eO=Object(E.withStyles)(function(e){return{container:{padding:e.typography.pxToRem(20)},header:{paddingBottom:e.typography.pxToRem(10)}}})(function(e){var t=e.classes,n=Object(Fe.a)(e,["classes"]),a=e.events?Object.keys(e.events).length:0;return 0===a?null:f.createElement(Be.a,{className:t.container},f.createElement("div",{className:t.header},"".concat(a," ").concat(c.a.t("events added"))),f.createElement($g,Object.assign({listId:"recentlyAddedEvents",noItemsText:c.a.t("No events added"),emptyListText:c.a.t("No events added")},n)))}),tO=Object(D.b)(function(e){return{events:e.recentlyAddedEvents,eventsValues:e.recentlyAddedEventsValues}},function(e){return{onRowClick:function(){}}})(eO),nO=function(e){function t(e){var n;return Object(A.a)(this,t),(n=Object(F.a)(this,Object(x.a)(t).call(this,e))).handleGoBackToAllEvents=function(){n.cancelButtonInstance&&n.cancelButtonInstance.handleCancel()},n.setCancelButtonInstance=function(e){n.cancelButtonInstance=e},n.state={discardWarningOpen:!1},n}return Object(P.a)(t,e),Object(w.a)(t,[{key:"renderHeader",value:function(){return f.createElement("div",{className:this.props.classes.headerContainer},f.createElement("div",{className:this.props.classes.header},c.a.t("New event")),f.createElement("div",null,this.renderHeaderButtons()))}},{key:"renderHeaderButtons",value:function(){var e=this,t=this.props.formFoundation;return!t||t.customForm?null:f.createElement(Yc,{color:"primary",onClick:function(){return e.props.onFormLayoutDirectionChange(!e.props.formHorizontal)}},this.props.formHorizontal?c.a.t("Switch to form view"):c.a.t("Switch to row view"))}},{key:"render",value:function(){var e=this.props,t=e.classes,n=e.formFoundation,a=e.formHorizontal,r=e.stage;return f.createElement("div",null,f.createElement(Yc,{className:t.showAllEvents,variant:"raised",onClick:this.handleGoBackToAllEvents},f.createElement(Hc.a,null),c.a.t("Show all events")),f.createElement(Kc.a,{className:t.dataEntryPaper},this.renderHeader(),f.createElement(Ig,{stage:r,cancelButtonRef:this.setCancelButtonInstance,formFoundation:n,formHorizontal:a})),f.createElement(tO,null))}}]),t}(f.Component),aO=Ii()(function(e){return{headerContainer:{display:"flex",justifyContent:"space-between",alignItems:"center"},header:Object(se.a)({flexGrow:1},e.typography.title,{fontSize:18,fontWeight:500,paddingLeft:8}),dataEntryPaper:{marginBottom:e.typography.pxToRem(10),padding:e.typography.pxToRem(10)},showAllEvents:{paddingLeft:8,marginBottom:10,textTransform:"none",backgroundColor:"#E9EEF4",boxShadow:"none",color:"#494949",fontSize:14,fontWeight:"normal"}}})(nO),rO="SetNewEventFormLayoutDirection",oO=function(e){return e.currentSelections.programId},iO=Object(D.b)(function(){var e=Object(nl.createSelector)(oO,function(e){var t=Je.get(e);if(!t)return O.a.error(Object(ze.b)("programId not found")({method:"getFormFoundation"})),null;var n=t.getStage();return n||(O.a.error(Object(ze.b)("stage not found for program")({method:"getFormFoundation"})),null)});return function(t){var n=e(t),a=n&&n.stageForm?n.stageForm:null;return{stage:n,formFoundation:a,dataEntryHasChanges:Rm(t),formHorizontal:(!a||!a.customForm)&&!!t.newEventPage.formHorizontal}}},function(e){return{onFormLayoutDirectionChange:function(t){e(function(e){return le(rO)({formHorizontal:e})}(t))}}})(aO),cO="NewEventCancelNewRelationship",sO="AddNewEventRelationship",lO="RecentlyAddedRelationship",uO="AddNewEventRelationshipBatch",dO=function(e){function t(){var e,n;Object(A.a)(this,t);for(var a=arguments.length,r=new Array(a),o=0;o<a;o++)r[o]=arguments[o];return(n=Object(F.a)(this,(e=Object(x.a)(t)).call.apply(e,[this].concat(r)))).onSelectRelationshipType=function(e){n.props.onSelectRelationshipType({id:e.id,name:e.name,from:Object(se.a)({},e.from),to:Object(se.a)({},e.to)})},n.renderRelationshipTypes=function(){var e=n.props,t=e.classes,a=e.relationshipTypes;return a?a.map(function(e){return f.createElement("div",{className:Cn()(t.relationshipType,t.relationshipTypeSelectable),key:e.id,role:"button",tabIndex:"0",onClick:function(){return n.onSelectRelationshipType(e)}},e.name)}):[]},n.renderSelectedRelationshipType=function(e){var t=n.props,a=t.classes,r=t.onDeselectRelationshipType;return f.createElement("div",{className:Cn()(a.relationshipType,a.relationshipTypeSelected)},f.createElement("div",{className:a.relationshipTypeSelectedText},f.createElement("div",null,e.name),f.createElement($e.a,{fontSize:"small",onClick:r})))},n}return Object(P.a)(t,e),Object(w.a)(t,[{key:"render",value:function(){var e=this.props,t=e.selectedRelationshipType,n=e.classes;return f.createElement("div",{className:n.container},t?this.renderSelectedRelationshipType(t):this.renderRelationshipTypes())}}]),t}(f.Component),pO=Ii()(function(e){return{relationshipType:{display:"flex",padding:e.typography.pxToRem(10),border:"1px solid ".concat(e.palette.grey.light),borderRadius:e.typography.pxToRem(4),margin:e.typography.pxToRem(10)},relationshipTypeSelectable:{cursor:"pointer"},relationshipTypeSelected:{backgroundColor:"#f0f9f8"},relationshipTypeSelectedText:{paddingLeft:e.typography.pxToRem(5),display:"flex",alignItems:"center",borderLeft:"2px solid #4ca899"},container:{display:"flex"}}})(dO),fO=n(530),mO=n.n(fO),hO="TeiSearchRequestFilterOrgUnits",bO="TeiSearchClearOrgUnitsFilter",gO="TeiSearchFilteredOrgUnitsRetrieved",OO="TeiSearchFilterOrgUnitsFailed",vO="TeiSearchSetOrgUnitScope",yO="TeiSearchSetOrgUnit",EO=Ia()($i()(pc()(vc()(uc()(Li))))),_O=pc()(vc()(Oi)),jO={labelContainerStyle:{paddingTop:12,flexBasis:200},inputContainerStyle:{flexBasis:150}},IO={labelContainerStyle:{paddingTop:13,flexBasis:200},inputContainerStyle:{flexBasis:150}},CO=[{name:"All accessible",value:"ACCESSIBLE"},{name:"Selected",value:"SELECTED"}],TO="Please select an organisation unit",SO=function(e){function t(){var e,n;Object(A.a)(this,t);for(var a=arguments.length,r=new Array(a),o=0;o<a;o++)r[o]=arguments[o];return(n=Object(F.a)(this,(e=Object(x.a)(t)).call.apply(e,[this].concat(r)))).onSelectOrgUnitScope=function(e){e&&n.props.onSelectOrgUnitScope(n.props.searchId,e)},n.onSetOrgUnit=function(e){n.props.onSetOrgUnit(n.props.searchId,e)},n.renderOrgUnitScopeSelector=function(){var e=n.props.selectedOrgUnitScope;return f.createElement(_O,{options:CO,label:"Organisation unit scope",styles:IO,onSelect:n.onSelectOrgUnitScope,value:e})},n.isValid=function(){return"ACCESSIBLE"===n.props.selectedOrgUnitScope||n.props.selectedOrgUnit},n.getErrorMessage=function(){return!n.isValid()&&n.props.searchAttempted?c.a.t(TO):null},n.handleFilterOrgUnits=function(e){n.props.onFilterOrgUnits(n.props.searchId,e)},n.renderOrgUnitField=function(){var e=n.props,t=e.selectedOrgUnit,a=e.treeRoots,r=e.treeReady,o=e.treeKey,i=e.treeSearchText;return f.createElement(EO,{label:"Organisation unit",styles:jO,searchText:i,roots:a,ready:r,treeKey:o,onBlur:n.onSetOrgUnit,value:t,validationAttempted:n.props.searchAttempted,errorMessage:n.getErrorMessage(),onSearch:n.handleFilterOrgUnits})},n}return Object(P.a)(t,e),Object(w.a)(t,[{key:"validateAndScrollToIfFailed",value:function(){var e=this.isValid();return e||this.goto(),e}},{key:"goto",value:function(){if(this.gotoInstance){this.gotoInstance.scrollIntoView();var e=window.scrollY;e&&window.scroll(0,e-48)}}},{key:"render",value:function(){var e=this,t=this.props.selectedOrgUnitScope;return f.createElement("div",{ref:function(t){e.gotoInstance=t}},this.renderOrgUnitScopeSelector(),"ACCESSIBLE"!==t&&this.renderOrgUnitField())}}]),t}(f.Component),RO=Object(D.b)(function(e,t){var n=t.searchId,a=Ic(n)||Ic("searchRoots");return{selectedOrgUnit:e.teiSearch[n].selectedOrgUnit,selectedOrgUnitScope:e.teiSearch[n].selectedOrgUnitScope,treeRoots:a,treeSearchText:e.teiSearch[n].orgUnitsSearchText,treeReady:!e.teiSearch[n].orgUnitsLoading,treeKey:e.teiSearch[n].orgUnitsSearchText||"initial"}},function(e){return{onFilterOrgUnits:function(t,n){var a=n?function(e,t){return le(hO)({searchId:e,searchText:t})}(t,n):function(e){return le(bO)({searchId:e})}(t);e(a)},onSetOrgUnit:function(t,n){e(function(e,t){return le(yO)({searchId:e,orgUnit:t})}(t,n))},onSelectOrgUnitScope:function(t,n){e(function(e,t){return le(vO)({searchId:e,orgUnitScope:t})}(t,n))}}},function(e,t,n){var a=n.innerRef,r=Object(Fe.a)(n,["innerRef"]);return Object(se.a)({},r,e,t,{ref:a})})(SO),kO=hc()(RO),NO=function(e){function t(){var e,n;Object(A.a)(this,t);for(var a=arguments.length,r=new Array(a),o=0;o<a;o++)r[o]=arguments[o];return(n=Object(F.a)(this,(e=Object(x.a)(t)).call.apply(e,[this].concat(r)))).validNumberOfAttributes=function(){return n.props.attributesWithValuesCount>=n.props.searchGroup.minAttributesRequiredToSearch},n.handleSearchAttempt=function(){var e=n.validateForm(),t=e.error,a=e.isValid;!t&&a?n.props.onSearch(n.props.id,n.props.searchGroupId):n.props.onSearchValidationFailed(n.props.id,n.props.searchGroupId)},n.getUniqueSearchButtonText=function(e){var t=e.getElements()[0].formName;return"Search ".concat(t)},n.renderOrgUnitSelector=function(){return f.createElement(kO,{innerRef:function(e){n.orgUnitSelectorInstance=e},searchId:n.props.searchId,searchAttempted:n.props.searchAttempted})},n.renderMinAttributesRequired=function(){var e=n.props,t=e.classes,a=e.searchAttempted,r=e.searchGroup,o=a&&!n.validNumberOfAttributes(),i=Cn()(t.minAttributesRequired,Object(Ut.a)({},t.minAttribtuesRequiredInvalid,o));return f.createElement("div",{className:i},c.a.t("Fill in at least {{minAttributesRequired}} attributes to search",{minAttributesRequired:r.minAttributesRequiredToSearch}))},n}return Object(P.a)(t,e),Object(w.a)(t,[{key:"validateForm",value:function(){if(!this.formInstance)return O.a.error(Object(ze.b)(t.errorMessages.SEARCH_FORM_MISSING)({Search:this})),{error:!0,isValid:!1};var e=this.formInstance.validateFormScrollToFirstFailedField({});return e&&!this.props.searchGroup.unique&&(e=this.orgUnitSelectorInstance.validateAndScrollToIfFailed()),e&&!this.props.searchGroup.unique&&(e=this.validNumberOfAttributes()),{isValid:e,error:!1}}},{key:"render",value:function(){var e=this,n=this.props,a=n.searchGroup,r=n.classes,o=(n.searchGroupId,n.onSearch,n.searchId,n.onSearchValidationFailed,n.searchAttempted,Object(Fe.a)(n,["searchGroup","classes","searchGroupId","onSearch","searchId","onSearchValidationFailed","searchAttempted"])),i=a&&a.searchForm;if(!i)return f.createElement("div",null,t.errorMessages.SEARCH_FORM_MISSING);var s=a.unique?this.getUniqueSearchButtonText(i):c.a.t("Search by attributes");return f.createElement("div",{className:r.container},f.createElement(uf,Object.assign({formRef:function(t){e.formInstance=t},formFoundation:a.searchForm},o)),!a.unique&&this.renderOrgUnitSelector(),f.createElement("div",{className:r.searchButtonContainer},f.createElement(Yc,{onClick:this.handleSearchAttempt},s),!a.unique&&this.renderMinAttributesRequired()))}}]),t}(f.Component);NO.errorMessages={NO_ITEM_SELECTED:"No item selected",SEARCH_FORM_MISSING:"search form is missing. see log for details"};var AO=Object(E.withStyles)(function(e){return{orgUnitSection:{backgroundColor:"white",padding:e.typography.pxToRem(8),maxWidth:e.typography.pxToRem(892)},searchButtonContainer:{padding:e.typography.pxToRem(10),display:"flex",alignItems:"center"},minAttributesRequired:{flexGrow:1,textAlign:"right",fontSize:e.typography.pxToRem(14)},minAttribtuesRequiredInvalid:{color:e.palette.error.main}}})(NO),wO=function(e,t){var n=e.formsValues[t]||{};return Object.keys(n).filter(function(e){return n[e]}).length},FO=Object(D.b)(function(e,t){var n=t.searchId,a=t.id;return{searchAttempted:(e.teiSearch[n]&&e.teiSearch[n][a]?e.teiSearch[n][a]:{}).validationFailed,attributesWithValuesCount:wO(e,a)}},function(){return{}})(AO),xO=function(e){function t(){var e,n;Object(A.a)(this,t);for(var a=arguments.length,r=new Array(a),o=0;o<a;o++)r[o]=arguments[o];return(n=Object(F.a)(this,(e=Object(x.a)(t)).call.apply(e,[this].concat(r)))).renderDefaultResultsView=function(){return f.createElement("div",null,n.props.resultsLoading&&f.createElement(C,null))},n}return Object(P.a)(t,e),Object(w.a)(t,[{key:"render",value:function(){var e=this.props,t=e.getResultsView,n=Object(Fe.a)(e,["getResultsView"]);return f.createElement("div",null,f.createElement("div",null,t?t(n):this.renderDefaultResultsView()))}}]),t}(f.Component),PO=Object(D.b)(function(e,t){var n=e.teiSearch[t.id]||{},a=n.searchResults||{},r=e.formsValues[a.formId],o=t.searchGroups[parseInt(a.searchGroupId)];return{resultsLoading:a.resultsLoading,teis:a.teis||[],paging:a.paging,searchValues:r,searchProgramId:n.selectedProgramId,searchGroup:o}},function(){return{}})(xO),DO=pc()(vc()(sn)),UO={labelContainerStyle:{paddingTop:12,flexBasis:200},inputContainerStyle:{flexBasis:150}},LO=function(e){function t(){var e,n;Object(A.a)(this,t);for(var a=arguments.length,r=new Array(a),o=0;o<a;o++)r[o]=arguments[o];return(n=Object(F.a)(this,(e=Object(x.a)(t)).call.apply(e,[this].concat(r)))).onSelectProgram=function(e){n.props.onSetProgram(n.props.searchId,e)},n}return Object(P.a)(t,e),Object(w.a)(t,[{key:"render",value:function(){return f.createElement(DO,{styles:UO,options:this.props.programOptions,onSelect:this.onSelectProgram,label:c.a.t("Selected program"),value:this.props.selectedProgramId})}}]),t}(f.Component),MO="TeiSearchStartSetProgram",BO=function(e,t){return e.teiSearch[t.searchId].selectedTrackedEntityTypeId},VO=Object(D.b)(function(){var e=Object(nl.createSelector)(BO,function(e){return Array.from(Je.values()).filter(function(t){return t instanceof Xt&&t.trackedEntityType.id===e&&t.access.data.read}).map(function(e){return{value:e.id,label:e.name}})});return function(t,n){return{selectedProgramId:t.teiSearch[n.searchId].selectedProgramId,programOptions:e(t,n)}}},function(e){return{onSetProgram:function(t,n){e(function(e,t){return le(MO)({searchId:e,programId:t})}(t,n))}}})(LO),GO=function(e){function t(e){var n;return Object(A.a)(this,t),(n=Object(F.a)(this,Object(x.a)(t).call(this,e))).getFormId=function(e){var t=n.props.selectedProgramId||n.props.selectedTrackedEntityTypeId||"";return"".concat(n.props.id,"-").concat(t,"-").concat(e)},n.handleSearch=function(e,t){var a=n.props.id;n.props.onSearch(e,t,a)},n.handleSearchResultsChangePage=function(e){n.props.onSearchResultsChangePage(n.props.id,e)},n.handleNewSearch=function(){n.props.onNewSearch(n.props.id)},n.handleEditSearch=function(){n.props.onEditSearch(n.props.id)},n.handleSearchValidationFailed=function(){for(var e,t=n.props.id,a=arguments.length,r=new Array(a),o=0;o<a;o++)r[o]=arguments[o];(e=n.props).onSearchValidationFailed.apply(e,r.concat([t]))},n.renderSearchForms=function(e){return f.createElement("div",null,n.renderProgramSection(),n.renderSearchGroups(e))},n.renderProgramSection=function(){var e=!n.state.programSectionOpen;return f.createElement($c,{className:n.props.classes.programSection,isCollapsed:e,header:f.createElement(as,{containerStyle:{borderBottom:"1px solid #ECEFF1"},isCollapsed:e,onChangeCollapseState:function(){n.setState({programSectionOpen:!!e})},title:c.a.t("Program")})},f.createElement(VO,{searchId:n.props.id}))},n.onChangeSectionCollapseState=function(e){n.props.openSearchGroupSection!==e?n.props.onSetOpenSearchGroupSection(n.props.id,e):n.props.onSetOpenSearchGroupSection(n.props.id,null)},n.renderSearchGroups=function(e){return e.map(function(e,t){var a=t.toString(),r=n.getFormId(a),o=e.unique?c.a.t("Search {{uniqueAttrName}}",{uniqueAttrName:e.searchForm.getElements()[0].formName}):c.a.t("Search by attributes"),i=n.props.openSearchGroupSection!==a;return f.createElement($c,{isCollapsed:i,className:n.props.classes.formContainerSection,header:f.createElement(as,{containerStyle:{borderBottom:"1px solid #ECEFF1"},onChangeCollapseState:function(){n.onChangeSectionCollapseState(a)},isCollapsed:i,title:o})},f.createElement(FO,{key:r,id:r,searchId:n.props.id,searchGroupId:a,searchGroup:e,onSearch:n.handleSearch,onSearchValidationFailed:n.handleSearchValidationFailed}))})},n.renderSearchResult=function(){var e=n.props,t=(e.onSearch,e.showResults,e.onNewSearch,e.onEditSearch,e.onSearchResultsChangePage,e.classes,Object(Fe.a)(e,["onSearch","showResults","onNewSearch","onEditSearch","onSearchResultsChangePage","classes"]));return f.createElement(PO,Object.assign({onChangePage:n.handleSearchResultsChangePage,onNewSearch:n.handleNewSearch,onEditSearch:n.handleEditSearch},t))},n.state={programSectionOpen:!0},n}return Object(P.a)(t,e),Object(w.a)(t,[{key:"render",value:function(){var e=this.props.searchGroups;return this.props.showResults?this.renderSearchResult():e?this.renderSearchForms(e):f.createElement("div",null)}}]),t}(f.Component),WO=Ii()(function(e){return{programSection:{backgroundColor:"white",maxWidth:e.typography.pxToRem(900),marginBottom:e.typography.pxToRem(20)},formContainerSection:{maxWidth:e.typography.pxToRem(900),marginBottom:e.typography.pxToRem(20)}}})(GO),HO="BatchSetTeiSearchProgramAndTet",zO="ResetSearchForms",KO="InitializeTeiSearch",YO="RequestSearchTei",qO="SearchFormValidationFailed",XO="SearchTeiFailed",ZO="SearchTeiResultRetrieved",JO="SetTeiSearchProgramAndTet",QO="TeiNewSearch",$O="TeiEditSearch",ev="TeiSearchResultsChangePage",tv="TeiSearchSetOpenSearchGroupSection",nv=function(e,t,n){return le(KO)({searchId:e,programId:t,trackedEntityTypeId:n})},av=function(e,t,n){return le(JO)({searchId:e,programId:t,trackedEntityTypeId:n})};function rv(e,t){return t?It(t).searchGroups:Dt(e).searchGroups}var ov=function(e,t){return e.teiSearch[t.id].selectedTrackedEntityTypeId},iv=function(e,t){return e.teiSearch[t.id].selectedProgramId},cv=Object(D.b)(function(){var e=Object(nl.createSelector)(ov,iv,function(e,t){return rv(e,t).sort(function(e,t){return e.unique===t.unique?0:e.unique?-1:1})});return function(t,n){var a=e(t,n),r=t.teiSearch[n.id];return{searchGroups:a,showResults:!!r.searchResults,selectedProgramId:r.selectedProgramId,selectedTrackedEntityTypeId:r.selectedTrackedEntityTypeId,openSearchGroupSection:r.openSearchGroupSection}}},function(e){return{onSearch:function(t,n,a){e(function(e,t,n){return le(YO)({formId:e,searchGroupId:t,searchId:n})}(t,n,a))},onSearchResultsChangePage:function(t,n){e(function(e,t){return le(ev)({searchId:e,pageNumber:t})}(t,n))},onSearchValidationFailed:function(t,n,a){e(function(e,t,n){return le(qO)({formId:e,searchGroupId:t,searchId:n})}(t,n,a))},onNewSearch:function(t){e(function(e){return le(QO)({searchId:e})}(t))},onEditSearch:function(t){e(function(e){return le($O)({searchId:e})}(t))},onSetOpenSearchGroupSection:function(t,n){e(function(e,t){return le(tv)({searchId:e,searchGroupId:t})}(t,n))}}})(WO),sv=n(390),lv=n.n(sv),uv=n(392),dv=n.n(uv),pv=n(391),fv=n.n(pv),mv=n(389),hv=n.n(mv),bv=function(e){return{root:{flexShrink:0,color:e.palette.text.secondary}}},gv=function(){return function(e){return Object(E.withStyles)(bv,{withTheme:!0})(function(e){return function(t){function n(){var e,t;Object(A.a)(this,n);for(var a=arguments.length,r=new Array(a),o=0;o<a;o++)r[o]=arguments[o];return(t=Object(F.a)(this,(e=Object(x.a)(n)).call.apply(e,[this].concat(r)))).handleFirstPageButtonClick=function(){t.props.onChangePage(1)},t.handleBackButtonClick=function(){t.props.onChangePage(t.props.currentPage-1)},t.handleNextButtonClick=function(){t.props.onChangePage(t.props.currentPage+1)},t.handleLastPageButtonClick=function(){t.props.onChangePage(Math.max(1,Math.ceil(t.props.rowsCount/t.props.rowsPerPage)))},t}return Object(P.a)(n,t),Object(w.a)(n,[{key:"renderNavigationElement",value:function(){var e=this.props,t=e.rowsPerPage,n=e.currentPage,a=e.rowsCount,r=e.classes,o=e.theme;return f.createElement("div",{className:r.root},f.createElement(te.a,{onClick:this.handleFirstPageButtonClick,disabled:n<=1,"aria-label":"First Page"},"rtl"===o.direction?f.createElement(hv.a,null):f.createElement(lv.a,null)),f.createElement(te.a,{onClick:this.handleBackButtonClick,disabled:n<=1,"aria-label":"Previous Page"},"rtl"===o.direction?f.createElement(fv.a,null):f.createElement(dv.a,null)),f.createElement(te.a,{onClick:this.handleNextButtonClick,disabled:n>=Math.ceil(a/t),"aria-label":"Next Page"},"rtl"===o.direction?f.createElement(dv.a,null):f.createElement(fv.a,null)),f.createElement(te.a,{onClick:this.handleLastPageButtonClick,disabled:n>=Math.ceil(a/t),"aria-label":"Last Page"},"rtl"===o.direction?f.createElement(lv.a,null):f.createElement(hv.a,null)))}},{key:"render",value:function(){var t=this.props,n=(t.classes,t.theme,Object(Fe.a)(t,["classes","theme"]));return f.createElement(e,Object.assign({navigationElements:this.renderNavigationElement()},n))}}]),n}(f.Component)}(e))}},Ov=function(e){return e.selectedTrackedEntityTypeId},vv=function(e){return e.selectedProgramId},yv=function(){return Object(nl.createSelector)(vv,Ov,function(e,t){return e?It(e).attributes.filter(function(e){return e.displayInReports}):Dt(t).attributes.filter(function(e){return e.displayInReports})})},Ev=function(e){function t(){var e,n;Object(A.a)(this,t);for(var a=arguments.length,r=new Array(a),o=0;o<a;o++)r[o]=arguments[o];return(n=Object(F.a)(this,(e=Object(x.a)(t)).call.apply(e,[this].concat(r)))).renderImageDataElement=function(e){var t=n.props,a=t.item,r=t.classes,o=a.values[e.id];return f.createElement("div",{className:r.imageContainer},o&&f.createElement(Si.a,{src:o.url,alt:o.name,className:r.image}))},n.renderChunks=function(e){return e.map(function(e,t){return f.createElement(Si.e,{item:!0,xs:12,md:6,lg:3,key:t.toString()},n.renderChunkValues(e))})},n.renderChunkValues=function(e){var t=n.props,a=t.item,r=t.classes;return e.map(function(e){return f.createElement("div",{key:e.id,className:r.value},f.createElement("span",{className:r.elementName},e.name,":"),f.createElement("span",null,e.convertValue(a.values[e.id],Ju)))})},n}return Object(P.a)(t,e),Object(w.a)(t,[{key:"render",value:function(){var e=this.props,t=e.item,n=e.classes,a=e.imageDataElement,r=e.dataElementChunks,o=e.getCustomTopElements,i=e.getCustomBottomElements;return f.createElement("div",{key:t.id,className:n.itemContainer},o&&o(this.props),f.createElement("div",{className:n.itemDataContainer},a&&this.renderImageDataElement(a),f.createElement("div",{className:n.itemValuesContainer},this.renderChunks(r))),i&&i(this.props))}}]),t}(f.Component),_v=Object(E.withStyles)(function(e){return{itemContainer:{display:"flex",margin:e.typography.pxToRem(10),padding:e.typography.pxToRem(10),borderRadius:e.typography.pxToRem(4),border:"2px solid ".concat(e.palette.grey.light),backgroundColor:e.palette.grey.lighter,flexDirection:"column"},itemDataContainer:{display:"flex",flexWrap:"wrap"},itemValuesContainer:{display:"flex",flexWrap:"wrap",flexGrow:1},value:{padding:e.typography.pxToRem(2)},elementName:{paddingRight:e.typography.pxToRem(10),fontWeight:500},image:{width:e.typography.pxToRem(60),height:e.typography.pxToRem(60)},imageContainer:{margin:e.typography.pxToRem(6),minWidth:e.typography.pxToRem(70)}}})(Ev),jv=function(e){return e.dataElements},Iv=function(){return Object(nl.createSelector)(jv,function(e){var t=Object(We.a)(e),n=e.find(function(e){return e.type===ct.IMAGE});return n&&t.splice(t.indexOf(n),1),{dataElementChunks:Object(ze.a)(e,5),imageDataElement:n}})},Cv=function(e){function t(e){var n;return Object(A.a)(this,t),(n=Object(F.a)(this,Object(x.a)(t).call(this,e))).renderLoading=function(){return f.createElement("div",{className:n.props.classes.loadingContainer},f.createElement(De,null))},n.renderItems=function(){var e=n.props,t=e.items,a=e.getCustomItemBottomElements,r=e.getCustomItemTopElements;if(!t||0===t.length)return n.renderNoItems();var o=n.getDataElementsContainer(n.props);return t.map(function(e){return f.createElement(_v,Object.assign({item:e,getCustomTopElements:r,getCustomBottomElements:a},o))})},n.renderNoItems=function(){var e=n.props,t=e.classes,a=e.noItemsText;return f.createElement("div",{className:t.noItemsContainer},a)},n.getDataElementsContainer=Iv(),n}return Object(P.a)(t,e),Object(w.a)(t,[{key:"render",value:function(){var e=this.props.itemsLoading;return f.createElement("div",null,e?this.renderLoading():this.renderItems())}}]),t}(f.Component);Cv.defaultProps={itemTypeName:"item"};var Tv,Sv=Object(E.withStyles)(function(e){return{noItemsContainer:{fontStyle:"italic",padding:e.typography.pxToRem(10)}}})(Cv),Rv=Object(ze.d)(bd,Ju),kv=gv()(Bo),Nv=function(e){function t(e){var n;return Object(A.a)(this,t),(n=Object(F.a)(this,Object(x.a)(t).call(this,e))).onAddRelationship=function(e){n.props.onAddRelationship(e.id,e.values)},n.getItemActions=function(e){var t=n.props.classes;return f.createElement("div",{className:t.itemActionsContainer},f.createElement(Yc,{color:"primary",onClick:function(){return n.onAddRelationship(e.item)}},c.a.t("Link")))},n.renderResults=function(){var e=n.getAttributes(n.props),t=n.props,a=t.teis,r=t.trackedEntityTypeName;return f.createElement(f.Fragment,null,n.renderTopSection(),f.createElement(Sv,{items:a,dataElements:e,noItemsText:c.a.t("No {{trackedEntityTypeName}} found.",{trackedEntityTypeName:r}),getCustomItemBottomElements:function(e){return n.getItemActions(e)}}),n.renderPager())},n.getSearchValues=function(){var e=n.props,t=e.searchValues,a=e.searchGroup,r=e.teis,o=e.classes,i=a.searchForm,s=Object.keys(t).filter(function(e){return null!==t[e]}).map(function(e){var n=i.getElement(e),a=t[e],r=n.convertValue(a,Rv);return f.createElement("span",{key:e},n.formName,": ",r)}).reduce(function(e,t){return e.length>0?[].concat(Object(We.a)(e),[", ",t]):[" ",t]},[]),l=c.a.t("{{teiCount}} results found for",{teiCount:r.length});return f.createElement("div",{className:o.topSectionValuesContainer},l,s)},n.renderTopSection=function(){var e=n.props,t=e.onNewSearch,a=e.onEditSearch,r=e.classes;return f.createElement("div",{className:r.topSection},n.getSearchValues(),f.createElement("div",{className:r.topSectionActionsContainer},f.createElement(Yc,{className:r.actionButton,onClick:t},c.a.t("New search")),f.createElement(Yc,{className:r.actionButton,onClick:a},c.a.t("Edit search"))))},n.renderPager=function(){var e=n.props,t=e.onChangePage,a=e.paging,r=e.classes;return f.createElement("div",{className:r.pagination},f.createElement(kv,Object.assign({onChangePage:t,onGetLabelDisplayedRows:function(e,t){return"".concat(e," of ").concat(t)}},a)))},n.getAttributes=yv(),n}return Object(P.a)(t,e),Object(w.a)(t,[{key:"render",value:function(){return f.createElement("div",null,this.props.resultsLoading?f.createElement(C,null):this.renderResults())}}]),t}(f.Component),Av=Object(E.withStyles)(function(e){return{itemActionsContainer:{padding:e.typography.pxToRem(10)},pagination:{display:"flex",justifyContent:"flex-end"},topSection:{display:"flex",flexDirection:"column",margin:e.typography.pxToRem(10),backgroundColor:e.palette.grey.lighter},topSectionValuesContainer:{padding:e.typography.pxToRem(10)},topSectionActionsContainer:{},actionButton:{margin:e.typography.pxToRem(10),color:e.palette.primary.dark,borderRadius:0,border:"1px solid ".concat(e.palette.primary.dark)}}})(Nv),wv=function(e){return e.selectedRelationshipType.to.trackedEntityTypeId},Fv=function(){return Object(nl.createSelector)(wv,function(e){return Dt(e)})},xv={TEI_SEARCH:"TEI_SEARCH",TEI_REGISTER:"TEI_REGISTER"},Pv=(Tv={},Object(Ut.a)(Tv,xv.TEI_SEARCH,c.a.t("Search")),Object(Ut.a)(Tv,xv.TEI_REGISTER,c.a.t("Register")),Tv),Dv=c.a.t("tracked entity instance");function Uv(e,t,n){var a=Object.keys(e),r=t.filter(function(e){return a.some(function(t){return t===e.id})&&e.displayInReports});return 0===r.length?n||Dv:r.slice(0,2).map(function(t){return t.convertValue(e[t.id],nd)}).join(" ")}var Lv=function(e){return e.newRelationshipRegisterTei.programId},Mv=new(function(){function e(){Object(A.a)(this,e)}return Object(w.a)(e,[{key:"convertText",value:function(e){return e||""}},{key:"convertLongText",value:function(e){return e||""}},{key:"convertLetter",value:function(e){return e||""}},{key:"convertPhoneNumber",value:function(e){return e||""}},{key:"convertEmail",value:function(e){return e||""}},{key:"convertBoolean",value:function(e){return e||!1===e?e:""}},{key:"convertTrueOnly",value:function(e){return e||!1===e?e:""}},{key:"convertDate",value:function(e){return e?l()(e).format("YYYY-MM-DD"):""}},{key:"convertDateTime",value:function(e){return e||""}},{key:"convertTime",value:function(e){return e||""}},{key:"convertNumber",value:function(e){return e||0===e?e:""}},{key:"convertInteger",value:function(e){return e||0===e?e:""}},{key:"convertIntegerPositive",value:function(e){return e||0===e?e:""}},{key:"convertIntegerNegative",value:function(e){return e||0===e?e:""}},{key:"convertIntegerZeroOrPositive",value:function(e){return e||0===e?e:""}},{key:"convertPercentage",value:function(e){return e||0===e?e:""}},{key:"convertUrl",value:function(e){return e||""}},{key:"convertAge",value:function(e){return this.convertDate(e)}}]),e}()),Bv=new(function(){function e(){Object(A.a)(this,e)}return Object(w.a)(e,[{key:"convertText",value:function(e){return e}},{key:"convertLongText",value:function(e){return e}},{key:"convertLetter",value:function(e){return e}},{key:"convertPhoneNumber",value:function(e){return e}},{key:"convertEmail",value:function(e){return e}},{key:"convertBoolean",value:function(e){return e}},{key:"convertTrueOnly",value:function(e){return e}},{key:"convertDate",value:function(e){return e?l()(e,"YYYY-MM-DD").format("L"):e}},{key:"convertDateTime",value:function(e){if(!e)return null;var t=l()(e);return{date:t.format("L"),time:t.format("LT")}}},{key:"convertTime",value:function(e){return e}},{key:"convertNumber",value:function(e){return e.toString()}},{key:"convertInteger",value:function(e){return e.toString()}},{key:"convertIntegerPositive",value:function(e){return e.toString()}},{key:"convertIntegerNegative",value:function(e){return e.toString()}},{key:"convertIntegerZeroOrPositive",value:function(e){return e.toString()}},{key:"convertPercentage",value:function(e){return e.toString()}},{key:"convertUrl",value:function(e){return e}},{key:"convertAge",value:function(e){if(!e)return null;var t=l()(),n=l()(e),a=t.diff(n,"years");n.add(a,"years");var r=t.diff(n,"months");n.add(r,"months");var o=t.diff(n,"days");return{date:l()(e).format("L"),years:a.toString(),months:r.toString(),days:o.toString()}}}]),e}()),Vv=new(function(){function e(){Object(A.a)(this,e)}return Object(w.a)(e,[{key:"rulesDateToMoment",value:function(e){return l()(e,"YYYY-MM-DD")}},{key:"momentToRulesDate",value:function(e){return e.format("YYYY-MM-DD")}}]),e}()),Gv={PROGRAM_NOT_FOUND:"Program not found in loadAndExecuteRulesForEvent",PROGRAMSTAGE_NOT_FOUND:"ProgramStage not found",PROGRAM_OR_FOUNDATION_MISSING:"Program or foundation missing"};function Wv(e){var t,n,a=[];return e instanceof Xt&&(t=e,a=Array.from(t.stages.values()).reduce(function(e,t){var n=Array.from(t.stageForm.sections.values()).reduce(function(e,t){return[].concat(Object(We.a)(e),Object(We.a)(Array.from(t.elements.values())))},[]);return[].concat(Object(We.a)(e),Object(We.a)(n))},[])),e instanceof Ht&&(a=(n=e).stage?Array.from(n.stage.stageForm.sections.values()).reduce(function(e,t){return[].concat(Object(We.a)(e),Object(We.a)(Array.from(t.elements.values())))},[]):[]),function(e){return e.reduce(function(e,t){return e[t.id]={id:t.id,valueType:t.type,optionSetId:t.optionSet&&t.optionSet.id},e},{})}(a)}function Hv(e,t,n,a,r,o,i){if(!t||!n)return O.a.error(Object(ze.b)(Gv.PROGRAM_OR_FOUNDATION_MISSING)({program:t,foundation:n,method:"getRulesActionsForEvent"})),null;var c=function(e,t){var n=e.programRuleVariables,a=e.programRules,r=t.programRules;return{programRulesVariables:n,programRules:[].concat(Object(We.a)(a),Object(We.a)(r)),constants:Qt.get()}}(t,n);return c.programRules&&0!==c.programRules.length?function(e,t,n,a,r,o,i){return e.executeRules(t,o,i,n,null,null,null,a,r,bp.EVENT)}(e,c,Wv(t),r,Jt.get(),o,i):null}var zv={PROGRAM_MISSING_OR_INVALID:"Program is missing or is invalid",FOUNDATION_MISSING:"Foundation missing"};function Kv(e,t,n,a,r,o,i){var c=function(e,t){return e?t&&t instanceof Xt?null:zv.PROGRAM_MISSING_OR_INVALID:zv.FOUNDATION_MISSING}(n,t);if(c)return O.a.error(Object(ze.b)(c)({program:t,method:"getRulesActionsForTEI"})),null;var s=function(e){return{programRulesVariables:e.programRuleVariables.filter(function(e){return"TEI_ATTRIBUTE"===e.programRuleVariableSourceType}),programRules:e.programRules,constants:Qt.get()}}(t);return s.programRules&&0!==s.programRules.length?function(e,t,n,a,r,o,i){return e.executeRules(t,null,null,null,o,i,n,a,r,bp.TEI)}(e,s,function(e){var t=e.enrollment.enrollmentForm;return(t?Array.from(t.sections.values()).reduce(function(e,t){return[].concat(Object(We.a)(e),Object(We.a)(Array.from(t.elements.values())))},[]):[]).reduce(function(e,t){return e[t.id]={id:t.id,valueType:t.type,optionSetId:t.optionSet&&t.optionSet.id},e},{})}(t),r,Jt.get(),o,i):null}function Yv(e,t,n,a){var r=function(e){return e?Object.keys(e).map(function(t){var n=e[t],a=n[n.length-1];return{id:a.id,value:a.value}}):[]}(e),o=function(e){return e?Object.keys(e).map(function(e){return{id:e,value:null}}):[]}(t),i=function(e,t){return e?Object.keys(e).map(function(e){var n=t.getSection(e);return n?Array.from(n.elements.entries()).map(function(e){return e[1]}).map(function(e){return{id:e.id,value:null}}):null}).filter(function(e){return e}).reduce(function(e,t){return[].concat(Object(We.a)(e),Object(We.a)(t))},[]):[]}(n,a);return[].concat(Object(We.a)(r),Object(We.a)(o),Object(We.a)(i)).reduce(function(e,t){return e[t.id]=t.value,e},{})}function qv(e,t){if(!e||!t)return null;var n=e.reduce(function(e,t){var n=t.type;e[n]=e[n]||{};var a=t.id;return e[n][a]=e[n][a]||[],e[n][a].push(t),e},{});return n[gp.HIDE_FIELD]=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2?arguments[2]:void 0;return e?Object.keys(e).filter(function(e){var a=n.getElement(e),r=a&&a.compulsory,o=t[e];return!(r||o)}).reduce(function(t,n){return t[n]=e[n],t},{}):e}(n[gp.HIDE_FIELD],n[gp.MAKE_COMPULSORY],t),n[gp.HIDE_SECTION]=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2?arguments[2]:void 0;return e?Object.keys(e).filter(function(e){var a=n.getSection(e);return!!a&&!Array.from(a.elements.entries()).map(function(e){return e[1]}).some(function(e){var n=e.compulsory,a=t[e.id];return n||a})}).reduce(function(t,n){return t[n]=e[n],t},{}):e}(n[gp.HIDE_SECTION],n[gp.MAKE_COMPULSORY],t),n[gp.ASSIGN_VALUE]=Yv(n[gp.ASSIGN_VALUE],n[gp.HIDE_FIELD],n[gp.HIDE_SECTION],t),n}var Xv=new Ep(Mv,Vv,c.a.t,Bv);function Zv(e,t,n){var a=qv(e,t);return[Cp(a,n)]}function Jv(e,t,n,a,r,o){return Zv(Hv(Xv,e,t,0,a,r,o),t,n)}function Qv(e,t,n,a,r,o){return Zv(Kv(Xv,e,t,0,a,r,o),t,n)}function $v(e,t){return t.convertValues(e,bd)}var ey=function(e){return Function("return ".concat(e))()};function ty(e,t,n,a){return e?Object.keys(e).reduce(function(r,o){var i=t[o]&&t[o].type,c=t[o]&&t[o].onConvertOut;if(t[o]&&t[o].clientIgnore)return r;if(i){var s=e[o];r[o]=bd(s,i)}else if(c){var l=t[o]&&t[o].clientId,u=e[o],d=n[l],p=ey(c);r[l]=p(u,d,a)}else r[o]=e[o];return r},{}):null}function ny(e,t,n,a){var r,o,i=e.formsValues[n]||{},c=a?Object(se.a)({},i,Object(Ut.a)({},a.elementId,a.value)):i,s=function(e,t){var n=Object.keys(e).filter(function(e){return e.startsWith(t)}).reduce(function(t,n){return t=Object(se.a)({},t,e[n])},{});return Object.keys(n).reduce(function(e,t){return e[t]=n[t].valid,e},{})}(e.formsSectionsFieldsUI,n),l=a?Object(se.a)({},s,Object(Ut.a)({},a.elementId,a.valid)):s;return function(e,t){return $v(e,t)}((r=c,o=l,Object.keys(r).reduce(function(e,t){var n=o[t];return e[t]=n?r[t]:null,e},{})),t)}function ay(e,t,n,a,r){var o,i="".concat(n,"-").concat(t),c=e.dataEntriesFieldsUI[i],s=(o=c,Object.keys(o).reduce(function(e,t){return e[t]=o[t].isValid,e},{}));return ty(function(e,t){return Object.keys(e).reduce(function(n,a){return n[a]=t[a]?e[a]:null,n},{})}(e.dataEntriesFieldsValue[i],s),e.dataEntriesFieldsMeta[i],a,r)}var ry="StartRunRulesOnUpdateForNewEnrollment",oy=function(e,t,n,a,r){return le(ry)({innerPayload:e,searchActions:t,uid:n,programId:a,orgUnit:r},{skipLogging:["searchActions"]})},iy="RulesExecutedPostUpdateFieldForEnrollment",cy="UpdateFieldNewEnrollmentActionBatch",sy="UpdateDataEntryFieldNewEnrollmentActionBatch",ly=function(e,t,n,a,r,o,i,c){var s=arguments.length>8&&void 0!==arguments[8]?arguments[8]:[],l=arguments.length>9?arguments[9]:void 0,u=[];return e&&t&&(u=Qv(e,t,n,o,i,c)),Object(Le.batchActions)([].concat(Object(We.a)(u),[Lf(a,r,l)],Object(We.a)(s)),iy)},uy=n(404),dy=n.n(uy),py=function(e){return[{validator:An,message:c.a.t("A value is required")},{validator:function(t){return function(e,t){var n=Pn(e);if(!n.isValid)return!1;if(t)return!0;var a=n.momentDate,r=Se();return{valid:a.isSameOrBefore(r),message:c.a.t("A future date is not allowed")}}(t,e)},message:c.a.t("Please provide a valid date")}]},fy=function(e){return[{validator:An,message:c.a.t("A value is required")},{validator:function(t){return function(e,t){var n=Pn(e);if(!n.isValid)return!1;if(t)return!0;var a=n.momentDate,r=Se();return{valid:a.isSameOrBefore(r),message:c.a.t("A future date is not allowed")}}(t,e)},message:c.a.t("Please provide a valid date")}]},my="enrollment",hy={errorMessage:"validationError"},by={labelContainerStyle:{flexBasis:200},inputContainerStyle:{flexBasis:150}},gy={labelContainerStyle:{width:150},inputContainerStyle:{width:150}};function Oy(e){e.formHorizontal,e.fieldOptions,e.validationError,e.modified;return Object(Fe.a)(e,["formHorizontal","fieldOptions","validationError","modified"])}var vy=function(e,t){return Object(se.a)({},function(e){return{fieldOptions:e.fieldOptions,formHorizontal:e.formHorizontal,styles:e.formHorizontal?gy:by}}(e),t)},yy=function(e){return e?"center":"left"},Ey=$i(hy)(Ia()(pc()(fc()(vc({onGetUseVerticalOrientation:function(e){return e.formHorizontal},onGetCustomFieldLabeClass:function(e){return"".concat(e.fieldOptions.fieldLabelMediaBasedClass," ").concat(dy.a.coordinateLabel)}})(uc()(Ya()(mc(Oy)(Ti)))))))),_y=$i(hy)(Ia()(pc()(fc()(vc({onGetUseVerticalOrientation:function(e){return e.formHorizontal},onGetCustomFieldLabeClass:function(e){return"".concat(e.fieldOptions.fieldLabelMediaBasedClass," ").concat(dy.a.polygonLabel)}})(uc()(Ya()(mc(Oy)(ki)))))))),jy=function(e){return e?Ga.VERTICAL:Ga.HORIZONTAL},Iy=function(e){function t(){return Object(A.a)(this,t),Object(F.a)(this,Object(x.a)(t).apply(this,arguments))}return Object(P.a)(t,e),Object(w.a)(t,[{key:"componentWillUnmount",value:function(){Ys.clear()}},{key:"render",value:function(){var e=this.props,n=e.enrollmentMetadata,a=Object(Fe.a)(e,["enrollmentMetadata"]);return m.a.createElement(Vf,Object.assign({dataEntrySections:t.dataEntrySectionDefinitions},a,{formFoundation:n.enrollmentForm}))}}]),t}(m.a.Component);Iy.dataEntrySectionDefinitions=Object(Ut.a)({},my,{placement:df,name:c.a.t("Enrollment")});var Cy=Ph(function(e){return e.enrollmentMetadata.inputSearchGroups},function(e){return Object(se.a)({},e.onGetValidationContext(),{trackedEntityType:e.enrollmentMetadata.trackedEntityType.id,program:e.programId})})(Iy),Ty=Pm({isApplicable:function(e){var t=e.enrollmentMetadata.enrollmentForm.featureType;return["Polygon","Point"].includes(t)},getComponent:function(e){return"Polygon"===e.enrollmentMetadata.enrollmentForm.featureType?_y:Ey},getComponentProps:function(e){var t=e.enrollmentMetadata.enrollmentForm.featureType;return vy(e,"Polygon"===t?{width:e&&e.formHorizontal?150:350,label:c.a.t("Area"),dialogLabel:c.a.t("Area"),required:!1,orientation:jy(e.formHorizontal)}:{width:e&&e.formHorizontal?150:350,label:c.a.t("Coordinate"),dialogLabel:c.a.t("Coordinate"),required:!1,orientation:jy(e.formHorizontal),shrinkDisabled:e.formHorizontal})},getPropName:function(){return"geometry"},getValidatorContainers:function(){return[]},getMeta:function(){return{placement:df,section:my}}})(Cy),Sy=Pm(function(){var e=$i(hy)(Ia()(pc()(fc()(vc({onGetUseVerticalOrientation:function(e){return e.formHorizontal},onGetCustomFieldLabeClass:function(e){return"".concat(e.fieldOptions.fieldLabelMediaBasedClass," ").concat(dy.a.dateLabel)}})(uc()(Ya()(mc(Oy)(yi))))))));return{isApplicable:function(e){return e.enrollmentMetadata.showIncidentDate},getComponent:function(){return e},getComponentProps:function(e){return vy(e,{width:e&&e.formHorizontal?150:"100%",label:e.enrollmentMetadata.incidentDateLabel,required:!0,calendarWidth:e.formHorizontal?250:350,popupAnchorPosition:yy(e.formHorizontal),calendarMaxMoment:e.enrollmentMetadata.allowFutureIncidentDate?void 0:Se()})},getPropName:function(){return"incidentDate"},getValidatorContainers:function(e){return fy(e.enrollmentMetadata.allowFutureIncidentDate)},getMeta:function(){return{placement:df,section:my}}}}())(Ty),Ry=am(function(){var e=$i(hy)(Ia()(pc()(fc()(vc({onGetUseVerticalOrientation:function(e){return e.formHorizontal},onGetCustomFieldLabeClass:function(e){return"".concat(e.fieldOptions.fieldLabelMediaBasedClass," ").concat(dy.a.dateLabel)}})(uc()(Ya()(mc(Oy)(yi))))))));return{getComponent:function(){return e},getComponentProps:function(e){return vy(e,{width:e&&e.formHorizontal?150:"100%",label:e.enrollmentMetadata.enrollmentDateLabel,required:!0,calendarWidth:e.formHorizontal?250:350,popupAnchorPosition:yy(e.formHorizontal),calendarMaxMoment:e.enrollmentMetadata.allowFutureEnrollmentDate?void 0:Se()})},getPropName:function(){return"enrollmentDate"},getValidatorContainers:function(e){return py(e.enrollmentMetadata.allowFutureEnrollmentDate)},getMeta:function(){return{placement:df,section:my}}}}())(Sy),ky=Lm()(Ry),Ny=function(e){function t(){return Object(A.a)(this,t),Object(F.a)(this,Object(x.a)(t).apply(this,arguments))}return Object(P.a)(t,e),Object(w.a)(t,[{key:"render",value:function(){return m.a.createElement(ky,this.props)}}]),t}(m.a.PureComponent),Ay=function(e){function t(){var e,n;Object(A.a)(this,t);for(var a=arguments.length,r=new Array(a),o=0;o<a;o++)r[o]=arguments[o];return(n=Object(F.a)(this,(e=Object(x.a)(t)).call.apply(e,[this].concat(r)))).getValidationContext=function(){var e=n.props,t=e.orgUnit,a=e.onGetUnsavedAttributeValues;return{orgUnitId:t.id,onGetUnsavedAttributeValues:a}},n.handleUpdateField=function(){for(var e,t=n.props,a=t.programId,r=t.orgUnit,o=arguments.length,i=new Array(o),c=0;c<o;c++)i[c]=arguments[c];(e=n.props).onUpdateField.apply(e,i.concat([a,r]))},n.handleUpdateDataEntryField=function(){for(var e,t=n.props,a=t.programId,r=t.orgUnit,o=arguments.length,i=new Array(o),c=0;c<o;c++)i[c]=arguments[c];(e=n.props).onUpdateDataEntryField.apply(e,i.concat([a,r]))},n.handleStartAsyncUpdateField=function(){for(var e,t=n.props,a=t.programId,r=t.orgUnit,o=arguments.length,i=new Array(o),c=0;c<o;c++)i[c]=arguments[c];(e=n.props).onStartAsyncUpdateField.apply(e,i.concat([a,r]))},n}return Object(P.a)(t,e),Object(w.a)(t,[{key:"render",value:function(){var e=this.props,t=(e.orgUnit,e.onUpdateField,e.onUpdateDataEntryField,e.onStartAsyncUpdateField,e.onGetUnsavedAttributeValues,Object(Fe.a)(e,["orgUnit","onUpdateField","onUpdateDataEntryField","onStartAsyncUpdateField","onGetUnsavedAttributeValues"]));return m.a.createElement(Ny,Object.assign({onGetValidationContext:this.getValidationContext,onUpdateFormField:this.handleUpdateField,onUpdateDataEntryField:this.handleUpdateDataEntryField,onUpdateFormFieldAsync:this.handleStartAsyncUpdateField},t))}}]),t}(m.a.Component),wy=Object(D.b)(function(){return{}},function(e){return{onUpdateDataEntryField:function(t,n,a,r){e(function(e,t,n){var a=e.payload,r=a.dataEntryId,o=a.itemId,i=Xc()();return Object(Le.batchActions)([e,Uf(r,o,i),oy(e.payload,null,i,t,n)],sy)}(t,a,r))},onUpdateField:function(t,n,a,r){e(function(e,t,n,a){var r=t.filterActions,o=t.filterActionsToBeExecuted,i=e.payload,c=i.dataEntryId,s=i.itemId,l=Xc()();return Object(Le.batchActions)([e].concat(Object(We.a)(o),[Uf(c,s,l),oy(e.payload,r,l,n,a)]),cy)}(t,n,a,r))},onStartAsyncUpdateField:function(t,n,a,r,o,i){e(function(e,t,n){return ue(e)({onSuccess:t,onError:n})}(t,function(e){return function(e,t,n,a,r,o){var i=t.filterActions,c=t.filterActionsToBeExecuted,s=Xc()();return Object(Le.batchActions)([e].concat(Object(We.a)(c),[Uf(n,a,s),oy(Object(se.a)({},e.payload,{dataEntryId:n,itemId:a}),i,s,r,o)]),cy)}(e,n,a,r,o,i)},function(e){return e}))}}})(Ay),Fy="OpenDataEntryForNewEnrollment",xy=function(e,t){return le(Fy)({dataEntryId:e,generatedUniqueValues:t})};function Py(e,t,n){if(!e||!["Polygon","Point"].includes(n.featureType))return null;var a=e;return"Point"===n.featureType&&(a=[e.longitude,e.latitude]),{type:n.featureType,coordinates:a}}function Dy(e){return function(t){return t&&e&&t.type===e.featureType?"Point"===e.featureType?{latitude:t.coordinates[1],longitude:t.coordinates[0]}:t.coordinates:null}}function Uy(e){return"COMPLETED"===e?"true":null}function Ly(e,t){return"true"===e&&"COMPLETED"!==t?"COMPLETED":e||"COMPLETED"!==t?t:"ACTIVE"}function My(e,t){return Object(ze.d)(yd,nc)(e,t)}function By(e,t){return Vy.apply(this,arguments)}function Vy(){return(Vy=Object(o.a)(r.a.mark(function e(t,n){var a,o,i,c,s;return r.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return a=ye(),e.next=3,a.get("trackedEntityAttributes/".concat(t,"/requiredValues")).then(function(e){return e&&e.REQUIRED}).catch(function(e){return O.a.error(Object(ze.b)("Could not retrieve required values")({teaId:t,error:e})),null});case 3:return o=e.sent,i=o&&o.includes("ORG_UNIT_CODE")?{ORG_UNIT_CODE:n.orgUnitCode}:null,c=Object(se.a)({},i,{expiration:"3"}),e.next=8,a.get("trackedEntityAttributes/".concat(t,"/generate"),c).then(function(e){return e&&e.value}).catch(function(e){return O.a.error(Object(ze.b)("Could not generate unique id")({teaId:t,error:e})),null});case 8:return s=e.sent,e.abrupt("return",s);case 10:case"end":return e.stop()}},e)}))).apply(this,arguments)}function Gy(e,t){var n=t[e];if(!n)return null;var a=Se().add(1,"days").unix();return n.expires>a?n:null}function Wy(e,t,n){if(!e)return Promise.resolve([]);var a=e.getElements().filter(function(e){return e.unique&&e.unique.generatable}).map(function(){var e=Object(o.a)(r.a.mark(function e(a){var o,i;return r.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(o=a.id,!(i=Gy(o,t))){e.next=4;break}return e.abrupt("return",{id:o,item:i});case 4:return e.abrupt("return",By(o,n).then(function(e){return{id:o,item:{value:My(e,a.type),expires:Se().add(3,"days").unix()}}}));case 5:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}());return Promise.all(a)}var Hy=[{id:"enrollmentDate",type:"DATE",validatorContainers:py()},{id:"incidentDate",type:"DATE",validatorContainers:fy()},{clientId:"geometry",dataEntryId:"geometry",onConvertOut:Py}],zy="OpenDataEntryForNewEnrollmentBatch",Ky=function(){var e=Object(o.a)(r.a.mark(function e(t,n,a,o){var i,c,s,l,u,d,p,f=arguments;return r.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return i=f.length>4&&void 0!==f[4]?f[4]:[],c=f.length>5&&void 0!==f[5]?f[5]:[],s=f.length>6&&void 0!==f[6]?f[6]:{},l=ff(o,"newEnrollment"),e.next=6,Wy(n,s,{orgUnitCode:a.code});case 6:return u=e.sent,d=Hh(o,"newEnrollment",[].concat(Hy,Object(We.a)(c)),null,u.reduce(function(e,t){return e[t.id]=t.item.value,e},{})),p=t&&n?Qv(t,n,l,a,{},{}):[],e.abrupt("return",Object(Le.batchActions)([xy(o,u.reduce(function(e,t){return e[t.id]=t.item,e},{}))].concat(Object(We.a)(d),Object(We.a)(p),Object(We.a)(i)),zy));case 10:case"end":return e.stop()}},e)}));return function(t,n,a,r){return e.apply(this,arguments)}}();function Yy(e,t,n){var a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},r=(arguments.length>4&&void 0!==arguments[4]&&arguments[4],arguments.length>5&&void 0!==arguments[5]&&arguments[5],arguments.length>6&&void 0!==arguments[6]&&arguments[6],function(e,t,n){var a=e.trackedEntityType.id;return{orgUnit:t.orgUnitId,trackedEntityType:a,attributes:Object.keys(n).map(function(e){return{attribute:e,value:n[e]}})}}(n,t,function(e,t){return t.convertValues(e,Object(ze.d)(bd,id))}(a,n.enrollmentForm)));return Object(se.a)({},r)}var qy="Program not found",Xy="Program is not a tracker program",Zy=function(e,t,n){var a,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[],o=e.getState(),i=t.programId,c=t.dataEntryId,s=t.itemId,l=t.orgUnit,u=t.uid,d=ff(c,s);try{var p=Nt(i);p instanceof Xt?a=p:O.a.error(Object(ze.b)(Xy)({method:"openNewEnrollmentInDataEntryEpic",program:p}))}catch(b){O.a.error(Object(ze.b)(qy)({method:"openNewEnrollmentInDataEntryEpic",error:b,programId:i}))}var f=a&&a.enrollment.enrollmentForm;if(!a||!f)return ly(a,f,d,c,s,l,null,null,r,u);var m=ny(o,f,d,n),h=ay(o,s,c,{},f);return ly(a,f,d,c,s,l,h,m,r,u)},Jy="NewTeiFieldUpdateBatch",Qy=function(e){function t(){return Object(A.a)(this,t),Object(F.a)(this,Object(x.a)(t).apply(this,arguments))}return Object(P.a)(t,e),Object(w.a)(t,[{key:"componentWillUnmount",value:function(){Ys.clear()}},{key:"render",value:function(){var e=this.props,t=e.teiRegistrationMetadata,n=Object(Fe.a)(e,["teiRegistrationMetadata"]);return m.a.createElement(Vf,Object.assign({},n,{formFoundation:t.form}))}}]),t}(m.a.Component),$y=Ph(function(e){return e.teiRegistrationMetadata.inputSearchGroups},function(e){return Object(se.a)({},e.onGetValidationContext(),{trackedEntityType:e.teiRegistrationMetadata.form.id})})(Qy),eE=Lm()($y),tE=function(e){function t(){return Object(A.a)(this,t),Object(F.a)(this,Object(x.a)(t).apply(this,arguments))}return Object(P.a)(t,e),Object(w.a)(t,[{key:"render",value:function(){return m.a.createElement(eE,this.props)}}]),t}(m.a.PureComponent),nE=function(e){function t(){var e,n;Object(A.a)(this,t);for(var a=arguments.length,r=new Array(a),o=0;o<a;o++)r[o]=arguments[o];return(n=Object(F.a)(this,(e=Object(x.a)(t)).call.apply(e,[this].concat(r)))).getValidationContext=function(){var e=n.props,t=e.orgUnit,a=e.onGetUnsavedAttributeValues;return{orgUnitId:t.id,onGetUnsavedAttributeValues:a}},n}return Object(P.a)(t,e),Object(w.a)(t,[{key:"render",value:function(){var e=this.props,t=(e.orgUnit,e.onUpdateField),n=e.onStartAsyncUpdateField,a=e.teiRegistrationMetadata,r=(e.onGetUnsavedAttributeValues,Object(Fe.a)(e,["orgUnit","onUpdateField","onStartAsyncUpdateField","teiRegistrationMetadata","onGetUnsavedAttributeValues"]));return a?m.a.createElement(tE,Object.assign({onGetValidationContext:this.getValidationContext,onUpdateFormField:t,onUpdateFormFieldAsync:n,teiRegistrationMetadata:a},r)):m.a.createElement("div",null,c.a.t("An error has occured. See log for details"))}}]),t}(m.a.Component),aE=Object(D.b)(function(){return{}},function(e){return{onUpdateField:function(t,n){e(function(e,t){var n=t.filterActions,a=t.filterActionsToBeExecuted;return Object(Le.batchActions)([e].concat(Object(We.a)(a),Object(We.a)(n)),Jy)}(t,n))},onStartAsyncUpdateField:function(t,n){e(function(e,t,n){return ue(e)({onSuccess:t,onError:n})}(t,function(e){return function(e,t){var n=t.filterActions,a=t.filterActionsToBeExecuted;return Object(Le.batchActions)([e].concat(Object(We.a)(a),Object(We.a)(n)),Jy)}(e,n)},function(e){return e}))}}})(nE),rE="OpenDataEntryForNewTEI",oE=function(e,t){return le(rE)({dataEntryId:e,generatedUniqueValues:t})},iE="NewTeiDataEntryOpenBatch",cE=function(){var e=Object(o.a)(r.a.mark(function e(t,n,a){var o,i,c,s,l=arguments;return r.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return o=l.length>3&&void 0!==l[3]?l[3]:[],i=l.length>4&&void 0!==l[4]?l[4]:{},e.next=4,Wy(t,i,{orgUnitCode:n.code});case 4:return c=e.sent,s=Hh(a,"newTei",null,null,c.reduce(function(e,t){return e[t.id]=t.item.value,e},{})),e.abrupt("return",Object(Le.batchActions)([oE(a,c.reduce(function(e,t){return e[t.id]=t.item,e},{}))].concat(Object(We.a)(s),Object(We.a)(o)),iE));case 7:case"end":return e.stop()}},e)}));return function(t,n,a){return e.apply(this,arguments)}}(),sE=function(e,t){var n=t.id,a=ff(n,e.dataEntries[n].itemId);return{possibleDuplicatesFound:!!(e.dataEntriesSearchGroupsResults[a]&&e.dataEntriesSearchGroupsResults[a].main&&e.dataEntriesSearchGroupsResults[a].main.count)}},lE=function(){return{}},uE=Zm({onGetFormFoundation:function(e){return e.enrollmentMetadata.enrollmentForm}})(function(e){return Object(D.b)(sE,lE,null,{withRef:!0})(function(e){return function(t){function n(){return Object(A.a)(this,n),Object(F.a)(this,Object(x.a)(n).apply(this,arguments))}return Object(P.a)(n,t),Object(w.a)(n,[{key:"renderButton",value:function(){var e=this.props,t=e.onSave,a=e.possibleDuplicatesFound,r=e.enrollmentMetadata;return f.createElement(Tr,{kind:"primary",size:"medium",onClick:t},n.getButtonText(a,r.trackedEntityType.name))}},{key:"render",value:function(){var t=this.props,n=(t.onSave,t.possibleDuplicatesFound,Object(Fe.a)(t,["onSave","possibleDuplicatesFound"])),a=this.renderButton();return f.createElement(e,Object.assign({mainButton:a},n))}}],[{key:"getButtonText",value:function(e,t){return e?c.a.t("Review Duplicates"):c.a.t("Create {{trackedEntityTypeName}} and link",{trackedEntityTypeName:t})}}]),n}(f.Component)}(e))}(wy)),dE=n(1492),pE=n.n(dE),fE=function(e){function t(e){var n;return Object(A.a)(this,t),(n=Object(F.a)(this,Object(x.a)(t).call(this,e))).handleSave=function(e,t,a){n.props.onSave(e,t,a)},n.fieldOptions={theme:e.theme,fieldLabelMediaBasedClass:pE.a.fieldLabelMediaBased},n}return Object(P.a)(t,e),Object(w.a)(t,[{key:"render",value:function(){var e=this.props,t=(e.classes,e.onSave,e.theme,e.enrollmentMetadata),n=Object(Fe.a)(e,["classes","onSave","theme","enrollmentMetadata"]);return m.a.createElement("div",null,m.a.createElement(uE,Object.assign({id:"relationship",onSave:this.handleSave,fieldOptions:this.fieldOptions,enrollmentMetadata:t},n)))}}]),t}(f.Component),mE=Object(E.withTheme)()(fE),hE=Object(D.b)(function(){var e=Object(nl.createSelector)(Lv,function(e){var t;try{t=Nt(e)}catch(n){return null}return t.enrollment});return function(t){return{enrollmentMetadata:e(t),programId:t.newRelationshipRegisterTei.programId,orgUnit:t.newRelationshipRegisterTei.orgUnit}}},function(){return{}})(mE),bE=function(e){return e.newRelationship.selectedRelationshipType.to.trackedEntityTypeId},gE=function(e,t){var n=t.id,a=ff(n,e.dataEntries[n].itemId);return{possibleDuplicatesFound:!!(e.dataEntriesSearchGroupsResults[a]&&e.dataEntriesSearchGroupsResults[a].main&&e.dataEntriesSearchGroupsResults[a].main.count)}},OE=function(){return{}},vE=Zm({onGetFormFoundation:function(e){return e.teiRegistrationMetadata.form}})(function(e){return Object(D.b)(gE,OE,null,{withRef:!0})(function(e){return function(t){function n(){return Object(A.a)(this,n),Object(F.a)(this,Object(x.a)(n).apply(this,arguments))}return Object(P.a)(n,t),Object(w.a)(n,[{key:"renderButton",value:function(){var e=this.props,t=e.onSave,a=e.possibleDuplicatesFound,r=e.teiRegistrationMetadata;return f.createElement(Tr,{kind:"primary",size:"medium",onClick:t},n.getButtonText(a,r.trackedEntityType.name))}},{key:"render",value:function(){var t=this.props,n=(t.onSave,t.possibleDuplicatesFound,Object(Fe.a)(t,["onSave","possibleDuplicatesFound"])),a=this.renderButton();return f.createElement(e,Object.assign({mainButton:a},n))}}],[{key:"getButtonText",value:function(e,t){return e?c.a.t("Review Duplicates"):c.a.t("Create {{trackedEntityTypeName}} and link",{trackedEntityTypeName:t})}}]),n}(f.Component)}(e))}(aE)),yE=n(1493),EE=n.n(yE),_E=function(e){function t(e){var n;return Object(A.a)(this,t),(n=Object(F.a)(this,Object(x.a)(t).call(this,e))).handleSave=function(e,t,a){n.props.onSave(e,t,a)},n.fieldOptions={theme:e.theme,fieldLabelMediaBasedClass:EE.a.fieldLabelMediaBased},n}return Object(P.a)(t,e),Object(w.a)(t,[{key:"render",value:function(){var e=this.props,t=(e.classes,e.onSave,e.theme,Object(Fe.a)(e,["classes","onSave","theme"]));return m.a.createElement("div",null,m.a.createElement(vE,Object.assign({id:"relationship",onSave:this.handleSave,fieldOptions:this.fieldOptions},t)))}}]),t}(f.Component),jE=Object(E.withTheme)()(_E),IE=Object(D.b)(function(){var e=Object(nl.createSelector)(bE,function(e){var t;try{t=Dt(e)}catch(n){return O.a.error(Object(ze.b)("Could not get TrackedEntityType for id")({TETypeId:e})),null}return t&&t.teiRegistration});return function(t){return{teiRegistrationMetadata:e(t),orgUnit:t.newRelationshipRegisterTei.orgUnit}}},function(){return{}})(jE),CE=function(e){function t(){var e,n;Object(A.a)(this,t);for(var a=arguments.length,r=new Array(a),o=0;o<a;o++)r[o]=arguments[o];return(n=Object(F.a)(this,(e=Object(x.a)(t)).call.apply(e,[this].concat(r)))).handleShowExisting=function(){n.props.onShowExisting()},n}return Object(P.a)(t,e),Object(w.a)(t,[{key:"renderDefault",value:function(e,t,n){var a=t.toLowerCase(),r=e.toLowerCase();return m.a.createElement(m.a.Fragment,null,m.a.createElement("div",null,c.a.t("A {{trackedEntityTypeName}} with this {{attributeName}} is already registered",{trackedEntityTypeName:a,attributeName:r})),m.a.createElement("div",null,m.a.createElement(Tn,{onClick:this.handleShowExisting,className:n},c.a.t("Show registered {{trackedEntityTypeName}}",{trackedEntityTypeName:a}))))}},{key:"renderContents",value:function(){var e=this.props,n=e.trackedEntityType,a=e.attributeName,r=e.errorData,o=e.classes;return n&&a?r?r.attributeValueExistsUnsaved?t.renderAttributeValueExistsUnsaved(a):r.tetId!==n.id?t.renderTypeDifference(a,n.name):this.renderDefault(a,n.name,o.linkButton):t.renderNoAccess(a):t.renderPrerequisitesError()}},{key:"render",value:function(){var e=this.props.classes;return m.a.createElement("div",{className:e.container},this.renderContents())}}],[{key:"renderPrerequisitesError",value:function(){return m.a.createElement("div",null,c.a.t("A duplicate exists (but there were some errors, see log for details"))}},{key:"renderNoAccess",value:function(e){var t=e.toLowerCase();return m.a.createElement("div",null,c.a.t("An item with this {{attributeName}} is already registered, but you don't have access to it",{attributeName:t}))}},{key:"renderAttributeValueExistsUnsaved",value:function(e){var t=e.toLowerCase();return m.a.createElement("div",null,c.a.t("You have already registered this {{attributeName}}",{attributeName:t}))}},{key:"renderTypeDifference",value:function(e,t){var n=t.toLowerCase(),a=e.toLowerCase();return m.a.createElement("div",null,c.a.t("A {{trackedEntityTypeName}} with this {{attributeName}} is already registered",{trackedEntityTypeName:n,attributeName:a}))}}]),t}(m.a.Component),TE=Object(E.withStyles)(function(){return{linkButton:{fontSize:"inherit",paddingLeft:0,paddingRight:3,backgroundColor:"inherit",textDecoration:"underline",cursor:"pointer",outline:"none"},container:{padding:2}}})(CE),SE=function(e){return e.newRelationship.selectedRelationshipType.to.trackedEntityTypeId},RE=function(e){return e.newRelationshipRegisterTei.programId},kE=function(e,t){return t.id};var NE=Object(D.b)(function(){var e=Object(nl.createSelector)(SE,function(e){var t;try{t=Dt(e)}catch(n){return null}return t}),t=Object(nl.createSelector)(RE,kE,function(e,t,n){return n},function(e,t,n){if(!e)return n?function(e,t){var n=t.teiRegistration.form.getElement(e);return n?n.name:null}(t,n):null;var a;try{a=It(e)}catch(r){return null}return function(e,t){var n=t.enrollment.enrollmentForm.getElement(e);return n?n.name:null}(t,a)});return function(n,a){var r=e(n,a);return{trackedEntityType:r,attributeName:t(n,a,r)}}},function(){return{}})(TE),AE=function(e){function t(){var e,n;Object(A.a)(this,t);for(var a=arguments.length,r=new Array(a),o=0;o<a;o++)r[o]=arguments[o];return(n=Object(F.a)(this,(e=Object(x.a)(t)).call.apply(e,[this].concat(r)))).handleLink=function(){n.props.onLink(n.props.attributeValues)},n}return Object(P.a)(t,e),Object(w.a)(t,[{key:"render",value:function(){var e=this.props,t=e.attributeValues,n=e.dataElements,a=e.onCancel,r=[{id:"foundTEI",values:t}];return m.a.createElement(m.a.Fragment,null,m.a.createElement(X.a,null,m.a.createElement(J.a,null,c.a.t("Registered person")),m.a.createElement(Sv,{items:r,dataElements:n})),m.a.createElement(Y.a,null,m.a.createElement($.a,{onClick:a,color:"primary"},c.a.t("Cancel")),m.a.createElement($.a,{onClick:this.handleLink,color:"primary",autoFocus:!0},c.a.t("Link"))))}}]),t}(m.a.Component),wE=function(e){return e.programId},FE=function(e){return e.tetAttributesOnly},xE=function(e){return e.errorData.tetId},PE=Object(D.b)(function(){var e=Object(nl.createSelector)(wE,FE,xE,function(e,t,n){if(t){var a;try{a=Dt(n)}catch(o){return[]}return a.attributes.filter(function(e){return e.displayInReports})}var r;try{r=It(e)}catch(o){return[]}return r.attributes.filter(function(e){return e.displayInReports})}),t=Object(nl.createSelector)(function(e,t){return t},function(e){return e.attributeValues},function(e,t){return e.reduce(function(e,n){var a=t[n.id];return(a||0===a||!1===a)&&(e[n.id]=n.convertValue(a,yd)),e},{})});return function(n,a){var r=e(a);return{dataElements:r,attributeValues:t(a,r)}}},function(){return{}},function(e,t,n){n.programId,n.tetAttributesOnly,n.errorData;var a=Object(Fe.a)(n,["programId","tetAttributesOnly","errorData"]);return Object.assign({},a,e,t)})(AE),DE=Ue()(PE),UE=function(e){function t(e){var n;return Object(A.a)(this,t),(n=Object(F.a)(this,Object(x.a)(t).call(this,e))).state={ready:!1,tetAttributesOnly:!1,attributeValues:null},n.requestTei(),n}return Object(P.a)(t,e),Object(w.a)(t,[{key:"componentWillUnmount",value:function(){this.cancelablePromise&&this.cancelablePromise.cancel()}},{key:"requestTeiWithoutProgram",value:function(){var e=this,t=this.props.errorData.id,n=Object(ze.c)(ye().get("trackedEntityInstances/".concat(t),{}));n.promise.then(function(t){var n=t&&t.attributes||[];e.setState({ready:!0,tetAttributesOnly:!0,attributeValues:n.reduce(function(e,t){return e[t.attribute]=t.value,e},{})})}).catch(function(t){t&&t.isCanceled||e.setState({ready:!0,tetAttributesOnly:!0,attributeValues:{}})}),this.cancelablePromise=n}},{key:"requestTeiInProgramContext",value:function(){var e=this,t=this.props,n=t.errorData,a=t.programId,r=n.id,o=Object(ze.c)(ye().get("trackedEntityInstances/".concat(r),{program:a}));o.promise.then(function(t){t&&t.attributes?e.setState({ready:!0,attributeValues:t.attributes.reduce(function(e,t){return e[t.attribute]=t.value,e},{})}):e.requestTeiWithoutProgram()}).catch(function(t){t&&t.isCanceled||e.requestTeiWithoutProgram()}),this.cancelablePromise=o}},{key:"requestTei",value:function(){this.props.programId?this.requestTeiInProgramContext():this.requestTeiWithoutProgram()}},{key:"render",value:function(){var e=Object(_.a)({},this.props);return m.a.createElement(DE,Object.assign({},this.state,e))}}]),t}(m.a.Component),LE=Object(D.b)(function(e){return{programId:e.newRelationshipRegisterTei.programId}},function(){return{}})(UE),ME=function(e){var t=e.open,n=Object(Fe.a)(e,["open"]);return m.a.createElement(z.a,{fullWidth:!0,maxWidth:"md",open:t,onClose:e.onCancel},m.a.createElement(LE,n))},BE=function(e){function t(e){var n;return Object(A.a)(this,t),(n=Object(F.a)(this,Object(x.a)(t).call(this,e))).handleShowExisting=function(){n.setState({existingTeiDialogOpen:!0})},n.handleCancelLink=function(){n.setState({existingTeiDialogOpen:!1})},n.handleLink=function(e){n.setState({existingTeiDialogOpen:!1});var t=n.props.errorData.id;n.props.onLink(t,e)},n.state={existingTeiDialogOpen:!1},n}return Object(P.a)(t,e),Object(w.a)(t,[{key:"render",value:function(){var e=this.props,t=e.id,n=(e.onLink,Object(Fe.a)(e,["id","onLink"])),a=this.state.existingTeiDialogOpen;return f.createElement(f.Fragment,null,f.createElement(NE,Object.assign({onShowExisting:this.handleShowExisting,id:t},n)),f.createElement(ME,Object.assign({open:a,onCancel:this.handleCancelLink,onLink:this.handleLink},n)))}}]),t}(f.Component),VE=function(e){return function(t){function n(e){var t;return Object(A.a)(this,n),(t=Object(F.a)(this,Object(x.a)(n).call(this,e))).postProcessErrorMessage=function(e,n,a,r,o){if("unique"!==n)return e;var i=t.cache[r]||{};if(e===i.errorMessage&&a===i.errorData)return i.outputElement;var c=f.createElement(BE,{errorData:a,id:o,onLink:t.props.onLink});return t.cache[r]={errorMessage:e,errorData:a,outputElement:c},c},t.cache={},t}return Object(P.a)(n,t),Object(w.a)(n,[{key:"render",value:function(){var t=this.props,n=(t.onLink,Object(Fe.a)(t,["onLink"]));return f.createElement(e,Object.assign({onPostProcessErrorMessage:this.postProcessErrorMessage},n))}}]),n}(f.Component)}(function(e){function t(){return Object(A.a)(this,t),Object(F.a)(this,Object(x.a)(t).apply(this,arguments))}return Object(P.a)(t,e),Object(w.a)(t,[{key:"render",value:function(){var e=this.props,t=e.showDataEntry,n=e.programId,a=Object(Fe.a)(e,["showDataEntry","programId"]);return t?n?f.createElement(hE,a):f.createElement(IE,a):null}}]),t}(f.Component)),GE=Object(D.b)(function(e){return{showDataEntry:e.newRelationshipRegisterTei.orgUnit,ready:!e.newRelationshipRegisterTei.dataEntryIsLoading,error:e.newRelationshipRegisterTei.dataEntryError,programId:e.newRelationshipRegisterTei.programId}},function(){return{}})(Ue()(Pe()(VE))),WE=function(e){function t(e){var n;return Object(A.a)(this,t),(n=Object(F.a)(this,Object(x.a)(t).call(this,e))).filterPrograms=function(e){var t=n.props.orgUnitIds;return e.filter(function(e){return!t||t.some(function(t){return e.organisationUnits[t]})})},n.programs=Array.from(Je.values()),n}return Object(P.a)(t,e),Object(w.a)(t,null,[{key:"isBeingFiltered",value:function(e,t){return e.length!==t.length}}]),Object(w.a)(t,[{key:"getBaselinePrograms",value:function(e){var t=this.props.baselineFilter;return e.filter(function(e){return t(e)})}},{key:"getPrograms",value:function(e){return Object(ze.d)(this.filterPrograms)(e)}},{key:"render",value:function(){var e=this.props,n=(e.orgUnitIds,e.baselineFilter,e.children),a=Object(Fe.a)(e,["orgUnitIds","baselineFilter","children"]),r=this.getBaselinePrograms(this.programs),o=this.getPrograms(r);return n(o,t.isBeingFiltered(r,o),a)}}]),t}(f.Component),HE=function(e){function t(){var e,n;Object(A.a)(this,t);for(var a=arguments.length,r=new Array(a),o=0;o<a;o++)r[o]=arguments[o];return(n=Object(F.a)(this,(e=Object(x.a)(t)).call.apply(e,[this].concat(r)))).baseLineFilter=function(e){var t=n.props.trackedEntityTypeId;return e instanceof Xt&&e.trackedEntityType.id===t&&e.access.data.write},n.getOptionsFromPrograms=function(e){return e.map(function(e){return{label:e.name,value:e.id,iconLeft:n.getProgramIcon(e)}})},n}return Object(P.a)(t,e),Object(w.a)(t,[{key:"getProgramIcon",value:function(e){var t=this.props.classes;return e.icon.data?f.createElement("div",{className:t.iconContainer},f.createElement("img",{style:{backgroundColor:e.icon.color},className:t.icon,src:e.icon.data,alt:e.name})):null}},{key:"renderIsFilteredText",value:function(){var e=this.props,t=e.classes,n=e.onClearFilter;return f.createElement("div",{className:t.isFilteredContainer},c.a.t("Some programs are being filtered."),f.createElement(Tn,{className:t.isFilteredLink,onClick:n},c.a.t("Show all")))}},{key:"render",value:function(){var e=this,t=this.props,n=(t.classes,t.orgUnitIds),a=t.onUpdateSelectedProgram,r=(t.onClearFilter,Object(Fe.a)(t,["classes","orgUnitIds","onUpdateSelectedProgram","onClearFilter"]));return f.createElement(WE,{orgUnitIds:n,baselineFilter:this.baseLineFilter},function(t,n){return f.createElement("div",null,f.createElement(hi,Object.assign({options:e.getOptionsFromPrograms(t),required:!1,onSelect:a},r)),n?e.renderIsFilteredText():null)})}}]),t}(f.Component),zE=Ia()(pc()(vc({onGetCustomFieldLabeClass:function(e){return e.programLabelClass}})(mc(function(e){e.programLabelClass;return Object(Fe.a)(e,["programLabelClass"])})(bi()(Object(E.withStyles)(function(e){return{iconContainer:{display:"flex",alignItems:"center",paddingRight:5},icon:{width:22,height:22,borderRadius:2},isFilteredContainer:{fontSize:12,color:e.palette.grey.dark,paddingTop:5},isFilteredLink:{paddingLeft:2,backgroundColor:"inherit"}}})(HE)))))),KE=function(e){function t(){return Object(A.a)(this,t),Object(F.a)(this,Object(x.a)(t).apply(this,arguments))}return Object(P.a)(t,e),Object(w.a)(t,[{key:"render",value:function(){var e=this.props,n=e.classes,a=Object(Fe.a)(e,["classes"]);return f.createElement(zE,Object.assign({styles:t.baseComponentStyles,programLabelClass:n.programLabel,label:c.a.t("Program")},a))}}]),t}(f.Component);KE.baseComponentStyles={labelContainerStyle:{flexBasis:200},inputContainerStyle:{flexBasis:150}};var YE=Object(E.withStyles)(function(e){return{programLabel:Object(Ut.a)({paddingTop:"10px"},e.breakpoints.down(523),{paddingTop:"0px !important"})}})(KE),qE="NewRelationshipSingleEventRegisterTeiProgramChange",XE="NewRelationshipSingleEventRegisterTeiOrgUnitChange",ZE="NewRelationshipSingleEventRegisterTeiOrgUnitSearchFailed",JE="NewRelationshipSingleEventRegisterTeiProgramFilterClear",QE=Object(D.b)(function(e){return{orgUnitIds:e.newRelationshipRegisterTei.orgUnit?[e.newRelationshipRegisterTei.orgUnit.id]:null,trackedEntityTypeId:e.newRelationship.selectedRelationshipType.to.trackedEntityTypeId,value:e.newRelationshipRegisterTei.programId}},function(e){return{onUpdateSelectedProgram:function(t){e(function(e){return le(qE)({programId:e})}(t))},onClearFilter:function(){e(le(JE)())}}})(YE),$E=function(e){var t,n=function(e){var t,n;return n=t=function(t){function n(e){var t;return Object(A.a)(this,n),(t=Object(F.a)(this,Object(x.a)(n).call(this,e))).handleFilterChange=function(e){e?t.filterOrgUnits(e):t.resetOrgUnits()},t.state={filteredRoots:null,filterText:null,inProgress:!1,treeKey:n.INITIAL_TREE_KEY},t.cancelablePromise=null,t}return Object(P.a)(n,t),Object(w.a)(n,[{key:"componentWillUnmount",value:function(){this.cancelablePromise&&this.cancelablePromise.cancel()}},{key:"filterOrgUnits",value:function(e){var t=this,n=this.props,a=n.scope,r=n.onSearchError,o=a===yc?{withinUserHierarchy:!0}:{withinUserSearchHierarchy:!0};this.setState({inProgress:!0}),this.cancelablePromise&&this.cancelablePromise.cancel();var i=Object(ze.c)(_e().models.organisationUnits.list(Object(se.a)({fields:["id,displayName,path,publicAccess,access,lastUpdated","children[id,displayName,publicAccess,access,path,children::isNotEmpty]"].join(","),paging:!1,query:e},o)));i.promise.then(function(n){t.setState({filteredRoots:n.toArray(),filterText:e,inProgress:!1,treeKey:e}),t.cancelablePromise=null}).catch(function(e){O.a.error(Object(ze.b)("There was an error retrieving organisation unit roots")({error:e})),r&&r(e)}),this.cancelablePromise=i}},{key:"resetOrgUnits",value:function(){this.setState({filteredRoots:null,filterText:null,treeKey:n.INITIAL_TREE_KEY})}},{key:"render",value:function(){var t=this.props,n=t.defaultRoots,a=(t.onSearchError,t.onSelect),r=(t.scope,Object(Fe.a)(t,["defaultRoots","onSearchError","onSelect","scope"])),o=this.state,i=o.filteredRoots,c=o.filterText,s=o.treeKey,l=o.inProgress;return f.createElement(e,Object.assign({roots:i||n,treeKey:s,searchText:c,ready:!l,onSearch:this.handleFilterChange,onBlur:a},r))}}]),n}(f.Component),t.INITIAL_TREE_KEY="initial",n}(e),a=function(e){function t(e){var n;Object(A.a)(this,t);var a=(n=Object(F.a)(this,Object(x.a)(t).call(this,e))).props.scope;return n.defaultRoots=Ic(t.DEFAULT_ROOTS_DATA[a])||[],n}return Object(P.a)(t,e),Object(w.a)(t,[{key:"render",value:function(){var e=Object(_.a)({},this.props);return f.createElement(n,Object.assign({defaultRoots:this.defaultRoots},e))}}]),t}(f.Component);return a.DEFAULT_ROOTS_DATA=(t={},Object(Ut.a)(t,yc,"captureRoots"),Object(Ut.a)(t,Ec,"search"),t),a}(Li),e_=function(e){function t(){return Object(A.a)(this,t),Object(F.a)(this,Object(x.a)(t).apply(this,arguments))}return Object(P.a)(t,e),Object(w.a)(t,[{key:"render",value:function(){var e=this.props,t=e.onUpdateSelectedOrgUnit,n=Object(Fe.a)(e,["onUpdateSelectedOrgUnit"]);return f.createElement($E,Object.assign({onSelect:t,scope:yc,maxTreeHeight:200},n))}}]),t}(f.Component),t_=fc()(pc()(vc({onGetUseVerticalOrientation:function(e){return e.formHorizontal},onGetCustomFieldLabeClass:function(e){return e.labelClass}})(mc(function(e){e.labelClass;return Object(Fe.a)(e,["labelClass"])})(Ya()(e_))))),n_=function(e){function t(){var e,n;Object(A.a)(this,t);for(var a=arguments.length,r=new Array(a),o=0;o<a;o++)r[o]=arguments[o];return(n=Object(F.a)(this,(e=Object(x.a)(t)).call.apply(e,[this].concat(r)))).handleUpdateSelectedOrgUnit=function(e){var t=n.props,a=t.programId,r=t.onUpdateSelectedOrgUnit;if(a&&e){var o;try{o=Nt(a)}catch(i){return void r(e,!0)}r(e,!!o.organisationUnits&&!o.organisationUnits[e.id])}else r(e,!1)},n}return Object(P.a)(t,e),Object(w.a)(t,[{key:"render",value:function(){var e=this.props,n=e.classes,a=(e.onUpdateSelectedOrgUnit,e.programId,Object(Fe.a)(e,["classes","onUpdateSelectedOrgUnit","programId"]));return f.createElement(t_,Object.assign({labelClass:n.label,label:c.a.t("Organisation Unit"),styles:t.baseComponentStyles,onUpdateSelectedOrgUnit:this.handleUpdateSelectedOrgUnit},a))}}]),t}(f.Component);n_.baseComponentStyles={labelContainerStyle:{flexBasis:200},inputContainerStyle:{flexBasis:150}};var a_=Object(E.withStyles)(function(e){return{label:Object(Ut.a)({paddingTop:"10px"},e.breakpoints.down(523),{paddingTop:"0px !important"})}})(n_),r_=Object(D.b)(function(e){return{value:e.newRelationshipRegisterTei.orgUnit,programId:e.newRelationshipRegisterTei.programId}},function(e){return{onUpdateSelectedOrgUnit:function(t,n){e(function(e,t){return le(XE)({orgUnit:e,resetProgramSelection:t})}(t,n))},onSearchError:function(){e(le(ZE)())}}})(a_),o_=Object(E.withStyles)(function(e){return{sectionFieldsInSection:{margin:e.spacing.unit}}})(function(e){var t=e.classes;return f.createElement("div",{className:t.sectionFieldsInSection},f.createElement(r_,null),f.createElement(QE,null))}),i_=function(){var e=c.a.t("Registration");return f.createElement(as,{title:e})},c_=Object(E.withStyles)(function(e){return{section:{backgroundColor:"white",maxWidth:e.typography.pxToRem(892)}}})(function(e){var t=e.classes;return f.createElement($c,{header:i_(),elevation:2,className:t.section},f.createElement(o_,null))}),s_=function(e){function t(e){var n;return Object(A.a)(this,t),(n=Object(F.a)(this,Object(x.a)(t).call(this,e))).toggleCollapse=function(){n.setState({collapsed:!n.state.collapsed})},n.renderCollapsable=function(){var e=n.props.classes;return f.createElement(Si.f,{className:e.toggleCollapseButton,onClick:n.toggleCollapse},n.state.collapsed?f.createElement(Di.b,null):f.createElement(Di.c,null))},n.renderContent=function(){var e=n.props,t=e.children,a=e.classes;return f.createElement("div",{className:a.contentContainer},t)},n.state={collapsed:n.props.collapsed||!1},n}return Object(P.a)(t,e),Object(w.a)(t,[{key:"componentWillReceiveProps",value:function(e){e.collapsed!==this.props.collapsed&&this.setState({collapsed:e.collapsed})}},{key:"render",value:function(){var e=this.props,t=e.header,n=e.collapsable,a=e.classes;return f.createElement(Si.i,{className:a.container},f.createElement("div",{className:a.headerContainer},t,n&&this.renderCollapsable()),!this.state.collapsed&&this.renderContent())}}]),t}(f.Component),l_=Object(E.withStyles)(function(e){return{container:{margin:e.typography.pxToRem(10)},headerContainer:{display:"flex",alignItems:"center",justifyContent:"space-between",padding:e.typography.pxToRem(5),minHeight:e.typography.pxToRem(42)},toggleCollapseButton:{height:e.typography.pxToRem(32),width:e.typography.pxToRem(32)},contentContainer:{padding:e.typography.pxToRem(10),borderTop:"1px solid ".concat(e.palette.grey.blueGrey)}}})(s_),u_=function(e){function t(){return Object(A.a)(this,t),Object(F.a)(this,Object(x.a)(t).apply(this,arguments))}return Object(P.a)(t,e),Object(w.a)(t,[{key:"render",value:function(){var e=this.props,t=e.icon,n=e.text,a=e.badgeCount,r=e.classes,o=e.badgeClass,i=!!a||0===a;return f.createElement("div",{className:r.headerContainer},f.createElement("div",{className:r.headerItemContainer},f.createElement(t,null)),f.createElement("div",{className:r.headerItemContainer},n),i&&f.createElement("div",{className:r.headerItemContainer},f.createElement(Si.b,{className:Cn()(r.badge,o),label:a})))}}]),t}(f.Component),d_=Object(E.withStyles)(function(e){return{headerContainer:{display:"flex",alignItems:"center"},headerItemContainer:{display:"inline-flex",paddingRight:e.typography.pxToRem(5),paddingLeft:e.typography.pxToRem(5)},badge:{height:e.typography.pxToRem(20),width:e.typography.pxToRem(20),fontWeight:700}}})(u_),p_=c.a.t("Errors"),f_=function(e){function t(){var e,n;Object(A.a)(this,t);for(var a=arguments.length,r=new Array(a),o=0;o<a;o++)r[o]=arguments[o];return(n=Object(F.a)(this,(e=Object(x.a)(t)).call.apply(e,[this].concat(r)))).renderHeader=function(){var e=n.props,t=e.classes,a=e.errors,r=a?a.length:0;return f.createElement(d_,{icon:Di.g,text:p_,badgeClass:t.badge,badgeCount:r})},n.renderItems=function(e){return e.map(function(e){return f.createElement("div",{className:n.props.classes.error,key:e.id},e.message)})},n}return Object(P.a)(t,e),Object(w.a)(t,[{key:"render",value:function(){var e=this.props.errors;return e&&e.length>0?f.createElement(l_,{collapsable:!0,header:this.renderHeader()},this.renderItems(e)):null}}]),t}(f.Component),m_=Object(E.withStyles)(function(e){return{badge:{backgroundColor:e.palette.error.main,color:"white"},error:{marginTop:e.typography.pxToRem(5),marginBottom:e.typography.pxToRem(5),padding:e.typography.pxToRem(10),borderRadius:e.typography.pxToRem(4),backgroundColor:e.palette.error.lighter}}})(f_),h_=function(e){return e.messagesContainer},b_=function(e){return e.containerPropNameMain},g_=function(e){return e.containerPropNameOnComplete},O_=function(e){return e.showOnComplete},v_=function(){return Object(nl.createSelector)(h_,O_,b_,g_,function(e,t,n,a){if(e=e||{},!t)return e[n];var r=e[n]||[],o=e[a]||[];return[].concat(Object(We.a)(r),Object(We.a)(o))})},y_=Object(D.b)(function(){var e=v_();return function(t,n){var a=n.dataEntryKey,r=t.rulesEffectsGeneralErrors[a],o=t.dataEntriesUI&&t.dataEntriesUI[a]&&t.dataEntriesUI[a].saveAttempted;return{errors:e({messagesContainer:r,containerPropNameMain:"error",containerPropNameOnComplete:"errorOnComplete",showOnComplete:o})}}},function(){return{}})(m_),E_=c.a.t("Warnings"),__=function(e){function t(){var e,n;Object(A.a)(this,t);for(var a=arguments.length,r=new Array(a),o=0;o<a;o++)r[o]=arguments[o];return(n=Object(F.a)(this,(e=Object(x.a)(t)).call.apply(e,[this].concat(r)))).renderHeader=function(){var e=n.props,t=e.classes,a=e.warnings,r=a?a.length:0;return f.createElement(d_,{icon:Di.j,text:E_,badgeClass:t.badge,badgeCount:r})},n.renderItems=function(e){return e.map(function(e){return f.createElement("div",{className:n.props.classes.warning,key:e.id},e.message)})},n}return Object(P.a)(t,e),Object(w.a)(t,[{key:"render",value:function(){var e=this.props.warnings;return e&&e.length>0?f.createElement(l_,{collapsable:!0,header:this.renderHeader()},this.renderItems(e)):null}}]),t}(f.Component),j_=Object(E.withStyles)(function(e){return{badge:{backgroundColor:e.palette.warning.light},warning:{marginTop:e.typography.pxToRem(5),marginBottom:e.typography.pxToRem(5),padding:e.typography.pxToRem(10),borderRadius:e.typography.pxToRem(4),backgroundColor:e.palette.warning.lighter}}})(__),I_=function(e){function t(){var e,n;Object(A.a)(this,t);for(var a=arguments.length,r=new Array(a),o=0;o<a;o++)r[o]=arguments[o];return(n=Object(F.a)(this,(e=Object(x.a)(t)).call.apply(e,[this].concat(r)))).handleDuplicatesClick=function(){var e=n.props;(0,e.onReviewDuplicates)(e.onOpenReviewDialog)},n}return Object(P.a)(t,e),Object(w.a)(t,[{key:"render",value:function(){var e=this.props.classes;return m.a.createElement("div",null,m.a.createElement(Tn,{onClick:this.handleDuplicatesClick,className:e.linkButton},c.a.t("Possible duplicates found")))}}]),t}(m.a.Component),C_=Object(E.withStyles)(function(){return{linkButton:{fontSize:"inherit",paddingLeft:0,paddingRight:3,backgroundColor:"inherit",textDecoration:"underline",cursor:"pointer",outline:"none"}}})(I_),T_="RelationshipTeiRegistrationDuplicatesReview",S_="RelationshipTeiRegistrationDuplicatesReviewRetrievalSuccess",R_="RelationshipTeiRegistrationDuplicatesReviewRetrievalFailed",k_="RelationshipTeiRegistrationDuplicatesChangePage",N_=function(){return le(T_)()},A_=function(){return le(R_)()},w_=Object(D.b)(function(e,t){return{}},function(e){return{onReviewDuplicates:function(t){e(N_()),t()}}})(C_),F_=gv()(Bo),x_=Object(E.withStyles)(function(){return{container:{display:"flex",justifyContent:"flex-end"}}})(function(e){var t=e.onChangePage,n=e.paginationData,a=e.classes;return m.a.createElement("div",{className:a.container},m.a.createElement(F_,Object.assign({onChangePage:t,onGetLabelDisplayedRows:function(e,t){return"".concat(e," of ").concat(t)}},n)))}),P_=Object(D.b)(function(e){return{paginationData:e.newRelationshipRegisterTeiDuplicatesReview.paginationData}},function(e){return{onChangePage:function(t){e(function(e){return le(k_)({page:e})}(t))}}})(x_),D_=Ue(null,null,function(e){return!e.isUpdating})(Sv),U_=function(e){function t(){var e,n;Object(A.a)(this,t);for(var a=arguments.length,r=new Array(a),o=0;o<a;o++)r[o]=arguments[o];return(n=Object(F.a)(this,(e=Object(x.a)(t)).call.apply(e,[this].concat(r)))).getLinkButton=function(e){var t=n.props,a=t.onLink,r=t.classes,o=e.item,i=o.id,s=o.values;return m.a.createElement("div",{className:r.linkButtonCotainer},m.a.createElement($.a,{onClick:function(){a(i,s)},color:"primary"},c.a.t("Link")))},n}return Object(P.a)(t,e),Object(w.a)(t,[{key:"componentDidMount",value:function(){!this.props.isUpdating&&this.contentListInstance&&(this.height=this.contentListInstance.clientHeight)}},{key:"render",value:function(){var e=this,t=this.props,n=t.dataElements,a=t.teis,r=t.isUpdating,o=this.height?{height:this.height}:null;return m.a.createElement(m.a.Fragment,null,m.a.createElement(X.a,null,m.a.createElement(J.a,null,c.a.t("Possible duplicates found")),m.a.createElement("div",{ref:function(t){e.contentListInstance=t},style:o},m.a.createElement(D_,{isUpdating:r,items:a,dataElements:n,getCustomItemBottomElements:this.getLinkButton}))),m.a.createElement(P_,null))}}]),t}(m.a.Component),L_=Object(E.withStyles)(function(e){return{linkButtonCotainer:{padding:e.typography.pxToRem(10)}}})(U_),M_=function(e){return e.newRelationshipRegisterTei.programId},B_=function(e){return e.newRelationship.selectedRelationshipType.to.trackedEntityTypeId},V_=Object(D.b)(function(){var e=Object(nl.createSelector)(M_,B_,function(e,t){if(!e){var n;try{n=Dt(t)}catch(r){return[]}return n.attributes.filter(function(e){return e.displayInReports})}var a;try{a=It(e)}catch(r){return[]}return a.attributes.filter(function(e){return e.displayInReports})});return function(t,n){return{ready:!t.newRelationshipRegisterTeiDuplicatesReview.isLoading,isUpdating:t.newRelationshipRegisterTeiDuplicatesReview.isUpdating,error:t.newRelationshipRegisterTeiDuplicatesReview.loadError?c.a.t("An error occured loading possible duplicates"):null,teis:t.newRelationshipRegisterTeiDuplicatesReview.teis,dataElements:e(t,n)}}},function(e){return{}})(Ue(function(){return{padding:5}})(Pe()(L_))),G_=function(e){function t(){return Object(A.a)(this,t),Object(F.a)(this,Object(x.a)(t).apply(this,arguments))}return Object(P.a)(t,e),Object(w.a)(t,[{key:"render",value:function(){var e=this.props,n=e.open,a=e.onCancel,r=e.onLink,o=e.extraActions;return f.createElement(z.a,{open:n,fullWidth:!0,maxWidth:"md",onClose:a,PaperProps:t.paperProps},f.createElement(V_,{onLink:r}),f.createElement(Y.a,null,o))}}]),t}(f.Component);G_.paperProps={style:{maxHeight:"calc(100% - 100px)"}};var W_=G_,H_=function(e){function t(e){var n;return Object(A.a)(this,t),(n=Object(F.a)(this,Object(x.a)(t).call(this,e))).handleOpenReviewDialog=function(){n.setState({duplicatesReviewDialogOpen:!0})},n.handleCloseReviewDialog=function(){n.setState({duplicatesReviewDialogOpen:!1})},n.state={duplicatesReviewDialogOpen:!1},n}return Object(P.a)(t,e),Object(w.a)(t,[{key:"getHideButton",value:function(){return m.a.createElement($.a,{onClick:this.handleCloseReviewDialog,color:"primary"},c.a.t("Hide"))}},{key:"render",value:function(){var e=this.props.onLink,t=this.state.duplicatesReviewDialogOpen;return m.a.createElement(m.a.Fragment,null,m.a.createElement(w_,{onOpenReviewDialog:this.handleOpenReviewDialog}),m.a.createElement(W_,{open:t,onCancel:this.handleCloseReviewDialog,onLink:e,extraActions:this.getHideButton()}))}}]),t}(m.a.Component),z_=function(e,t){return e.dataEntriesSearchGroupsResults[t.dataEntryKey]&&e.dataEntriesSearchGroupsResults[t.dataEntryKey].main&&e.dataEntriesSearchGroupsResults[t.dataEntryKey].main.count},K_=function(e,t){return t.onLink},Y_=function(e,t){return t},q_=Object(D.b)(function(){var e=Object(nl.createSelector)(z_,K_,function(e,t){return e?{id:"duplicateWarning",message:m.a.createElement(H_,{onLink:t})}:null}),t=Object(nl.createSelector)(Y_,function(e){return e},function(e,t){return e=e||[],t?[].concat(Object(We.a)(e),[t]):e}),n=v_();return function(a,r){var o=r.dataEntryKey,i=a.rulesEffectsGeneralWarnings[o],c=a.dataEntriesUI&&a.dataEntriesUI[o]&&a.dataEntriesUI[o].saveAttempted,s=n({messagesContainer:i,containerPropNameMain:"warning",containerPropNameOnComplete:"warningOnComplete",showOnComplete:c}),l=e(a,r);return{warnings:t(l,s)}}},function(){return{}})(j_),X_=c.a.t("Feedbacks"),Z_=function(e){function t(){var e,n;Object(A.a)(this,t);for(var a=arguments.length,r=new Array(a),o=0;o<a;o++)r[o]=arguments[o];return(n=Object(F.a)(this,(e=Object(x.a)(t)).call.apply(e,[this].concat(r)))).renderHeader=function(e){var t=n.props.classes;return f.createElement(d_,{icon:Di.a,text:X_,badgeClass:t.badge,badgeCount:e})},n.renderTextItems=function(e,t){return e.map(function(e){return f.createElement("div",{className:Cn()(t.feedback,t.textFeedback),key:e.id},e.message)})},n.renderKeyValueItems=function(e,t){return e.map(function(e){return f.createElement("div",{className:Cn()(t.feedback,t.keyValueFeedback),key:e.id},f.createElement("div",{className:t.keyValueFeedbackItem},e.key),f.createElement("div",{className:t.keyValueFeedbackItem},e.value))})},n.getFeedbacks=function(){return n.props.feedbacks||{}},n}return Object(P.a)(t,e),Object(w.a)(t,[{key:"render",value:function(){var e=this.props.classes,t=this.getFeedbacks(),n=t.displayTexts||[],a=t.displayKeyValuePairs||[],r=n.length+a.length;return r>0?f.createElement(l_,{collapsable:!0,header:this.renderHeader(r)},this.renderTextItems(n,e),this.renderKeyValueItems(a,e)):null}}]),t}(f.Component),J_=Object(E.withStyles)(function(e){return{badge:{backgroundColor:e.palette.grey.light},feedback:{marginTop:e.typography.pxToRem(5),marginBottom:e.typography.pxToRem(5),borderRadius:e.typography.pxToRem(4),backgroundColor:e.palette.grey.lighter,display:"flex"},textFeedback:{padding:e.typography.pxToRem(10)},keyValueFeedbackItem:{padding:e.typography.pxToRem(10)},keyValueFeedback:{alignItems:"center",justifyContent:"space-between"}}})(Z_),Q_=Object(D.b)(function(e,t){return{feedbacks:e.rulesEffectsFeedback[t.dataEntryKey]}},function(){return{}})(J_),$_=c.a.t("Indicators"),ej=function(e){function t(){var e,n;Object(A.a)(this,t);for(var a=arguments.length,r=new Array(a),o=0;o<a;o++)r[o]=arguments[o];return(n=Object(F.a)(this,(e=Object(x.a)(t)).call.apply(e,[this].concat(r)))).renderHeader=function(e){var t=n.props.classes;return f.createElement(d_,{icon:Di.h,text:$_,badgeClass:t.badge,badgeCount:e})},n.renderTextItems=function(e,t){return e.map(function(e){return f.createElement("div",{className:Cn()(t.indicator,t.textIndicator),key:e.id},e.message)})},n.renderKeyValueItems=function(e,t){return e.map(function(e){return f.createElement("div",{className:Cn()(t.indicator,t.keyValueIndicator),key:e.id},f.createElement("div",{className:t.keyValueIndicatorItem},e.key),f.createElement("div",{className:t.keyValueIndicatorItem},e.value))})},n.getIndicators=function(){return n.props.indicators||{}},n}return Object(P.a)(t,e),Object(w.a)(t,[{key:"render",value:function(){var e=this.props.classes,t=this.getIndicators(),n=t.displayTexts||[],a=t.displayKeyValuePairs||[],r=n.length+a.length;return r>0?f.createElement(l_,{collapsable:!0,header:this.renderHeader(r)},this.renderTextItems(n,e),this.renderKeyValueItems(a,e)):null}}]),t}(f.Component),tj=Object(E.withStyles)(function(e){return{badge:{backgroundColor:e.palette.grey.light},indicator:{marginTop:e.typography.pxToRem(5),marginBottom:e.typography.pxToRem(5),borderRadius:e.typography.pxToRem(4),backgroundColor:e.palette.grey.lighter,display:"flex"},textIndicator:{padding:e.typography.pxToRem(10)},keyValueIndicatorItem:{padding:e.typography.pxToRem(10)},keyValueIndicator:{alignItems:"center",justifyContent:"space-between"}}})(ej),nj=Object(D.b)(function(e,t){return{indicators:e.rulesEffectsIndicators[t.dataEntryKey]}},function(){return{}})(tj),aj=[{id:"ErrorsSection",Component:y_},{id:"WarningsSection",Component:q_},{id:"FeedbacksSection",Component:Q_},{id:"IndicatorsSection",Component:nj}],rj=function(e){function t(){var e,n;Object(A.a)(this,t);for(var a=arguments.length,r=new Array(a),o=0;o<a;o++)r[o]=arguments[o];return(n=Object(F.a)(this,(e=Object(x.a)(t)).call.apply(e,[this].concat(r)))).renderComponent=function(e,t){t.onLink;var n=Object(Fe.a)(t,["onLink"]),a="WarningsSection"===e.id?t:n;return f.createElement(e.Component,Object.assign({key:e.id},a))},n}return Object(P.a)(t,e),Object(w.a)(t,[{key:"render",value:function(){var e=this,t=this.props,n=t.classes,a=Object(Fe.a)(t,["classes"]);return f.createElement(hf,{offsetTop:50,containerClass:n.stickyOnScroll},f.createElement("div",null,aj.map(function(t){return e.renderComponent(t,a)})))}}]),t}(f.Component),oj=Object(E.withStyles)(function(e){return{stickyOnScroll:{position:"relative",flexGrow:1,width:e.typography.pxToRem(300),margin:e.typography.pxToRem(10),marginTop:0}}})(rj),ij=Object(D.b)(function(e,t){var n=e.newRelationshipRegisterTei,a=!n.loading&&!n.dataEntryIsLoading;return{ready:a,dataEntryKey:a?ff("relationship",e.dataEntries.relationship.itemId):null}},function(){return{}})(function(e){return e.ready?m.a.createElement(oj,e):null}),cj=function(e){function t(e){var n;return Object(A.a)(this,t),(n=Object(F.a)(this,Object(x.a)(t).call(this,e))).handleSaveAttempt=function(){for(var e=arguments.length,t=new Array(e),a=0;a<e;a++)t[a]=arguments[a];var r;n.props.possibleDuplicates?(n.args=t,n.props.onReviewDuplicates(function(){n.setState({duplicatesOpen:!0})})):(r=n.props).onSave.apply(r,t)},n.handleSaveFromDialog=function(){var e;(e=n.props).onSave.apply(e,Object(We.a)(n.args))},n.handleDialogCancel=function(){n.setState({duplicatesOpen:!1})},n.state={duplicatesOpen:!1},n}return Object(P.a)(t,e),Object(w.a)(t,[{key:"getSaveButton",value:function(){return f.createElement($.a,{onClick:this.handleSaveFromDialog,color:"primary"},c.a.t("Save as new {{tetName}}",{tetName:this.props.tetName}))}},{key:"getCancelButton",value:function(){return f.createElement($.a,{onClick:this.handleDialogCancel,color:"primary"},c.a.t("Cancel"))}},{key:"getActions",value:function(){return f.createElement(f.Fragment,null,this.getCancelButton(),this.getSaveButton())}},{key:"render",value:function(){var e=this.props,t=e.onLink,n=e.classes,a=e.onGetUnsavedAttributeValues,r=this.state.duplicatesOpen;return f.createElement("div",{className:n.container},f.createElement("div",{className:n.leftContainer},f.createElement(c_,null),f.createElement(GE,{onLink:t,onSave:this.handleSaveAttempt,onGetUnsavedAttributeValues:a})),f.createElement(ij,{onLink:t}),f.createElement(W_,{open:r,onLink:t,onCancel:this.handleDialogCancel,extraActions:this.getActions()}))}}]),t}(f.Component),sj=Object(E.withStyles)(function(){return{container:{display:"flex",flexWrap:"wrap"},leftContainer:{flexGrow:10,flexBasis:0,marginTop:10}}})(cj),lj=function(e){return e.newRelationship.selectedRelationshipType.to.trackedEntityTypeId},uj=Object(D.b)(function(){var e=Object(nl.createSelector)(lj,function(e){var t;try{t=Dt(e)}catch(n){return null}return t.name});return function(t){var n=!t.newRelationshipRegisterTei.loading,a=n?ff("relationship",t.dataEntries.relationship.itemId):null;return{tetName:e(t),ready:n,error:t.newRelationshipRegisterTei.error,possibleDuplicates:!!(t.dataEntriesSearchGroupsResults[a]&&t.dataEntriesSearchGroupsResults[a].main&&t.dataEntriesSearchGroupsResults[a].main.count)}}},function(e){return{onReviewDuplicates:function(t){e(N_()),t()}}})(Ue()(Pe()(sj))),dj="InitializeNewRelationship",pj="SelectRelationshipType",fj="DeselectRelationshipType",mj="SelectFindMode",hj="SetSearching",bj="UnsetSearching",gj=function(){return le(dj)({})},Oj="InitializeRegisterTei",vj="InitializeRegisterTeiFailed",yj=function(e,t){return le(Oj)({programId:e,orgUnit:t})},Ej=function(e){return le(vj)({errorMessage:e})};var _j="NewRelationshipRegisterTeiDataEntryOpen",jj="NewRelationshopRegisterTeiDataEntryOpenCancelled",Ij="NewRelationshopRegisterTeiDataEntryOpenFailed",Cj=function(){return le(_j)()},Tj=function(e){return le(Ij)({errorMessage:e})},Sj=function(e,t){return e?function(e){return It(e).enrollment.inputSearchGroups[0]}(e):function(e){return Dt(e).teiRegistration.inputSearchGroups[0]}(t)},Rj=function(e,t){return e?function(e){return It(e).enrollment.enrollmentForm}(e):function(e){return Dt(e).teiRegistration.form}(t)},kj=n(131);function Nj(e,t){return e?function(e){var t=It(e);return{form:t.enrollment.enrollmentForm,attributes:t.trackedEntityType.attributes,tetName:t.trackedEntityType.name}}(e):function(e){var t=Dt(e);return{form:t.teiRegistration.form,attributes:t.attributes,tetName:t.name}}(t)}function Aj(e,t,n){var a,r,o=ff(e,t),i=n.formsValues[o],c=n.newRelationshipRegisterTei,s=c.programId,l=c.orgUnit,u=n.newRelationship.selectedRelationshipType.to.trackedEntityTypeId,d=Nj(s,u),p=d.attributes,f=d.form,m=d.tetName,h=function(e,t){return t.convertValues(e,bd)}(i,f),b=Uv(h,p,m),g=f.convertValues(h,id),O=function(e,t,n){var a=ty(e,t,{},n)||{};return Object.keys(a).reduce(function(e,n){var r=a[n],o=t[n].type;return e[n]=id(r,o),e},{})}(n.dataEntriesFieldsValue[o],n.dataEntriesFieldsMeta[o],f),v=s?Object(se.a)({program:s,status:"ACTIVE",orgUnit:l.id,incidentDate:Se().format("YYYY-MM-DD")},O):null,y=(a=g,Object.keys(a).find(function(e){return e.startsWith("FEATURETYPE_")}));return y&&(r=function(e,t){if(t[e])return{type:ri(e.replace("FEATURETYPE_","").toLocaleLowerCase()),coordinates:t[e]}}(y,g),delete g[y]),{data:{attributes:Object.keys(g).map(function(e){return{attribute:e,value:g[e]}}),orgUnit:l.id,trackedEntityType:u,geometry:r,enrollments:v?[v]:[]},name:b,id:Object(kj.a)()}}var wj,Fj,xj=function(e){return function(e){return function(t){return f.createElement(e,Object.assign({},t,t.paging))}}(e)}(gv()(Av)),Pj="Tracked entity instance",Dj=function(e){function t(e){var n;return Object(A.a)(this,t),(n=Object(F.a)(this,Object(x.a)(t).call(this,e))).getTrackedEntityTypeName=function(){var e=n.trackedEntityTypeSelector(n.props);return e?e.name:Pj},n.handleAddRelationship=function(e,t){var a=n.trackedEntityTypeSelector(n.props);n.props.onAddRelationship({id:e,name:Uv(t,a.attributes,a.name)})},n.handleAddRelationshipWithNewTei=function(e,t){n.props.onAddRelationship({itemId:e,dataEntryId:t})},n.renderModeSelections=function(){var e=n.props.classes,t=n.getTrackedEntityTypeName();return f.createElement("div",{className:e.modeSelectionsContainer},f.createElement("div",{className:e.button},f.createElement(mO.a,{fontSize:"large",className:e.buttonIcon}),f.createElement(Yc,{color:"primary",onClick:function(){return n.props.onSelectFindMode(xv.TEI_SEARCH)}},c.a.t("Link to an existing {{trackedEntityType}}",{trackedEntityType:t}))),f.createElement("div",{className:e.button},f.createElement(Uc.a,{className:e.buttonIcon}),f.createElement(Yc,{color:"primary",onClick:function(){return n.props.onSelectFindMode(xv.TEI_REGISTER)}},c.a.t("Create new {{trackedEntityType}}",{trackedEntityType:t}))))},n.renderSearch=function(e){e.selectedRelationshipType,e.onAddRelationship;var t=Object(Fe.a)(e,["selectedRelationshipType","onAddRelationship"]),a=n.getTrackedEntityTypeName();return f.createElement(cv,Object.assign({id:"relationshipTeiSearch",getResultsView:function(e){return f.createElement(xj,Object.assign({onAddRelationship:n.handleAddRelationship,trackedEntityTypeName:a},e))}},t))},n.renderRegister=function(){return f.createElement(uj,{onLink:n.handleAddRelationship,onSave:n.handleAddRelationshipWithNewTei,onGetUnsavedAttributeValues:n.props.onGetUnsavedAttributeValues})},n.renderByMode=function(e,t){return e===xv.TEI_SEARCH?n.renderSearch(t):e===xv.TEI_REGISTER?n.renderRegister():null},n.trackedEntityTypeSelector=Fv(),n}return Object(P.a)(t,e),Object(w.a)(t,[{key:"render",value:function(){var e=this.props,t=e.classes,n=e.findMode,a=(e.onOpenSearch,e.onSelectFindMode,Object(Fe.a)(e,["classes","findMode","onOpenSearch","onSelectFindMode"]));return f.createElement("div",{className:t.container},n?this.renderByMode(n,a):this.renderModeSelections())}}]),t}(f.Component),Uj=Ii()(function(e){return{modeSelectionsContainer:{display:"flex"},button:{height:e.typography.pxToRem(150),width:e.typography.pxToRem(250),margin:e.typography.pxToRem(10),padding:e.typography.pxToRem(10),display:"flex",flexDirection:"column",alignItems:"center",textAlign:"center",backgroundColor:e.palette.grey.lighter},buttonIcon:{flexGrow:1,fontSize:e.typography.pxToRem(80)}}})(Dj),Lj=function(e){function t(){var e,n;Object(A.a)(this,t);for(var a=arguments.length,r=new Array(a),o=0;o<a;o++)r[o]=arguments[o];return(n=Object(F.a)(this,(e=Object(x.a)(t)).call.apply(e,[this].concat(r)))).renderForRelationshipType=function(e){var t=n.props,a=t.onSelectRelationshipType,r=t.findMode,o=e.name;return f.createElement(f.Fragment,null,n.renderSlash(),r?f.createElement(f.Fragment,null,f.createElement(Tn,{onClick:function(){return a(e)}},o),n.renderForFindMode(r)):o)},n.renderSlash=function(){return f.createElement("span",{style:{padding:5}},"/")},n.renderForFindMode=function(e){var t=n.props,a=t.onSelectFindMode,r=t.searching,o=Pv[e];return f.createElement(f.Fragment,null,n.renderSlash(),r?f.createElement(f.Fragment,null,f.createElement(Tn,{onClick:function(){return a(e)}},o),n.renderForSearching()):o)},n.renderForSearching=function(){return f.createElement(f.Fragment,null,n.renderSlash(),c.a.t("Search results"))},n}return Object(P.a)(t,e),Object(w.a)(t,[{key:"render",value:function(){var e=this.props,t=e.selectedRelationshipType,n=e.onInitializeNewRelationship,a=e.header;return f.createElement("div",{style:{padding:10}},t?f.createElement(f.Fragment,null,f.createElement(Tn,{onClick:n},a),this.renderForRelationshipType(t)):a)}}]),t}(f.Component),Mj=Object(D.b)(function(e){return{searching:e.newRelationship.searching}},function(e){return{}})(Lj),Bj={TRACKED_ENTITY_INSTANCE:Uj},Vj=function(e){function t(){var e,n;Object(A.a)(this,t);for(var a=arguments.length,r=new Array(a),o=0;o<a;o++)r[o]=arguments[o];return(n=Object(F.a)(this,(e=Object(x.a)(t)).call.apply(e,[this].concat(r)))).renderRelationship=function(e,t){var a=Bj[e.to.entity];return f.createElement(a,Object.assign({onAddRelationship:n.handleAddRelationship},t))},n.handleAddRelationship=function(e){var t=n.props.selectedRelationshipType;t&&n.props.onAddRelationship({id:t.id,name:t.name},e,t.to.entity)},n}return Object(P.a)(t,e),Object(w.a)(t,[{key:"render",value:function(){var e=this.props,t=(e.classes,e.onAddRelationship,Object(Fe.a)(e,["classes","onAddRelationship"])),n=this.props.selectedRelationshipType;return f.createElement("div",{className:this.props.classes.container},f.createElement(Mj,t),!n&&f.createElement(pO,t),n&&this.renderRelationship(n,t))}}]),t}(f.Component),Gj=Ii()(function(e){return{container:{}}})(Vj),Wj=Object(D.b)(function(e){return{selectedRelationshipType:e.newRelationship.selectedRelationshipType,findMode:e.newRelationship.findMode}},function(e){return{onInitializeNewRelationship:function(){e(gj())},onSelectRelationshipType:function(t){e(function(e){return le(pj)({selectedRelationshipType:e})}(t))},onDeselectRelationshipType:function(){e(le(fj)({}))},onSelectFindMode:function(t){e(function(e){return le(mj)({findMode:e})}(t))}}})(Gj),Hj=function(e){function t(e){var n;return Object(A.a)(this,t),(n=Object(F.a)(this,Object(x.a)(t).call(this,e))).handleDiscard=function(){n.setState({discardDialogOpen:!0})},n.handleCancelDiscard=function(){n.setState({discardDialogOpen:!1})},n.renderHeader=function(){return f.createElement("div",{className:n.props.classes.headerContainer},f.createElement("div",{className:n.props.classes.header},c.a.t("New event relationship")))},n.onGetUnsavedAttributeValues=function(e){return n.props.unsavedRelationships.map(function(t){if(!t.to.data||!t.to.data.attributes)return null;var n=t.to.data.attributes.find(function(t){return t.attribute===e});return n&&n.value}).filter(function(e){return e})},n.state={discardDialogOpen:!1},n}return Object(P.a)(t,e),Object(w.a)(t,[{key:"render",value:function(){var e=this.props,t=e.classes,n=(e.onCancel,Object(Fe.a)(e,["classes","onCancel"]));return f.createElement("div",null,f.createElement("div",{className:t.backToEventContainer},f.createElement("span",null,c.a.t("Adding relationship to event.")),f.createElement(Tn,{className:t.backToEventButton,onClick:this.handleDiscard},c.a.t("Go back to event without saving relationship"))),f.createElement(Be.a,{className:t.newRelationshipPaper},f.createElement(Wj,Object.assign({header:c.a.t("New event relationship"),onGetUnsavedAttributeValues:this.onGetUnsavedAttributeValues},n))),f.createElement(Kf,{header:c.a.t("Unsaved changes"),text:c.a.t("Leaving this page will discard the selections you made for a new relationship"),confirmText:c.a.t("Yes, discard"),cancelText:c.a.t("No, stay here"),onConfirm:this.props.onCancel,open:!!this.state.discardDialogOpen,onCancel:this.handleCancelDiscard}))}}]),t}(f.Component),zj=Ii()(function(e){return{headerContainer:{display:"flex",justifyContent:"space-between",alignItems:"center"},header:Object(se.a)({flexGrow:1},e.typography.title,{fontSize:18,fontWeight:500,paddingLeft:8}),newRelationshipPaper:{marginBottom:e.typography.pxToRem(10),padding:e.typography.pxToRem(10)},backToEventContainer:{padding:8,borderRadius:4,display:"inline-block",marginBottom:10,backgroundColor:"#E9EEF4",color:"#494949",fontSize:14},backToEventButton:{backgroundColor:"inherit",fontSize:"inherit",color:"inherit"}}})(Hj),Kj=function(e){return e.currentSelections.programId},Yj=Object(D.b)(function(){var e=Object(nl.createSelector)(Kj,function(e){return Et(e).getStageThrowIfNull().relationshipTypesWhereStageIsFrom.filter(function(e){return"TRACKED_ENTITY_INSTANCE"===e.to.entity})});return function(t){var n=e(t),a=ff("singleEvent",t.dataEntries.singleEvent.itemId);return{relationshipTypes:n,unsavedRelationships:t.dataEntriesRelationships[a]}}},function(e){return{onCancel:function(t){e(le(cO)({}))},onAddRelationship:function(t,n,a){e(function(e,t,n){return le(sO)({relationshipType:e,entity:t,entityType:n})}(t,n,a))}}})(zj),qj=function(e){function t(){return Object(A.a)(this,t),Object(F.a)(this,Object(x.a)(t).apply(this,arguments))}return Object(P.a)(t,e),Object(w.a)(t,[{key:"renderHeader",value:function(){return m.a.createElement("div",{className:this.props.classes.headerContainer},m.a.createElement("div",{className:this.props.classes.header},c.a.t("New event")))}},{key:"render",value:function(){var e=this.props,t=e.classes,n=e.onCancel;return m.a.createElement("div",{className:t.container},this.renderHeader(),m.a.createElement(Be.a,{elevation:0},m.a.createElement("div",{className:t.contents},c.a.t("You dont have access to create an event in the current selections"))),m.a.createElement("div",{className:t.buttonRow},m.a.createElement("div",{className:t.buttonContainer},m.a.createElement(Yc,{variant:"raised",color:"primary",disabled:!0},c.a.t("Save"))),m.a.createElement("div",{className:t.buttonContainer},m.a.createElement(Yc,{variant:"text",color:"primary",onClick:n},c.a.t("Cancel")))))}}]),t}(f.Component),Xj=Object(E.withStyles)(function(e){return{container:{padding:24},contents:{display:"flex",justifyContent:"center",alignItems:"center",paddingTop:50,paddingBottom:50},buttonRow:{display:"flex",flexWrap:"wrap",paddingTop:10,marginLeft:"-8px"},buttonContainer:{paddingRight:2*e.spacing.unit},headerContainer:{paddingTop:9,paddingBottom:20},header:Object(se.a)({flexGrow:1},e.typography.title,{fontSize:16,fontWeight:500})}})(qj),Zj=Object(D.b)(function(e){return{}},function(e){return{onCancel:function(){e(vg())}}})(Xj),Jj=function(e){function t(e){var n;return Object(A.a)(this,t),(n=Object(F.a)(this,Object(x.a)(t).call(this,e))).state={discardWarningOpen:!1},n}return Object(P.a)(t,e),Object(w.a)(t,[{key:"render",value:function(){var e=this.props,t=e.classes,n=e.showAddRelationship;return e.eventAccess.write?m.a.createElement("div",{className:t.container},n?m.a.createElement(Yj,null):m.a.createElement(iO,null)):m.a.createElement(Zj,null)}}]),t}(f.Component),Qj=Object(E.withStyles)(function(e){return{container:{padding:"10px 24px 24px 24px"}}})(Jj),$j=function(){return{}},eI=function(e){return e.currentSelections.programId},tI=function(e){return e.currentSelections.categories},nI={header:c.a.t("Unsaved changes"),text:c.a.t("Leaving this page will discard the changes you made to this event."),confirmText:c.a.t("Yes, discard"),cancelText:c.a.t("No, stay here")},aI=Object(D.b)(function(){var e=Object(nl.createSelector)(eI,tI,function(e,t){return _t(e,t)});return function(t){return{showAddRelationship:!!t.newEventPage.showAddRelationship,eventAccess:e(t)}}},function(){return{}})((wj=nI,Fj=function(e){return qf(e,"singleEvent-newEvent")||e.newEventPage.showAddRelationship},function(e){return Object(D.b)((t=Fj,function(e,n){return{inEffect:t(e,n)}}),$j)(Object(B.a)(function(e,t){return function(n){function a(e){var t;return Object(A.a)(this,a),(t=Object(F.a)(this,Object(x.a)(a).call(this,e))).handleDialogConfirm=function(){t.setState({dialogOpen:!1}),t.unblock(),t.props.history.goBack()},t.handleDialogCancel=function(){t.setState({dialogOpen:!1})},t.state={dialogOpen:!1},t}return Object(P.a)(a,n),Object(w.a)(a,[{key:"componentDidMount",value:function(){var e=this,t=this.props.history;this.historyLength=window.history.length,this.unblock=t.block(function(t,n){var a=e.props.inEffect,r=window.history.length===e.historyLength;return"POP"!==n||!a||!r||(e.setState({dialogOpen:!0}),!1)})}},{key:"componentWillUnmount",value:function(){this.unblock&&this.unblock()}},{key:"render",value:function(){var n=this.props,a=(n.inEffect,n.history,n.location,n.match,n.staticContext,Object(Fe.a)(n,["inEffect","history","location","match","staticContext"]));return f.createElement(f.Fragment,null,f.createElement(e,a),f.createElement(Kf,Object.assign({},t,{onConfirm:this.handleDialogConfirm,open:this.state.dialogOpen,onCancel:this.handleDialogCancel})))}}]),a}(f.Component)}(e,wj)));var t})(Qj)),rI=function(e){function t(){return Object(A.a)(this,t),Object(F.a)(this,Object(x.a)(t).apply(this,arguments))}return Object(P.a)(t,e),Object(w.a)(t,[{key:"renderHeader",value:function(){return m.a.createElement("div",{className:this.props.classes.headerContainer},m.a.createElement("div",{className:this.props.classes.header},c.a.t("New event")))}},{key:"getText",value:function(){var e=this.props,t=e.isProgramSelected,n=e.isOrgUnitSelected;return t||n?t?n?c.a.t("Select a category option to start reporting"):c.a.t("Select a registering unit to start reporting"):c.a.t("Select a program to start reporting"):c.a.t("Select a registering unit and program above to get started")}},{key:"render",value:function(){var e=this.props,t=e.classes,n=e.onCancel;return m.a.createElement("div",{className:t.container},this.renderHeader(),m.a.createElement(Be.a,{elevation:0},m.a.createElement("div",{className:t.contents},this.getText())),m.a.createElement("div",{className:t.buttonRow},m.a.createElement("div",{className:t.buttonContainer},m.a.createElement(Yc,{variant:"raised",color:"primary",disabled:!0},c.a.t("Save"))),m.a.createElement("div",{className:t.buttonContainer},m.a.createElement(Yc,{variant:"text",color:"primary",onClick:n},c.a.t("Cancel")))))}}]),t}(f.Component),oI=Object(E.withStyles)(function(e){return{container:{padding:24},contents:{display:"flex",justifyContent:"center",alignItems:"center",paddingTop:50,paddingBottom:50},buttonRow:{display:"flex",flexWrap:"wrap",paddingTop:10,marginLeft:"-8px"},buttonContainer:{paddingRight:2*e.spacing.unit},headerContainer:{paddingTop:9,paddingBottom:20},header:Object(se.a)({flexGrow:1},e.typography.title,{fontSize:16,fontWeight:500})}})(rI),iI="CancelNewEventFromIncompleteSelectionAndReturnToMainPage",cI=Object(D.b)(function(e){return{isProgramSelected:!!e.currentSelections.programId,isOrgUnitSelected:!!e.currentSelections.orgUnitId}},function(e){return{onCancel:function(){e(le(iI)())}}})(oI),sI=function(e){function t(){return Object(A.a)(this,t),Object(F.a)(this,Object(x.a)(t).apply(this,arguments))}return Object(P.a)(t,e),Object(w.a)(t,[{key:"renderContents",value:function(){return this.props.isSelectionsComplete?m.a.createElement(aI,null):m.a.createElement(cI,null)}},{key:"render",value:function(){return m.a.createElement("div",null,this.renderContents())}}]),t}(m.a.Component),lI=Object(E.withStyles)(function(){return{}})(sI),uI=Object(D.b)(function(e){return{isSelectionsComplete:!!e.currentSelections.complete}},function(){return{}})(lI),dI={header:c.a.t("Unsaved changes"),text:c.a.t("Leaving this page will discard the changes you made to this event."),confirmText:c.a.t("Yes, discard"),cancelText:c.a.t("No, stay here")},pI=function(e){function t(e){var n;return Object(A.a)(this,t),(n=Object(F.a)(this,Object(x.a)(t).call(this,e))).dontShowWarning=function(){return!n.props.formInputInProgess&&!n.props.inAddRelationship},n.state={openStartAgainWarning:!1,openOrgUnitWarning:!1,openProgramWarning:null,openCatComboWarning:!1,categoryIdToReset:"",openNewEventWarning:!1},n.handleOpenStartAgainWarning=n.handleOpenStartAgainWarning.bind(Object(V.a)(n)),n.handleOpenOrgUnitWarning=n.handleOpenOrgUnitWarning.bind(Object(V.a)(n)),n.handleOpenProgramWarning=n.handleOpenProgramWarning.bind(Object(V.a)(n)),n.handleOpenCatComboWarning=n.handleOpenCatComboWarning.bind(Object(V.a)(n)),n.handleClose=n.handleClose.bind(Object(V.a)(n)),n.handleAcceptStartAgain=n.handleAcceptStartAgain.bind(Object(V.a)(n)),n.handleAcceptOrgUnit=n.handleAcceptOrgUnit.bind(Object(V.a)(n)),n.handleAcceptProgram=n.handleAcceptProgram.bind(Object(V.a)(n)),n.handleAcceptCatCombo=n.handleAcceptCatCombo.bind(Object(V.a)(n)),n.handleClickNew=n.handleClickNew.bind(Object(V.a)(n)),n.handleAcceptNew=n.handleAcceptNew.bind(Object(V.a)(n)),n}return Object(P.a)(t,e),Object(w.a)(t,[{key:"handleOpenStartAgainWarning",value:function(){this.dontShowWarning()?this.props.onStartAgain():this.setState({openStartAgainWarning:!0})}},{key:"handleOpenOrgUnitWarning",value:function(){this.dontShowWarning()?this.props.onResetOrgUnitId():this.setState({openOrgUnitWarning:!0})}},{key:"handleOpenProgramWarning",value:function(e){this.dontShowWarning()?this.props.onResetProgramId(e):this.setState({openProgramWarning:e})}},{key:"handleOpenCatComboWarning",value:function(e){this.dontShowWarning()?this.props.onResetCategoryOption(e):this.setState({openCatComboWarning:!0,categoryIdToReset:e})}},{key:"handleClose",value:function(){this.setState({openStartAgainWarning:!1,openOrgUnitWarning:!1,openProgramWarning:null,openCatComboWarning:!1,openNewEventWarning:!1})}},{key:"handleAcceptStartAgain",value:function(){this.props.onStartAgain(),this.handleClose()}},{key:"handleAcceptOrgUnit",value:function(){this.props.onResetOrgUnitId(),this.handleClose()}},{key:"handleAcceptProgram",value:function(){this.props.onResetProgramId(this.state.openProgramWarning),this.handleClose()}},{key:"handleAcceptCatCombo",value:function(){this.props.onResetCategoryOption(this.state.categoryIdToReset),this.handleClose()}},{key:"handleClickNew",value:function(){this.dontShowWarning()||this.setState({openNewEventWarning:!0})}},{key:"handleAcceptNew",value:function(){this.props.onResetDataEntry(),this.handleClose()}},{key:"render",value:function(){return m.a.createElement("div",null,m.a.createElement(Gc,{onSetOrgUnit:this.props.onSetOrgUnit,onResetOrgUnitId:this.handleOpenOrgUnitWarning,onSetProgramId:this.props.onSetProgramId,onResetProgramId:this.handleOpenProgramWarning,onSetCategoryOption:this.props.onSetCategoryOption,onResetCategoryOption:this.handleOpenCatComboWarning,onResetAllCategoryOptions:this.props.onResetAllCategoryOptions,onStartAgain:this.handleOpenStartAgainWarning,onClickNew:this.handleClickNew}),m.a.createElement(uI,null),m.a.createElement(Kf,Object.assign({onConfirm:this.handleAcceptStartAgain,open:this.state.openStartAgainWarning,onCancel:this.handleClose},dI)),m.a.createElement(Kf,Object.assign({onConfirm:this.handleAcceptOrgUnit,open:this.state.openOrgUnitWarning,onCancel:this.handleClose},dI)),m.a.createElement(Kf,Object.assign({onConfirm:this.handleAcceptProgram,open:!!this.state.openProgramWarning,onCancel:this.handleClose},dI)),m.a.createElement(Kf,Object.assign({onConfirm:this.handleAcceptCatCombo,open:this.state.openCatComboWarning,onCancel:this.handleClose},dI)),m.a.createElement(Kf,Object.assign({onConfirm:this.handleAcceptNew,open:this.state.openNewEventWarning,onCancel:this.handleClose},dI)))}}]),t}(f.Component),fI={SET_ORG_UNIT:"setOrgUnitFromNewEventPage",RESET_ORG_UNIT_ID:"resetOrgUnitIdFromNewEventPage",SET_PROGRAM_ID:"setProgramIdFromNewEventPage",RESET_PROGRAM_ID:"resetProgramIdFromNewEventPage",SET_CATEGORY_OPTION:"setCategoryOptionFromNewEventPage",RESET_CATEGORY_OPTION:"resetCategoryOptionFromNewEventPage",RESET_ALL_CATEGORY_OPTIONS:"resetAllCategoryOptionsFromNewEventPage",OPEN_NEW_EVENT_FROM_NEW_EVENT_PAGE:"OpenNewEventFromNewEventPage"},mI="startAgainFromNewEventPageBatch",hI="resetProgramAndCategoryOptionFromNewEventPageBatch",bI=function(){return le(fI.RESET_ORG_UNIT_ID)()},gI=function(){return le(fI.RESET_PROGRAM_ID)()},OI=function(){return le(fI.RESET_ALL_CATEGORY_OPTIONS)()},vI=Object(D.b)(function(e){return{formInputInProgess:e.currentSelections.complete&&qf(e,"singleEvent-newEvent"),inAddRelationship:e.newEventPage.showAddRelationship}},function(e){return{onSetOrgUnit:function(t,n){e(function(e,t){return le(fI.SET_ORG_UNIT)({id:e,orgUnit:t})}(t,n))},onResetOrgUnitId:function(){e(bI())},onSetProgramId:function(t){e(function(e){return le(fI.SET_PROGRAM_ID)(e)}(t))},onSetCategoryOption:function(t,n){e(function(e,t){return le(fI.SET_CATEGORY_OPTION)({categoryId:e,categoryOptionId:t})}(t,n))},onResetCategoryOption:function(t){e(function(e){return le(fI.RESET_CATEGORY_OPTION)(e)}(t))},onResetAllCategoryOptions:function(){e(OI())},onStartAgain:function(){e(Object(Le.batchActions)([bI(),gI(),OI(),jn()],mI))},onResetProgramId:function(t){e(Object(Le.batchActions)([gI(),OI(),t],hI))},onResetDataEntry:function(){e(le(fI.OPEN_NEW_EVENT_FROM_NEW_EVENT_PAGE)())}}})(pI),yI=Object(D.b)(function(e){return{error:e.newEventPage.selectionsError,ready:!e.newEventPage.isLoading}},function(){return{}})(Ue()(Pe()(vI))),EI="UpdateSelectionsFromUrlForNewEvent",_I="SetOrgUnitBasedOnUrlForNewEvent",jI="InvalidOrgUnitFromUrlForNewEvent",II="ErrorRetrievingOrgUnitBasedOnUrlForNewEvent",CI="SetEmptyOrgUnitBasedOnUrlForNewEvent",TI="InvalidSelectionsFromUrlForNewEvent",SI="ValidSelectionsFromUrlForNewEvent",RI=function(e){return le(TI)(e)},kI="newRecentlyAddedEvent",NI=function e(t,n){return Object.keys(t).filter(function(e){return"complete"!==e&&null!=t[e]}).every(function(a){var r=t[a],o=n[a];return"categories"===a?e(t.categories,n.categories):r===o})},AI="setOrgUnitFromEditEventPage",wI="resetOrgUnitIdFromEditEventPage",FI="setProgramIdFromEditEventPage",xI="resetProgramIdFromEditEventPage",PI="setCategoryOptionFromEditEventPage",DI="resetCategoryOptionFromEditEventPage",UI="resetAllCategoryOptionsFromEditEventPage",LI="openNewEventPageFromEditEventPage",MI="startAgainFromEditEventPageBatch",BI="resetProgramAndCategoryOptionFromEditEventPageBatch",VI=function(){return le(wI)()},GI=function(){return le(xI)()},WI=function(){return le(UI)()},HI="setOrgUnitFromViewEventPage",zI="resetOrgUnitIdFromViewEventPage",KI="setProgramIdFromViewEventPage",YI="resetProgramIdFromViewEventPage",qI="setCategoryOptionFromViewEventPage",XI="resetCategoryOptionFromViewEventPage",ZI="resetAllCategoryOptionsFromViewEventPage",JI="openNewEventPageFromViewEventPage",QI="startAgainFromViewEventPageBatch",$I="resetProgramAndCategoryOptionFromViewEventPageBatch",eC=function(){return le(zI)()},tC=function(){return le(YI)()},nC=function(){return le(ZI)()},aC="setOrgUnitFromMainPage",rC="resetOrgUnitIdFromMainPage",oC="setProgramIdFromMainPage",iC="resetProgramIdFromMainPage",cC="setCategoryOptionFromMainPage",sC="resetCategoryOptionFromMainPage",lC="resetAllCategoryOptionsFromMainPage",uC="openNewEventPageFromMainPage",dC="startAgainFromMainPageBatch",pC="resetProgramAndCategoryOptionFromMainPageBatch",fC=function(){return le(rC)()},mC=function(){return le(iC)()},hC=function(){return le(lC)()},bC=ff("singleEvent","newEvent"),gC=[{id:"eventDate",type:"DATE",validatorContainers:Om()},{clientId:"geometry",dataEntryId:"geometry",onConvertOut:Py},{id:"note",type:"TEXT",validatorContainers:xm(),clientIgnore:!0},{id:"relationship",type:"TEXT",clientIgnore:!0},{clientId:"status",dataEntryId:"complete",onConvertIn:Uy,onConvertOut:Ly}],OC=function(e){return new Promise(function(t,n){var a=vt(e);a.error&&n();var r=a.stage.stageForm;t([].concat(Object(We.a)([{id:Bg,visible:!0,isMainProperty:!0,type:ct.DATE},{id:Vg,header:"Status",visible:!0,isMainProperty:!0,type:ct.TEXT,singleSelect:!0,options:[{text:c.a.t("Active"),value:"ACTIVE"},{text:c.a.t("Completed"),value:"COMPLETED"}]}]),Object(We.a)(r.getElements().map(function(e){return{id:e.id,visible:e.displayInReports}}))))})},vC="AppendListItem",yC="PrependListItem",EC="removeListItem",_C="resetList",jC="Program or stage not found",IC=function(e,t,n,a,r){var o,i=e.getState(),c=ff(t,n),s=gt(i.currentSelections.programId),l=i.currentSelections.orgUnitId,u=i.organisationUnits[l];if(s.error){var d=s.stage?s.stage.stageForm:null;o=Jv(s.program,d,c,u)}else{var p=s.stage.stageForm,f=ny(i,p,c,r),m=ay(i,n,t,{},p),h=Object(se.a)({},f,m);o=Jv(s.program,p,c,u,h,[h])}return Object(Le.batchActions)([].concat(Object(We.a)(o),[Lf(t,n,a)]),Wb)};function CC(e,t,n,a,r){return{formClientValues:e.convertValues(t,bd),dataEntryClientValues:ty(n,a,r,e)}}var TC=function(e,t,n,a){var r,o=t.convertValues(n,id),i=Mg(a);return"COMPLETED"===i.status&&(i.completedDate=Se().format("YYYY-MM-DD")),Object(se.a)({},i,{program:e.currentSelections.programId,programStage:t.id,orgUnit:e.currentSelections.orgUnitId},(r=e.currentSelections.categories)?{attributeCategoryOptions:Object.keys(r).map(function(e){return r[e]}).join(";")}:null,{dataValues:Object.keys(o).map(function(e){return{dataElement:e,value:o[e]}})})};function SC(e,t){var n=e.dataEntriesNotes&&e.dataEntriesNotes[t];return n?n.map(function(e){return{value:e.value}}):[]}var RC=function(e,t,n){var a={},r=CC(n,e.formsValues[t],e.dataEntriesFieldsValue[t],e.dataEntriesFieldsMeta[t],a),o=r.formClientValues,i=r.dataEntryClientValues;return{formClientValues:o,mainDataClientValues:Object(se.a)({},a,i,{notes:SC(e,t)})}},kC=function(e,t){var n=[];return e&&n.push("programId=".concat(e)),t&&n.push("orgUnitId=".concat(t)),n.join("&")},NC={TRACKED_ENTITY_INSTANCE:function(e){return{trackedEntityInstance:{trackedEntityInstance:e}}},PROGRAM_STAGE_INSTANCE:function(e){return{event:{event:e}}}};function AC(e){return{relationshipType:e.relationshipType.id,from:NC[e.from.type](e.from.id),to:NC[e.to.type](e.to.id)}}var wC,FC=ff("singleEvent","newEvent"),xC=function(e,t,n){var a=e.find(function(e){return e.to.data});return a?function(e,t,n,a,r){return le(fg)({selections:t},{offline:{effect:{url:"trackedEntityInstances",method:Db,data:e},commit:{type:mg,meta:{selections:t,triggerAction:n,relationshipData:a,relationshipClientId:r}},rollback:{type:hg,meta:{selections:t,triggerAction:n}}}})}(a.to.data,t,n,e,a.clientId):function(e,t,n){return le(ug)({selections:t},{offline:{effect:{url:"relationships",method:Db,data:e},commit:{type:dg,meta:{selections:t,triggerAction:n}},rollback:{type:pg,meta:{selections:t,triggerAction:n}}}})}({relationships:e.map(AC)},t,n)},PC={SAVEANDADDANOTHER:"SAVEANDADDANOTHER",SAVEANDEXIT:"SAVEANDEXIT",FINISH:"FINISH"},DC=Object(se.a)({},PC,{FINISH:"FINISH"}),UC=(wC={},Object(Ut.a)(wC,DC.SAVEANDADDANOTHER,function(e){return{key:DC.SAVEANDADDANOTHER,text:c.a.t("Save and add another"),onClick:function(){e.onSave(PC.SAVEANDADDANOTHER)}}}),Object(Ut.a)(wC,DC.SAVEANDEXIT,function(e){return{key:DC.SAVEANDEXIT,text:c.a.t("Save and exit"),onClick:function(){e.onSave(PC.SAVEANDEXIT)}}}),Object(Ut.a)(wC,DC.FINISH,function(e){return{key:DC.FINISH,text:c.a.t("Finish"),onClick:function(){e.onCancel()}}}),wC),LC=function(e,t){var n=e.dataEntries&&e.dataEntries[t.id]&&e.dataEntries[t.id].itemId,a=ff(t.id,n),r=e.recentlyAddedEvents&&Object.keys(e.recentlyAddedEvents).length>0;return{saveTypes:e.newEventPage.saveTypes,finalInProgress:e.dataEntriesUI[a]&&e.dataEntriesUI[a].finalInProgress,dataEntryHasChanges:!1,hasRecentlyAddedEvents:r}},MC=function(){return{}},BC=Zf(function(){return{color:"primary"}})(wy),VC=Zm({onGetFormFoundation:function(e){return e.enrollmentMetadata.enrollmentForm}})(function(e){return Object(D.b)(LC,MC,null,{withRef:!0})(function(e){return function(t){function n(){var e,t;Object(A.a)(this,n);for(var a=arguments.length,r=new Array(a),o=0;o<a;o++)r[o]=arguments[o];return(t=Object(F.a)(this,(e=Object(x.a)(n)).call.apply(e,[this].concat(r)))).getButtonDefinition=function(e){return UC[e](t.props)},t.getFormHorizontalButtons=function(e,n){var a=[t.getButtonDefinition(DC.SAVEANDADDANOTHER),t.getButtonDefinition(DC.SAVEANDEXIT)];return e||!n?a:[t.getButtonDefinition(DC.FINISH)].concat(a)},t.getFormVerticalButtons=function(e,n,a){var r=a?a.map(function(e){return t.getButtonDefinition(e)}):[t.getButtonDefinition(DC.SAVEANDEXIT),t.getButtonDefinition(DC.SAVEANDADDANOTHER)];return e||!n?r:[t.getButtonDefinition(DC.FINISH)].concat(Object(We.a)(r))},t.renderMultiButton=function(e,t,n){var a=e[0],r=e.slice(1);return f.createElement(an.a,{title:t?"":c.a.t("No write access")},f.createElement(Sm,{variant:"raised",color:"primary",buttonType:"progress",buttonText:a.text,disabled:!t,buttonProps:{onClick:a.onClick,color:"primary",inProgress:n},dropDownItems:r}))},t}return Object(P.a)(n,t),Object(w.a)(n,[{key:"getWrappedInstance",value:function(){return this.innerInstance}},{key:"render",value:function(){var t=this,n=this.props,a=n.saveTypes,r=n.dataEntryHasChanges,o=n.hasRecentlyAddedEvents,i=(n.onSave,n.finalInProgress),c=Object(Fe.a)(n,["saveTypes","dataEntryHasChanges","hasRecentlyAddedEvents","onSave","finalInProgress"]),s=this.props.formHorizontal?this.getFormHorizontalButtons(r,o):this.getFormVerticalButtons(r,o,a),l=this.renderMultiButton(s,!0,i);return f.createElement(e,Object.assign({ref:function(e){t.innerInstance=e},mainButton:l},c))}}]),n}(f.Component)}(e))}(BC)),GC=Object(Ut.a)({},my,{placement:df,name:c.a.t("Enrollment")}),WC=function(e){function t(e){var n;return Object(A.a)(this,t),(n=Object(F.a)(this,Object(x.a)(t).call(this,e))).handleSave=function(e,t,a,r){r===PC.SAVEANDADDANOTHER?(n.props.formHorizontal||n.props.onSetSaveTypes([PC.SAVEANDADDANOTHER,PC.SAVEANDEXIT]),n.props.onSaveAndAddAnother(e,t,a)):r===PC.SAVEANDEXIT&&n.props.onSave(e,t,a)},n.renderHorizontal=function(){var e=n.props.classes;return m.a.createElement("div",{className:e.horizontal},n.renderContent())},n.renderVertical=function(){return m.a.createElement("div",{className:n.props.classes.dataEntryVerticalContainer},n.renderContent())},n.renderContent=function(){var e=n.props,t=e.onUpdateField,a=e.onStartAsyncUpdateField,r=(e.programName,e.orgUnitName,e.classes),o=(e.onSave,e.onSetSaveTypes,e.onSaveAndAddAnother,e.theme,e.enrollmentMetadata),i=Object(Fe.a)(e,["onUpdateField","onStartAsyncUpdateField","programName","orgUnitName","classes","onSave","onSetSaveTypes","onSaveAndAddAnother","theme","enrollmentMetadata"]);return m.a.createElement("div",null,m.a.createElement("div",null,m.a.createElement(VC,Object.assign({id:"enrollment",onUpdateFormField:t,onUpdateFormFieldAsync:a,onSave:n.handleSave,fieldOptions:n.fieldOptions,dataEntrySections:n.dataEntrySections,enrollmentMetadata:o},i))),m.a.createElement("div",{className:r.savingContextContainer},m.a.createElement(Jc.a,null),m.a.createElement("div",{className:r.savingContextText},n.getSavingText())))},n.fieldOptions={theme:e.theme,fieldLabelMediaBasedClass:e.classes.fieldLabelMediaBased},n.dataEntrySections=GC,n}return Object(P.a)(t,e),Object(w.a)(t,[{key:"componentWillMount",value:function(){}},{key:"componentWillUnmount",value:function(){Ys.clear()}},{key:"getSavingText",value:function(){var e=this.props,t=e.classes,n=e.orgUnitName,a=e.programName,r=e.enrollmentMetadata,o=c.a.t("Creating a new {{TET}} in {{program}} in {{orgUnit}}",{TET:r.trackedEntityType.name,program:a,orgUnit:n}).replace(a,'<span class="'.concat(t.savingContextNames,'">').concat(a,"</span>")).replace(n,'<span class="'.concat(t.savingContextNames,'">').concat(n,"</span>"));return m.a.createElement("span",{dangerouslySetInnerHTML:{__html:o}})}},{key:"render",value:function(){return m.a.createElement("div",null,this.props.formHorizontal?this.renderHorizontal():this.renderVertical())}}]),t}(f.Component),HC=Object(E.withStyles)(function(e){return{savingContextContainer:{paddingTop:e.typography.pxToRem(10),display:"flex",alignItems:"center",color:e.palette.grey.dark,fontSize:e.typography.pxToRem(13)},savingContextText:{paddingLeft:e.typography.pxToRem(10)},savingContextNames:{fontWeight:"bold"},topButtonsContainer:{display:"flex",flexFlow:"row-reverse"},horizontal:{padding:e.typography.pxToRem(10),paddingTop:e.typography.pxToRem(20),paddingBottom:e.typography.pxToRem(15)},fieldLabelMediaBased:Object(Ut.a)({},e.breakpoints.down(523),{paddingTop:"0px !important"}),dataEntryVerticalContainer:{padding:e.typography.pxToRem(8)}}})(Object(E.withTheme)()(WC)),zC=function(e){return e.currentSelections.programId},KC="StartSaveAfterReturnedToMainPageForNewEnrollment",YC="RequestSaveAndReturnToMainPageForNewEnrollment",qC="EnrollmentSaved",XC="EnrollmentSaveFailed",ZC=Object(D.b)(function(){var e=Object(nl.createSelector)(zC,function(e){var t=Nt(e);return t&&t.name||""});return function(t,n){return{ready:!t.newEnrollmentPage.dataEntryIsLoading,error:t.newEnrollmentPage.dataEntryError,programName:e(t),orgUnitName:t.organisationUnits[t.currentSelections.orgUnitId]&&t.organisationUnits[t.currentSelections.orgUnitId].name}}},function(e){return{onSave:function(t,n,a){window.scrollTo(0,0),e(function(e,t,n){return le(YC)({dataEntryId:e,itemId:t,formFoundation:n},{skipLogging:["formFoundation"]})}(n,t,a))}}})(Ue(function(){return{margin:4}})(Pe()(HC))),JC=function(e){function t(){return Object(A.a)(this,t),Object(F.a)(this,Object(x.a)(t).apply(this,arguments))}return Object(P.a)(t,e),Object(w.a)(t,[{key:"handleBackToMainPage",value:function(){}},{key:"renderHeaderButtons",value:function(){var e=this.props.enrollmentMetadata.enrollmentForm;return!e||e.customForm?null:f.createElement(Tr,{color:"primary"},this.props.formHorizontal?c.a.t("Switch to form view"):c.a.t("Switch to row view"))}},{key:"renderHeader",value:function(){var e=this.props,t=e.classes,n=e.enrollmentMetadata;return f.createElement("div",{className:t.headerContainer},f.createElement("div",{className:t.header},c.a.t("New {{TET}}",{TET:n.trackedEntityType.name})),f.createElement("div",null,this.renderHeaderButtons()))}},{key:"render",value:function(){var e=this.props,t=e.classes,n=Object(Fe.a)(e,["classes"]);return f.createElement("div",null,f.createElement(Tr,{className:t.backButton,variant:"raised",onClick:this.handleBackToMainPage},f.createElement(Hc.a,null),c.a.t("Working Lists")),f.createElement(Be.a,{className:t.dataEntryPaper},this.renderHeader(),f.createElement(ZC,n)))}}]),t}(f.Component),QC=Ii()(function(e){return{headerContainer:{display:"flex",justifyContent:"space-between",alignItems:"center"},header:Object(se.a)({flexGrow:1},e.typography.title,{fontSize:18,fontWeight:500,paddingLeft:8}),dataEntryPaper:{marginBottom:e.typography.pxToRem(10),padding:e.typography.pxToRem(10)},backButton:{paddingLeft:8,marginBottom:10,textTransform:"none",backgroundColor:"#E9EEF4",boxShadow:"none",color:"#494949",fontSize:14,fontWeight:"normal"}}})(JC),$C=function(e){return e.currentSelections.programId},eT=Object(D.b)(function(){var e=Object(nl.createSelector)($C,function(e){var t;try{t=Nt(e)}catch(n){return null}return t.enrollment?t.enrollment:(O.a.error(Object(ze.b)("could not find enrollment specification for ".concat(e))({program:t})),null)});return function(t){return{enrollmentMetadata:e(t)}}},function(e){return{}})(QC),tT=Object(D.b)(function(e){return{error:e.newEnrollmentPage.selectionsError,ready:!e.newEnrollmentPage.isLoading}},function(e){return{}})(Ue(function(){return{margin:4}})(Pe()(eT))),nT="UpdateSelectionsFromUrlForNewEnrollment",aT="SetOrgUnitBasedOnUrlForNewEnrollment",rT="ErrorRetrievingOrgUnitBasedOnUrlForNewEnrollment",oT="SetEmptyOrgUnitBasedOnUrlForNewEnrollment",iT="ValidSelectionsFromUrlForNewEnrollment",cT="InvalidSelectionsFromUrlForNewEnrollment",sT=function(e){return le(cT)({error:e})},lT="SelectionsNotCompleteOpeningNewEnrollment",uT="OpenDataEntryForNewEnrollment",dT="Program not found",pT="Program is not a tracker program",fT="WorkingListUpdateDataRetrieved",mT="WorkingListUpdateDataRetrievalFailed",hT="SortWorkingList",bT="OpenEditEventPage",gT="OpenViewEventPage",OT="RequestDeleteEvent",vT="StartDeleteEvent",yT="DeleteEventFailed",ET="EventDeleted",_T="WorkingListUpdating",jT="WorkingListUpdatingWithDialog",IT="StartDeleteEventUpdateWorkingList",CT=function(e){return le(gT)(e)},TT=function(e){return le(vT)({},{offline:{effect:{url:"events/".concat(e),method:Lb},commit:{type:ET},rollback:{type:yT}}})},ST=Object(D.b)(function(e){return{events:e.events,eventsValues:e.eventsValues}},function(e){return{onRowClick:function(t){var n;window.scrollTo(0,0),e((n=t.eventId,le(bT)(n)))}}})($g),RT="ChangePage",kT="ChangeRowsPerPage",NT=function(e){return{rowsPerPage:e.workingListsMeta.main.rowsPerPage,currentPage:e.workingListsMeta.main.currentPage,rowsCount:e.workingListsMeta.main.rowsCount}},AT=function(e){return{onChangeRowsPerPage:function(t){e(function(e){return le(kT)(e)}(t))},onChangePage:function(t){var n;e((n=t,le(RT)(n)))}}};n(8113);var wT=function(e){return function(t){function n(e){var t;return Object(A.a)(this,n),(t=Object(F.a)(this,Object(x.a)(n).call(this,e))).translations={clearText:c.a.t("Clear"),noResults:c.a.t("No results")},t}return Object(P.a)(n,t),Object(w.a)(n,[{key:"render",value:function(){var t=Object(_.a)({},this.props);return f.createElement(e,Object.assign({translations:this.translations},t))}}]),n}(f.Component)}(sn),FT=n(388),xT=n.n(FT),PT=n(260),DT=n.n(PT),UT=n(259),LT=n.n(UT),MT=n(49),BT=n.n(MT)()(f.createElement(f.Fragment,null,f.createElement("path",{d:"M12,2C17.53,2 22,6.47 22,12C22,17.53 17.53,22 12,22C6.47,22 2,17.53 2,12C2,6.47 6.47,2 12,2M15.59,7L12,10.59L8.41,7L7,8.41L10.59,12L7,15.59L8.41,17L12,13.41L15.59,17L17,15.59L13.41,12L17,8.41L15.59,7Z"})),"CloseCircle"),VT=function(e){function t(e){var n;return Object(A.a)(this,t),(n=Object(F.a)(this,Object(x.a)(t).call(this,e))).setIsHovered=function(){n.setState({isHovered:!0})},n.clearIsHovered=function(){n.setState({isHovered:!1})},n.handleClearClick=function(e){e.stopPropagation(),n.props.onClear()},n.state={isHovered:!1},n}return Object(P.a)(t,e),Object(w.a)(t,null,[{key:"stopClearPropagation",value:function(e){e.stopPropagation()}},{key:"getCappedValue",value:function(e){var t=e.substring(0,7).trimRight();return"".concat(t,"...")}},{key:"getViewValueForFilter",value:function(e){var n=e.length>10?t.getCappedValue(e):e;return": ".concat(n)}}]),Object(w.a)(t,[{key:"render",value:function(){var e=this.props,n=e.onChange,a=(e.onClear,e.classes),r=e.iconClass,o=e.title,i=e.arrowIconElement,s=e.filterValue,l=this.state.isHovered,u=Cn()(a.button,Object(Ut.a)({},a.hovered,l));return f.createElement(Yc,{variant:"text",color:"default",size:"small",classes:{button:u,contents:a.contents},muiClasses:{label:a.label},onClick:n,onMouseEnter:this.setIsHovered,onMouseLeave:this.clearIsHovered},o,t.getViewValueForFilter(s),i,f.createElement(an.a,{title:c.a.t("Clear"),placement:"bottom",enterDelay:300},f.createElement(BT,{onMouseEnter:this.clearIsHovered,onMouseLeave:this.setIsHovered,className:Cn()(r,a.clearIcon),onClick:this.handleClearClick,onMouseDown:t.stopClearPropagation,onMouseUp:t.stopClearPropagation,onTouchStart:t.stopClearPropagation,onTouchEnd:t.stopClearPropagation,onTouchMove:t.stopClearPropagation,onKeyDown:t.stopClearPropagation,onKeyUp:t.stopClearPropagation})))}}]),t}(f.Component),GT=Object(E.withStyles)(function(e){return{button:{backgroundColor:Object($o.lighten)(e.palette.primary.light,.7),"&:hover":{backgroundColor:Object($o.lighten)(e.palette.primary.light,.7)}},hovered:{backgroundColor:"".concat(Object($o.lighten)(e.palette.primary.light,.4)," !important")},contents:{color:e.palette.text.primary},clearIcon:{color:e.palette.text.secondary,"&:hover":{color:e.palette.text.primary}},label:{textTransform:"none"}}})(VT),WT=[ct.TEXT,ct.NUMBER,ct.INTEGER,ct.INTEGER_POSITIVE,ct.INTEGER_NEGATIVE,ct.INTEGER_ZERO_OR_POSITIVE,ct.DATE,ct.BOOLEAN,ct.TRUE_ONLY],HT=WT.reduce(function(e,t){return e[t]=t,e},{}),zT=function(e){return{buttonsContainer:{paddingTop:e.typography.pxToRem(8)},firstButtonContainer:{paddingRight:e.typography.pxToRem(8),display:"inline-block"}}},KT=function(){return function(e){return Object(E.withStyles)(zT)(function(t){function n(){var e,t;Object(A.a)(this,n);for(var a=arguments.length,r=new Array(a),o=0;o<a;o++)r[o]=arguments[o];return(t=Object(F.a)(this,(e=Object(x.a)(n)).call.apply(e,[this].concat(r)))).update=function(e){var n=t.filterTypeInstance.onGetUpdateData(e);t.props.onUpdate(n,e)},t.handleUpdateClick=function(){t.isValid()&&t.update()},t.focusUpdateButton=function(){t.updateButtonInstance&&t.updateButtonInstance.focus()},t.focusCloseButton=function(){t.closeButtonInstance&&t.closeButtonInstance.focus()},t.setFilterTypeInstance=function(e){t.filterTypeInstance=e},t.setUpdateButtonInstance=function(e){t.updateButtonInstance=e},t.setCloseButtonInstance=function(e){t.closeButtonInstance=e},t}return Object(P.a)(n,t),Object(w.a)(n,[{key:"isValid",value:function(){return!this.filterTypeInstance.onIsValid||this.filterTypeInstance.onIsValid()}},{key:"render",value:function(){var t=this.props,n=(t.onUpdate,t.onClose),a=t.classes,r=Object(Fe.a)(t,["onUpdate","onClose","classes"]);return f.createElement(f.Fragment,null,f.createElement(e,Object.assign({filterTypeRef:this.setFilterTypeInstance,onUpdate:this.update,onFocusUpdateButton:this.focusUpdateButton,onFocusCloseButton:this.focusCloseButton},r)),f.createElement("div",{className:a.buttonsContainer},f.createElement("div",{className:a.firstButtonContainer},f.createElement(Yc,{muiButtonRef:this.setUpdateButtonInstance,variant:"raised",color:"primary",onClick:this.handleUpdateClick},c.a.t("Update"))),f.createElement(Yc,{muiButtonRef:this.setCloseButtonInstance,variant:"text",color:"primary",onClick:n},c.a.t("Close"))))}}]),n}(f.Component))}},YT=function(e,t){return{value:e.workingListFiltersEdit.main&&e.workingListFiltersEdit.main.next&&oe()(e.workingListFiltersEdit.main.next[t.id])?e.workingListFiltersEdit.main.next[t.id]:e.workingListFiltersEdit.main&&e.workingListFiltersEdit.main[t.id]}},qT=function(e){return{}},XT=function(){return function(e){return Object(D.b)(YT,qT)(e)}},ZT=function(){return function(e){return function(t){return f.createElement(e,Object.assign({innerRef:t.filterTypeRef},t))}}},JT=n(386),QT=n.n(JT),$T=function(e){function t(e){var n;return Object(A.a)(this,t),(n=Object(F.a)(this,Object(x.a)(t).call(this,e))).handleChange=function(e){n.props.onChange&&n.props.onChange(e.currentTarget.value,e)},n.handleBlur=function(e){n.props.onBlur&&n.props.onBlur(e.currentTarget.value,e)},n.handleChange=n.handleChange.bind(Object(V.a)(n)),n.handleBlur=n.handleBlur.bind(Object(V.a)(n)),n}return Object(P.a)(t,e),Object(w.a)(t,[{key:"focus",value:function(){this.materialUIInstance&&this.materialUIInstance.focus()}},{key:"render",value:function(){var e=this,t=this.props,n=(t.onChange,t.onBlur,t.value),a=Object(Fe.a)(t,["onChange","onBlur","value"]);return m.a.createElement("div",{ref:function(t){e.materialUIContainerInstance=t}},m.a.createElement(QT.a,Object.assign({inputRef:function(t){e.materialUIInstance=t},value:n||"",onChange:this.handleChange,onBlur:this.handleBlur},a)))}}]),t}(f.Component);$T.defaultProps={value:""};var eS,tS,nS=$T,aS=function(){return function(e){return function(t){function n(e){var t;Object(A.a)(this,n),(t=Object(F.a)(this,Object(x.a)(n).call(this,e))).handleChange=t.handleChange.bind(Object(V.a)(t));var a=t.props.value;return t.state={value:a},t}return Object(P.a)(n,t),Object(w.a)(n,[{key:"componentWillReceiveProps",value:function(e){e.value!==this.props.value&&this.setState({value:e.value})}},{key:"handleChange",value:function(e){this.setState({value:e})}},{key:"render",value:function(){var t=this.props,n=(t.onChange,t.value,Object(Fe.a)(t,["onChange","value"])),a=this.state.value;return f.createElement(e,Object.assign({onChange:this.handleChange,value:a},n))}}]),n}(f.Component)}},rS=function(e){function t(){var e,n;Object(A.a)(this,t);for(var a=arguments.length,r=new Array(a),o=0;o<a;o++)r[o]=arguments[o];return(n=Object(F.a)(this,(e=Object(x.a)(t)).call.apply(e,[this].concat(r)))).handleKeyPress=function(e){"Enter"===e.key&&n.props.onEnterKey(n.props.value)},n}return Object(P.a)(t,e),Object(w.a)(t,[{key:"render",value:function(){var e=this.props,t=(e.onEnterKey,Object(Fe.a)(e,["onEnterKey"]));return m.a.createElement(nS,Object.assign({onKeyPress:this.handleKeyPress,fullWidth:!0,placeholder:c.a.t("Contains text")},t))}}]),t}(m.a.Component),oS=aS()(rS),iS=function(e){function t(){var e,n;Object(A.a)(this,t);for(var a=arguments.length,r=new Array(a),o=0;o<a;o++)r[o]=arguments[o];return(n=Object(F.a)(this,(e=Object(x.a)(t)).call.apply(e,[this].concat(r)))).handleEnterKey=function(e){n.props.onUpdate(e||null)},n.handleBlur=function(e){n.props.onCommitValue(e)},n}return Object(P.a)(t,e),Object(w.a)(t,[{key:"onGetUpdateData",value:function(e){var t="undefined"!==typeof e?e:this.props.value;return t?{requestData:"like:".concat(t),appliedText:t}:null}},{key:"render",value:function(){var e=this.props.value;return m.a.createElement(oS,{onBlur:this.handleBlur,onEnterKey:this.handleEnterKey,value:e})}}]),t}(f.Component),cS=function(e){function t(){var e,n;Object(A.a)(this,t);for(var a=arguments.length,r=new Array(a),o=0;o<a;o++)r[o]=arguments[o];return(n=Object(F.a)(this,(e=Object(x.a)(t)).call.apply(e,[this].concat(r)))).handleBlur=function(e){n.props.onBlur(t.getValueObject(e))},n.handleKeyPress=function(e){"Enter"===e.key&&n.props.onEnterKey()},n}return Object(P.a)(t,e),Object(w.a)(t,[{key:"render",value:function(){var e=this.props,t=e.error,n=e.errorClass,a=(e.onBlur,e.onEnterKey,Object(Fe.a)(e,["error","errorClass","onBlur","onEnterKey"]));return m.a.createElement("div",null,m.a.createElement(nS,Object.assign({onKeyPress:this.handleKeyPress,onBlur:this.handleBlur,placeholder:c.a.t("Min"),fullWidth:!0},a)),m.a.createElement("div",{className:n},t))}}],[{key:"getValueObject",value:function(e){return{min:e.trim()}}}]),t}(f.Component),sS=aS()(cS),lS=function(e){function t(){var e,n;Object(A.a)(this,t);for(var a=arguments.length,r=new Array(a),o=0;o<a;o++)r[o]=arguments[o];return(n=Object(F.a)(this,(e=Object(x.a)(t)).call.apply(e,[this].concat(r)))).handleBlur=function(e){n.props.onBlur(t.getValueObject(e))},n.handleKeyPress=function(e){"Enter"===e.key&&n.props.onEnterKey(t.getValueObject(n.props.value||""))},n}return Object(P.a)(t,e),Object(w.a)(t,[{key:"render",value:function(){var e=this.props,t=e.error,n=(e.onBlur,e.onEnterKey,e.textFieldRef),a=e.errorClass,r=Object(Fe.a)(e,["error","onBlur","onEnterKey","textFieldRef","errorClass"]);return m.a.createElement("div",null,m.a.createElement(nS,Object.assign({ref:n,onKeyPress:this.handleKeyPress,onBlur:this.handleBlur,placeholder:c.a.t("Max"),fullWidth:!0},r)),m.a.createElement("div",{className:a},t))}}],[{key:"getValueObject",value:function(e){return{max:e.trim()}}}]),t}(f.Component),uS=aS()(lS),dS=function(e){function t(){var e,n;Object(A.a)(this,t);for(var a=arguments.length,r=new Array(a),o=0;o<a;o++)r[o]=arguments[o];return(n=Object(F.a)(this,(e=Object(x.a)(t)).call.apply(e,[this].concat(r)))).handleEnterKeyInMin=function(){n.maxD2TextFieldInstance.focus()},n.handleEnterKeyInMax=function(e){var a=n.getUpdatedValue(e);a&&!t.isFilterValid(a.min,a.max,n.props.type)?n.props.onCommitValue(a):n.props.onUpdate(a||null)},n.handleFieldBlur=function(e){n.props.onCommitValue(n.getUpdatedValue(e))},n.setMaxD2TextFieldInstance=function(e){n.maxD2TextFieldInstance=e},n}return Object(P.a)(t,e),Object(w.a)(t,[{key:"onGetUpdateData",value:function(e){var n="undefined"!==typeof e?e:this.props.value;return n?{requestData:t.getRequestData(n),appliedText:t.getAppliedText(n)}:null}},{key:"onIsValid",value:function(){var e=this.props.value;return!e||t.isFilterValid(e.min,e.max,this.props.type)}},{key:"getUpdatedValue",value:function(e){var t=Object(se.a)({},this.props.value,e);return Object.keys(t).filter(function(e){return t[e]}).length>0?t:null}},{key:"getErrors",value:function(){var e=this.props.value,n=e&&e.min,a=e&&e.max,r=this.props.type,o=t.validateField(n,r),i=o.isValid,s=o.error,l=t.validateField(a,r),u=l.isValid,d=l.error,p=null;return i&&u&&n&&a&&Number(n)>Number(a)&&(p=c.a.t(t.errorMessages.MIN_GREATER_THAN_MAX)),{minValueError:s,maxValueError:d,logicError:p}}},{key:"render",value:function(){var e=this.props,t=e.value,n=e.classes,a=this.getErrors(),r=a.minValueError,o=a.maxValueError,i=a.logicError;return m.a.createElement("div",null,m.a.createElement("div",{className:n.container},m.a.createElement("div",{className:n.inputContainer},m.a.createElement(sS,{value:t&&t.min,error:r,errorClass:n.error,onBlur:this.handleFieldBlur,onEnterKey:this.handleEnterKeyInMin})),m.a.createElement("div",{className:n.toLabelContainer},c.a.t("to")),m.a.createElement("div",{className:n.inputContainer},m.a.createElement(uS,{value:t&&t.max,error:o,errorClass:n.error,onBlur:this.handleFieldBlur,onEnterKey:this.handleEnterKeyInMax,textFieldRef:this.setMaxD2TextFieldInstance}))),m.a.createElement("div",{className:Cn()(n.error,n.logicErrorContainer)},i))}}],[{key:"validateField",value:function(e,n){if(!e)return{isValid:!0,error:null};var a=(0,t.validatorForTypes[n])(e);return{isValid:a,error:a?null:c.a.t(t.errorMessages[n])}}},{key:"isFilterValid",value:function(e,n,a){return!(!t.validateField(e,a).isValid||!t.validateField(e,a).isValid)&&!(e&&n&&Number(e)>Number(n))}},{key:"getRequestData",value:function(e){var t=[];return e.min&&t.push("ge:".concat(e.min)),e.max&&t.push("le:".concat(e.max)),2===t.length?t.join(":"):t[0]}},{key:"getAppliedText",value:function(e){return e.min&&e.max?Number(e.min)===Number(e.max)?e.min:"".concat(e.min," ").concat(c.a.t("to")," ").concat(e.max):e.min?"".concat(c.a.t("greater than or equal to")," ").concat(e.min):"".concat(c.a.t("less than or equal to")," ").concat(e.max)}}]),t}(f.Component);dS.errorMessages=(eS={MIN_GREATER_THAN_MAX:"Minimum value cannot be greater than maximum value"},Object(Ut.a)(eS,ct.NUMBER,"Please provide a valid number"),Object(Ut.a)(eS,ct.INTEGER,"Please provide a valid integer"),Object(Ut.a)(eS,ct.INTEGER_POSITIVE,"Please provide a positive integer"),Object(Ut.a)(eS,ct.INTEGER_NEGATIVE,"Please provide a negative integer"),Object(Ut.a)(eS,ct.INTEGER_ZERO_OR_POSITIVE,"Please provide zero or a positive integer"),eS),dS.validatorForTypes=(tS={},Object(Ut.a)(tS,ct.NUMBER,zn),Object(Ut.a)(tS,ct.INTEGER,Vn),Object(Ut.a)(tS,ct.INTEGER_POSITIVE,Gn),Object(Ut.a)(tS,ct.INTEGER_NEGATIVE,Wn),Object(Ut.a)(tS,ct.INTEGER_ZERO_OR_POSITIVE,Hn),tS);var pS=Object(E.withStyles)(function(e){return{container:{display:"flex",flexWrap:"wrap"},inputContainer:{width:e.typography.pxToRem(100)},toLabelContainer:{paddingTop:e.typography.pxToRem(6),paddingLeft:e.typography.pxToRem(10),paddingRight:e.typography.pxToRem(10),fontSize:e.typography.body1.fontSize},error:Object(se.a)({},e.typography.caption,{color:e.palette.error.main}),logicErrorContainer:{paddingTop:e.typography.pxToRem(10)}}})(dS),fS=n(164),mS=n.n(fS),hS=n(200),bS=n.n(hS),gS=n(199),OS=n.n(gS),vS=n(184),yS=n.n(vS),ES=n(229),_S=n.n(ES),jS=n(531),IS=n.n(jS),CS=n(532),TS=n.n(CS),SS="horizontal",RS="vertical",kS=function(e){function t(e){var n;return Object(A.a)(this,t),(n=Object(F.a)(this,Object(x.a)(t).call(this,e))).handleOptionChange=n.handleOptionChange.bind(Object(V.a)(n)),n.labelClasses=n.buildLabelClasses(),n}return Object(P.a)(t,e),Object(w.a)(t,[{key:"buildLabelClasses",value:function(){return{root:this.props.classes.label}}},{key:"getBoxes",value:function(e){var t=this,n=this.props.optionSet;return n?n.options.map(function(n,a){return m.a.createElement(_S.a,{control:m.a.createElement(mS.a,Object.assign({onChange:function(e,a){t.handleOptionChange(e,a,n.value)},checked:t.isChecked(n.value),icon:m.a.createElement(IS.a,null),checkedIcon:m.a.createElement(TS.a,null)},e)),label:n.text,key:a})}):null}},{key:"handleOptionChange",value:function(e,t,n){this.handleSingleSelectUpdate(t,n)}},{key:"handleSingleSelectUpdate",value:function(e,t){(!1!==e||this.props.nullable)&&this.props.onBlur(e?t:null)}},{key:"setCheckedStatusForBoxes",value:function(){var e=this.props.value;this.checkedValues=e||!1===e||0===e?(new Set).add(e):null}},{key:"isChecked",value:function(e){return!(!this.checkedValues||!this.checkedValues.has(e))}},{key:"renderHorizontal",value:function(e){return m.a.createElement(yS.a,{row:!0},this.getBoxes(e))}},{key:"renderVertical",value:function(e){return m.a.createElement(yS.a,null,this.getBoxes(e))}},{key:"renderBoxes",value:function(e){return this.props.orientation===RS?this.renderVertical(e):this.renderHorizontal(e)}},{key:"render",value:function(){var e=this,t=this.props,n=(t.onBlur,t.optionSet,t.label),a=(t.nullable,t.value,t.orientation,t.required),r=(t.classes,t.style,Object(Fe.a)(t,["onBlur","optionSet","label","nullable","value","orientation","required","classes","style"]));return this.setCheckedStatusForBoxes(),m.a.createElement("div",{ref:function(t){e.materialUIContainerInstance=t}},m.a.createElement(bS.a,{component:"fieldset"},n?m.a.createElement(OS.a,{component:"label",required:!!a,classes:e.labelClasses,focused:!1},n):null,this.renderBoxes(r)))}}]),t}(f.Component),NS=Object(E.withStyles)(function(e){return{label:e.typography.formFieldTitle}})(kS),AS="right",wS="up",FS="absolute",xS="inline",PS=function(e){function t(){return Object(A.a)(this,t),Object(F.a)(this,Object(x.a)(t).apply(this,arguments))}return Object(P.a)(t,e),Object(w.a)(t,[{key:"getAbsoluteBottom",value:function(){return this.props.inputUsesFloatingLabel?60:40}},{key:"getAbsoluteVerticalPosition",value:function(){return this.props.absoluteDirection===wS?{bottom:this.getAbsoluteBottom()}:{top:0}}},{key:"calculateMarginLeftInline",value:function(){var e=this.props,t=e.inputWidth;return e.calendarWidth-t}},{key:"getPopupStyle",value:function(){var e=this.props,t=e.anchorPosition,n=e.mode;return t===AS?n===xS?{marginLeft:"-".concat(this.calculateMarginLeftInline(),"px")}:Object(se.a)({},this.getAbsoluteVerticalPosition(),{right:0}):n===xS?{}:Object(se.a)({},this.getAbsoluteVerticalPosition(),{left:0})}},{key:"render",value:function(){var e=this.props,t=e.open,n=e.mode,a=(e.anchorPosition,e.absoluteDirection,e.classes),r=e.children;if(!t)return null;var o=n===xS?a.containerInline:a.containerAbsolute,i=n===xS?a.calendarInline:a.calendarAbsolute,c=this.getPopupStyle();return f.createElement("div",{className:o},f.createElement("div",{className:i,style:c},r))}}]),t}(f.Component),DS=Object(E.withStyles)(function(){return{containerAbsolute:{position:"relative"},containerInline:{},calendarAbsolute:{position:"absolute",zIndex:201},calendarInline:{}}})(PS),US=(n(8116),function(e){return{accentColor:e.palette.secondary.main,floatingNav:{background:Object($o.fade)(Object($o.darken)(e.palette.primary.dark,.6),.8),chevron:Object($o.lighten)(e.palette.secondary.light,.4),color:"white"},headerColor:e.palette.primary.main,todayColor:e.palette.secondary.main,selectionColor:e.palette.primary.main,weekdayColor:e.palette.primary.main}}),LS=function(e){function t(e){var n;Object(A.a)(this,t),(n=Object(F.a)(this,Object(x.a)(t).call(this,e))).handleChange=n.handleChange.bind(Object(V.a)(n));var a=ai.get(),r=n.props.currentWidth;return n.calendarLocaleData={locale:a.dateFnsLocale,headerFormat:r>=400?a.calendarFormatHeaderLong:a.calendarFormatHeaderShort,weekdays:a.weekDaysShort.map(function(e){return ri(e)}),blank:a.selectDatesText,todayLabel:{long:a.todayLabelLong,short:a.todayLabelShort},weekStartsOn:a.weekStartsOn},n.theme=US(n.props.theme),n.displayOptions=Object(se.a)({},t.displayOptions,n.props.displayOptions),n}return Object(P.a)(t,e),Object(w.a)(t,[{key:"shouldComponentUpdate",value:function(e){if(e.currentWidth!==this.props.currentWidth){var t=ai.get();return e.currentWidth<400?this.calendarLocaleData.headerFormat=t.calendarFormatHeaderShort:this.calendarLocaleData.headerFormat=t.calendarFormatHeaderLong,!0}return!1}},{key:"handleChange",value:function(e){var t=Se(e).format("L");this.props.onDateSelected(t)}},{key:"getValue",value:function(e){if(!e)return null;var t=Pn(e);return t.isValid?t.momentDate.toDate():null}},{key:"getMinMaxProps",value:function(){var e={},t=this.props.minMoment,n=this.props.maxMoment;if(t){var a=t.toDate();e.min=a,e.minDate=a}if(n){var r=n.toDate();e.max=r,e.maxDate=r}return e}},{key:"render",value:function(){var e=this.props,t=e.value,n=e.classes,a=e.currentWidth,r=e.height,o=(e.minMoment,e.maxMoment,e.onDateSelected,e.theme,e.displayOptions,Object(Fe.a)(e,["value","classes","currentWidth","height","minMoment","maxMoment","onDateSelected","theme","displayOptions"]));return m.a.createElement("div",{className:n.container},m.a.createElement(Pa.a,Object.assign({},this.getMinMaxProps(),{selected:this.getValue(t),onSelect:this.handleChange,locale:this.calendarLocaleData,width:a,height:r,autoFocus:!1,theme:this.theme,displayOptions:this.displayOptions},o)))}}]),t}(f.Component);LS.displayOptions={showHeader:!1};var MS=Object(E.withTheme)()(Object(E.withStyles)(function(){return{container:{}}})(LS));var BS=function(e){function t(e){var n;return Object(A.a)(this,t),(n=Object(F.a)(this,Object(x.a)(t).call(this,e))).state={popoverOpen:!1},n.handleTextFieldFocus=n.handleTextFieldFocus.bind(Object(V.a)(n)),n.handleDateSelected=n.handleDateSelected.bind(Object(V.a)(n)),n.handleTextFieldBlur=n.handleTextFieldBlur.bind(Object(V.a)(n)),n.hidePopover=n.hidePopover.bind(Object(V.a)(n)),n.handleDocumentClick=n.handleDocumentClick.bind(Object(V.a)(n)),n}return Object(P.a)(t,e),Object(w.a)(t,null,[{key:"splitPassOnProps",value:function(e){var n={input:{},popup:{},calendar:{}};return e?Object.keys(e).reduce(function(n,a){var r;r=a.startsWith(t.propContainers.CALENDAR)?t.propContainers.CALENDAR:a.startsWith(t.propContainers.POPUP)?t.propContainers.POPUP:t.propContainers.INPUT;var o,i=(o=a.replace(r,"")).charAt(0).toLocaleLowerCase()+o.slice(1);return n[r][i]=e[a],n},n):n}}]),Object(w.a)(t,[{key:"componentWillUnmount",value:function(){document.removeEventListener("click",this.handleDocumentClick)}},{key:"handleTextFieldFocus",value:function(){document.removeEventListener("click",this.handleDocumentClick),this.setState({popoverOpen:!0}),this.props.onFocus&&this.props.onFocus()}},{key:"handleDateSelected",value:function(e){this.props.onBlur(e),this.hidePopover(),this.props.onDateSelectedFromCalendar&&this.props.onDateSelectedFromCalendar(),document.removeEventListener("click",this.handleDocumentClick)}},{key:"handleDocumentClick",value:function(e){e.target&&e.target.className&&e.target.className.startsWith&&e.target.className.startsWith("Cal__")||e.target&&e.target.className&&e.target.className.baseVal&&e.target.className.baseVal.startsWith("Cal__")||(this.hidePopover(),document.removeEventListener("click",this.handleDocumentClick))}},{key:"handleTextFieldBlur",value:function(e,t){this.props.onBlur(e),t.relatedTarget&&"Cal__Container__root"===t.relatedTarget.className?document.addEventListener("click",this.handleDocumentClick):this.hidePopover()}},{key:"hidePopover",value:function(){this.setState({popoverOpen:!1})}},{key:"render",value:function(){var e=this,n=this.props,a=n.width,r=n.calendarWidth,o=n.calendarHeight,i=n.inputWidth,c=n.classes,s=(n.onBlur,n.onFocus,n.onDateSelectedFromCalendar,n.textFieldRef),l=Object(Fe.a)(n,["width","calendarWidth","calendarHeight","inputWidth","classes","onBlur","onFocus","onDateSelectedFromCalendar","textFieldRef"]),u=this.state.popoverOpen,d=s?{ref:s}:null,p=i||a,m=r||a,h=t.splitPassOnProps(l),b=o||350;return f.createElement("div",{ref:function(t){e.containerInstance=t},style:{width:a}},f.createElement(nS,Object.assign({},d,{onFocus:this.handleTextFieldFocus,onBlur:this.handleTextFieldBlur,className:c.textField,width:p},h.input)),f.createElement(DS,Object.assign({open:u,onClose:this.hidePopover,width:m,height:b,inputWidth:p,inputUsesFloatingLabel:!!h.input.label},h.popup),f.createElement(MS,Object.assign({onDateSelected:this.handleDateSelected,value:this.props.value,currentWidth:m,height:b},h.calendar))))}}]),t}(f.Component);BS.propContainers={CALENDAR:"calendar",POPUP:"popup",INPUT:"input"};var VS,GS,WS,HS=Object(E.withStyles)(function(){return{textField:{width:"100%"}}})(BS),zS=function(e){function t(e){var n;return Object(A.a)(this,t),(n=Object(F.a)(this,Object(x.a)(t).call(this,e))).handleBlur=function(e){n.props.onBlur(t.getValueObject(e))},n.handleKeyPress=function(e){"Enter"===e.key&&n.props.onEnterKey()},n.displayOptions={showWeekdays:!0,showHeader:!1},n}return Object(P.a)(t,e),Object(w.a)(t,null,[{key:"getValueObject",value:function(e){return{from:e.trim()}}}]),Object(w.a)(t,[{key:"render",value:function(){var e=this.props,t=e.error,n=e.errorClass,a=(e.onBlur,e.onEnterKey,Object(Fe.a)(e,["error","errorClass","onBlur","onEnterKey"]));return m.a.createElement("div",null,m.a.createElement(HS,Object.assign({onKeyPress:this.handleKeyPress,onBlur:this.handleBlur,placeholder:c.a.t("From"),popupMode:FS,popupAbsoluteDirection:wS,width:150,calendarWidth:330,calendarHeight:170,calendarRowHeight:45,calendarDisplayOptions:this.displayOptions},a)),m.a.createElement("div",{className:n},t))}}]),t}(f.Component),KS=aS()(zS),YS=function(e){function t(e){var n;return Object(A.a)(this,t),(n=Object(F.a)(this,Object(x.a)(t).call(this,e))).handleBlur=function(e){n.props.onBlur(t.getValueObject(e))},n.handleKeyPress=function(e){"Enter"===e.key&&n.props.onEnterKey(t.getValueObject(n.props.value||""))},n.handleDateSelectedFromCalendar=function(){n.props.onFocusUpdateButton()},n.displayOptions={showWeekdays:!0,showHeader:!1},n}return Object(P.a)(t,e),Object(w.a)(t,null,[{key:"getValueObject",value:function(e){return{to:e.trim()}}}]),Object(w.a)(t,[{key:"render",value:function(){var e=this.props,t=e.error,n=(e.onBlur,e.onEnterKey,e.errorClass),a=(e.onFocusUpdateButton,Object(Fe.a)(e,["error","onBlur","onEnterKey","errorClass","onFocusUpdateButton"]));return m.a.createElement("div",null,m.a.createElement(HS,Object.assign({onKeyPress:this.handleKeyPress,onBlur:this.handleBlur,onDateSelectedFromCalendar:this.handleDateSelectedFromCalendar,placeholder:c.a.t("To"),popupAnchorPosition:AS,popupMode:FS,popupAbsoluteDirection:wS,width:150,calendarWidth:330,calendarHeight:170,calendarRowHeight:45,calendarDisplayOptions:this.displayOptions},a)),m.a.createElement("div",{className:n},t))}}]),t}(f.Component),qS=aS()(YS),XS=(n(8117),function(e){function t(e){var n;return Object(A.a)(this,t),(n=Object(F.a)(this,Object(x.a)(t).call(this,e))).handleEnterKeyInFrom=function(){n.toD2DateTextFieldInstance.focus()},n.handleDateSelectedFromCalendarInFrom=function(){n.toD2DateTextFieldInstance.focus()},n.handleEnterKeyInTo=function(e){var a=n.getUpdatedValue(e);n.setState({submitAttempted:!0}),a&&!t.isFilterValid(a.main,a.from,a.to,n.props.type)?n.props.onCommitValue(a):n.props.onUpdate(a||null)},n.handleFieldBlur=function(e){n.props.onCommitValue(n.getUpdatedValue(e))},n.handleMainSelect=function(e){var t=e?{main:e}:null;n.props.onCommitValue(t)},n.setToD2DateTextFieldInstance=function(e){n.toD2DateTextFieldInstance=e},n.state={submitAttempted:!1},n}return Object(P.a)(t,e),Object(w.a)(t,null,[{key:"formatDateForFilterRequest",value:function(e){return e.format("YYYY-MM-DD")}},{key:"convertDateFilterValueToClientValue",value:function(e){return bd(e,ct.DATE)}},{key:"convertDateFilterValueToFormValue",value:function(e){return nc(e,ct.DATE)}},{key:"validateField",value:function(e,n){if(!e)return{isValid:!0,error:null};var a=(0,t.validatorForTypes[n])(e);return{isValid:a,error:a?null:c.a.t(t.errorMessages[n])}}},{key:"isFilterValid",value:function(e,n,a,r){return!(e===t.mainOptionKeys.CUSTOM_RANGE&&!n&&!a)&&(!(!t.validateField(n,r).isValid||!t.validateField(n,r).isValid)&&!(n&&a&&this.isFromAfterTo(n,a)))}},{key:"getRequestData",value:function(e){return t.mapMainSelectionsToRequests[e.main](e.from,e.to)}},{key:"getAppliedText",value:function(e){return t.mapMainSelectionsToAppliedText[e.main](e.from,e.to)}},{key:"isFromAfterTo",value:function(e,n){var a=t.convertDateFilterValueToClientValue(e),r=t.convertDateFilterValueToClientValue(n),o=Se(a),i=Se(r);return o.isAfter(i)}}]),Object(w.a)(t,[{key:"onGetUpdateData",value:function(e){var n="undefined"!==typeof e?e:this.props.value;return n?{requestData:t.getRequestData(n),appliedText:t.getAppliedText(n)}:null}},{key:"onIsValid",value:function(){this.setState({submitAttempted:!0});var e=this.props.value;return!e||t.isFilterValid(e.main,e.from,e.to,this.props.type)}},{key:"getUpdatedValue",value:function(e){var n=Object(se.a)({},this.props.value,e);return n.from||n.to?n.main=t.mainOptionKeys.CUSTOM_RANGE:n.main===t.mainOptionKeys.CUSTOM_RANGE&&(n.main=null),Object.keys(n).filter(function(e){return n[e]}).length>0?n:null}},{key:"getErrors",value:function(){var e=this.props.value,n=this.state.submitAttempted,a=e&&e.main,r=e&&e.from,o=e&&e.to,i=this.props.type;if(a===t.mainOptionKeys.CUSTOM_RANGE&&!r&&!o)return{minValueError:null,maxValueError:null,logicError:n?c.a.t(t.errorMessages.CUSTOM_RANGE_WITHOUT_VALUES):null};var s=t.validateField(r,i),l=s.isValid,u=s.error,d=t.validateField(o,i),p=d.isValid,f=d.error,m=null;return l&&p&&r&&o&&t.isFromAfterTo(r,o)&&(m=c.a.t(t.errorMessages.FROM_GREATER_THAN_TO)),{minValueError:u,maxValueError:f,logicError:m}}},{key:"render",value:function(){var e=this.props,n=e.value,a=e.classes,r=e.onFocusUpdateButton,o=this.getErrors(),i=o.minValueError,s=o.maxValueError,l=o.logicError;return m.a.createElement("div",{id:"dateFilter"},m.a.createElement("div",null,m.a.createElement(NS,{optionSet:t.mainOptionSet,orientation:RS,value:n&&n.main,onBlur:this.handleMainSelect,color:"secondary",nullable:!0})),m.a.createElement("div",{className:a.fromToContainer},m.a.createElement("div",{className:a.inputContainer},m.a.createElement(KS,{value:n&&n.from,error:i,errorClass:a.error,onBlur:this.handleFieldBlur,onEnterKey:this.handleEnterKeyInFrom,onDateSelectedFromCalendar:this.handleDateSelectedFromCalendarInFrom})),m.a.createElement("div",{className:a.toLabelContainer},c.a.t("to")),m.a.createElement("div",{className:a.inputContainer},m.a.createElement(qS,{value:n&&n.to,error:s,errorClass:a.error,onBlur:this.handleFieldBlur,onEnterKey:this.handleEnterKeyInTo,textFieldRef:this.setToD2DateTextFieldInstance,onFocusUpdateButton:r}))),m.a.createElement("div",{className:Cn()(a.error,a.logicErrorContainer)},l))}}]),t}(f.Component));XS.errorMessages=Object(Ut.a)({CUSTOM_RANGE_WITHOUT_VALUES:"Please specify a range",FROM_GREATER_THAN_TO:"The From date can't be after the To date"},ct.DATE,"Please provide a valid date"),XS.validatorForTypes=Object(Ut.a)({},ct.DATE,Dn),XS.mainOptionKeys={LAST_WEEK:"lastWeek",LAST_MONTH:"lastMonth",LAST_3_MONTHS:"last3Months",CUSTOM_RANGE:"customRange"},XS.mainOptionsTranslatedTexts=(VS={},Object(Ut.a)(VS,XS.mainOptionKeys.LAST_WEEK,c.a.t("Last week")),Object(Ut.a)(VS,XS.mainOptionKeys.LAST_MONTH,c.a.t("Last month")),Object(Ut.a)(VS,XS.mainOptionKeys.LAST_3_MONTHS,c.a.t("Last 3 months")),Object(Ut.a)(VS,XS.mainOptionKeys.CUSTOM_RANGE,c.a.t("Custom range")),VS),XS.mainOptionSet=new it("mainOptions",[new tt(function(e){e.text=XS.mainOptionsTranslatedTexts[XS.mainOptionKeys.LAST_WEEK],e.value=XS.mainOptionKeys.LAST_WEEK}),new tt(function(e){e.text=XS.mainOptionsTranslatedTexts[XS.mainOptionKeys.LAST_MONTH],e.value=XS.mainOptionKeys.LAST_MONTH}),new tt(function(e){e.text=XS.mainOptionsTranslatedTexts[XS.mainOptionKeys.LAST_3_MONTHS],e.value=XS.mainOptionKeys.LAST_3_MONTHS}),new tt(function(e){e.text=XS.mainOptionsTranslatedTexts[XS.mainOptionKeys.CUSTOM_RANGE],e.value=XS.mainOptionKeys.CUSTOM_RANGE})]),XS.mapMainSelectionsToRequests=(GS={},Object(Ut.a)(GS,XS.mainOptionKeys.LAST_WEEK,function(){var e=Se().subtract(1,"weeks").startOf("week"),t=Se().subtract(1,"weeks").endOf("week");return["ge:".concat(XS.formatDateForFilterRequest(e)),"le:".concat(XS.formatDateForFilterRequest(t))]}),Object(Ut.a)(GS,XS.mainOptionKeys.LAST_MONTH,function(){var e=Se().subtract(1,"months").startOf("month"),t=Se().subtract(1,"months").endOf("month");return["ge:".concat(XS.formatDateForFilterRequest(e)),"le:".concat(XS.formatDateForFilterRequest(t))]}),Object(Ut.a)(GS,XS.mainOptionKeys.LAST_3_MONTHS,function(){var e=Se().subtract(3,"months").startOf("month"),t=Se().subtract(1,"months").endOf("month");return["ge:".concat(XS.formatDateForFilterRequest(e)),"le:".concat(XS.formatDateForFilterRequest(t))]}),Object(Ut.a)(GS,XS.mainOptionKeys.CUSTOM_RANGE,function(e,t){var n=[];if(e){var a=XS.convertDateFilterValueToClientValue(e),r=XS.formatDateForFilterRequest(Se(a));n.push("ge:".concat(r))}if(t){var o=XS.convertDateFilterValueToClientValue(t),i=XS.formatDateForFilterRequest(Se(o));n.push("le:".concat(i))}return n}),GS),XS.mapMainSelectionsToAppliedText=(WS={},Object(Ut.a)(WS,XS.mainOptionKeys.LAST_WEEK,function(){return XS.mainOptionsTranslatedTexts[XS.mainOptionKeys.LAST_WEEK]}),Object(Ut.a)(WS,XS.mainOptionKeys.LAST_MONTH,function(){return XS.mainOptionsTranslatedTexts[XS.mainOptionKeys.LAST_MONTH]}),Object(Ut.a)(WS,XS.mainOptionKeys.LAST_3_MONTHS,function(){return XS.mainOptionsTranslatedTexts[XS.mainOptionKeys.LAST_3_MONTHS]}),Object(Ut.a)(WS,XS.mainOptionKeys.CUSTOM_RANGE,function(e,t){var n="";if(e&&t){var a=XS.convertDateFilterValueToClientValue(e),r=XS.convertDateFilterValueToClientValue(t),o=Se(a),i=Se(r);if(o.isSame(i))n=XS.convertDateFilterValueToFormValue(a);else{var s=XS.convertDateFilterValueToFormValue(a),l=XS.convertDateFilterValueToFormValue(r);n="".concat(s," ").concat(c.a.t("to")," ").concat(l)}}else if(e){var u=XS.convertDateFilterValueToClientValue(e),d=XS.convertDateFilterValueToFormValue(u);n="".concat(c.a.t("after or equal to")," ").concat(d)}else{var p=XS.convertDateFilterValueToClientValue(t),f=XS.convertDateFilterValueToFormValue(p);n="".concat(c.a.t("before or equal to")," ").concat(f)}return n}),WS);var ZS=Object(E.withStyles)(function(e){return{fromToContainer:{display:"flex",flexWrap:"wrap"},inputContainer:{},toLabelContainer:{width:30,display:"flex",justifyContent:"center",alignItems:"center",paddingTop:e.typography.pxToRem(6),fontSize:e.typography.body1.fontSize},error:Object(se.a)({},e.typography.caption,{color:e.palette.error.main}),logicErrorContainer:{paddingTop:e.typography.pxToRem(10)}}})(XS),JS="horizontal",QS="vertical",$S=function(e){function t(e){var n;return Object(A.a)(this,t),(n=Object(F.a)(this,Object(x.a)(t).call(this,e))).handleOptionChange=n.handleOptionChange.bind(Object(V.a)(n)),n.labelClasses=n.buildLabelClasses(),n}return Object(P.a)(t,e),Object(w.a)(t,[{key:"buildLabelClasses",value:function(){return{root:this.props.classes.label}}},{key:"getBoxes",value:function(e){var t=this,n=this.props.optionSet;return n?n.options.map(function(n,a){return m.a.createElement(_S.a,{control:m.a.createElement(mS.a,Object.assign({onChange:function(e,a){t.handleOptionChange(e,a,n.value)},checked:t.isChecked(n.value)},e)),label:n.text,key:a})}):null}},{key:"handleOptionChange",value:function(e,t,n){this.handleSelectUpdate(t,n)}},{key:"handleSelectUpdate",value:function(e,t){var n=null;e?this.checkedValues?(this.checkedValues.add(t),n=Array.from(this.checkedValues)):n=[t]:this.checkedValues&&(this.checkedValues.delete(t),n=this.checkedValues.size>0?Array.from(this.checkedValues):null),this.props.onBlur(n)}},{key:"setCheckedStatusForBoxes",value:function(){var e=this.props.value;this.checkedValues=e||!1===e||0===e?new Set(e):null}},{key:"isChecked",value:function(e){return!(!this.checkedValues||!this.checkedValues.has(e))}},{key:"renderHorizontal",value:function(e){return m.a.createElement(yS.a,{row:!0},this.getBoxes(e))}},{key:"renderVertical",value:function(e){return m.a.createElement(yS.a,null,this.getBoxes(e))}},{key:"renderCheckboxes",value:function(e){return this.props.orientation===QS?this.renderVertical(e):this.renderHorizontal(e)}},{key:"render",value:function(){var e=this,t=this.props,n=(t.onBlur,t.optionSet,t.label),a=(t.value,t.orientation,t.required),r=(t.classes,t.style,t.passOnClasses),o=Object(Fe.a)(t,["onBlur","optionSet","label","value","orientation","required","classes","style","passOnClasses"]);return this.setCheckedStatusForBoxes(),m.a.createElement("div",{ref:function(t){e.materialUIContainerInstance=t}},m.a.createElement(bS.a,{component:"fieldset"},n?m.a.createElement(OS.a,{component:"label",required:!!a,classes:e.labelClasses,focused:!1},n):null,this.renderCheckboxes(Object(se.a)({},o,{classes:r}))))}}]),t}(f.Component),eR=Object(E.withStyles)(function(e){return{label:e.typography.formFieldTitle}})($S),tR=function(e){function t(e){var n;return Object(A.a)(this,t),(n=Object(F.a)(this,Object(x.a)(t).call(this,e))).optionSet=t.getOptions(),n}return Object(P.a)(t,e),Object(w.a)(t,null,[{key:"getOptions",value:function(){var e=c.a.t("Yes"),t=c.a.t("No"),n=new it;return n.addOption(new tt(function(t){t.text=e,t.value="true"})),n.addOption(new tt(function(e){e.text=t,e.value="false"})),n}}]),Object(w.a)(t,[{key:"render",value:function(){var e=this.props,t=e.allowMultiple,n=Object(Fe.a)(e,["allowMultiple"]),a=t?eR:NS;return m.a.createElement("div",null,m.a.createElement(a,Object.assign({},n,{optionSet:this.optionSet})))}}]),t}(f.Component),nR=function(e){function t(){var e,n;Object(A.a)(this,t);for(var a=arguments.length,r=new Array(a),o=0;o<a;o++)r[o]=arguments[o];return(n=Object(F.a)(this,(e=Object(x.a)(t)).call.apply(e,[this].concat(r)))).setBooleanFieldInstance=function(e){n.booleanFieldInstance=e},n}return Object(P.a)(t,e),Object(w.a)(t,[{key:"onGetUpdateData",value:function(){var e=this.props.value;return e?{requestData:t.getRequestData(e,this.props.type),appliedText:t.getAppliedText(e,this.booleanFieldInstance&&this.booleanFieldInstance.optionSet)}:null}},{key:"onIsValid",value:function(){return!0}},{key:"render",value:function(){var e=this.props,t=e.onCommitValue,n=e.value,a=e.classes;return m.a.createElement("div",{className:a.selectBoxesContainer},m.a.createElement(tR,{ref:this.setBooleanFieldInstance,allowMultiple:!0,value:n,onBlur:t,orientation:QS}))}}],[{key:"getRequestData",value:function(e,t){var n=e.map(function(e){return id(bd(e,t),t)}).join(";");return"in:".concat(n)}},{key:"getAppliedText",value:function(e,t){return e.map(function(e){return t?t.getOptionText(e):e}).join(", ")}}]),t}(f.Component),aR=Object(E.withStyles)(function(e){return{selectBoxesContainer:{marginRight:e.typography.pxToRem(-24)}}})(nR),rR=n(533),oR=n.n(rR),iR=function(e){function t(e){var n;return Object(A.a)(this,t),(n=Object(F.a)(this,Object(x.a)(t).call(this,e))).handleChange=n.handleChange.bind(Object(V.a)(n)),n.labelClasses=n.buildLabelClasses(),n}return Object(P.a)(t,e),Object(w.a)(t,[{key:"buildLabelClasses",value:function(){return{root:this.props.classes.label}}},{key:"handleChange",value:function(e,t){var n;n=t?"true":null,this.props.onBlur(n)}},{key:"render",value:function(){var e=this,t=this.props,n=(t.onBlur,t.value),a=t.label,r=t.required,o=(t.classes,t.style),i=t.useSwitch,c=t.useValueLabel,s=Object(Fe.a)(t,["onBlur","value","label","required","classes","style","useSwitch","useValueLabel"]),l=i?oR.a:mS.a;return m.a.createElement("div",{ref:function(t){e.materialUIContainerInstance=t},style:o},m.a.createElement(bS.a,{component:"fieldset"},!a||c?null:m.a.createElement(OS.a,{component:"label",required:!!r,classes:e.labelClasses,focused:!1},a),m.a.createElement(yS.a,null,m.a.createElement(_S.a,{label:c?a:"",control:m.a.createElement(l,Object.assign({},s,{onChange:this.handleChange,checked:!!n}))}))))}}]),t}(f.Component),cR=Object(E.withStyles)(function(e){return{label:e.typography.formFieldTitle}})(iR),sR=function(e){function t(){var e,n;Object(A.a)(this,t);for(var a=arguments.length,r=new Array(a),o=0;o<a;o++)r[o]=arguments[o];return(n=Object(F.a)(this,(e=Object(x.a)(t)).call.apply(e,[this].concat(r)))).handleTrueOnlyBlur=function(e){n.props.onCommitValue(e?[e]:null)},n}return Object(P.a)(t,e),Object(w.a)(t,[{key:"onGetUpdateData",value:function(){var e=this.props.value;return e?{requestData:t.getRequestData(e,this.props.type),appliedText:t.getAppliedText(e)}:null}},{key:"onIsValid",value:function(){return!0}},{key:"render",value:function(){var e=this.props,t=e.value,n=e.classes;return m.a.createElement("div",{className:n.selectBoxesContainer},m.a.createElement(cR,{label:c.a.t("Yes"),useValueLabel:!0,value:t,onBlur:this.handleTrueOnlyBlur,orientation:QS}))}}],[{key:"getRequestData",value:function(e,t){var n=e.map(function(e){return id(bd(e,t),t)}).join(";");return"in:".concat(n)}},{key:"getAppliedText",value:function(e){return e.map(function(){return c.a.t("Yes")}).join(", ")}}]),t}(f.Component),lR=Object(E.withStyles)(function(e){return{selectBoxesContainer:{marginRight:e.typography.pxToRem(-24)}}})(sR),uR=function(e){var t=e.multiSelect,n=Object(Fe.a)(e,["multiSelect"]);return t?m.a.createElement(eR,Object.assign({orientation:JS},n)):m.a.createElement(NS,Object.assign({orientation:SS},n))};uR.defaultProps={multiSelect:!1};var dR,pR=function(e){var t,n;return n=t=function(t){function n(e){var t;return Object(A.a)(this,n),(t=Object(F.a)(this,Object(x.a)(n).call(this,e))).formOptionSet=t.buildFormOptionSet(),t}return Object(P.a)(n,t),Object(w.a)(n,[{key:"buildFormOptionSet",value:function(){var e=this.props.optionSet;return e.dataElement?e.dataElement.getConvertedOptionSet(nc):(O.a.error(Object(ze.b)(n.errorMessages.DATAELEMENT_MISSING)({OptionSetConverter:this})),null)}},{key:"render",value:function(){return f.createElement(e,Object.assign({},this.props,{optionSet:this.formOptionSet}))}}]),n}(f.Component),t.errorMessages={DATAELEMENT_MISSING:"DataElement missing"},n}(uR),fR=function(e){function t(){return Object(A.a)(this,t),Object(F.a)(this,Object(x.a)(t).apply(this,arguments))}return Object(P.a)(t,e),Object(w.a)(t,[{key:"onGetUpdateData",value:function(){var e=this.props,n=e.value,a=e.singleSelect,r=e.optionSet,o=e.type;return n?a?{requestData:"eq:".concat(n),appliedText:r.getOptionText(n)}:{requestData:t.getRequestData(n,o),appliedText:t.getAppliedText(n,r)}:null}},{key:"onIsValid",value:function(){return!0}},{key:"render",value:function(){var e=this.props,t=e.onCommitValue,n=e.optionSet,a=e.value,r=e.classes,o=e.singleSelect;return m.a.createElement("div",{className:r.selectBoxesContainer},m.a.createElement(pR,{optionSet:n,value:a,onBlur:t,orientation:QS,multiSelect:!o,nullable:!0}))}}],[{key:"getRequestData",value:function(e,t){var n=e.map(function(e){return id(bd(e,t),t)}).join(";");return"in:".concat(n)}},{key:"getAppliedText",value:function(e,t){return e.map(function(e){return t.getOptionText(e)}).join(", ")}}]),t}(f.Component),mR=Object(E.withStyles)(function(e){return{selectBoxesContainer:{maxHeight:e.typography.pxToRem(250),overflowY:"auto",marginRight:e.typography.pxToRem(-24)}}})(fR),hR=function(e){function t(){return Object(A.a)(this,t),Object(F.a)(this,Object(x.a)(t).apply(this,arguments))}return Object(P.a)(t,e),Object(w.a)(t,[{key:"getContentsComponent",value:function(){var e=this.props,n=e.type,a=e.optionSet;if(a&&a.options&&a.options.length<=25)return t.getOptionSetComponent();var r,o=t.selectorContentsForTypes[n];return t.hasStylesHOC.includes(n)?KT()(XT()(ZT()(o))):KT()(XT()((r=o,function(e){var t=e.filterTypeRef,n=Object(Fe.a)(e,["filterTypeRef"]);return f.createElement(r,Object.assign({ref:t},n))})))}},{key:"render",value:function(){var e=this.props,t=e.classes,n=Object(Fe.a)(e,["classes"]),a=this.getContentsComponent();return m.a.createElement("div",{className:t.container},m.a.createElement(a,n))}}],[{key:"getOptionSetComponent",value:function(){return KT()(XT()(ZT()(mR)))}}]),t}(m.a.PureComponent);hR.selectorContentsForTypes=(dR={},Object(Ut.a)(dR,HT.TEXT,iS),Object(Ut.a)(dR,HT.NUMBER,pS),Object(Ut.a)(dR,HT.INTEGER,pS),Object(Ut.a)(dR,HT.INTEGER_POSITIVE,pS),Object(Ut.a)(dR,HT.INTEGER_NEGATIVE,pS),Object(Ut.a)(dR,HT.INTEGER_ZERO_OR_POSITIVE,pS),Object(Ut.a)(dR,HT.DATE,ZS),Object(Ut.a)(dR,HT.BOOLEAN,aR),Object(Ut.a)(dR,HT.TRUE_ONLY,lR),dR),hR.hasStylesHOC=[HT.NUMBER,HT.INTEGER,HT.INTEGER_POSITIVE,HT.INTEGER_NEGATIVE,HT.INTEGER_ZERO_OR_POSITIVE,HT.DATE,HT.BOOLEAN,HT.TRUE_ONLY];var bR=Object(E.withStyles)(function(e){return{container:{padding:e.typography.pxToRem(24)}}})(hR),gR={vertical:"bottom",horizontal:"left"},OR={vertical:"top",horizontal:"left"},vR=function(e){function t(e){var n;return Object(A.a)(this,t),(n=Object(F.a)(this,Object(x.a)(t).call(this,e))).openFilterSelector=function(e){n.setState({filterSelectorOpen:{anchorElement:e.currentTarget}}),n.props.filterValue&&n.activeFilterButtonInstance&&n.activeFilterButtonInstance.clearIsHovered()},n.closeFilterSelector=function(){n.setState({filterSelectorOpen:null})},n.handleCloseFilterSelector=function(){n.closeFilterSelector(),n.props.onRevertFilter()},n.handleEditFilterContents=function(e){n.props.onEditFilterContents(e,n.props.itemId)},n.handleFilterUpdate=function(e,t){var a=n.props.itemId;n.props.onFilterUpdate(e,a,t),n.closeFilterSelector()},n.handleClearFilter=function(){var e=n.props.itemId;n.props.onClearFilter(e)},n.refActiveFilterInstance=function(e){n.activeFilterButtonInstance=e},n.state={filterSelectorOpen:null},n}return Object(P.a)(t,e),Object(w.a)(t,[{key:"renderSelectorContents",value:function(){var e=this.props,t=e.itemId,n=e.type,a=e.optionSet,r=e.singleSelect;return m.a.createElement(bR,{type:n,optionSet:a,singleSelect:r,id:t,onCommitValue:this.handleEditFilterContents,onUpdate:this.handleFilterUpdate,onClose:this.handleCloseFilterSelector})}},{key:"renderWithAppliedFilter",value:function(){var e=this.props,t=e.classes,n=e.title,a=e.filterValue,r=this.state.filterSelectorOpen?m.a.createElement(LT.a,{className:t.icon}):m.a.createElement(DT.a,{className:t.icon});return m.a.createElement(GT,{innerRef:this.refActiveFilterInstance,onChange:this.openFilterSelector,onClear:this.handleClearFilter,iconClass:t.icon,title:n,arrowIconElement:r,filterValue:a})}},{key:"renderWithoutAppliedFilter",value:function(){var e=this.props,t=e.classes,n=e.title;return m.a.createElement(Yc,{variant:"outlined",color:"default",size:"small",classes:{button:t.inactiveFilterButton},muiClasses:{label:t.inactiveFilterButtonLabel},onClick:this.openFilterSelector},n,this.state.filterSelectorOpen?m.a.createElement(LT.a,{className:t.icon}):m.a.createElement(DT.a,{className:t.icon}))}},{key:"render",value:function(){var e=this,t=this.props.filterValue,n=this.state.filterSelectorOpen,a=t?this.renderWithAppliedFilter():this.renderWithoutAppliedFilter();return m.a.createElement(m.a.Fragment,null,a,m.a.createElement(xT.a,{open:!!n,anchorEl:n&&n.anchorElement,onClose:this.handleCloseFilterSelector,anchorOrigin:gR,transformOrigin:OR},n?e.renderSelectorContents():null))}}]),t}(f.Component),yR=Object(E.withStyles)(function(e){return{icon:{fontSize:e.typography.pxToRem(20),paddingLeft:e.typography.pxToRem(5)},inactiveFilterButton:{backgroundColor:e.palette.grey[100]},inactiveFilterButtonLabel:{textTransform:"none"}}})(vR),ER="EditFilterSelectorContentsForWorkingList",_R="SetWorkingListFilter",jR="ClearWorkingListFilter",IR="RevertWorkingListFilter",CR="RestMenuItemSelected",TR="UpdateIncludedFiltersAfterColumnSortingForWorkingList",SR="SetFilterBatch",RR=function(e,t){return le(ER)({value:e,itemId:t})},kR=function(e){return le(jR)({itemId:e})},NR=function(e,t){return e.workingListsAppliedFilters.main&&e.workingListsAppliedFilters.main[t.itemId]},AR=function(e,t){return e.workingListsAppliedFilters.main&&e.workingListsAppliedFilters.main.next&&e.workingListsAppliedFilters.main.next[t.itemId]},wR=Object(D.b)(function(){var e=Object(nl.createSelector)(NR,AR,function(e,t){return t||e});return function(t,n){return{filterValue:e(t,n)}}},function(e){return{onEditFilterContents:function(t,n){e(RR(t,n))},onFilterUpdate:function(t,n,a){var r=oe()(a)?[RR(a,n)]:[];r.push(null==t?kR(n):function(e,t){return le(_R)(Object(se.a)({},e,{itemId:t}))}(t,n)),r.push(le(_T)({})),e(Object(Le.batchActions)(r,SR))},onClearFilter:function(t){e(kR(t))},onRevertFilter:function(){e(le(IR)())}}})(yR),FR=n(236),xR=n(256),PR=n.n(xR),DR=n(258),UR=n.n(DR),LR=function(e){function t(e){var n;return Object(A.a)(this,t),(n=Object(F.a)(this,Object(x.a)(t).call(this,e))).handleMenuButtonClick=function(){n.toggleMenu()},n.handleClickAway=function(e){n.menuReferenceInstance&&n.menuReferenceInstance.contains(e.target)||n.closeMenu()},n.handleItemSelected=function(e){n.closeMenu(),n.props.onItemSelected(e)},n.handleReferenceInstanceRetrieved=function(e){n.managerRef(e),n.menuReferenceInstance=e},n.state={filterSelectorOpen:!1},n.setClassesOnMount(),n}return Object(P.a)(t,e),Object(w.a)(t,[{key:"setClassesOnMount",value:function(){var e=this.props.classes;this.menuClasses={paper:e.menuPaper},this.menuItemClasses={root:e.menuItemRoot}}},{key:"closeMenu",value:function(){this.setState({filterSelectorOpen:!1})}},{key:"toggleMenu",value:function(){this.setState({filterSelectorOpen:!this.state.filterSelectorOpen})}},{key:"renderMenuItems",value:function(){var e=this;return this.props.columns.map(function(t){return m.a.createElement(Rl.a,{key:t.id,onClick:function(){e.handleItemSelected(t.id)},classes:e.menuItemClasses},t.header)})}},{key:"render",value:function(){var e=this,t=this.props.classes;return m.a.createElement(FR.a,null,m.a.createElement(FR.c,null,function(n){var a=n.ref;return e.managerRef=a,m.a.createElement("div",{ref:e.handleReferenceInstanceRetrieved},m.a.createElement(Yc,{variant:"outlined",color:"default",size:"small",classes:{button:t.restMenuButton},muiClasses:{label:t.restMenuButtonLabel},onClick:e.handleMenuButtonClick},c.a.t("More filters"),e.state.filterSelectorOpen?m.a.createElement(LT.a,{className:t.icon}):m.a.createElement(DT.a,{className:t.icon})))}),this.state.filterSelectorOpen&&m.a.createElement(FR.b,{placement:"bottom-start"},function(t){var n=t.ref,a=t.style,r=t.placement;return m.a.createElement("div",{ref:n,style:a,"data-placement":r},m.a.createElement(PR.a,{onClickAway:e.handleClickAway},m.a.createElement(Te.a,{in:!!e.state.filterSelectorOpen,id:"menu-list-grow",style:{transformOrigin:"0 0 0"},timeout:{exit:0,enter:200}},m.a.createElement(Be.a,null,m.a.createElement(UR.a,{role:"menu"},e.renderMenuItems())))))}))}}]),t}(m.a.Component),MR=Object(E.withStyles)(function(e){return{icon:{fontSize:e.typography.pxToRem(20),paddingLeft:e.typography.pxToRem(5)},restMenuButton:{backgroundColor:e.palette.grey[100]},restMenuButtonLabel:{textTransform:"none"},menuPaper:{maxHeight:30},menuItemRoot:{padding:6,paddingLeft:24,paddingRight:24,fontSize:e.typography.pxToRem(14)},popperContainerHidden:{display:"none"}}})(LR),BR=function(e){return{filterButtonContainer:{paddingRight:e.typography.pxToRem(e.spacing.unit),paddingBottom:e.typography.pxToRem(e.spacing.unit/2),paddingTop:e.typography.pxToRem(e.spacing.unit/2)}}},VR=function(e){return{userSelectedFilters:e.workingListsUserSelectedFilters}},GR=function(e){return{onRestMenuItemSelected:function(t){e(function(e){return le(CR)({id:e})}(t))}}},WR=function(e){return Object(D.b)(VR,GR)(function(e){return Object(E.withStyles)(BR)(function(t){function n(){return Object(A.a)(this,n),Object(F.a)(this,Object(x.a)(n).apply(this,arguments))}return Object(P.a)(n,t),Object(w.a)(n,[{key:"getUserSelectedColumns",value:function(e,t){var n=this.props.userSelectedFilters;return e.filter(function(e){return t.every(function(t){return t!==e})}).filter(function(e){return n[e.id]})}},{key:"renderConcatenatedSelectorButton",value:function(e){return e&&0!==e.length?f.createElement(MR,{key:"restMenu",columns:e,onItemSelected:this.props.onRestMenuItemSelected}):null}},{key:"renderIndividualFilterSelectorButtons",value:function(e){var t=this.props.classes;return e.map(function(e){return f.createElement("div",{key:e.id,className:t.filterButtonContainer},f.createElement(wR,{itemId:e.id,type:e.type,title:e.header,optionSet:e.optionSet,singleSelect:e.singleSelect}))})}},{key:"renderFilterSelectorButtons",value:function(){var e=this.props.columns;if(!e)return null;var t=e.filter(function(e){return WT.includes(e.type)||e.optionSet&&e.optionSet.options.length<=25}),a=n.getCalculatedIndividiualColumns(t),r=[].concat(Object(We.a)(a),Object(We.a)(this.getUserSelectedColumns(t,a))),o=n.getRestColumns(t,r),i=this.renderIndividualFilterSelectorButtons(r),c=this.renderConcatenatedSelectorButton(o);return c?[].concat(Object(We.a)(i),[c]):i}},{key:"render",value:function(){var t=this.props,n=(t.classes,t.userSelectedFilters,Object(Fe.a)(t,["classes","userSelectedFilters"])),a=this.renderFilterSelectorButtons();return f.createElement(f.Fragment,null,f.createElement(e,Object.assign({filterButtons:a},n)))}}],[{key:"getCalculatedIndividiualColumns",value:function(e){var t=e.filter(function(e){return e.visible});if(t.length<4){var n=e.filter(function(e){return!e.visible}),a=[].concat(Object(We.a)(t),Object(We.a)(n));return a.slice(0,a.length>=4?4:a.length)}return t.slice(0,4)}},{key:"getRestColumns",value:function(e,t){return e.filter(function(e){return t.every(function(t){return t!==e})})}}]),n}(f.Component))}(e))},HR=n(539),zR=n.n(HR),KR=n(398),YR=n(1495),qR=n.n(YR),XR=n(1496),ZR=n.n(XR),JR=n(535),QR=n.n(JR),$R=n(538),ek=n.n($R),tk=n(261),nk=n.n(tk),ak=n(536),rk=n.n(ak),ok=n(537),ik=n.n(ok),ck=n(534),sk=n.n(ck),lk={cursor:"move",outline:"none"},uk="listItem",dk=function(e){function t(){return Object(A.a)(this,t),Object(F.a)(this,Object(x.a)(t).apply(this,arguments))}return Object(P.a)(t,e),Object(w.a)(t,[{key:"render",value:function(){var e=this.props,t=e.text,n=e.isDragging,a=e.connectDragSource,r=n?0:1;return(0,e.connectDropTarget)(a(m.a.createElement("tr",{key:this.props.id,tabIndex:-1,style:Object(se.a)({},lk,{opacity:r})},m.a.createElement(nk.a,{component:"th",scope:"row"},m.a.createElement(mS.a,{color:"primary",checked:this.props.visible,tabIndex:-1,disableRipple:!0,onClick:this.props.handleToggle(this.props.id)}),t),m.a.createElement(nk.a,null,m.a.createElement(sk.a,{style:{float:"right"}})))))}}]),t}(f.Component),pk=Object(KR.DragSource)(uk,{beginDrag:function(e){return{id:e.id,index:e.index}}},function(e,t){return{connectDragSource:e.dragSource(),isDragging:t.isDragging()}})(Object(KR.DropTarget)(uk,{hover:function(e,t){var n=t.getItem().index,a=e.index;n!==a&&(e.moveListItem(n,a),t.getItem().index=a)}},function(e){return{connectDropTarget:e.dropTarget()}})(dk)),fk=function(e){function t(e){var n;return Object(A.a)(this,t),(n=Object(F.a)(this,Object(x.a)(t).call(this,e))).moveListItem=n.moveListItem.bind(Object(V.a)(n)),n}return Object(P.a)(t,e),Object(w.a)(t,[{key:"moveListItem",value:function(e,t){var n,a=this.props.listItems,r=a[e];n=ZR()(a,{$splice:[[e,1],[t,0,r]]}),this.props.handleUpdateListOrder(n)}},{key:"render",value:function(){var e=this,t=this.props.listItems;return m.a.createElement(QR.a,null,m.a.createElement(rk.a,null,m.a.createElement(ik.a,null,m.a.createElement(nk.a,{colSpan:12},c.a.t("Column")))),m.a.createElement(ek.a,null,t.map(function(t,n){return m.a.createElement(pk,{key:t.id,index:n,id:t.id,text:t.header,moveListItem:e.moveListItem,handleToggle:e.props.handleToggle,visible:t.visible})})))}}]),t}(f.Component),mk=Object(KR.DragDropContext)(qR.a)(fk),hk=function(e){function t(e){var n;return Object(A.a)(this,t),(n=Object(F.a)(this,Object(x.a)(t).call(this,e))).handleClickOpen=function(){n.setState({open:!0})},n.handleClose=function(){n.setState({open:!1})},n.getListToSave=function(){return n.state.columnList.map(function(e){return{id:e.id,visible:e.visible,isMainProperty:e.isMainProperty,header:e.header,type:e.type,options:e.options}})},n.handleSave=function(){n.props.onUpdateWorkinglistOrder(n.getListToSave()),n.setState({open:!1})},n.handleToggle=function(e){return function(){var t=n.state.columnList.findIndex(function(t){return t.id===e}),a=n.state.columnList;a[t]=Object(se.a)({},a[t],{visible:!a[t].visible}),n.setState({columnList:a})}},n.handleUpdateListOrder=function(e){n.setState({columnList:e})},n.state={open:!1,columnList:Object(We.a)(n.props.columns)},n}return Object(P.a)(t,e),Object(w.a)(t,[{key:"render",value:function(){var e=this.props.classes;return m.a.createElement("span",null,m.a.createElement(te.a,{onClick:this.handleClickOpen},m.a.createElement(zR.a,{className:e.optionsIcon})),m.a.createElement(z.a,{open:this.state.open,onClose:this.handleClose,fullWidth:!0},m.a.createElement(J.a,null,c.a.t("Columns to show in table")),m.a.createElement(X.a,null,m.a.createElement(mk,{listItems:this.state.columnList,handleUpdateListOrder:this.handleUpdateListOrder,handleToggle:this.handleToggle})),m.a.createElement(Y.a,null,m.a.createElement($.a,{onClick:this.handleSave,color:"primary",autoFocus:!0},"Save"))))}}]),t}(f.Component),bk=Object(E.withStyles)(function(e){return{optionsIcon:{color:e.palette.primary.main}}})(hk),gk="updateWorkinglistOrder",Ok=Object(D.b)(null,function(e){return{onUpdateWorkinglistOrder:function(t){e(function(e){return le(gk)(e)}(t))}}})(bk),vk=n(540),yk=n.n(vk),Ek=function(e){function t(){var e;return Object(A.a)(this,t),(e=Object(F.a)(this,Object(x.a)(t).call(this))).handleClick=function(t){e.setState({anchorEl:t.currentTarget})},e.handleClose=function(){e.setState({anchorEl:null})},e.getFileName=function(e,t){var n=Se().format("YYYYMMDD");return"".concat(t.name," - ").concat(e.name," - ").concat(n)},e.state={anchorEl:null},e.handleClick=e.handleClick.bind(Object(V.a)(e)),e.handleClose=e.handleClose.bind(Object(V.a)(e)),e}return Object(P.a)(t,e),Object(w.a)(t,[{key:"render",value:function(){var e=this.state.anchorEl,t=this.props,n=t.classes,a=t.programAndStageContainer,r=t.orgUnit,o=t.selectedCategoryOptions,i=(r||{}).orgUnitId,c=ye().baseUrl,s="";if(a.program&&a.program.categoryCombination&&o){s="&attributeCc=".concat(a.program.categoryCombination.id);var l="";Object.keys(o).forEach(function(e){l+="".concat(o[e],";")}),s+="&attributeCos=".concat(l)}if(!a.stage)return null;var u=a.stage.id,d=this.getFileName(a.program,r);return m.a.createElement("span",null,m.a.createElement(te.a,{"aria-owns":e?"download-menu":null,"aria-haspopup":"true",onClick:this.handleClick,variant:"fab",color:"primary"},m.a.createElement(yk.a,null)),m.a.createElement(Em.a,{id:"download-menu",anchorEl:e,open:Boolean(e),onClose:this.handleClose},m.a.createElement("a",{className:n.menuButtonHref,href:"".concat(c,"/events/query.json?orgUnit=").concat(i,"&programStage=").concat(u).concat(s,"&skipPaging=true"),download:d,tabIndex:-1},m.a.createElement(Rl.a,{className:n.menuButton,onClick:this.handleClose},"JSON")),m.a.createElement("a",{className:n.menuButtonHref,href:"".concat(c,"/events/query.xml?orgUnit=").concat(i,"&programStage=").concat(u).concat(s,"&skipPaging=true"),download:d,tabIndex:-1},m.a.createElement(Rl.a,{className:n.menuButton,onClick:this.handleClose},"XML")),m.a.createElement("a",{className:n.menuButtonHref,href:"".concat(c,"/events/query.csv?orgUnit=").concat(i,"&programStage=").concat(u).concat(s,"&skipPaging=true"),download:d,tabIndex:-1},m.a.createElement(Rl.a,{className:n.menuButton,onClick:this.handleClose},"CSV"))))}}]),t}(f.Component),_k=Object(E.withStyles)(function(){return{menuButtonHref:{textDecoration:"none",outline:"none"},menuButton:{paddingLeft:24,paddingRight:24}}})(Ek),jk=function(e){return e.currentSelections.programId},Ik=function(e){return e.currentSelections.orgUnitId},Ck=function(e){return e.organisationUnits},Tk=Object(D.b)(function(){var e=Object(nl.createSelector)(jk,function(e){return e?gt(e):null}),t=Object(nl.createSelector)(Ik,Ck,function(e,t){return e&&t?t[e]:null});return function(n){return{programAndStageContainer:e(n),orgUnit:t(n),selectedCategoryOptions:n.currentSelections.categories}}})(_k),Sk=function(e){return{container:{backgroundColor:"#fff"},title:Object(se.a)({},e.typography.title)}},Rk=function(e){return{headerContainer:{padding:e.typography.pxToRem(24),borderColor:"light"===e.palette.type?Object($o.lighten)(Object($o.fade)(e.palette.divider,1),.88):Object($o.darken)(Object($o.fade)(e.palette.divider,1),.8),borderWidth:"0 0 1px 0",borderStyle:"solid"},listContainer:{padding:e.typography.pxToRem(24)}}},kk=n(542),Nk=n.n(kk),Ak=n(541),wk=n.n(Ak),Fk=function(e){function t(e){var n;return Object(A.a)(this,t),(n=Object(F.a)(this,Object(x.a)(t).call(this,e))).handleDelete=function(e){n.closeMenu(),n.props.onDelete(n.props.row.eventId),e.stopPropagation()},n.handleView=function(e){n.closeMenu(),n.props.onView(n.props.row.eventId),e.stopPropagation()},n.handleReferenceInstanceRetrieved=function(e){n.managerRef(e),n.menuReferenceInstance=e},n.toggleMenu=function(e){n.setState({menuOpen:!n.state.menuOpen}),e.stopPropagation()},n.closeMenu=function(){n.setState({menuOpen:!1})},n.handleClickAway=function(e){n.menuReferenceInstance&&n.menuReferenceInstance.contains(e.target)||n.closeMenu()},n.renderMenuItems=function(){var e=n.props.classes;return f.createElement(f.Fragment,null,f.createElement(Rl.a,{onClick:n.handleEdit},c.a.t("View event info")),f.createElement(Rl.a,{onClick:n.handleDelete},f.createElement(wk.a,{className:e.deleteIcon}),c.a.t("Delete event")))},n.state={menuOpen:!1},n}return Object(P.a)(t,e),Object(w.a)(t,[{key:"render",value:function(){var e=this,t=this.props.classes;return f.createElement(FR.a,null,f.createElement(FR.c,null,function(t){var n=t.ref;return e.managerRef=n,f.createElement("div",{ref:e.handleReferenceInstanceRetrieved},f.createElement(te.a,{onClick:e.toggleMenu},f.createElement(Nk.a,null)))}),this.state.menuOpen&&f.createElement(FR.b,{placement:"bottom-end"},function(n){var a=n.ref,r=n.style,o=n.placement;return f.createElement("div",{ref:a,style:r,className:t.popperContainer,"data-placement":o},f.createElement(PR.a,{onClickAway:e.handleClickAway},f.createElement(Te.a,{in:!!e.state.menuOpen,id:"menu-list-grow",style:{transformOrigin:"0 0 0"},timeout:{exit:0,enter:200}},f.createElement(Be.a,null,f.createElement(UR.a,{role:"menu",className:t.menuList},e.renderMenuItems())))))}))}}]),t}(f.Component),xk=Ii()(function(e){return{deleteIcon:{fill:e.palette.error.main},menuList:{padding:0},popperContainer:{zIndex:100}}})(Fk),Pk=function(e){function t(){return Object(A.a)(this,t),Object(F.a)(this,Object(x.a)(t).apply(this,arguments))}return Object(P.a)(t,e),Object(w.a)(t,[{key:"render",value:function(){return m.a.createElement(z.a,{open:!0},m.a.createElement(X.a,null,m.a.createElement(C,null)))}}]),t}(f.Component),Dk=function(e){return Object(D.b)(NT,AT)(e)}(function(e){return function(e){return function(t){function n(t){var a;return Object(A.a)(this,n),(a=Object(F.a)(this,Object(x.a)(n).call(this,t))).handleRowsSelect=function(e){a.props.onChangeRowsPerPage(e)},a.renderSelectorElement=function(){var e=a.props.rowsPerPage;return f.createElement("div",{id:"rows-per-page-selector"},f.createElement(wT,{onSelect:a.handleRowsSelect,options:a.options,value:e,nullable:!1,withoutUnderline:!0,searchable:!1}))},a.render=function(){var t=Object(_.a)({},a.props);return f.createElement(e,Object.assign({rowsCountSelector:a.renderSelectorElement()},t))},a.options=n.getOptions(),a}return Object(P.a)(n,t),Object(w.a)(n,null,[{key:"getOptions",value:function(){return[10,15,25,50,100].map(function(e){return{label:e.toString(),value:e}})}}]),n}(f.Component)}(e)}(gv()(Bo))),Uk=function(e){function t(e){var n;return Object(A.a)(this,t),(n=Object(F.a)(this,Object(x.a)(t).call(this,e))).getSortHandler=function(e){return function(t){n.props.onSort(e,t)}},n.getCustomEndCellHeader=function(){var e=n.props,t=e.getCustomEndCellHeader,a=e.getCustomEndCellBody,r=e.customEndCellHeaderStyle,o=e.classes;return a?f.createElement(Mo,{className:Cn()(o.cell,o.headerCell),style:r},t&&t(n.props)):null},n.getCustomEndCellBody=function(e,t){var a=n.props,r=a.getCustomEndCellBody,o=a.customEndCellBodyStyle,i=a.classes;return r?f.createElement(Mo,{className:Cn()(i.cell,i.bodyCell),style:o},r(e,t)):null},n.getPaginationLabelDisplayedRows=function(e,t){return"".concat(e," of ").concat(t)},n.columnHeaderInstances=[],n}return Object(P.a)(t,e),Object(w.a)(t,[{key:"setColumnWidth",value:function(e,t){e&&!this.props.isUpdating&&(this.columnHeaderInstances[t]=e)}},{key:"renderHeaderRow",value:function(e){var n=this,a=this.props.sortById,r=this.props.sortByDirection,o=e.map(function(e,o){return f.createElement(Mo,{innerRef:function(e){n.setColumnWidth(e,o)},key:e.id,className:Cn()(n.props.classes.cell,n.props.classes.headerCell),style:{width:n.props.isUpdating&&n.columnHeaderInstances.length-1>=o?n.columnHeaderInstances[o].clientWidth:"auto"}},f.createElement(Ng,{isActive:e.id===a,initialDirection:t.typesWithAscendingInitialDirection.includes(e.type)?Wo.ASC:Wo.DESC,placement:t.typesWithRightPlacement.includes(e.type)?zo:Ho,direction:r,onSort:n.getSortHandler(e.id),childrenClass:n.props.classes.sortLabelChilden},e.header))});return f.createElement(Go,{className:this.props.classes.row},o,this.getCustomEndCellHeader())}},{key:"renderBody",value:function(e){var t=this.props,n=t.classes,a=t.getCustomEndCellBody,r=t.isUpdating,o=e.length+(a?1:0);return r?f.createElement(Go,{className:n.loadingRow},f.createElement(Po,{colSpan:o,className:Cn()(n.cell,n.bodyCell,n.loadingCell)},f.createElement(C,null))):this.renderRows(e,o)}},{key:"renderRows",value:function(e,n){var a=this,r=this.props,o=r.dataSource,i=r.classes,s=Object(Fe.a)(r,["dataSource","classes"]);return o&&0!==o.length?o.map(function(n){var r=e.map(function(e){return f.createElement(Po,{key:e.id,className:Cn()(i.cell,i.bodyCell)},f.createElement("div",{style:t.typesWithRightPlacement.includes(e.type)?{textAlign:"right"}:null},n[e.id]))});return f.createElement(Go,{key:n.eventId,className:Cn()(i.row,i.dataRow),onClick:function(){return a.props.onRowClick(n)}},r,a.getCustomEndCellBody(n,s))}):f.createElement(Go,{className:i.row},f.createElement(Po,{colSpan:n,className:Cn()(i.cell,i.bodyCell)},c.a.t("No events to display")))}},{key:"render",value:function(){var e=this.props,t=(e.dataSource,e.columns),n=e.classes,a=e.filterButtons,r=t?t.filter(function(e){return e.visible}):[];return f.createElement("div",{className:n.container},f.createElement("div",{className:n.topBarContainer},f.createElement("div",{className:n.topBarLeftContainer},a),f.createElement("div",null,f.createElement(Ok,{columns:t}),f.createElement(Tk,null))),f.createElement("div",{className:n.tableContainer},f.createElement(Yo,{className:n.table},f.createElement(Lo,null,this.renderHeaderRow(r)),f.createElement(ko,null,this.renderBody(r)))),f.createElement("div",{className:n.paginationContainer},f.createElement(Dk,{rowsCountSelectorLabel:c.a.t("Rows per page"),onGetLabelDisplayedRows:this.getPaginationLabelDisplayedRows})),this.props.isUpdatingWithDialog&&f.createElement(Pk,null))}}]),t}(f.Component);Uk.typesWithAscendingInitialDirection=[ct.TEXT,ct.LONG_TEXT],Uk.typesWithRightPlacement=[ct.NUMBER,ct.INTEGER,ct.INTEGER_POSITIVE,ct.INTEGER_NEGATIVE,ct.INTEGER_ZERO_OR_POSITIVE];var Lk,Mk,Bk=function(e){return Object(E.withStyles)(Sk)(function(t){var n=t.classes,a=Object(Fe.a)(t,["classes"]);return f.createElement("div",{className:n.container},f.createElement(e,Object.assign({},a,{header:f.createElement("span",{className:n.title},"Registered events")})))})}(function(e){return Object(E.withStyles)(Rk)(function(t){function n(){return Object(A.a)(this,n),Object(F.a)(this,Object(x.a)(n).apply(this,arguments))}return Object(P.a)(n,t),Object(w.a)(n,[{key:"render",value:function(){var t=this.props,n=t.header,a=t.classes,r=Object(Fe.a)(t,["header","classes"]);return f.createElement(Be.a,null,f.createElement("div",{className:a.headerContainer},n),f.createElement("div",{className:a.listContainer},f.createElement(e,r)))}}]),n}(f.Component))}((Lk=function(){return{getCellBody:function(e,t){return f.createElement(xk,Object.assign({row:e},t))},headerCellStyle:{width:96}}},function(e){return function(t){function n(){var e,t;Object(A.a)(this,n);for(var a=arguments.length,r=new Array(a),o=0;o<a;o++)r[o]=arguments[o];return(t=Object(F.a)(this,(e=Object(x.a)(n)).call.apply(e,[this].concat(r)))).getCustomEndCellBody=function(e,t){return Lk().getCellBody(e,t)},t.getCustomEndCellHeader=function(e,t){var n=Lk();return n.getCellHeader&&n.getCellHeader(t)},t}return Object(P.a)(n,t),Object(w.a)(n,[{key:"render",value:function(){var t=Lk();return f.createElement(e,Object.assign({getCustomEndCellHeader:this.getCustomEndCellHeader,getCustomEndCellBody:this.getCustomEndCellBody,customEndCellHeaderStyle:t.headerCellStyle,customEndCellBodyStyle:t.bodyCellStyle},this.props))}}]),n}(f.Component)})(function(e){return WR(e)}(Object(E.withStyles)(function(e){return{loaderContainer:{display:"flex",justifyContent:"center"},container:{borderColor:"light"===e.palette.type?Object($o.lighten)(Object($o.fade)(e.palette.divider,1),.88):Object($o.darken)(Object($o.fade)(e.palette.divider,1),.8),borderWidth:"1px",borderStyle:"solid"},topBarContainer:{display:"flex",justifyContent:"space-between",padding:e.typography.pxToRem(8)},topBarLeftContainer:{display:"flex",alignItems:"center",flexWrap:"wrap"},topBarRightContainer:{display:"flex",justifyContent:"flex-end"},tableContainer:{overflowX:"auto"},optionsIcon:{color:e.palette.primary.main},table:{},row:{},loadingRow:{height:100},dataRow:{cursor:"pointer","&:hover":{backgroundColor:"#F1FBFF"}},cell:{padding:"".concat(e.spacing.unit/2,"px ").concat(7*e.spacing.unit,"px ").concat(e.spacing.unit/2,"px ").concat(3*e.spacing.unit,"px"),"&:last-child":{paddingRight:3*e.spacing.unit},borderBottomColor:"light"===e.palette.type?Object($o.lighten)(Object($o.fade)(e.palette.divider,1),.88):Object($o.darken)(Object($o.fade)(e.palette.divider,1),.8)},bodyCell:{fontSize:e.typography.pxToRem(13),color:e.palette.text.primary},staticHeaderCell:{width:1},headerCell:{fontSize:e.typography.pxToRem(12),color:e.palette.text.secondary,fontWeight:e.typography.fontWeightMedium},loadingCell:{textAlign:"center"},paginationContainer:{fontSize:e.typography.pxToRem(12),color:e.palette.text.secondary,fontWeight:e.typography.fontWeightMedium,display:"flex",justifyContent:"flex-end"},sortLabelChilden:{"&:focus":{color:e.palette.text.primary},"&:hover":{color:e.palette.text.primary}},updatingContainer:{position:"absolute",width:"100%",height:"100%",textAlign:"center"}}})(Uk))))),Vk=function(e){return e.currentSelections.programId},Gk=function(e){return e.workingListsColumnsOrder.main},Wk=function(e){var t=new ut(function(t){t.id=e.id,t.type=e.type}),n=e.options.map(function(e){return new tt(function(t){t.text=e.text,t.value=e.value})}),a=new it(e.id,n,null,t);return t.optionSet=a,a},Hk=function(e){return e.events},zk=function(e){return e.eventsValues},Kk=function(e){return e.workingLists.main.order},Yk=function(e,t,n){return n.map(function(n){return{event:e[n],eventValues:t[n]}})},qk=Object(nl.createSelectorCreator)(nl.defaultMemoize,function(e,t){return t.every(function(t,n){return t.event===(e[n]&&e[n].event)&&t.eventValues===(e[n]&&e[n].eventValues)})&&e.every(function(e,n){return e.event===(t[n]&&t[n].event)&&e.eventValues===(t[n]&&t[n].eventValues)})}),Xk=function(e){return e},Zk=function(){return qk(Xk,function(e){return function(e){if(0===e.length)return[];var t=Rt(e[0].event),n=t.stage;return t.error||!n?null:e.map(function(e){var t=n.stageForm.convertValues(e.eventValues,Ju),a=Ug(e.event,Ju);return Object(se.a)({},a,t)})}(e)})},Jk=Object(D.b)(function(){var e=Object(nl.createSelector)(Vk,Gk,function(e,t){var n=vt(e);if(n.error)return t;var a=n.stage.stageForm;return t.map(function(e){if(e.isMainProperty)return Object(se.a)({},e,{header:e.header||a.getLabel(e.id),optionSet:e.options&&Wk(e)});var t=a.getElement(e.id);return Object(se.a)({},e,{header:t.formName,type:t.type,optionSet:t.optionSet})})}),t=Object(nl.createSelector)(Hk,zk,Kk,Yk),n=Zk();return function(a){var r=!!a.workingListsUI.main.isLoading,o=r?null:e(a),i=r?[]:t(a),c=r?null:a.workingListsMeta.main.sortById,s=r?null:a.workingListsMeta.main.sortByDirection;return{isUpdating:!!a.workingListsUI.main.isUpdating,isUpdatingWithDialog:!!a.workingListsUI.main.isUpdatingWithDialog,columns:o,dataSource:n(i),sortById:c,sortByDirection:s}}},function(e){return{onSort:function(t,n){e(function(e,t){return le(hT)({id:e,direction:t})}(t,n))},onRowClick:function(t){window.scrollTo(0,0),e(CT(t.eventId))},onView:function(t){window.scrollTo(0,0),e(CT(t.eventId))},onDelete:function(t){e(function(e){return le(OT)({eventId:e})}(t))}}})(Bk),Qk=Object(D.b)(function(e){return{ready:e.workingListsUI.main&&!e.workingListsUI.main.isLoading,error:e.workingListsUI.main&&e.workingListsUI.main.dataLoadingError}},{})(Ue()(Pe()(Jk))),$k=function(e){return m.a.createElement("div",null,e.isOnline?m.a.createElement(Qk,null):m.a.createElement(ST,null))},eN=Object(D.b)(function(e){return{isOnline:!!e.offline.online&&!e.app.goingOnlineInProgress}},{})($k),tN=function(e){function t(){return Object(A.a)(this,t),Object(F.a)(this,Object(x.a)(t).apply(this,arguments))}return Object(P.a)(t,e),Object(w.a)(t,[{key:"render",value:function(){var e=this.props,t=e.currentSelectionsComplete,n=e.classes;return m.a.createElement("div",null,t?m.a.createElement("div",{className:n.listContainer},m.a.createElement(eN,null)):null)}}]),t}(f.Component),nN=Object(E.withStyles)(function(){return{listContainer:{padding:24}}})(tN),aN=Object(D.b)(function(e){return{currentSelectionsComplete:!!e.currentSelections.complete}})(nN),rN=function(e){function t(e){var n;return Object(A.a)(this,t),(n=Object(F.a)(this,Object(x.a)(t).call(this,e))).handleStartAgain=n.handleStartAgain.bind(Object(V.a)(n)),n.handleClickNew=n.handleClickNew.bind(Object(V.a)(n)),n}return Object(P.a)(t,e),Object(w.a)(t,[{key:"handleStartAgain",value:function(){this.props.onStartAgain()}},{key:"handleClickNew",value:function(){this.props.onOpenNewEventPage(this.props.selectedProgramId,this.props.selectedOrgUnitId)}},{key:"render",value:function(){var e=this.props,t=e.onSetOrgUnit,n=e.onResetOrgUnitId,a=e.onSetProgramId,r=e.onResetProgramId,o=e.onSetCategoryOption,i=e.onResetCategoryOption,c=e.onResetAllCategoryOptions;return m.a.createElement("div",null,m.a.createElement(Gc,{onSetOrgUnit:t,onResetOrgUnitId:n,onSetProgramId:a,onResetProgramId:r,onSetCategoryOption:o,onResetCategoryOption:i,onResetAllCategoryOptions:c,onStartAgain:this.handleStartAgain,onClickNew:this.handleClickNew}),m.a.createElement(aN,null))}}]),t}(f.Component),oN=Object(D.b)(function(e){return{selectedProgramId:e.currentSelections.programId,selectedOrgUnitId:e.currentSelections.orgUnitId}},function(e){return{onSetOrgUnit:function(t,n){e(function(e,t){return le(aC)({id:e,orgUnit:t})}(t,n))},onResetOrgUnitId:function(){e(fC())},onSetProgramId:function(t){e(function(e){return le(oC)(e)}(t))},onSetCategoryOption:function(t,n){e(function(e,t){return le(cC)({categoryId:e,categoryOptionId:t})}(t,n))},onResetCategoryOption:function(t){e(function(e){return le(sC)(e)}(t))},onResetAllCategoryOptions:function(){e(hC())},onOpenNewEventPage:function(t,n){e(function(e,t){return le(uC)({programId:e,orgUnitId:t})}(t,n))},onStartAgain:function(){e(Object(Le.batchActions)([fC(),mC(),hC(),jn()],dC))},onResetProgramId:function(t){e(Object(Le.batchActions)([mC(),hC(),t],pC))}}})(rN),iN=Object(D.b)(function(e){return{error:e.mainPage.selectionsError,ready:!e.mainPage.isLoading}},function(){return{}})(Ue()(Pe()(oN))),cN=function(e){return!e||Dn(e)},sN=function(){return[{validator:An,message:c.a.t("A value is required")},{validator:cN,message:c.a.t("Please provide a valid date")}]},lN=function(e){return!e},uN=function(){return[{validator:lN,message:c.a.t("Please add or cancel comment before saving the event")}]},dN=function(e,t){var n=e.dataEntries&&e.dataEntries[t.id]&&e.dataEntries[t.id].itemId,a=ff(t.id,n);return{finalInProgress:e.dataEntriesUI[a]&&e.dataEntriesUI[a].finalInProgress}},pN=function(){return{}},fN=function(){return function(e){return Object(D.b)(dN,pN,null,{withRef:!0})(function(e){return function(t){function n(){var e,t;Object(A.a)(this,n);for(var a=arguments.length,r=new Array(a),o=0;o<a;o++)r[o]=arguments[o];return(t=Object(F.a)(this,(e=Object(x.a)(n)).call.apply(e,[this].concat(r)))).renderMainButton=function(e,n){return f.createElement(an.a,{title:t.props.formFoundation.access.data.write?"":c.a.t("No write access")},f.createElement(zf,{variant:"raised",color:"primary",onClick:function(){t.props.onSave()},disabled:!t.props.formFoundation.access.data.write,inProgress:n},c.a.t("Save")))},t}return Object(P.a)(n,t),Object(w.a)(n,[{key:"getWrappedInstance",value:function(){return this.innerInstance}},{key:"render",value:function(){var t=this,n=this.props,a=(n.onSave,n.finalInProgress),r=Object(Fe.a)(n,["onSave","finalInProgress"]),o=this.props.formFoundation.access.data.write;return f.createElement(e,Object.assign({ref:function(e){t.innerInstance=e},mainButton:this.renderMainButton(o,a)},r))}}]),n}(f.Component)}(e))}},mN=n(187),hN=n.n(mN),bN="BASICINFO",gN="STATUS",ON="COMMENTS",vN={errorMessage:"validationError"},yN={labelContainerStyle:{flexBasis:200},inputContainerStyle:{flexBasis:150}},EN={labelContainerStyle:{width:150},inputContainerStyle:{width:150}};function _N(e){e.formHorizontal,e.fieldOptions,e.validationError,e.modified;return Object(Fe.a)(e,["formHorizontal","fieldOptions","validationError","modified"])}var jN,IN=function(e,t){return Object(se.a)({},function(e){return{fieldOptions:e.fieldOptions,formHorizontal:e.formHorizontal,styles:e.formHorizontal?EN:yN}}(e),t)},CN=$i(vN)(Ia()(pc()(fc()(vc({onGetUseVerticalOrientation:function(e){return e.formHorizontal},onGetCustomFieldLabeClass:function(e){return"".concat(e.fieldOptions.fieldLabelMediaBasedClass," ").concat(hN.a.coordinateLabel)}})(uc()(Ya()(mc(_N)(Ti)))))))),TN=$i(vN)(Ia()(pc()(fc()(vc({onGetUseVerticalOrientation:function(e){return e.formHorizontal},onGetCustomFieldLabeClass:function(e){return"".concat(e.fieldOptions.fieldLabelMediaBasedClass," ").concat(hN.a.polygonLabel)}})(uc()(Ya()(mc(_N)(ki)))))))),SN={onIsCompleting:function(e){return e.completeDataEntryFieldValue},onFilterProps:function(e){e.completeDataEntryFieldValue;return Object(Fe.a)(e,["completeDataEntryFieldValue"])}},RN=Dh()(Vf),kN=Pm({isApplicable:function(e){var t=e.formFoundation.featureType;return["Polygon","Point"].includes(t)},getComponent:function(e){return"Polygon"===e.formFoundation.featureType?TN:CN},getComponentProps:function(e){var t=e.formFoundation.featureType;return IN(e,"Polygon"===t?{width:e&&e.formHorizontal?150:350,label:c.a.t("Area"),dialogLabel:c.a.t("Area"),required:!1}:{width:e&&e.formHorizontal?150:"100%",label:c.a.t("Coordinate"),dialogLabel:c.a.t("Coordinate"),required:!1})},getPropName:function(){return"geometry"},getValidatorContainers:function(){return[]},getMeta:function(){return{placement:df,section:bN}}})(RN),NN=am(function(){var e=$i(vN)(Ia()(pc()(fc()(vc({onGetUseVerticalOrientation:function(e){return e.formHorizontal},onGetCustomFieldLabeClass:function(e){return"".concat(e.fieldOptions.fieldLabelMediaBasedClass," ").concat(hN.a.dateLabel)}})(uc()(Ya()(mc(_N)(yi))))))));return{getComponent:function(){return e},getComponentProps:function(e){return IN(e,{width:"100%",calendarWidth:350,label:e.formFoundation.getLabel("eventDate"),required:!0})},getPropName:function(){return"eventDate"},getValidatorContainers:function(){return sN()},getMeta:function(){return{placement:df,section:bN}}}}())(kN),AN=am(function(){var e=$i(vN)(pc()(fc()(uc()(Ya()(om()(lm))))));return{getComponent:function(){return e},getComponentProps:function(e){return IN(e,{id:"comments",label:"Comments",onAddNote:e.onAddNote,dataEntryId:e.id,readonly:!e.formFoundation.access.data.write})},getPropName:function(){return"note"},getValidatorContainers:function(){return uN()},getMeta:function(){return{placement:pf,section:ON}}}}())(NN),wN=dh()(AN),FN=Sh()(wN),xN=gh()(FN),PN=jh()(xN),DN=Zm(SN)(fN()(PN)),UN=Zf(function(){return{color:"primary"}})(DN),LN=am(function(){var e=$i(vN)(Ia()(pc()(fc()(vc({onGetUseVerticalOrientation:function(e){return e.formHorizontal},onGetCustomFieldLabeClass:function(e){return"".concat(e.fieldOptions.fieldLabelMediaBasedClass," ").concat(hN.a.trueOnlyLabel)}})(uc()(Ya()(ui)))))));return{getComponent:function(){return e},getComponentProps:function(e){return IN(e,{label:"Complete event",id:"complete"})},getPropName:function(){return"complete"},getValidatorContainers:function(){return[]},getMeta:function(){return{placement:pf,section:gN}},getPassOnFieldData:function(){return!0}}}())(UN),MN=Lm()(LN),BN=(Mk={},Object(Ut.a)(Mk,bN,{placement:df,name:c.a.t("Basic info")}),Object(Ut.a)(Mk,gN,{placement:pf,name:c.a.t("Status")}),Object(Ut.a)(Mk,ON,{placement:pf,name:c.a.t("Comments")}),Mk),VN=function(e){function t(e){var n;return Object(A.a)(this,t),(n=Object(F.a)(this,Object(x.a)(t).call(this,e))).fieldOptions={theme:e.theme,fieldLabelMediaBasedClass:e.classes.fieldLabelMediaBased},n.dataEntrySections=BN,n}return Object(P.a)(t,e),Object(w.a)(t,[{key:"componentWillUnmount",value:function(){Ys.clear()}},{key:"render",value:function(){var e=this.props,t=e.onUpdateField,n=e.onStartAsyncUpdateField,a=e.classes,r=Object(Fe.a)(e,["onUpdateField","onStartAsyncUpdateField","classes"]);return m.a.createElement("div",{className:a.dataEntryContainer},m.a.createElement(MN,Object.assign({id:"singleEvent",onUpdateFormField:t,onUpdateFormFieldAsync:n,fieldOptions:this.fieldOptions,dataEntrySections:this.dataEntrySections},r)))}}]),t}(f.Component),GN=Object(E.withStyles)(function(e){return{dataEntryContainer:{padding:e.typography.pxToRem(8)},fieldLabelMediaBased:Object(Ut.a)({},e.breakpoints.down(523),{paddingTop:"0px !important"})}})(VN),WN="UpdateDataEntryFieldForEditSingleEventActionsBatch",HN="UpdateFieldForEditSingleEventActionsBatch",zN="RulesEffectsForEditSingleEventActionsBatch",KN="AddNoteForEditSingleEventBatch",YN="RemoveNoteForEditSingleEventBatch",qN="OpenSingleEventForEditInDataEntry",XN="PrerequisitesErrorOpeningSingleEventForEditInDataEntry",ZN="StartRunRulesOnUpdateForEditSingleEvent",JN="RequestSaveReturnToMainPageForEditSingleEvent",QN="StartSaveAfterReturnedToMainPageForEditEvent",$N="SingleEventUpdatedAfterReturnToMainPage",eA="SingleEventUpdateFailedAfterReturnToMainPage",tA="CancelUpdateForSingleEventReturnToMainPage",nA="NoWorkingListUpdateNeededAfterEventUpdateCancelled",aA="UpdateWorkingListAfterEventUpdateCancelled",rA="RequestAddNoteForEditSingleEvent",oA="StartAddNoteForEditSingleEvent",iA="NoteAddedForEditSingleEvent",cA="AddNoteFailedForEditSingleEvent",sA="singleEvent",lA="editEvent",uA=function(e,t,n,a){var r=sA,o=lA,i=[{id:"eventDate",type:"DATE",validatorContainers:sN()},{clientId:"geometry",dataEntryId:"geometry",onConvertIn:Dy(n),onConvertOut:Py},{clientId:"status",dataEntryId:"complete",onConvertIn:Uy,onConvertOut:Ly}],c=ff(r,o),s=Kh(r,o,e.event,e.values,i,n,{eventId:e.event.eventId}),l=Object(se.a)({},e.event,e.values);return[].concat(Object(We.a)(s),Object(We.a)(Jv(a,n,c,t,l,[l])),[le(qN)()])},dA=function(e){return le(ZN)(e)},pA=function(){return le(nA)()},fA=function(){return le(aA)()},mA=function(e,t,n){return ue(e)({onSuccess:t,onError:n})},hA=function(e,t,n){return le(rA)({itemId:e,dataEntryId:t,note:n})},bA=function(e,t,n,a){return le(oA)({selections:n,context:a},{offline:{effect:{url:"events/".concat(e,"/note"),method:Db,data:t},commit:{type:iA,meta:{selections:n,context:a}},rollback:{type:cA,meta:{selections:n,context:a}}}})},gA=function(e){var t=e.currentSelections.programId,n=Je.get(t);if(!n)return O.a.error(Object(ze.b)("programId not found")({method:"getFormFoundation"})),null;var a=n.getStage();return a?a.stageForm:(O.a.error(Object(ze.b)("stage not found for program")({method:"getFormFoundation"})),null)},OA=Object(D.b)(function(e){return{formFoundation:gA(e),ready:!e.editEventPage.dataEntryIsLoading,error:e.editEventPage.dataEntryLoadError}},function(e){return{onUpdateDataEntryField:function(t){var n=t.payload,a=n.dataEntryId,r=n.itemId,o=Xc()();e(Object(Le.batchActions)([t,Uf(a,r,o),dA(Object(se.a)({},t.payload,{uid:o}))],WN))},onUpdateField:function(t){var n=t.payload,a=n.dataEntryId,r=n.itemId,o=Xc()();e(Object(Le.batchActions)([t,Uf(a,r,o),dA(Object(se.a)({},t.payload,{uid:o}))],HN))},onAddNote:function(t,n,a){e(hA(t,n,a))},onStartAsyncUpdateField:function(t,n,a){e(mA(t,function(e){var t=Xc()();return Object(Le.batchActions)([e,Uf(n,a,t),dA(Object(se.a)({},e.payload,{dataEntryId:n,itemId:a,uid:t}))],HN)},function(e){return e}))},onSave:function(t,n,a){window.scrollTo(0,0),e(function(e,t,n){return le(JN)({itemId:e,dataEntryId:t,formFoundation:n},{skipLogging:["formFoundation"]})}(t,n,a))},onCancel:function(){window.scrollTo(0,0),e(le(tA)())}}})(Ue()(Pe()(GN))),vA=function(e){function t(e){var n;return Object(A.a)(this,t),(n=Object(F.a)(this,Object(x.a)(t).call(this,e))).handleGoBackToAllEvents=function(){n.cancelButtonInstance&&n.cancelButtonInstance.handleCancel()},n.setCancelButtonInstance=function(e){n.cancelButtonInstance=e},n.state={discardWarningOpen:!1},n}return Object(P.a)(t,e),Object(w.a)(t,[{key:"render",value:function(){var e=this.props.classes;return m.a.createElement("div",{className:e.container},m.a.createElement(Yc,{className:e.showAllEvents,variant:"raised",onClick:this.handleGoBackToAllEvents},m.a.createElement(Hc.a,null),c.a.t("Show all events")),m.a.createElement(Be.a,{className:e.dataEntryPaper},m.a.createElement("div",{className:e.header},c.a.t("Edit event")),m.a.createElement(OA,{cancelButtonRef:this.setCancelButtonInstance})))}}]),t}(f.Component),yA=Object(E.withStyles)(function(e){return{container:{padding:e.typography.pxToRem(24),paddingTop:e.typography.pxToRem(10)},dataEntryPaper:{marginBottom:e.typography.pxToRem(10),padding:e.typography.pxToRem(10)},header:Object(se.a)({},e.typography.title,{fontSize:18,fontWeight:500,paddingTop:8,paddingBottom:8,paddingLeft:8}),showAllEvents:{paddingLeft:8,marginBottom:10,textTransform:"none",backgroundColor:"#E9EEF4",boxShadow:"none",color:"#494949",fontSize:14,fontWeight:"normal"}}})(vA),EA={header:c.a.t("Unsaved changes"),text:c.a.t("Leaving this page will discard the changes you made to this event."),confirmText:c.a.t("Yes, discard"),cancelText:c.a.t("No, stay here")},_A=function(e){function t(e){var n;return Object(A.a)(this,t),(n=Object(F.a)(this,Object(x.a)(t).call(this,e))).state={openStartAgainWarning:!1,openOrgUnitWarning:!1,openProgramWarning:null,openCatComboWarning:!1,categoryIdToReset:"",openNewWarning:!1},n.handleOpenStartAgainWarning=n.handleOpenStartAgainWarning.bind(Object(V.a)(n)),n.handleOpenOrgUnitWarning=n.handleOpenOrgUnitWarning.bind(Object(V.a)(n)),n.handleOpenProgramWarning=n.handleOpenProgramWarning.bind(Object(V.a)(n)),n.handleOpenCatComboWarning=n.handleOpenCatComboWarning.bind(Object(V.a)(n)),n.handleClose=n.handleClose.bind(Object(V.a)(n)),n.handleAcceptStartAgain=n.handleAcceptStartAgain.bind(Object(V.a)(n)),n.handleAcceptOrgUnit=n.handleAcceptOrgUnit.bind(Object(V.a)(n)),n.handleAcceptProgram=n.handleAcceptProgram.bind(Object(V.a)(n)),n.handleAcceptCatCombo=n.handleAcceptCatCombo.bind(Object(V.a)(n)),n.handleClickNew=n.handleClickNew.bind(Object(V.a)(n)),n.handleAcceptNew=n.handleAcceptNew.bind(Object(V.a)(n)),n}return Object(P.a)(t,e),Object(w.a)(t,[{key:"handleOpenStartAgainWarning",value:function(){this.props.formInputInProgress?this.setState({openStartAgainWarning:!0}):this.props.onStartAgain()}},{key:"handleOpenOrgUnitWarning",value:function(){this.props.formInputInProgress?this.setState({openOrgUnitWarning:!0}):this.props.onResetOrgUnitId()}},{key:"handleOpenProgramWarning",value:function(e){this.props.formInputInProgress?this.setState({openProgramWarning:e}):this.props.onResetProgramId(e)}},{key:"handleOpenCatComboWarning",value:function(e){this.props.formInputInProgress?this.setState({openCatComboWarning:!0,categoryIdToReset:e}):this.props.onResetCategoryOption(e)}},{key:"handleClose",value:function(){this.setState({openStartAgainWarning:!1,openOrgUnitWarning:!1,openProgramWarning:null,openCatComboWarning:!1,openNewWarning:!1})}},{key:"handleAcceptStartAgain",value:function(){this.props.onStartAgain(),this.handleClose()}},{key:"handleAcceptOrgUnit",value:function(){this.props.onResetOrgUnitId(),this.handleClose()}},{key:"handleAcceptProgram",value:function(){this.props.onResetProgramId(this.state.openProgramWarning),this.handleClose()}},{key:"handleAcceptCatCombo",value:function(){this.props.onResetCategoryOption(this.state.categoryIdToReset),this.handleClose()}},{key:"handleClickNew",value:function(){this.props.formInputInProgress||this.props.onOpenNewEventPage(this.props.selectedProgramId,this.props.selectedOrgUnitId),this.setState({openNewWarning:!0})}},{key:"handleAcceptNew",value:function(){this.props.onOpenNewEventPage(this.props.selectedProgramId,this.props.selectedOrgUnitId),this.handleClose()}},{key:"render",value:function(){return m.a.createElement("div",null,m.a.createElement(Gc,{onSetOrgUnit:this.props.onSetOrgUnit,onResetOrgUnitId:this.handleOpenOrgUnitWarning,onSetProgramId:this.props.onSetProgramId,onResetProgramId:this.handleOpenProgramWarning,onSetCategoryOption:this.props.onSetCategoryOption,onResetCategoryOption:this.handleOpenCatComboWarning,onResetAllCategoryOptions:this.props.onResetAllCategoryOptions,onStartAgain:this.handleOpenStartAgainWarning,onClickNew:this.handleClickNew}),m.a.createElement(yA,null),m.a.createElement(Kf,Object.assign({onConfirm:this.handleAcceptStartAgain,open:this.state.openStartAgainWarning,onCancel:this.handleClose},EA)),m.a.createElement(Kf,Object.assign({onConfirm:this.handleAcceptOrgUnit,open:this.state.openOrgUnitWarning,onCancel:this.handleClose},EA)),m.a.createElement(Kf,Object.assign({onConfirm:this.handleAcceptProgram,open:!!this.state.openProgramWarning,onCancel:this.handleClose},EA)),m.a.createElement(Kf,Object.assign({onConfirm:this.handleAcceptCatCombo,open:this.state.openCatComboWarning,onCancel:this.handleClose},EA)),m.a.createElement(Kf,Object.assign({onConfirm:this.handleAcceptNew,open:this.state.openNewWarning,onCancel:this.handleClose},EA)))}}]),t}(f.Component),jA=Object(D.b)(function(e){return{selectedProgramId:e.currentSelections.programId,selectedOrgUnitId:e.currentSelections.orgUnitId,formInputInProgress:e.currentSelections.complete&&qf(e,"singleEvent-editEvent")}},function(e){return{onSetOrgUnit:function(t,n){e(function(e,t){return le(AI)({id:e,orgUnit:t})}(t,n))},onResetOrgUnitId:function(){e(VI())},onSetProgramId:function(t){e(function(e){return le(FI)(e)}(t))},onSetCategoryOption:function(t,n){e(function(e,t){return le(PI)({categoryId:e,categoryOptionId:t})}(t,n))},onResetCategoryOption:function(t){e(function(e){return le(DI)(e)}(t))},onResetAllCategoryOptions:function(){e(WI())},onOpenNewEventPage:function(t,n){e(function(e,t){return le(LI)({programId:e,orgUnitId:t})}(t,n))},onStartAgain:function(){e(Object(Le.batchActions)([VI(),GI(),WI(),jn()],MI))},onResetProgramId:function(t){e(Object(Le.batchActions)([GI(),WI(),t],BI))}}})(_A),IA=Object(D.b)(function(e){return{ready:!e.editEventPage.isLoading,error:e.editEventPage.loadError}},function(){return{}})(Ue()(Pe()(jA))),CA="ViewEventFromUrl",TA="EventFromUrlRetrievedForViewEvent",SA="EventFromUrlCouldNotBeRetrievedForViewEvent",RA="OrgUnitRetrievedForViewEventOnUrlUpdate",kA="OrgUnitRetrievalFailedForViewEventOnUrlUpdate",NA="StartOpenEventForView",AA="AddEventNoteForViewEvent",wA="RemoveEventNoteForViewEvent",FA="UpdateWorkingListOnBackToMainPageForViewEvent",xA="NoWorkingListUpdateNeededOnBackToMainPageForViewEvent",PA="StartGoBackToMainPageForViewEvent",DA="ViewEventOpenAddRelationship",UA="UpdateEventContainerForViewEvent",LA="UpdateWorkingListPendingOnBackToMainPageForViewEvent",MA="OpenViewEventPageFailed",BA=function(e){return le(SA)(e)},VA=function(){return le(xA)()},GA=function(){return le(FA)()},WA=function(e,t){return le(UA)({eventContainer:e,orgUnit:t})},HA=function(e){return le(MA)({error:e})},zA="BASICINFO",KA="STATUS",YA={errorMessage:"validationError"},qA={labelContainerStyle:{flexBasis:200},inputContainerStyle:{flexBasis:150}},XA={labelContainerStyle:{width:150},inputContainerStyle:{width:150}};function ZA(e){e.formHorizontal,e.fieldOptions,e.validationError,e.modified;return Object(Fe.a)(e,["formHorizontal","fieldOptions","validationError","modified"])}var JA,QA=function(e,t){return Object(se.a)({},function(e){return{fieldOptions:e.fieldOptions,formHorizontal:e.formHorizontal,styles:e.formHorizontal?XA:qA}}(e),t)},$A=$i(YA)(Ia()(pc()(fc()(vc({onGetUseVerticalOrientation:function(e){return e.formHorizontal},onGetCustomFieldLabeClass:function(e){return"".concat(e.fieldOptions.fieldLabelMediaBasedClass," ").concat(hN.a.coordinateLabel)}})(uc()(Ya()(mc(ZA)(Ti)))))))),ew=$i(YA)(Ia()(pc()(fc()(vc({onGetUseVerticalOrientation:function(e){return e.formHorizontal},onGetCustomFieldLabeClass:function(e){return"".concat(e.fieldOptions.fieldLabelMediaBasedClass," ").concat(hN.a.polygonLabel)}})(uc()(Ya()(mc(ZA)(ki)))))))),tw={onIsCompleting:function(e){return e.completeDataEntryFieldValue},onFilterProps:function(e){e.completeDataEntryFieldValue;return Object(Fe.a)(e,["completeDataEntryFieldValue"])}},nw=Dh()(Vf),aw=Pm({isApplicable:function(e){var t=e.formFoundation.featureType;return["Polygon","Point"].includes(t)},getComponent:function(e){return"Polygon"===e.formFoundation.featureType?ew:$A},getComponentProps:function(e){var t=e.formFoundation.featureType;return QA(e,"Polygon"===t?{width:e&&e.formHorizontal?150:350,label:c.a.t("Area"),dialogLabel:c.a.t("Area"),required:!1}:{width:e&&e.formHorizontal?150:"100%",label:c.a.t("Coordinate"),dialogLabel:c.a.t("Coordinate"),required:!1})},getPropName:function(){return"geometry"},getValidatorContainers:function(){return[]},getMeta:function(){return{placement:df,section:zA}}})(nw),rw=am(function(){var e=$i(YA)(Ia()(pc()(fc()(vc({onGetUseVerticalOrientation:function(e){return e.formHorizontal},onGetCustomFieldLabeClass:function(e){return"".concat(e.fieldOptions.fieldLabelMediaBasedClass," ").concat(hN.a.dateLabel)}})(uc()(Ya()(mc(ZA)(yi))))))));return{getComponent:function(){return e},getComponentProps:function(e){return QA(e,{width:"100%",calendarWidth:350,label:e.formFoundation.getLabel("eventDate"),required:!0})},getPropName:function(){return"eventDate"},getValidatorContainers:function(){return sN()},getMeta:function(){return{placement:df,section:zA}}}}())(aw),ow=Zm(tw)(fN()(rw)),iw=Zf(function(){return{color:"primary"}})(ow),cw=am(function(){var e=$i(YA)(Ia()(pc()(fc()(vc({onGetUseVerticalOrientation:function(e){return e.formHorizontal},onGetCustomFieldLabeClass:function(e){return"".concat(e.fieldOptions.fieldLabelMediaBasedClass," ").concat(hN.a.trueOnlyLabel)}})(uc()(Ya()(ui)))))));return{getComponent:function(){return e},getComponentProps:function(e){return QA(e,{label:"Complete event",id:"complete"})},getPropName:function(){return"complete"},getValidatorContainers:function(){return[]},getMeta:function(){return{placement:pf,section:KA}},getPassOnFieldData:function(){return!0}}}())(iw),sw=Lm()(cw),lw=(jN={},Object(Ut.a)(jN,zA,{placement:df,name:c.a.t("Basic info")}),Object(Ut.a)(jN,KA,{placement:pf,name:c.a.t("Status")}),jN),uw=function(e){function t(e){var n;return Object(A.a)(this,t),(n=Object(F.a)(this,Object(x.a)(t).call(this,e))).fieldOptions={theme:e.theme,fieldLabelMediaBasedClass:e.classes.fieldLabelMediaBased},n.dataEntrySections=lw,n}return Object(P.a)(t,e),Object(w.a)(t,[{key:"componentWillUnmount",value:function(){Ys.clear()}},{key:"render",value:function(){var e=this.props,t=e.onUpdateField,n=e.onStartAsyncUpdateField,a=(e.classes,Object(Fe.a)(e,["onUpdateField","onStartAsyncUpdateField","classes"]));return m.a.createElement(sw,Object.assign({id:"singleEvent",onUpdateFormField:t,onUpdateFormFieldAsync:n,fieldOptions:this.fieldOptions,dataEntrySections:this.dataEntrySections},a))}}]),t}(f.Component),dw=Object(E.withStyles)(function(e){return{dataEntryContainer:{},fieldLabelMediaBased:Object(Ut.a)({},e.breakpoints.down(523),{paddingTop:"0px !important"})}})(uw),pw="StartSaveEditEventDataEntryBatchForViewSingleEvent",fw="CancelEditEventDataEntryForViewSingleEvent",mw="RequestSaveEditEventDataEntryForViewSingleEvent",hw="StartSaveEditEventDataEntryForViewSingleEvent",bw="EditEventDataEntrySavedForViewSingleEvent",gw="SaveEditEventDataEntryFailedForViewSingleEvent",Ow="PrerequisitesErrorLoadingEditEventDataEntryForViewSingleEvent",vw=function(e,t,n){return le(hw)({selections:n},{offline:{effect:{url:"events/".concat(e),method:Ub,data:t},commit:{type:bw,meta:{selections:n,eventId:e}},rollback:{type:gw,meta:{selections:n,eventId:e}}}})},yw="StartShowEditEventDataEntryForViewSingleEvent",Ew="ShowEditEventDataEntryForViewSingleEvent",_w="singleEvent",jw="viewEvent",Iw=Object(D.b)(function(e){var t=e.viewEventPage.eventDetailsSection||{};return{ready:!e.viewEventPage.dataEntryIsLoading&&!t.loading}},function(e){return{onUpdateDataEntryField:function(t){var n=t.payload,a=n.dataEntryId,r=n.itemId,o=Xc()();e(Object(Le.batchActions)([t,Uf(a,r,o),dA(Object(se.a)({},t.payload,{uid:o}))],WN))},onUpdateField:function(t){var n=t.payload,a=n.dataEntryId,r=n.itemId,o=Xc()();e(Object(Le.batchActions)([t,Uf(a,r,o),dA(Object(se.a)({},t.payload,{uid:o}))],HN))},onAddNote:function(t,n,a){e(hA(t,n,a))},onStartAsyncUpdateField:function(t,n,a){e(mA(t,function(e){var t=Xc()();return Object(Le.batchActions)([e,Uf(n,a,t),dA(Object(se.a)({},e.payload,{dataEntryId:n,itemId:a,uid:t}))],HN)},function(e){return e}))},onSave:function(t,n,a){window.scrollTo(0,0),e(function(e,t,n){return le(mw)({itemId:e,dataEntryId:t,formFoundation:n},{skipLogging:["formFoundation"]})}(t,n,a))},onCancel:function(){var t,n,a;window.scrollTo(0,0),e(Object(Le.batchActions)([le(fw)(),(t=_w,n=jw,le(Af)({dataEntryId:t,itemId:n,extraProps:a}))]))}}})(Ue()(dw)),Cw=n(1497),Tw=n.n(Cw),Sw=Object(ze.d)(bd,nd),Rw="BASICINFO",kw="STATUS",Nw="COMMENTS",Aw={labelContainerStyle:{flexBasis:200},inputContainerStyle:{flexBasis:150}},ww={labelContainerStyle:{width:150},inputContainerStyle:{width:150}};var Fw,xw,Pw=function(e,t){return Object(se.a)({},function(e){return{fieldOptions:e.fieldOptions,formHorizontal:e.formHorizontal,styles:e.formHorizontal?ww:Aw}}(e),t)},Dw=pc()(vc({onGetUseVerticalOrientation:function(e){return e.formHorizontal},onGetCustomFieldLabeClass:function(e){return"".concat(e.fieldOptions.fieldLabelMediaBasedClass," ").concat(Tw.a.defaultViewLabel)}})(mc(function(e){return e.formHorizontal,e.fieldOptions,e.validationError,e.modified,Object(Fe.a)(e,["formHorizontal","fieldOptions","validationError","modified"])})(Gi))),Uw=Dh()(Vf),Lw=Pm({isApplicable:function(e){var t=e.formFoundation.featureType;return["Polygon","Point"].includes(t)},getComponent:function(){return Dw},getComponentProps:function(e){if("Polygon"===e.formFoundation.featureType)return Pw(e,{label:c.a.t("Area"),valueConverter:function(e){return e?"Polygon captured":"No polygon captured"}});var t=new ut(function(e){e.id="geometry",e.type=ct.COORDINATE});return Pw(e,{label:"Coordinate",valueConverter:function(e){return t.convertValue(e,Sw)}})},getPropName:function(){return"geometry"},getValidatorContainers:function(){return[]},getMeta:function(){return{placement:df,section:Rw}}})(Uw),Mw=am(function(){var e=new ut(function(e){e.id="eventDate",e.type=ct.DATE});return{getComponent:function(){return Dw},getComponentProps:function(t){return Pw(t,{label:t.formFoundation.getLabel(e.id),valueConverter:function(t){return e.convertValue(t,Sw)}})},getPropName:function(){return e.id},getMeta:function(){return{placement:df,section:Rw}}}}())(Lw),Bw=am(function(){var e=new ut(function(e){e.id="complete",e.type=ct.BOOLEAN});return{getComponent:function(){return Dw},getComponentProps:function(t){return Pw(t,{label:"Event completed",id:e.id,valueConverter:function(t){return e.convertValue(t,Sw)}})},getPropName:function(){return e.id},getMeta:function(){return{placement:pf,section:kw}},passOnFieldData:!0}}())(Mw),Vw=Lm()(Bw),Gw=(JA={},Object(Ut.a)(JA,Rw,{placement:df,name:c.a.t("Basic info")}),Object(Ut.a)(JA,kw,{placement:pf,name:c.a.t("Status")}),Object(Ut.a)(JA,Nw,{placement:pf,name:c.a.t("Comments")}),JA),Ww=function(e){function t(e){var n;return Object(A.a)(this,t),(n=Object(F.a)(this,Object(x.a)(t).call(this,e))).fieldOptions={theme:e.theme,fieldLabelMediaBasedClass:e.classes.fieldLabelMediaBased},n.dataEntrySections=Gw,n}return Object(P.a)(t,e),Object(w.a)(t,[{key:"render",value:function(){var e=this.props,t=(e.classes,Object(Fe.a)(e,["classes"]));return m.a.createElement(Vw,Object.assign({id:"singleEvent",viewMode:!0,fieldOptions:this.fieldOptions,dataEntrySections:this.dataEntrySections},t))}}]),t}(f.Component),Hw=Object(E.withStyles)(function(e){return{header:Object(se.a)({},e.typography.title,{fontSize:18,padding:e.typography.pxToRem(10),borderBottom:"1px solid ".concat(e.palette.grey.blueGrey)}),paper:{maxWidth:e.typography.pxToRem(1070)},container:{flexGrow:3},content:{display:"flex"},dataEntryContainer:{flexGrow:1,padding:e.typography.pxToRem(10)},dataEntryActionsContainer:{padding:e.typography.pxToRem(10),paddingTop:e.typography.pxToRem(30)},button:{whiteSpace:"nowrap"},fieldLabelMediaBased:Object(Ut.a)({},e.breakpoints.down(523),{paddingTop:"0px !important"})}})(Ww),zw=Object(D.b)(function(e){var t=e.viewEventPage.eventDetailsSection||{};return{ready:!e.viewEventPage.dataEntryIsLoading&&!t.loading}},function(){return{}})(Ue()(Hw)),Kw=function(e){function t(){var e,n;Object(A.a)(this,t);for(var a=arguments.length,r=new Array(a),o=0;o<a;o++)r[o]=arguments[o];return(n=Object(F.a)(this,(e=Object(x.a)(t)).call.apply(e,[this].concat(r)))).renderDataEntryContainer=function(){var e=n.props,t=e.classes,a=(e.onOpenEditEvent,e.showEditEvent),r=e.programStage,o=(e.eventAccess,Object(Fe.a)(e,["classes","onOpenEditEvent","showEditEvent","programStage","eventAccess"])),i=r.stageForm;return m.a.createElement("div",{className:t.dataEntryContainer},a?m.a.createElement(Iw,Object.assign({formFoundation:i},o)):m.a.createElement(zw,Object.assign({formFoundation:i},o)))},n.renderActionsContainer=function(){var e=n.props,t=e.classes,a=e.onOpenEditEvent,r=e.showEditEvent,o=e.eventAccess.write;return m.a.createElement("div",{className:t.actionsContainer},!r&&m.a.createElement(Si.j,{title:o?"":c.a.t("You dont have access to edit this event")},m.a.createElement("div",{className:t.editButtonContainer},m.a.createElement(Yc,{className:t.button,variant:"raised",onClick:a,disabled:!o},c.a.t("Edit event")))))},n}return Object(P.a)(t,e),Object(w.a)(t,[{key:"render",value:function(){var e=this.props.classes;return m.a.createElement("div",{className:e.container},m.a.createElement(l_,{header:m.a.createElement(d_,{text:"Event details",icon:Di.h})},m.a.createElement("div",{className:e.content},this.renderDataEntryContainer(),this.renderActionsContainer())))}}]),t}(f.Component),Yw=Object(E.withStyles)(function(e){return{container:{flexGrow:2,flexBasis:0},content:{display:"flex"},dataEntryContainer:{flexGrow:1,padding:e.typography.pxToRem(10)},actionsContainer:{minWidth:e.typography.pxToRem(128),padding:e.typography.pxToRem(10),paddingTop:e.typography.pxToRem(30)},button:{whiteSpace:"nowrap"},editButtonContainer:{display:"inline-block"}}})(Kw),qw=Object(D.b)(function(e){return{showEditEvent:e.viewEventPage.eventDetailsSection&&e.viewEventPage.eventDetailsSection.showEditEvent}},function(e){return{onOpenEditEvent:function(){e(le(yw)())}}})(Yw),Xw=Object(D.b)(function(){var e=v_();return function(t,n){var a=t.rulesEffectsGeneralErrors[n.dataEntryKey];return{errors:e({messagesContainer:a,containerPropNameMain:"error",containerPropNameOnComplete:"errorOnComplete",showOnComplete:!0})}}},function(){return{}})(m_),Zw=Object(D.b)(function(){var e=v_();return function(t,n){var a=t.rulesEffectsGeneralWarnings[n.dataEntryKey];return{warnings:e({messagesContainer:a,containerPropNameMain:"warning",containerPropNameOnComplete:"warningOnComplete",showOnComplete:!0})}}},function(){return{}})(j_),Jw=Ue(null,function(e){return{style:e.loadingIndicatorStyle}})(bm),Qw={height:36,width:36},$w=c.a.t("Relationships"),eF=function(e){function t(){var e,n;Object(A.a)(this,t);for(var a=arguments.length,r=new Array(a),o=0;o<a;o++)r[o]=arguments[o];return(n=Object(F.a)(this,(e=Object(x.a)(t)).call.apply(e,[this].concat(r)))).renderHeader=function(){var e=n.props,t=e.classes,a=e.relationships,r=e.ready,o=a?a.length:0;return o=r?o:null,f.createElement(d_,{icon:Di.i,text:$w,badgeClass:t.badge,badgeCount:o})},n.handleOpenAddRelationship=function(){n.props.onOpenAddRelationship()},n.handleRemoveRelationship=function(e){n.props.onDeleteRelationship(e)},n.renderItems=function(e){return e.map(function(e){return f.createElement("div",{className:n.props.classes.relationship},e)})},n}return Object(P.a)(t,e),Object(w.a)(t,[{key:"render",value:function(){var e=this.props,t=e.programStage,n=e.eventId,a=e.relationships,r=e.ready,o=e.eventAccess,i=(t.relationshipTypes||[]).length>0,c=t.relationshipTypesWhereStageIsFrom.filter(function(e){return e.access.data.write});return i&&f.createElement(l_,{collapsable:!0,header:this.renderHeader()},f.createElement(Jw,{loadingIndicatorStyle:Qw,ready:r,relationships:a,writableRelationshipTypes:c,onOpenAddRelationship:this.handleOpenAddRelationship,onRemoveRelationship:this.handleRemoveRelationship,currentEntityId:n,entityAccess:o}))}}]),t}(f.Component),tF=Object(E.withStyles)(function(e){return{badge:{backgroundColor:e.palette.grey.light},relationship:{marginTop:e.typography.pxToRem(5),marginBottom:e.typography.pxToRem(5),padding:e.typography.pxToRem(10),borderRadius:e.typography.pxToRem(4),backgroundColor:e.palette.grey.lighter}}})(eF),nF="LoadEventRelationshipsBatch",aF="SaveEventRelationshipBatch",rF="DeleteEventRelationshipBatch",oF="EventRelationshipsLoaded",iF="EventCancelNewRelationship",cF="RequestAddEventRelationship",sF="StartSaveEventRelationship",lF="EventRelationshipSaved",uF="SaveFailedForEventRelationship",dF="EventRelationshipAlreadyExists",pF="StartDeleteEventRelationship",fF="EventRelationshipDeleted",mF="DeleteFailedForEventRelationship",hF="RequestDeleteEventRelationship",bF="EventRelationshipNewTeiSave",gF="EventRelationshipNewTeiSaveSuccess",OF="EventRelationshipNewTeiSaveFailed",vF=function(e,t,n){return le(sF)({selections:t},{offline:{effect:{url:"relationships",method:Db,data:e,clientId:n},commit:{type:lF,meta:{selections:t,clientId:n}},rollback:{type:uF,meta:{selections:t,clientId:n}}}})},yF=function(e,t,n){if("SaveFailedForEventRelationship"===n.type)return null;var a=n.payload.response.importSummaries[0].reference;return e.meta.offline.effect.url="relationships/".concat(a),e},EF=function(e,t,n){return le(pF)({selections:n},{offline:{effect:{url:e?"relationships/".concat(e):null,method:Lb,clientId:t,updateOnDequeueCallback:yF.toString()},commit:{type:fF,meta:{selections:n,clientId:t}},rollback:{type:mF,meta:{selections:n,clientId:t}}}})},_F=Object(D.b)(function(e,t){var n=e.viewEventPage.relationshipsSection||{};return{eventId:e.viewEventPage.eventId,ready:!n.isLoading,relationships:e.relationships.viewEvent||[]}},function(e){return{onOpenAddRelationship:function(){e(le(DA)())},onDeleteRelationship:function(t){e(function(e){return le(hF)({clientId:e})}(t))}}})(tF),jF=Ue(null,function(e){return{style:e.loadingIndicatorStyle}})(lm),IF={height:36,width:36},CF=c.a.t("Comments"),TF=function(e){function t(){var e,n;Object(A.a)(this,t);for(var a=arguments.length,r=new Array(a),o=0;o<a;o++)r[o]=arguments[o];return(n=Object(F.a)(this,(e=Object(x.a)(t)).call.apply(e,[this].concat(r)))).renderHeader=function(){var e=n.props,t=e.classes,a=e.notes,r=e.ready,o=a?a.length:0;return o=r?o:null,f.createElement(d_,{icon:Di.e,text:CF,badgeClass:t.badge,badgeCount:o})},n}return Object(P.a)(t,e),Object(w.a)(t,[{key:"render",value:function(){var e=this.props,t=e.notes,n=e.fieldValue,a=e.onAddNote,r=e.ready,o=e.programStage,i=e.eventAccess;return f.createElement(l_,{collapsable:!0,header:this.renderHeader()},f.createElement(jF,{loadingIndicatorStyle:IF,ready:r,notes:t,entityAccess:i,addNotAllowed:!o.stageForm.access.data.write,onAddNote:a,onBlur:this.props.onUpdateNoteField,value:n}))}}]),t}(f.Component),SF=Object(E.withStyles)(function(e){return{badge:{backgroundColor:e.palette.grey.light},note:{marginTop:e.typography.pxToRem(5),marginBottom:e.typography.pxToRem(5),padding:e.typography.pxToRem(10),borderRadius:e.typography.pxToRem(4),backgroundColor:e.palette.grey.lighter}}})(TF),RF="LoadEventNotesBatch",kF="SaveEventNoteBatch",NF="EventNotesLoaded",AF="RequestSaveEventNote",wF="StartSaveEventNote",FF="SaveEventNoteFailed",xF="EventNoteSaved",PF="UpdateEventNoteField",DF=function(e,t,n,a){return le(wF)({selections:n,clientId:a},{offline:{effect:{url:"events/".concat(e,"/note"),method:Db,data:t},commit:{type:xF,meta:{selections:n,clientId:a}},rollback:{type:FF,meta:{selections:n,clientId:a}}}})},UF=[{id:"ErrorsSection",Component:Xw},{id:"WarningsSection",Component:Zw},{id:"FeedbacksSection",Component:Q_},{id:"IndicatorsSection",Component:nj},{id:"RelationshipsSection",Component:_F},{id:"NotesSection",Component:Object(D.b)(function(e,t){var n=e.viewEventPage.notesSection||{};return{notes:e.notes.viewEvent||[],ready:!n.isLoading,fieldValue:n.fieldValue}},function(e){return{onAddNote:function(t){e(function(e){return le(AF)({note:e})}(t))},onUpdateNoteField:function(t){e(function(e){return le(PF)({value:e})}(t))}}})(SF)}],LF=function(e){function t(){var e,n;Object(A.a)(this,t);for(var a=arguments.length,r=new Array(a),o=0;o<a;o++)r[o]=arguments[o];return(n=Object(F.a)(this,(e=Object(x.a)(t)).call.apply(e,[this].concat(r)))).renderComponent=function(e,t){return f.createElement(e.Component,Object.assign({key:e.id},t))},n}return Object(P.a)(t,e),Object(w.a)(t,[{key:"render",value:function(){var e=this,t=this.props,n=(t.classes,Object(Fe.a)(t,["classes"]));return f.createElement("div",{className:this.props.classes.container},UF.map(function(t){return e.renderComponent(t,n)}))}}]),t}(f.Component),MF=Object(E.withStyles)(function(e){return{container:{flexBasis:e.typography.pxToRem(0),flexGrow:1,minWidth:e.typography.pxToRem(300)}}})(LF),BF=function(e){function t(e){var n;return Object(A.a)(this,t),(n=Object(F.a)(this,Object(x.a)(t).call(this,e))).handleGoBackToAllEvents=function(){n.props.onBackToAllEvents()},n.state={discardWarningOpen:!1},n}return Object(P.a)(t,e),Object(w.a)(t,[{key:"render",value:function(){var e=this.props,t=e.classes,n=e.programStage,a=e.currentDataEntryKey,r=e.eventAccess;return m.a.createElement("div",{className:t.container},m.a.createElement(Yc,{className:t.showAllEvents,variant:"raised",onClick:this.handleGoBackToAllEvents},m.a.createElement(Hc.a,null),c.a.t("Show all events")),m.a.createElement("div",{className:t.contentContainer},m.a.createElement(qw,{eventAccess:r,programStage:n}),m.a.createElement(MF,{eventAccess:r,programStage:n,dataEntryKey:a})))}}]),t}(f.Component),VF=Object(E.withStyles)(function(e){return{container:{padding:e.typography.pxToRem(24),paddingTop:e.typography.pxToRem(10)},dataEntryPaper:{marginBottom:e.typography.pxToRem(10),padding:e.typography.pxToRem(10)},showAllEvents:{paddingLeft:8,marginBottom:10,textTransform:"none",backgroundColor:"#E9EEF4",boxShadow:"none",color:"#494949",fontSize:14,fontWeight:"normal"},header:Object(se.a)({},e.typography.title,{fontSize:18,padding:e.typography.pxToRem(10),borderBottom:"1px solid ".concat(e.palette.grey.blueGrey)}),contentContainer:{display:"flex",flexWrap:"wrap"}}})(BF),GF=function(e){return e.currentSelections.programId},WF=function(e){return e.currentSelections.categories},HF=Object(D.b)(function(){var e=Object(nl.createSelector)(GF,function(e){return Et(e).getStageThrowIfNull()}),t=Object(nl.createSelector)(GF,WF,function(e,t){return _t(e,t)});return function(n){var a=n.viewEventPage.eventDetailsSection||{};return{programStage:e(n),eventAccess:t(n),error:n.viewEventPage.loadError,currentDataEntryKey:a.showEditEvent?ff(sA,lA):ff(_w,jw)}}},function(e){return{onBackToAllEvents:function(){e(le(PA)())}}})(Pe()(VF)),zF=function(e){function t(e){var n;return Object(A.a)(this,t),(n=Object(F.a)(this,Object(x.a)(t).call(this,e))).handleDiscard=function(){n.setState({discardDialogOpen:!0})},n.handleCancelDiscard=function(){n.setState({discardDialogOpen:!1})},n.renderHeader=function(){return f.createElement("div",{className:n.props.classes.headerContainer},f.createElement("div",{className:n.props.classes.header},c.a.t("New event relationship")))},n.state={discardDialogOpen:!1},n}return Object(P.a)(t,e),Object(w.a)(t,[{key:"render",value:function(){var e=this.props,t=e.classes,n=(e.onCancel,Object(Fe.a)(e,["classes","onCancel"]));return f.createElement("div",{className:t.container},f.createElement("div",{className:t.backToEventContainer},f.createElement("span",null,c.a.t("Adding relationship to event.")),f.createElement(Tn,{className:t.backToEventButton,onClick:this.handleDiscard},c.a.t("Go back to event without saving relationship"))),f.createElement(Be.a,{className:t.newRelationshipPaper},f.createElement(Wj,Object.assign({header:c.a.t("New event relationship")},n))),f.createElement(Kf,{header:c.a.t("Unsaved changes"),text:c.a.t("Leaving this page will discard any selections you made for a new relationship"),confirmText:c.a.t("Yes, discard"),cancelText:c.a.t("No, stay here"),onConfirm:this.props.onCancel,open:!!this.state.discardDialogOpen,onCancel:this.handleCancelDiscard}))}}]),t}(f.Component),KF=Ii()(function(e){return{container:{padding:"".concat(e.typography.pxToRem(10)," ").concat(e.typography.pxToRem(24))},headerContainer:{display:"flex",justifyContent:"space-between",alignItems:"center"},header:Object(se.a)({flexGrow:1},e.typography.title,{fontSize:18,fontWeight:500,paddingLeft:8}),newRelationshipPaper:{marginBottom:e.typography.pxToRem(10),padding:e.typography.pxToRem(10)},backToEventContainer:{padding:8,borderRadius:4,display:"inline-block",marginBottom:10,backgroundColor:"#E9EEF4",color:"#494949",fontSize:14},backToEventButton:{backgroundColor:"inherit",fontSize:"inherit",color:"inherit"}}})(zF),YF=function(e){return e.currentSelections.programId},qF=Object(D.b)(function(){var e=Object(nl.createSelector)(YF,function(e){return Et(e).getStageThrowIfNull().relationshipTypesWhereStageIsFrom.filter(function(e){return"TRACKED_ENTITY_INSTANCE"===e.to.entity})});return function(t){return{relationshipTypes:e(t)}}},function(e){return{onCancel:function(){e(le(iF)({}))},onAddRelationship:function(t,n,a){e(function(e,t,n){return le(cF)({relationshipType:e,entity:t,entityType:n})}(t,n,a))}}})(KF),XF={header:c.a.t("Unsaved changes"),text:c.a.t("Leaving this page will discard the changes you made to this event."),confirmText:c.a.t("Yes, discard"),cancelText:c.a.t("No, stay here")},ZF=function(e){function t(e){var n;return Object(A.a)(this,t),(n=Object(F.a)(this,Object(x.a)(t).call(this,e))).state={openStartAgainWarning:!1,openOrgUnitWarning:!1,openProgramWarning:null,openCatComboWarning:!1,categoryIdToReset:"",openNewWarning:!1},n.handleOpenStartAgainWarning=n.handleOpenStartAgainWarning.bind(Object(V.a)(n)),n.handleOpenOrgUnitWarning=n.handleOpenOrgUnitWarning.bind(Object(V.a)(n)),n.handleOpenProgramWarning=n.handleOpenProgramWarning.bind(Object(V.a)(n)),n.handleOpenCatComboWarning=n.handleOpenCatComboWarning.bind(Object(V.a)(n)),n.handleClose=n.handleClose.bind(Object(V.a)(n)),n.handleAcceptStartAgain=n.handleAcceptStartAgain.bind(Object(V.a)(n)),n.handleAcceptOrgUnit=n.handleAcceptOrgUnit.bind(Object(V.a)(n)),n.handleAcceptProgram=n.handleAcceptProgram.bind(Object(V.a)(n)),n.handleAcceptCatCombo=n.handleAcceptCatCombo.bind(Object(V.a)(n)),n.handleClickNew=n.handleClickNew.bind(Object(V.a)(n)),n.handleAcceptNew=n.handleAcceptNew.bind(Object(V.a)(n)),n}return Object(P.a)(t,e),Object(w.a)(t,[{key:"handleOpenStartAgainWarning",value:function(){this.props.formInputInProgress?this.setState({openStartAgainWarning:!0}):this.props.onStartAgain()}},{key:"handleOpenOrgUnitWarning",value:function(){this.props.formInputInProgress?this.setState({openOrgUnitWarning:!0}):this.props.onResetOrgUnitId()}},{key:"handleOpenProgramWarning",value:function(e){this.props.formInputInProgress?this.setState({openProgramWarning:e}):this.props.onResetProgramId(e)}},{key:"handleOpenCatComboWarning",value:function(e){this.props.formInputInProgress?this.setState({openCatComboWarning:!0,categoryIdToReset:e}):this.props.onResetCategoryOption(e)}},{key:"handleClose",value:function(){this.setState({openStartAgainWarning:!1,openOrgUnitWarning:!1,openProgramWarning:null,openCatComboWarning:!1,openNewWarning:!1})}},{key:"handleAcceptStartAgain",value:function(){this.props.onStartAgain(),this.handleClose()}},{key:"handleAcceptOrgUnit",value:function(){this.props.onResetOrgUnitId(),this.handleClose()}},{key:"handleAcceptProgram",value:function(){this.props.onResetProgramId(this.state.openProgramWarning),this.handleClose()}},{key:"handleAcceptCatCombo",value:function(){this.props.onResetCategoryOption(this.state.categoryIdToReset),this.handleClose()}},{key:"handleClickNew",value:function(){this.props.formInputInProgress||this.props.onOpenNewEventPage(this.props.selectedProgramId,this.props.selectedOrgUnitId),this.setState({openNewWarning:!0})}},{key:"handleAcceptNew",value:function(){this.props.onOpenNewEventPage(this.props.selectedProgramId,this.props.selectedOrgUnitId),this.handleClose()}},{key:"render",value:function(){return m.a.createElement("div",null,m.a.createElement(Gc,{onSetOrgUnit:this.props.onSetOrgUnit,onResetOrgUnitId:this.handleOpenOrgUnitWarning,onSetProgramId:this.props.onSetProgramId,onResetProgramId:this.handleOpenProgramWarning,onSetCategoryOption:this.props.onSetCategoryOption,onResetCategoryOption:this.handleOpenCatComboWarning,onResetAllCategoryOptions:this.props.onResetAllCategoryOptions,onStartAgain:this.handleOpenStartAgainWarning,onClickNew:this.handleClickNew}),this.props.showAddRelationship?m.a.createElement(qF,null):m.a.createElement(HF,null),m.a.createElement(Kf,Object.assign({onConfirm:this.handleAcceptStartAgain,open:this.state.openStartAgainWarning,onCancel:this.handleClose},XF)),m.a.createElement(Kf,Object.assign({onConfirm:this.handleAcceptOrgUnit,open:this.state.openOrgUnitWarning,onCancel:this.handleClose},XF)),m.a.createElement(Kf,Object.assign({onConfirm:this.handleAcceptProgram,open:!!this.state.openProgramWarning,onCancel:this.handleClose},XF)),m.a.createElement(Kf,Object.assign({onConfirm:this.handleAcceptCatCombo,open:this.state.openCatComboWarning,onCancel:this.handleClose},XF)),m.a.createElement(Kf,Object.assign({onConfirm:this.handleAcceptNew,open:this.state.openNewWarning,onCancel:this.handleClose},XF)))}}]),t}(f.Component),JF=Object(D.b)(function(e){var t=e.viewEventPage.eventDetailsSection||{},n=e.currentSelections.complete&&t.showEditEvent&&qf(e,"singleEvent-editEvent");return{selectedProgramId:e.currentSelections.programId,selectedOrgUnitId:e.currentSelections.orgUnitId,formInputInProgress:n,showAddRelationship:e.viewEventPage.showAddRelationship}},function(e){return{onSetOrgUnit:function(t,n){e(function(e,t){return le(HI)({id:e,orgUnit:t})}(t,n))},onResetOrgUnitId:function(){e(eC())},onSetProgramId:function(t){e(function(e){return le(KI)(e)}(t))},onSetCategoryOption:function(t,n){e(function(e,t){return le(qI)({categoryId:e,categoryOptionId:t})}(t,n))},onResetCategoryOption:function(t){e(function(e){return le(XI)(e)}(t))},onResetAllCategoryOptions:function(){e(nC())},onOpenNewEventPage:function(t,n){e(function(e,t){return le(JI)({programId:e,orgUnitId:t})}(t,n))},onStartAgain:function(){e(Object(Le.batchActions)([eC(),tC(),nC(),jn()],QI))},onResetProgramId:function(t){e(Object(Le.batchActions)([tC(),nC(),t],$I))}}})(ZF),QF=Object(D.b)(function(e){return{ready:!e.viewEventPage.isLoading,error:e.viewEventPage.loadError}},function(){return{}})(Ue()(Pe()(JF))),$F=function(e){function t(){return Object(A.a)(this,t),Object(F.a)(this,Object(x.a)(t).apply(this,arguments))}return Object(P.a)(t,e),Object(w.a)(t,[{key:"render",value:function(){var e=this.props.classes,t=_e();return m.a.createElement("div",{className:e.app},m.a.createElement(ge.a,{d2:t},m.a.createElement(we,null)),m.a.createElement("div",{className:e.pageContainer},m.a.createElement(me.a,null,m.a.createElement(he.a,{path:"/newEvent",component:yI}),m.a.createElement(he.a,{path:"/editEvent",component:IA}),m.a.createElement(he.a,{path:"/viewEvent",component:QF}),m.a.createElement(he.a,{path:"/newEnrollment",component:tT}),m.a.createElement(he.a,{path:"/:keys",component:iN}),m.a.createElement(he.a,{path:"/",component:iN}))))}}]),t}(f.Component),ex=Object(E.withStyles)(function(e){return{app:{fontFamily:e.typography.fontFamily,fontSize:e.typography.pxToRem(16)},pageContainer:{paddingTop:48}}})($F),tx=Object(nl.createSelector)(function(e){return e.currentSelections.programId},function(e){return e.currentSelections.orgUnitId},function(e){return e.editEventPage.eventId},function(e){return e.viewEventPage.eventId},function(e,t,n,a){return{programId:e,orgUnitId:t,eventId:n,viewEventId:a}}),nx="UpdateMainSelections",ax="MainSelectionsCompleted",rx="WorkingListDataRetrieved",ox="WorkingListDataRetrievalFailed",ix="OrgUnitDataRetrived",cx="UpdateMainSelectionsFromUrl",sx="SetOrgUnitBasedOnUrl",lx="InvalidOrgUnitFromUrl",ux="ErrorRetrievingOrgUnitBasedOnUrl",dx="SetEmptyOrgUnitBasedOnUrl",px="InvalidSelectionsFromUrl",fx="ValidSelectionsFromUrl",mx=function(e){return le(px)(e)},hx="EditEventFromUrl",bx="EventFromUrlRetrievedForEditEvent",gx="EventFromUrlCouldNotBeRetrievedForEditEvent",Ox="OrgUnitRetrievedForEditEventOnUrlUpdate",vx="OrgUnitRetrievalFailedForEditEventOnUrlUpdate",yx="StartOpenEventForEditInDataEntry",Ex="AddEventNote",_x="RemoveEventNote",jx=function(e){return le(gx)(e)},Ix=function(e,t){return le(Ex)({eventId:e,note:t})},Cx=function(e,t){return le(_x)({eventId:e,noteClientId:t})},Tx="ENTIRE_PARAM_STRING",Sx={MAIN:"main",NEW_EVENT:"newEvent",EDIT_EVENT:"editEvent",VIEW_EVENT:"viewEvent",NEW_ENROLLMENT:"newEnrollment"},Rx=(Fw={},Object(Ut.a)(Fw,Sx.MAIN,[{urlKey:"programId",propKey:"programId"},{urlKey:"orgUnitId",propKey:"orgUnitId"}]),Object(Ut.a)(Fw,Sx.NEW_EVENT,[{urlKey:"programId",propKey:"programId"},{urlKey:"orgUnitId",propKey:"orgUnitId"}]),Object(Ut.a)(Fw,Sx.EDIT_EVENT,[{urlKey:Tx,propKey:"eventId"}]),Object(Ut.a)(Fw,Sx.VIEW_EVENT,[{urlKey:Tx,propKey:"viewEventId"}]),Object(Ut.a)(Fw,Sx.NEW_ENROLLMENT,[{urlKey:"programId",propKey:"programId"},{urlKey:"orgUnitId",propKey:"orgUnitId"}]),Fw),kx=(xw={},Object(Ut.a)(xw,Sx.MAIN,function(e){return le(cx)(e)}),Object(Ut.a)(xw,Sx.NEW_EVENT,function(e){return le(EI)(e)}),Object(Ut.a)(xw,Sx.EDIT_EVENT,function(e){return le(hx)({eventId:e.nextProps.eventId,page:e.nextPage})}),Object(Ut.a)(xw,Sx.VIEW_EVENT,function(e){return le(CA)({eventId:e.nextProps.viewEventId,page:e.nextPage})}),Object(Ut.a)(xw,Sx.NEW_ENROLLMENT,function(e){return le(nT)(e)}),xw),Nx=function(){return function(e){var t=function(t){function n(){var e,t;Object(A.a)(this,n);for(var a=arguments.length,r=new Array(a),o=0;o<a;o++)r[o]=arguments[o];return(t=Object(F.a)(this,(e=Object(x.a)(n)).call.apply(e,[this].concat(r)))).handleUpdate=function(e){t.props.onUpdateFromUrl(t.page,e)},t}return Object(P.a)(n,t),Object(w.a)(n,[{key:"getSyncSpecification",value:function(){var e=this.page||Sx.MAIN;return Rx[e]||[]}},{key:"setPageAndParams",value:function(){var e=function(e){var t=e.match(/[\/][^\/]+/g);return null==t?[]:t.map(function(e){return e.substring(1)})}(this.props.location.pathname);if(0===e.length)return this.page=Sx.MAIN,void(this.params=null);if(1===e.length){var t=e[0];Object.keys(Sx).map(function(e){return Sx[e]}).includes(t)?(this.page=t,this.params=null):(this.params=t,this.page=Sx.MAIN)}else this.page=e[0],this.params=e[1]}},{key:"render",value:function(){var t=this.props,n=(t.location,t.onUpdateFromUrl,t.locationSwitchInProgress),a=t.params,r=t.page,o=Object(Fe.a)(t,["location","onUpdateFromUrl","locationSwitchInProgress","params","page"]);return n?f.createElement(T,null):(this.setPageAndParams(),f.createElement(e,Object.assign({statePage:r||Sx.MAIN,urlPage:this.page,urlParams:this.params,onUpdate:this.handleUpdate,syncSpecification:this.getSyncSpecification(),stateParams:a},o)))}}]),n}(f.Component);return Object(D.b)(function(e){return{params:tx(e),page:e.app.page,locationSwitchInProgress:e.app.locationSwitchInProgress}},function(e){return{onUpdateFromUrl:function(t,n){return e(kx[t](n))}}})(t)}},Ax=n(1504),wx=function(e,t,n){return function(a){return Object(D.b)(function(t,n){return{ready:e(t,n)}},null,function(e,t,n){return Object.assign({},n,e,t,{InnerComponent:a})})(function(e,t){return function(n){var a=n.ready,r=n.InnerComponent,o=Object(Fe.a)(n,["ready","InnerComponent"]);if(!a){if(t)return f.createElement(T,null);var i=e?e(n):null;return f.createElement(De,{containerStyle:i})}return f.createElement(r,o)}}(t,n))}},Fx=n(393),xx=n.n(Fx),Px=n(406),Dx=n.n(Px),Ux=n(405),Lx=n.n(Ux),Mx={main:"#1976D2",dark:"#004BA0",light:"#63A4FF",lightest:"#EAF4FF"},Bx=Object(E.createMuiTheme)({overrides:{MuiButton:{raisedPrimary:{"&:hover":{backgroundColor:Mx.main},backgroundColor:Mx.dark},flatPrimary:{"&:hover":{backgroundColor:Mx.lightest},color:Mx.dark}}},palette:{primary:Mx,secondary:{main:"#00796B",dark:"#004C40",light:"#48A999",lightest:"#B2DFDB"},error:{lighter:"#FBEAE5",light:xx.a[300],main:"#E53935",dark:xx.a[700]},warning:Object(se.a)({},Lx.a,{lighter:Lx.a[100],light:Lx.a[300],main:"#F19C02",dark:Lx.a[900]}),success:{main:"#3D9305"},info:{main:"#EAF4FF"},grey:{main:"#9E9E9E",light:"#E0E0E0",lighter:"#F6F6F6",lightest:"#FBFBFB",dark:"#494949",blueGrey:"#ECEFF1",snow:"#F4F6F8",black:"#000000"}}});Bx.typography.formFieldTitle={fontSize:Bx.typography.pxToRem(12)},Bx.palette=Object(se.a)({},Bx.palette,{accent:{lighter:Dx.a[50],light:Dx.a[100],main:Dx.a[300],dark:Dx.a[500],contrastText:"#000000"},input:{bottomLine:"rgba(0, 0, 0, 0.42)"},dividerForm:"#f2f4f5",required:xx.a[500]});var Vx,Gx,Wx=Bx,Hx=wx(function(e){return!e.app.goingOnline},null,!0)(ex),zx=wx(function(e,t){return!t.urlOutOfSync},null,!0)(Hx),Kx=(Vx=function(e){return e.syncSpecification},function(e){return function(e,t,n){return function(a){function r(e){var t;return Object(A.a)(this,r),t=Object(F.a)(this,Object(x.a)(r).call(this,e)),n&&t.updateIfOutOfSync(),t}return Object(P.a)(r,a),Object(w.a)(r,null,[{key:"getValueFromParam",value:function(e,t){var n=null;if(e&&e.length>0){var a=new RegExp("".concat(t,"="),"i");n=e[e.length-1].replace(a,"").trim()||null}return n}},{key:"getNextProps",value:function(e,t){return Object.keys(e).reduce(function(n,a){return n[(t.find(function(e){return e.urlKey===a})||{}).propKey||a]=e[a],n},{})}}]),Object(w.a)(r,[{key:"getLocationParams",value:function(e){var t=this.props.urlParams;return e.map(function(e){var n,a=e.urlKey;if(t)if(a===Tx)n=t;else{var o=new RegExp("".concat(a,"[^&]+"),"i"),i=t.match(o);n=r.getValueFromParam(i,a)}else n=null;return{key:a,value:n}}).reduce(function(e,t){return e[t.key]=t.value,e},{})}},{key:"paramsNeedsUpdate",value:function(e,t){var n=this;return e.some(function(e){return t[e.urlKey]!==(n.props.stateParams&&n.props.stateParams[e.propKey]||null)})}},{key:"update",value:function(e){this.props.onUpdate(e)}},{key:"noUpdateRequired",value:function(){this.props.onNoUpdateRequired&&this.props.onNoUpdateRequired()}},{key:"updateIfOutOfSync",value:function(){var e=t(this.props),n=this.getLocationParams(e);if(this.props.urlPage!==this.props.statePage||this.paramsNeedsUpdate(e,n)){var a=r.getNextProps(n,e);return this.update({nextProps:a,prevProps:this.props.stateParams||{},nextPage:this.props.urlPage,prevPage:this.props.statePage}),!0}return this.noUpdateRequired(),!1}},{key:"render",value:function(){var t=this.props,a=(t.onUpdate,t.urlParams,t.stateParams,t.urlPage,t.statePage,Object(Fe.a)(t,["onUpdate","urlParams","stateParams","urlPage","statePage"]));return!n&&this.updateIfOutOfSync()?f.createElement(e,Object.assign({urlOutOfSync:!0},a)):f.createElement(e,a)}}]),r}(f.Component)}(e,Vx,Gx)})(zx),Yx=function(e){var t,n;return n=t=function(t){function n(){return Object(A.a)(this,n),Object(F.a)(this,Object(x.a)(n).apply(this,arguments))}return Object(P.a)(n,t),Object(w.a)(n,[{key:"getChildContext",value:function(){return{d2:_e()}}},{key:"render",value:function(){return f.createElement(e,this.props)}}]),n}(f.Component),t.childContextTypes={d2:Ao.a.object},n}(Nx()(Kx)),qx=wx(function(e,t){return e.app.initDone},null,!0)(Yx),Xx=Object(B.a)(qx),Zx=function(e){function t(){return Object(A.a)(this,t),Object(F.a)(this,Object(x.a)(t).apply(this,arguments))}return Object(P.a)(t,e),Object(w.a)(t,[{key:"renderContents",value:function(){return f.createElement(f.Fragment,null,f.createElement(L.a,null),f.createElement(D.a,{store:this.props.store},f.createElement(M.a,{history:this.props.history},f.createElement(E.MuiThemeProvider,{theme:Wx},f.createElement(Ax.a,null,f.createElement(Xx,null),f.createElement(fe,null))))))}},{key:"render",value:function(){var e=this.props;e.store,e.history;return this.renderContents()}}]),t}(f.Component),Jx=n(181),Qx=n(1499),$x=n(1500),eP=n(1501),tP=n(961),nP=n.n(tP),aP=n(1503),rP=n(962),oP=n.n(rP),iP=function(e){var t=e.url,n=e.method,a=e.data;return ye()[n](t,a)};function cP(e){return e&&e.meta&&e.meta.offline&&e.meta.offline.effect?e.meta.offline.effect:{}}var sP=Object(se.a)({},oP.a,{enqueue:function(e,t){var n=cP(t);if(n.clientId){var a=e.filter(function(e){var t=cP(e);return!(t.clientId===n.clientId&&t.method===n.method)});return[].concat(Object(We.a)(a),[t])}return[].concat(Object(We.a)(e),[t])},dequeue:function(e,t){var n=Object(aP.a)(e),a=n[0],r=n.slice(1),o=cP(a);return o.method===Db?r.map(function(e){var n,r=cP(e);return r.clientId===o.clientId&&r.updateOnDequeueCallback?(n=r.updateOnDequeueCallback,Function("return ".concat(n))())(e,a,t):e}).filter(function(e){return e}):r}}),lP=function(e){var t=e&&e.httpStatusCode;return!!t&&(![408,429,502,503,504].includes(t)&&t>=400)},uP=n(111),dP=n.n(uP),pP=function(){function e(t){Object(A.a)(this,e),this.name=t.name,this.version=t.version||1,this.objectStoreNames=t.objectStores,this.keyPath=t.keyPath,this.opened=!1}return Object(w.a)(e,null,[{key:"isSupported",value:function(){return!0}}]),Object(w.a)(e,[{key:"open",value:function(){this.storage=this.objectStoreNames.reduce(function(e,t){return e[t]=new Map,e},{}),this.opened=!0}},{key:"_executeSet",value:function(e,t){var n=t[this.keyPath];e.set(n,t)}},{key:"set",value:function(e,t){var n=this.storage[e];this._executeSet(n,t)}},{key:"setAll",value:function(e,t){var n=this,a=this.storage[e];t.forEach(function(e){n._executeSet(a,e)})}},{key:"get",value:function(e,t){return this.storage[e].get(t)}},{key:"getAll",value:function(e,t){var n=this.storage[e],a=Array.from(n.values()),r="function"===typeof t;return r?a.filter(r):a}},{key:"getKeys",value:function(e){var t=this.storage[e];return Array.from(t.keys())}},{key:"contains",value:function(e,t){return this.storage[e].has(t)}},{key:"count",value:function(t,n){if(n)throw Error(Object(up.a)(e.errorMessages.KEY_BASED_COUNT_IS_NOT_SUPPORTED)({adapter:this}));return this.storage[t].size}},{key:"remove",value:function(e,t){this.storage[e].delete(t)}},{key:"removeAll",value:function(e){this.storage[e]=new Map}},{key:"close",value:function(){this.opened=!1}},{key:"destroy",value:function(){this.opened=!1,this.storage=this.objectStoreNames.reduce(function(e,t){return e[t]=new Map,e},{})}},{key:"isOpen",value:function(){return this.opened}}]),e}();pP.errorMessages={INVALID_STORE_NAME:"Invalid store name",KEY_BASED_COUNT_IS_NOT_SUPPORTED:"Key based count is not supported by DomLocalStorageAdapter"};var fP=pP,mP=function(){function e(t,n,a,r,o){var i=this;if(Object(A.a)(this,e),this.throwIfDataObjectError=function(t){if(!t||!t[i.adapter.keyPath])throw Error(Object(up.a)(e.errorMessages.INVALID_STORAGE_OBJECT)({adapter:i.adapter}))},!t)throw new Error(e.errorMessages.INVALID_NAME);if(this.name=t,this.onFallback=o,!a||!dP()(a||0===a.length))throw new Error(e.errorMessages.NO_ADAPTERS_DEFINED);var c=a.filter(function(t){if(!e.isAdapterValid(t))throw new Error(Object(up.a)(e.errorMessages.INVALID_ADAPTER_PROVIDED)({Adapter:t}));return t.isSupported()});if(c.length<=0)throw new Error(e.errorMessages.NO_VALID_ADAPTERS_FOUND);this.Adapters=a,this.AvailableAdapters=c;var s=c[0];this.adapter=new s({name:t,version:n,objectStores:r,keyPath:"id"}),this.adapterType=s}return Object(w.a)(e,null,[{key:"isAdapterValid",value:function(e){return!!"isSupported".split(" ").every(function(t){return e[t]})&&"open set setAll get getAll getKeys count contains remove removeAll close destroy isOpen".split(" ").every(function(t){return e.prototype[t]})}}]),Object(w.a)(e,[{key:"getOpenStatusError",value:function(){return this.adapter.isOpen()?null:Object(up.a)(e.errorMessages.STORAGE_NOT_OPEN)({adapter:this.adapter})}},{key:"throwIfNotOpen",value:function(){if(this.getOpenStatusError())throw Error(Object(up.a)(e.errorMessages.STORAGE_NOT_OPEN)({adapter:this.adapter}))}},{key:"throwIfStoreNotFound",value:function(t,n){if(!t||!this.adapter.objectStoreNames.includes(t))throw Error(Object(up.a)(e.errorMessages.INVALID_OBJECTSTORE)({storageContainer:this,adapter:this.adapter,method:n}))}},{key:"throwIfDataArrayError",value:function(t){if(!t)throw Error(Object(up.a)(e.errorMessages.INVALID_STORAGE_ARRAY)({adapter:this.adapter}));t.forEach(this.throwIfDataObjectError)}},{key:"getBackupDataAsync",value:function(){var e=Object(o.a)(r.a.mark(function e(){var t,n,a=this;return r.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.adapter.objectStoreNames.map(function(){var e=Object(o.a)(r.a.mark(function e(t){var n;return r.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Promise.resolve().then(function(){return a.adapter.getAll(t)});case 2:return n=e.sent,e.abrupt("return",n);case 4:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}()),e.next=3,Promise.all(t);case 3:return n=e.sent,e.abrupt("return",n.reduce(function(e,t,n){return t&&t.length>0&&(e[a.adapter.objectStoreNames[n]]=t),e},{}));case 5:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"restoreBackupDataAsync",value:function(e){var t=this;return Object.keys(e).asyncForEach(function(n){return Promise.resolve().then(function(){return t.adapter.setAll(n,e[n])})})}},{key:"fallbackToMemoryStorageAsync",value:function(){var e=Object(o.a)(r.a.mark(function e(){var t,n=this;return r.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.getBackupDataAsync();case 2:return t=e.sent,e.next=5,Promise.resolve().then(function(){return n.adapter.destroy()});case 5:return e.next=7,Promise.resolve().then(function(){return n.adapter.open()});case 7:if(!this.onFallback){e.next=10;break}return e.next=10,this.onFallback({set:this.setWithoutFallback.bind(this)});case 10:return e.next=12,Promise.resolve().then(function(){return n.adapter.close()});case 12:return this.adapter=new fP({name:this.adapter.name,version:this.adapter.version,objectStores:this.adapter.objectStoreNames,keyPath:"id"}),this.adapterType=fP,e.next=16,Promise.resolve().then(function(){return n.adapter.open()});case 16:return e.next=18,this.restoreBackupDataAsync(t);case 18:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"_openFallbackAdapter",value:function(){var t=Object(o.a)(r.a.mark(function t(){var n,a,o,i,c=this,s=arguments;return r.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(n=this.AvailableAdapters.findIndex(function(e){return e===c.adapterType}),a=n+1,!(this.AvailableAdapters.length<=a)){t.next=4;break}throw new Error(e.errorMessages.OPEN_FAILED);case 4:return o=this.AvailableAdapters[a],i=new o({name:this.adapter.name,version:this.adapter.version,objectStores:this.adapter.objectStoreNames,keyPath:"id"}),this.adapter=i,this.adapterType=o,t.next=10,this.open.apply(this,s);case 10:case"end":return t.stop()}},t,this)}));return function(){return t.apply(this,arguments)}}()},{key:"open",value:function(){var t=Object(o.a)(r.a.mark(function t(){var n,a,o=arguments;return r.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(!this.adapter.isOpen()){t.next=2;break}throw new Error(Object(up.a)(e.errorMessages.STORAGE_ALREADY_OPEN)({adapter:this.adapter}));case 2:if((n=this.adapter.objectStoreNames)&&dP()(n)&&0!==n.length){t.next=5;break}throw new Error(e.errorMessages.NO_OBJECTSTORES_DEFINED);case 5:return t.prev=5,t.next=8,(a=this.adapter).open.apply(a,o);case 8:t.next=14;break;case 10:return t.prev=10,t.t0=t.catch(5),t.next=14,this._openFallbackAdapter.apply(this,o);case 14:case"end":return t.stop()}},t,this,[[5,10]])}));return function(){return t.apply(this,arguments)}}()},{key:"setWithoutFallback",value:function(){var e=Object(o.a)(r.a.mark(function e(t,n){return r.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return this.throwIfNotOpen(),this.throwIfStoreNotFound(t,"set"),this.throwIfDataObjectError(n),e.abrupt("return",this.adapter.set(t,n));case 4:case"end":return e.stop()}},e,this)}));return function(t,n){return e.apply(this,arguments)}}()},{key:"set",value:function(){var t=Object(o.a)(r.a.mark(function t(n,a){var o=this;return r.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return this.throwIfNotOpen(),this.throwIfStoreNotFound(n,"set"),this.throwIfDataObjectError(a),t.abrupt("return",Promise.resolve().then(function(){return o.adapter.set(n,a)}).catch(function(t){return o.adapterType===fP?Promise.reject(t):(O.a.error(Object(up.a)(e.errorMessages.FALLBACK_TO_MEMORY_STORAGE_TRIGGERED)({method:"set",adapter:o.adapter})),o.fallbackToMemoryStorageAsync().then(function(){return o.adapter.set(n,a)}))}));case 4:case"end":return t.stop()}},t,this)}));return function(e,n){return t.apply(this,arguments)}}()},{key:"setAll",value:function(){var t=Object(o.a)(r.a.mark(function t(n,a){var o=this;return r.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return this.throwIfNotOpen(),this.throwIfStoreNotFound(n,"setAll"),this.throwIfDataArrayError(a),t.abrupt("return",Promise.resolve().then(function(){return o.adapter.setAll(n,a)}).catch(function(t){return o.adapterType===fP?Promise.reject(t):(O.a.error(Object(up.a)(e.errorMessages.FALLBACK_TO_MEMORY_STORAGE_TRIGGERED)({method:"setAll",adapter:o.adapter})),o.fallbackToMemoryStorageAsync().then(function(){return o.adapter.setAll(n,a)}))}));case 4:case"end":return t.stop()}},t,this)}));return function(e,n){return t.apply(this,arguments)}}()},{key:"get",value:function(){var t=Object(o.a)(r.a.mark(function t(n,a){return r.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(this.throwIfNotOpen(),this.throwIfStoreNotFound(n,"get"),a){t.next=4;break}throw Error(Object(up.a)(e.errorMessages.MISSING_KEY)({adapter:this.adapter,key:a,method:"get"}));case 4:return t.abrupt("return",this.adapter.get(n,a));case 5:case"end":return t.stop()}},t,this)}));return function(e,n){return t.apply(this,arguments)}}()},{key:"getAll",value:function(){var e=Object(o.a)(r.a.mark(function e(t,n){return r.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return this.throwIfNotOpen(),this.throwIfStoreNotFound(t,"getAll"),e.abrupt("return",this.adapter.getAll(t,n));case 3:case"end":return e.stop()}},e,this)}));return function(t,n){return e.apply(this,arguments)}}()},{key:"getKeys",value:function(){var e=Object(o.a)(r.a.mark(function e(t){return r.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return this.throwIfNotOpen(),this.throwIfStoreNotFound(t,"getKeys"),e.abrupt("return",this.adapter.getKeys(t));case 3:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"remove",value:function(){var t=Object(o.a)(r.a.mark(function t(n,a){return r.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(this.throwIfNotOpen(),this.throwIfStoreNotFound(n,"remove"),a){t.next=4;break}throw Error(Object(up.a)(e.errorMessages.MISSING_KEY)({adapter:this.adapter,key:a,method:"remove"}));case 4:return t.abrupt("return",this.adapter.remove(n,a));case 5:case"end":return t.stop()}},t,this)}));return function(e,n){return t.apply(this,arguments)}}()},{key:"removeAll",value:function(){var e=Object(o.a)(r.a.mark(function e(t){return r.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return this.throwIfNotOpen(),this.throwIfStoreNotFound(t,"removeAll"),e.abrupt("return",this.adapter.removeAll(t));case 3:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"contains",value:function(){var t=Object(o.a)(r.a.mark(function t(n,a){return r.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(this.throwIfNotOpen(),this.throwIfStoreNotFound(n,"contains"),a){t.next=4;break}throw Error(Object(up.a)(e.errorMessages.MISSING_KEY)({adapter:this.adapter,key:a,method:"contains"}));case 4:return t.abrupt("return",this.adapter.contains(n,a));case 5:case"end":return t.stop()}},t,this)}));return function(e,n){return t.apply(this,arguments)}}()},{key:"count",value:function(){var e=Object(o.a)(r.a.mark(function e(t,n){return r.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return this.throwIfNotOpen(),this.throwIfStoreNotFound(t,"count"),e.abrupt("return",this.adapter.count(t,n));case 3:case"end":return e.stop()}},e,this)}));return function(t,n){return e.apply(this,arguments)}}()},{key:"close",value:function(){var e=Object(o.a)(r.a.mark(function e(){var t,n=arguments;return r.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(t=this.adapter).close.apply(t,n));case 1:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"destroy",value:function(){var e=Object(o.a)(r.a.mark(function e(){var t,n=arguments;return r.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(t=this.adapter).destroy.apply(t,n));case 1:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()}]),e}();mP.errorMessages={INVALID_NAME:"A valid database name must be provided",NO_OBJECTSTORES_DEFINED:"no objectStores defined",NO_ADAPTERS_PROVIDED:"no adapters provided",NO_VALID_ADAPTERS_FOUND:"no valid adapters found",INVALID_ADAPTER_PROVIDED:"An invalid adapter was provided",INVALID_OBJECTSTORE:"Specify a valid objectStore",STORAGE_NOT_OPEN:"Please open storage first",STORAGE_ALREADY_OPEN:"Storage is already open",INVALID_STORAGE_OBJECT:"Invalid storage object",INVALID_STORAGE_ARRAY:"Invalid storage array",MISSING_KEY:"Please specifiy key",FALLBACK_TO_MEMORY_STORAGE_TRIGGERED:"Fallback to memory storage triggered",OPEN_FAILED:"Open storage failed"};var hP=function(){function e(t){Object(A.a)(this,e),this.name=t.name,this.version=t.version,this.objectStoreNames=t.objectStores,this.keyPath=t.keyPath}return Object(w.a)(e,null,[{key:"isSupported",value:function(){return e.indexedDB&&e.iDBKeyRange&&e.iDBTransaction}}]),Object(w.a)(e,[{key:"_upgrade",value:function(){var e=this;this.db.objectStoreNames&&Array.from(this.db.objectStoreNames).forEach(function(t){e.db.deleteObjectStore(t)});this.objectStoreNames.forEach(function(t){e.db.createObjectStore(t)})}},{key:"open",value:function(t,n){var a=this,r=e.indexedDB.open(this.name,this.version);return new Promise(function(o,i){r.onsuccess=function(e){a.db=e.target.result,o()},r.onerror=function(t){i(Object(up.a)(e.errorMessages.OPEN_FAILED)({adapter:a,error:t}))},r.onblocked=function(t){i(Object(up.a)(e.errorMessages.OPEN_BLOCKED)({adapter:a,error:t}))},r.onupgradeneeded=function(e){a.db=e.target.result;var r=e.target.transaction;return Promise.resolve().then(function(){return t&&t({get:function(e,t){return a.db.objectStoreNames.contains(e)?a.getForUpgrade(e,t,r):Promise.resolve(null)}})}).then(function(){return a._upgrade(),Promise.resolve()}).then(function(){return n&&n({set:function(e,t){return a.setForUpgrade(e,t,r)}})})}})}},{key:"setForUpgrade",value:function(t,n,a){var r=this;return new Promise(function(o,i){var c=JSON.parse(JSON.stringify(n)),s=c[r.keyPath];delete c[r.keyPath];var l=a.objectStore(t).put(c,s);l.onsuccess=function(){o(c)},l.onerror=function(t){i(Object(up.a)(e.errorMessages.SET_FAILED)({adapter:r,error:t}))}})}},{key:"set",value:function(t,n){var a=this;return new Promise(function(r,o){var i,c;try{var s=JSON.parse(JSON.stringify(n)),l=s[a.keyPath];delete s[a.keyPath],(i=a.db.transaction([t],e.transactionMode.READ_WRITE)).oncomplete=function(){r(s)},i.onerror=function(t){o(Object(up.a)(e.errorMessages.SET_FAILED)({adapter:a,error:t}))},i.onabort=function(){o(Object(up.a)(e.errorMessages.SET_FAILED)({adapter:a,aborted:!0,error:c}))},i.objectStore(t).put(s,l)}catch(u){i?function(e){c=e,i.abort()}(u):o(Object(up.a)(e.errorMessages.SET_FAILED)({adapter:a,error:u}))}})}},{key:"setAll",value:function(t,n){var a=this;return new Promise(function(r,o){var i,c,s=function(e){c=e,i.abort()};try{(i=a.db.transaction([t],e.transactionMode.READ_WRITE)).oncomplete=function(){r()},i.onerror=function(t){o(Object(up.a)(e.errorMessages.SET_FAILED)({adapter:a,error:t}))},i.onabort=function(){o(Object(up.a)(e.errorMessages.SET_FAILED)({adapter:a,aborted:!0,error:c}))};var l=i.objectStore(t),u=0;!function t(){if(u<n.length){var r=n[u],o=JSON.parse(JSON.stringify(r));oe()(o)&&oe()(o[a.keyPath])||s(Object(up.a)(e.errorMessages.INVALID_STORAGE_OBJECT)({adapter:a}));var i=o[a.keyPath];delete o[a.keyPath],l.put(o,i).onsuccess=function(){u+=1,t()}}}()}catch(d){i&&s(d),o(Object(up.a)(e.errorMessages.SET_FAILED)({adapter:a,error:d}))}})}},{key:"getForUpgrade",value:function(t,n,a){var r=this;return new Promise(function(o,i){var c=a.objectStore(t).get(n);c.onsuccess=function(e){var t=e.target.result;oe()(t)&&(t[r.keyPath]=n),o(t)},c.onerror=function(t){i(Object(up.a)(e.errorMessages.GET_FAILED)({adapter:r,error:t}))}})}},{key:"get",value:function(t,n){var a=this;return new Promise(function(r,o){var i,c;try{var s;(i=a.db.transaction([t],e.transactionMode.READ_ONLY)).oncomplete=function(){r(s)},i.onerror=function(t){o(Object(up.a)(e.errorMessages.GET_FAILED)({adapter:a,error:t}))},i.onabort=function(){o(Object(up.a)(e.errorMessages.GET_FAILED)({adapter:a,aborted:!0,error:c}))},i.objectStore(t).get(n).onsuccess=function(e){var t=e.target.result;oe()(t)&&(t[a.keyPath]=n),s=t}}catch(l){i&&function(e){c=e,i.abort()}(l),o(Object(up.a)(e.errorMessages.GET_FAILED)({adapter:a,error:l}))}})}},{key:"getAll",value:function(t,n){var a=this;return new Promise(function(r,o){var i,c;try{var s=[],l="function"===typeof n;(i=a.db.transaction([t],e.transactionMode.READ_ONLY)).oncomplete=function(){r(s)},i.onerror=function(t){o(Object(up.a)(e.errorMessages.GET_ALL_FAILED)({adapter:a,error:t}))},i.onabort=function(){o(Object(up.a)(e.errorMessages.GET_ALL_FAILED)({adapter:a,aborted:!0,error:c}))},i.objectStore(t).openCursor().onsuccess=function(e){var t=e.target.result;t&&(t.value[a.keyPath]=t.key,l?n(t.value)&&s.push(t.value):s.push(t.value),t.continue())}}catch(u){i&&function(e){c=e,i.abort()}(u),o(Object(up.a)(e.errorMessages.GET_ALL_FAILED)({adapter:a,error:u}))}})}},{key:"getKeys",value:function(t){var n=this;return new Promise(function(a,r){var o,i;try{var c=[];(o=n.db.transaction([t],e.transactionMode.READ_ONLY)).oncomplete=function(){a(c)},o.onerror=function(t){r(Object(up.a)(e.errorMessages.GET_KEYS_FAILED)({adapter:n,error:t}))},o.onabort=function(){r(Object(up.a)(e.errorMessages.GET_KEYS_FAILED)({adapter:n,aborted:!0,error:i}))},o.objectStore(t).openCursor().onsuccess=function(e){var t=e.target.result;t&&(c.push(t.key),t.continue())}}catch(s){o&&function(e){i=e,o.abort()}(s),r(Object(up.a)(e.errorMessages.GET_KEYS_FAILED)({adapter:n,error:s}))}})}},{key:"remove",value:function(t,n){var a=this;return new Promise(function(r,o){var i,c;try{(i=a.db.transaction([t],e.transactionMode.READ_WRITE)).oncomplete=function(){r()},i.onerror=function(t){o(Object(up.a)(e.errorMessages.REMOVE_FAILED)({adapter:a,error:t}))},i.onabort=function(){o(Object(up.a)(e.errorMessages.REMOVE_FAILED)({adapter:a,aborted:!0,error:c}))},i.objectStore(t).delete(n)}catch(s){i&&function(e){c=e,i.abort()}(s),o(Object(up.a)(e.errorMessages.REMOVE_FAILED)({adapter:a,error:s}))}})}},{key:"removeAll",value:function(t){var n=this;return new Promise(function(a,r){var o,i;try{(o=n.db.transaction([t],e.transactionMode.READ_WRITE)).oncomplete=function(){a()},o.onerror=function(t){r(Object(up.a)(e.errorMessages.REMOVE_ALL_FAILED)({adapter:n,error:t}))},o.onabort=function(){r(Object(up.a)(e.errorMessages.REMOVE_ALL_FAILED)({adapter:n,aborted:!0,error:i}))},o.objectStore(t).clear()}catch(c){o&&function(e){i=e,o.abort()}(c),r(Object(up.a)(e.errorMessages.REMOVE_ALL_FAILED)({adapter:n,error:c}))}})}},{key:"contains",value:function(t,n){var a=this;return new Promise(function(r,o){var i,c;try{var s;(i=a.db.transaction([t],e.transactionMode.READ_ONLY)).oncomplete=function(){r(s)},i.onerror=function(t){o(Object(up.a)(e.errorMessages.CONTAINS_FAILED)({adapter:a,error:t}))},i.onabort=function(){o(Object(up.a)(e.errorMessages.CONTAINS_FAILED)({adapter:a,aborted:!0,error:c}))},i.objectStore(t).get(n).onsuccess=function(e){var t=e.target.result;s=!!t}}catch(l){i&&function(e){c=e,i.abort()}(l),o(Object(up.a)(e.errorMessages.CONTAINS_FAILED)({adapter:a,error:l}))}})}},{key:"count",value:function(t,n){var a=this;return new Promise(function(r,o){var i,c;n||(n=null);try{var s;(i=a.db.transaction([t],e.transactionMode.READ_ONLY)).oncomplete=function(){r(s)},i.onerror=function(t){o(Object(up.a)(e.errorMessages.COUNT_FAILED)({adapter:a,error:t}))},i.onabort=function(){o(Object(up.a)(e.errorMessages.COUNT_FAILED)({adapter:a,aborted:!0,error:c}))},i.objectStore(t).count(n).onsuccess=function(e){s=e.target.result}}catch(l){i&&function(e){c=e,i.abort()}(l),o(Object(up.a)(e.errorMessages.COUNT_FAILED)({adapter:a,error:l}))}})}},{key:"close",value:function(){var t=this;return new Promise(function(n,a){if(t.db)try{t.db.close(),t.db=null,n()}catch(r){a(Object(up.a)(e.errorMessages.CLOSE_FAILED)({adapter:t,error:r}))}else n()})}},{key:"destroy",value:function(){var t=Object(o.a)(r.a.mark(function t(){var n=this;return r.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,new Promise(function(t,a){n.close().then(function(){t()}).catch(function(t){a(Object(up.a)(e.errorMessages.CLOSE_FAILED_FROM_DESTROY)({adapter:n,error:t}))})});case 2:return t.next=4,new Promise(function(t,a){var r=e.indexedDB.deleteDatabase(n.name);r.onsuccess=function(e){t(e)},r.onerror=function(t){a(Object(up.a)(e.errorMessages.DESTROY_FAILED)({adapter:n,error:t}))},r.onblocked=function(t){a(Object(up.a)(e.errorMessages.DESTROY_BLOCKED)({adapter:n,error:t}))}});case 4:case"end":return t.stop()}},t)}));return function(){return t.apply(this,arguments)}}()},{key:"isOpen",value:function(){return!!this.db}}]),e}();hP.errorMessages={OPEN_FAILED:"open indexedDB failed",OPEN_BLOCKED:"indexedDB blocked",OPEN_DATABASE_FIRST:"Open database first",INVALID_STORAGE_OBJECT:"Invalid storage object",STORAGE_ARRAY_NOT_PROVIDED:"An array must be provided",SET_FAILED:"Save to indexedDB failed",INVALID_KEY:"Key is invalid",GET_FAILED:"Get from indexedDB failed",GET_ALL_FAILED:"Get All from indexedDB failed",GET_KEYS_FAILED:"Get Keys from indexedDB failed",REMOVE_FAILED:"Remove from indexedDB failed",REMOVE_ALL_FAILED:"Remove all from indexedDB failed",CONTAINS_FAILED:"Contains check from indexedDB failed",COUNT_FAILED:"Count from indexedDB failed",CLOSE_FAILED:"Close indexedDB failed",DESTROY_FAILED:"Destroy indexedDB failed",DESTROY_BLOCKED:"Destroy indexedDB blocked",CLOSE_FAILED_FROM_DESTROY:"Close indexedDB failed from destroy"},hP.transactionMode={READ_WRITE:"readwrite",READ_ONLY:"readonly"},hP.adapterName="IndexedDBAdapter",hP.indexedDB=window.indexedDB||window.webkitIndexedDB||window.mozIndexedDB||window.oIndexedDB||window.msIndexedDB,hP.iDBKeyRange=function(){var e=window.IDBKeyRange||window.webkitIDBKeyRange||window.msIDBKeyRange;return e?e.bind(window):null}(),hP.iDBTransaction=function(){var e=window.IDBTransaction||window.webkitIDBTransaction||window.msIDBTransaction;return e?e.bind(window):null}();var bP=hP,gP=function(){function e(t,n,a){Object(A.a)(this,e),this.key="".concat(t,".").concat(n,".**index**"),this.storage=a}return Object(w.a)(e,[{key:"all",value:function(){var e=this.storage.getItem(this.key);if(e)try{e=JSON.parse(e)}catch(t){e=null}return e||this.storage.setItem(this.key,JSON.stringify([])),JSON.parse(this.storage.getItem(this.key))}},{key:"add",value:function(e){var t=this.all();t.push(e),this.storage.setItem(this.key,JSON.stringify(t))}},{key:"remove",value:function(e){var t=this.all();t.includes(e)&&(t.splice(t.indexOf(e),1),this.storage.setItem(this.key,JSON.stringify(t)))}},{key:"find",value:function(e){return this.all().indexOf(e)}},{key:"exists",value:function(e){return-1!==this.all().indexOf(e)}},{key:"destroy",value:function(){this.storage.removeItem(this.key)}}]),e}(),OP=function(){function e(t){Object(A.a)(this,e),this.name=t.name,this.version=t.version||1,this.objectStoreNames=t.objectStores,this.keyPath=t.keyPath,this.opened=!1}return Object(w.a)(e,null,[{key:"isSupported",value:function(){return!!e.storage}}]),Object(w.a)(e,[{key:"open",value:function(t,n){var a=this;this.indexer=this.objectStoreNames.reduce(function(t,n){return t[n]=new gP(a.name,n,e.storage),t},{});var r="".concat(this.name,".").concat(e.CACHEVERSIONKEY),o=e.storage.getItem(r),i=o&&JSON.parse(o);return this.opened=!0,this.version!==i?Promise.resolve().then(function(){return t&&t({get:a.get.bind(a)})}).then(function(){return a._executeDestroy(),e.storage.setItem(r,JSON.stringify(a.version)),Promise.resolve()}).then(function(){return n&&n({set:a.set.bind(a)})}):Promise.resolve()}},{key:"_executeSet",value:function(t,n){var a=JSON.parse(JSON.stringify(n)),r=a[this.keyPath];delete a[this.keyPath];var o=this.getStoreKey(t,r);this.indexer[t].exists(o)||this.indexer[t].add(o),e.storage.setItem(o,JSON.stringify(a))}},{key:"set",value:function(t,n){var a=this;return new Promise(function(r,o){try{a._executeSet(t,n),r()}catch(i){o(Object(up.a)(e.errorMessages.SET_FAILED)({adapter:a,error:i}))}})}},{key:"setAll",value:function(e,t){var n=this;try{return t.forEach(function(t){n._executeSet(e,t)}),Promise.resolve()}catch(a){return Promise.reject(a)}}},{key:"get",value:function(t,n){var a=this;return new Promise(function(r){var o,i=e.storage.getItem(a.getStoreKey(t,n));i&&((o=JSON.parse(i))[a.keyPath]=n),r(o)})}},{key:"getAll",value:function(t,n){var a=this,r=this.indexer[t].all(),o="function"===typeof n,i=r.reduce(function(r,i){var c=e.storage.getItem(i);if(c&&(!o||n(c))){var s=JSON.parse(c);s[a.keyPath]=a.mainKeyFromStoreKey(i,t),r.push(s)}return r},[]);return Promise.resolve(i)}},{key:"_executeGetKeys",value:function(e){var t=this;return this.indexer[e].all().map(function(n){return t.mainKeyFromStoreKey(n,e)})}},{key:"getKeys",value:function(e){return Promise.resolve(this._executeGetKeys(e))}},{key:"_executeRemove",value:function(t,n){var a=this.getStoreKey(t,n);this.indexer[t].remove(a),e.storage.removeItem(a)}},{key:"remove",value:function(e,t){return this._executeRemove(e,t),Promise.resolve()}},{key:"_executeRemoveAll",value:function(e){var t=this;this._executeGetKeys(e).forEach(function(n){t._executeRemove(e,n)})}},{key:"removeAll",value:function(e){return Promise.resolve(this._executeRemoveAll(e))}},{key:"contains",value:function(e,t){var n=this.getStoreKey(e,t);return Promise.resolve(this.indexer[e].exists(n))}},{key:"count",value:function(t,n){return n&&Promise.reject(Object(up.a)(e.errorMessages.KEY_BASED_COUNT_IS_NOT_SUPPORTED)({adapter:this})),Promise.resolve(this.indexer[t].all().length)}},{key:"close",value:function(){return this.opened=!1,Promise.resolve()}},{key:"_executeDestroy",value:function(){var e=this;this.objectStoreNames.forEach(function(t){e._executeRemoveAll(t),e.indexer[t].destroy()})}},{key:"destroy",value:function(){return this.opened=!1,this._executeDestroy(),Promise.resolve()}},{key:"isOpen",value:function(){return this.opened}},{key:"getStoreKey",value:function(e,t){return"".concat(this.name,".").concat(e,".").concat(t)}},{key:"mainKeyFromStoreKey",value:function(e,t){return e.replace("".concat(this.name,".").concat(t,"."),"")}}]),e}();OP.storage=window.localStorage,OP.adapterName="DomLocalStorageAdapter",OP.CACHEVERSIONKEY="__VERSION__",OP.errorMessages={INVALID_STORAGE_OBJECT:"Invalid storage object",SET_FAILED:"Save to localStorage failed",INVALID_KEY:"Key is invalid",KEY_BASED_COUNT_IS_NOT_SUPPORTED:"Key based count is not supported by DomLocalStorageAdapter",STORAGE_NOT_OPENED:"Please call open first in the DomLocalStorageAdapter"};var vP=OP,yP={INDEXED_DB:bP,LOCAL_STORAGE:vP,MEMORY:fP},EP={CONSTANTS:"constants",ORGANISATION_UNITS:"organisationUnits",ORGANISATION_UNIT_LEVELS:"ouLevels",RELATIONSHIP_TYPES:"relationshipTypes",TRACKED_ENTITY_TYPES:"trackedEntityTypes",PROGRAMS:"programs",PROGRAM_RULES:"programRules",PROGRAM_RULES_VARIABLES:"programRulesVariables",PROGRAM_INDICATORS:"programIndicators",TRACKED_ENTITY_ATTRIBUTES:"trackedEntityAttributes",OPTION_SETS:"optionSets",CATEGORIES:"categories"},_P={REDUX_PERSIST:"reduxPersist"},jP={USER_CACHES:"userCaches",STATUS:"status"};function IP(e){var t=e.name+Ee().id,n=function(){var e=Number("6");if(Number.isNaN(e)||!Number.isSafeInteger(e))throw new Error("invalid cache version");return e}(),a=function(){var e=Object.keys(EP).map(function(e){return EP[e]}),t=Object.keys(_P).map(function(e){return _P[e]});return[].concat(Object(We.a)(e),Object(We.a)(t))}();return new mP(t,n,[e.adapterType],a,function(){return e.setWithoutFallback(jP.STATUS,{id:"fallback",value:!0})})}function CP(){return(CP=Object(o.a)(r.a.mark(function e(t){var n,a;return r.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=IP(t),e.next=3,n.open(function(e){return e.get(_P.REDUX_PERSIST,"reduxPersist:offline").then(function(e){a=e})},function(e){return a?e.set(_P.REDUX_PERSIST,a):null});case 3:return e.abrupt("return",n);case 4:case"end":return e.stop()}},e)}))).apply(this,arguments)}var TP=function(e){return CP.apply(this,arguments)},SP="dhis2ca";function RP(e,t){var n=function(){var e=Number("6");if(Number.isNaN(e)||!Number.isSafeInteger(e))throw new Error("invalid cache version");return e}();return new mP(e,n,t,Object.keys(jP).map(function(e){return jP[e]}),function(e){return e.set(jP.STATUS,{id:"fallback",value:!0})})}function kP(){return(kP=Object(o.a)(r.a.mark(function e(t){var n,a,o,i;return r.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=RP(SP,t),e.next=3,n.open(function(e){return e.get(jP.USER_CACHES,"accessHistory").then(function(e){a=e})},function(e){return a?e.set(jP.USER_CACHES,a):null});case 3:return e.next=5,n.get(jP.STATUS,"fallback");case 5:if(!(o=e.sent)||!o.value){e.next=11;break}return i=RP(SP,[yP.MEMORY]),e.next=10,i.open();case 10:return e.abrupt("return",i);case 11:return e.abrupt("return",n);case 12:case"end":return e.stop()}},e)}))).apply(this,arguments)}var NP,AP,wP,FP=function(e){return kP.apply(this,arguments)},xP=[yP.INDEXED_DB,yP.LOCAL_STORAGE,yP.MEMORY],PP={};function DP(){return UP.apply(this,arguments)}function UP(){return(UP=Object(o.a)(r.a.mark(function e(){return r.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,FP(xP);case 2:return PP.main=e.sent,e.next=5,TP(PP.main);case 5:PP.user=e.sent;case 6:case"end":return e.stop()}},e)}))).apply(this,arguments)}function LP(){return PP.main}function MP(){return PP.user}function BP(){var e=_P.REDUX_PERSIST,t=MP();return{setItem:function(n,a){return t.set(e,{id:n,value:a})},getItem:function(n,a){t.get(e,n).then(function(e){a(null,e&&e.value)}).catch(function(e){a(e,null)})},removeItem:function(n){return t.remove(e,n)},getAllKeys:function(n){t.getKeys(e).then(function(e){n(null,e)}).catch(function(e){n(e,null)})}}}var VP,GP,WP,HP,zP,KP,YP,qP,XP,ZP,JP,QP,$P,eD,tD,nD,aD,rD,oD,iD,cD,sD,lD,uD,dD,pD,fD,mD,hD,bD,gD,OD,vD,yD,ED,_D,jD,ID,CD=Object(_p.b)((NP={},Object(Ut.a)(NP,Uh.ADD_FORM_DATA,function(e,t){var n=Object(se.a)({},e),a=t.payload;return n[a.formId]=a.formValues,n}),Object(Ut.a)(NP,Vp,function(e,t){var n=Object(se.a)({},e),a=t.payload;return(n[a.formId]=Object(se.a)({},n[a.formId]))[a.elementId]=a.value,n}),Object(Ut.a)(NP,af,function(e,t){var n=t.payload,a=n.formId,r=n.elementId,o=n.value;return Object(se.a)({},e,Object(Ut.a)({},a,Object(se.a)({},e[a],Object(Ut.a)({},r,o))))}),Object(Ut.a)(NP,Sf,function(e,t){var n=Object(se.a)({},e),a=t.payload;return(n[a.formId]=Object(se.a)({},n[a.formId]))[a.elementId]=a.value,n}),Object(Ut.a)(NP,Ip,function(e,t){var n=Object(se.a)({},e),a=t.payload;return(n[a.formId]=Object(se.a)({},n[a.formId]))[a.elementId]=a.value,n}),Object(Ut.a)(NP,jp,function(e,t){var n=t.payload.rulesEffects&&t.payload.rulesEffects[gp.ASSIGN_VALUE];if(!n)return e;var a=t.payload;return Object(se.a)({},e,Object(Ut.a)({},a.formId,Object(se.a)({},e[a.formId],n)))}),NP),"formsValues"),TD=Object(_p.b)((AP={},Object(Ut.a)(AP,Uh.ADD_FORM_DATA,function(e,t){var n=Object(se.a)({},e),a=t.payload.formId;return Object.keys(n).filter(function(e){return e.startsWith(a)}).forEach(function(e){n[e]={}}),n}),Object(Ut.a)(AP,$p,function(e,t){var n=Object(se.a)({},e),a=t.payload;return n[a.formBuilderId]=Object.keys(a.fieldsUI).reduce(function(e,t){return e[t]=Object(se.a)({},e[t],a.fieldsUI[t],{validatingMessage:null}),e},Object(se.a)({},n[a.formBuilderId])),n}),Object(Ut.a)(AP,Vp,function(e,t){var n=Object(se.a)({},e),a=t.payload;n[a.sectionId]=Object(se.a)({},n[a.sectionId]);var r=n[a.sectionId];return r[a.elementId]=Object(se.a)({},r[a.elementId],a.uiState,{modified:!0,validatingMessage:null}),n}),Object(Ut.a)(AP,nf,function(e,t){var n=t.payload,a=n.formBuilderId,r=n.elementId;return Object(se.a)({},e,Object(Ut.a)({},a,Object(se.a)({},e[a],Object(Ut.a)({},r,Object(se.a)({},e[a]&&e[a][r],{loading:!0})))))}),Object(Ut.a)(AP,af,function(e,t){var n=t.payload,a=n.uiState,r=n.formBuilderId,o=n.elementId;return Object(se.a)({},e,Object(Ut.a)({},r,Object(se.a)({},e[r],Object(Ut.a)({},o,Object(se.a)({},e[r]&&e[r][o],a,{modified:!0,validatingMessage:null,loading:!1})))))}),Object(Ut.a)(AP,rf,function(e,t){var n=t.payload,a=n.uiState,r=n.formBuilderId,o=n.elementId,i=n.errorMessage;return Object(se.a)({},e,Object(Ut.a)({},r,Object(se.a)({},e[r],Object(Ut.a)({},o,Object(se.a)({},e[r]&&e[r][o],a,{modified:!0,validatingMessage:null,loading:!1,warning:i})))))}),Object(Ut.a)(AP,Sf,function(e,t){var n=Object(se.a)({},e),a=t.payload;n[a.formBuilderId]=Object(se.a)({},n[a.formBuilderId]);var r=n[a.formBuilderId];return r[a.elementId]=Object(se.a)({},r[a.elementId],a.uiState,{modified:!0,validatingMessage:null}),n}),Object(Ut.a)(AP,cs,function(e,t){var n=Object(se.a)({},e),a=t.payload;n[a.sectionId]=Object(se.a)({},n[a.sectionId]);var r=n[a.sectionId];return r[a.elementId]=Object(se.a)({},r[a.elementId],a.uiState),n}),Object(Ut.a)(AP,ef,function(e,t){var n=t.payload,a=n.fieldId,r=n.formBuilderId,o=n.message,i=n.fieldUIUpdates;return Object(se.a)({},e,Object(Ut.a)({},r,Object(se.a)({},e[r],Object(Ut.a)({},a,Object(se.a)({},e[r]&&e[r][a],i,{validatingMessage:o})))))}),AP),"formsSectionsFieldsUI"),SD=Object(_p.b)(Object(Ut.a)({},Uh.ADD_FORM_DATA,function(e,t){var n,a=t.payload,r=e[a.formId]&&e[a.formId].loadNr;return n=r?999===r?1:r+1:1,Object(se.a)({},e,Object(Ut.a)({},a.formId,Object(se.a)({},e[a.formId],{loadNr:n})))}),"forms"),RD=Object(_p.b)((wP={},Object(Ut.a)(wP,Uh.ADD_FORM_DATA,function(e,t){return Object(se.a)({},e,Object(Ut.a)({},t.payload.formId,{}))}),Object(Ut.a)(wP,ul,function(e,t){var n=t.payload,a=n.formId,r=n.elementId,o=n.searchText;return Object(se.a)({},e,Object(Ut.a)({},a,Object(se.a)({},e[a],Object(Ut.a)({},r,Object(se.a)({},e[a][r],{orgUnitsLoading:!0,orgUnitsSearchText:o})))))}),Object(Ut.a)(wP,dl,function(e,t){var n=t.payload,a=n.formId,r=n.elementId,o=n.roots;return Object(se.a)({},e,Object(Ut.a)({},a,Object(se.a)({},e[a],Object(Ut.a)({},r,Object(se.a)({},e[a][r],{orgUnitsLoading:!1,orgUnitsRoots:o})))))}),Object(Ut.a)(wP,pl,function(e,t){var n=t.payload,a=n.formId,r=n.elementId;return Object(se.a)({},e,Object(Ut.a)({},a,Object(se.a)({},e[a],Object(Ut.a)({},r,Object(se.a)({},e[a][r],{orgUnitsLoading:!1})))))}),Object(Ut.a)(wP,fl,function(e,t){var n=t.payload,a=n.formId,r=n.elementId;return jc(ml(a,r),null),Object(se.a)({},e,Object(Ut.a)({},a,Object(se.a)({},e[a],Object(Ut.a)({},r,Object(se.a)({},e[a][r],{orgUnitsLoading:!1,orgUnitsRoots:null,orgUnitsSearchText:null})))))}),wP),"formsFieldsMisc"),kD="EnrollmentLoaded",ND="EnrollmentLoadFailed",AD=function(e,t){return e&&0!==e.length?e.reduce(function(e,n){return e[n.id]=n[t],e},{}):{}},wD=Object(_p.b)((VP={},Object(Ut.a)(VP,rx,function(e,t){var n=t.payload.eventContainers,a=AD(n,"event");return Object(se.a)({},a)}),Object(Ut.a)(VP,fT,function(e,t){var n=t.payload.eventContainers,a=AD(n,"event");return Object(se.a)({},a)}),Object(Ut.a)(VP,kD,function(e,t){var n=t.payload;if(!n||0===n.length)return e;var a=n.reduce(function(e,t){return e[t.id]=t.event,e},{});return Object(se.a)({},e,a)}),Object(Ut.a)(VP,jf,function(e,t){var n=Object(se.a)({},e),a=t.payload;return n[a.eventId]=a.event,n}),Object(Ut.a)(VP,Ef,function(e,t){var n=Object(se.a)({},e),a=t.payload;return n[a.eventId]=a.event,n}),Object(Ut.a)(VP,bx,function(e,t){var n=t.payload.eventContainer.event;return Object(se.a)({},e,Object(Ut.a)({},n.eventId,n))}),Object(Ut.a)(VP,TA,function(e,t){var n=t.payload.eventContainer.event;return Object(se.a)({},e,Object(Ut.a)({},n.eventId,n))}),Object(Ut.a)(VP,AA,function(e,t){var n=Object(se.a)({},e),a=t.payload;return n&&n[a.eventId]&&(n[a.eventId].notes=[].concat(Object(We.a)(e[a.eventId].notes),[a.note])),n}),Object(Ut.a)(VP,wA,function(e,t){var n=Object(se.a)({},e),a=t.payload;return n&&n[a.eventId]&&(n[a.eventId].notes=e[a.eventId].notes.filter(function(e){return e.clientId!==a.noteClientId})),n}),VP),"events",{}),FD=Object(_p.b)((GP={},Object(Ut.a)(GP,rx,function(e,t){var n=t.payload.eventContainers,a=AD(n,"values");return Object(se.a)({},a)}),Object(Ut.a)(GP,fT,function(e,t){var n=t.payload.eventContainers,a=AD(n,"values");return Object(se.a)({},a)}),Object(Ut.a)(GP,kD,function(e,t){var n=t.payload;if(!n||0===n.length)return e;var a=n.reduce(function(e,t){return e[t.id]=t.values,e},{});return Object(se.a)({},e,a)}),Object(Ut.a)(GP,Ef,function(e,t){var n=Object(se.a)({},e);return n[t.payload.eventId]=t.payload.clientValues,n}),Object(Ut.a)(GP,jf,function(e,t){var n=Object(se.a)({},e);return n[t.payload.eventId]=t.payload.clientValues,n}),GP),"eventsValues",{}),xD=Object(_p.b)((WP={},Object(Ut.a)(WP,Wh.LOAD_NEW_DATA_ENTRY,function(e,t){var n=Object(se.a)({},e),a=t.payload;return n[a.dataEntryId]=Object(se.a)({},n[a.dataEntryId]),n[a.dataEntryId].itemId=a.itemId,n}),Object(Ut.a)(WP,zh.LOAD_EDIT_DATA_ENTRY,function(e,t){var n=Object(se.a)({},e),a=t.payload;return n[a.dataEntryId]=Object(se.a)({},n[a.dataEntryId],{itemId:a.itemId},a.extraProps),n}),Object(Ut.a)(WP,Yh.LOAD_VIEW_DATA_ENTRY,function(e,t){var n=Object(se.a)({},e),a=t.payload;return n[a.dataEntryId]=Object(se.a)({},n[a.dataEntryId],{itemId:a.itemId},a.extraProps),n}),Object(Ut.a)(WP,Af,function(e,t){var n=Object(se.a)({},e),a=t.payload;return n[a.dataEntryId]=Object(se.a)({},n[a.dataEntryId],{itemId:a.itemId},a.extraProps),n}),WP),"dataEntries"),PD=Object(_p.b)((HP={},Object(Ut.a)(HP,Wh.LOAD_NEW_DATA_ENTRY,function(e,t){var n=Object(se.a)({},e);return n[t.payload.key]={loaded:!0},n}),Object(Ut.a)(HP,zh.LOAD_EDIT_DATA_ENTRY,function(e,t){var n=Object(se.a)({},e);return n[t.payload.key]={loaded:!0},n}),Object(Ut.a)(HP,Yh.LOAD_VIEW_DATA_ENTRY,function(e,t){var n=Object(se.a)({},e);return n[t.payload.key]={loaded:!0},n}),Object(Ut.a)(HP,If,function(e,t){var n=Object(se.a)({},e),a=t.payload,r=ff(a.id,a.itemId);return n[r]=Object(se.a)({},n[r]),n[r].saveAttempted=!0,n}),Object(Ut.a)(HP,Cf,function(e,t){var n=Object(se.a)({},e),a=t.payload,r=ff(a.id,a.itemId);return n[r]=Object(se.a)({},n[r]),n[r].saveAttempted=!0,n}),Object(Ut.a)(HP,Sf,function(e,t){var n=Object(se.a)({},e),a=t.payload,r=ff(a.dataEntryId,a.itemId);return n[r]=Object(se.a)({},n[r]),n[r].inProgress=n[r].inProgress?n[r].inProgress+1:1,n}),Object(Ut.a)(HP,Rf,function(e,t){var n=Object(se.a)({},e),a=t.payload,r=ff(a.dataEntryId,a.itemId);return n[r]=Object(se.a)({},n[r]),n[r].inProgress=n[r].inProgress?n[r].inProgress-1:0,n}),HP),"dataEntriesUI"),DD=Object(_p.b)((zP={},Object(Ut.a)(zP,Wh.LOAD_NEW_DATA_ENTRY,function(e,t){var n=Object(se.a)({},e),a=t.payload,r=a.dataEntryValues;return n[a.key]=r||{},n}),Object(Ut.a)(zP,zh.LOAD_EDIT_DATA_ENTRY,function(e,t){var n=Object(se.a)({},e),a=t.payload;return n[a.key]=a.dataEntryValues,n}),Object(Ut.a)(zP,Yh.LOAD_VIEW_DATA_ENTRY,function(e,t){var n=Object(se.a)({},e),a=t.payload;return n[a.key]=a.dataEntryValues,n}),Object(Ut.a)(zP,Tf,function(e,t){var n=Object(se.a)({},e),a=t.payload,r=ff(a.dataEntryId,a.itemId);return n[r]=Object(se.a)({},n[r]),n[r][a.fieldId]=a.value,n}),zP),"dataEntriesFieldsValue"),UD=Object(_p.b)((KP={},Object(Ut.a)(KP,Wh.LOAD_NEW_DATA_ENTRY,function(e,t){var n=Object(se.a)({},e);return n[t.payload.key]=[],n}),Object(Ut.a)(KP,zh.LOAD_EDIT_DATA_ENTRY,function(e,t){var n=Object(se.a)({},e),a=t.payload;return n[a.key]=a.dataEntryNotes?Object(We.a)(a.dataEntryNotes):[],n}),Object(Ut.a)(KP,kf,function(e,t){var n=Object(se.a)({},e),a=t.payload,r=ff(a.dataEntryId,a.itemId),o=e[r]?e[r].length:0;return n[r]=[].concat(Object(We.a)(e[r]),[Object(se.a)({},a.note,{key:o})]),n}),Object(Ut.a)(KP,Nf,function(e,t){var n=Object(se.a)({},e),a=t.payload,r=ff(a.dataEntryId,a.itemId);return n[r]=e[r].filter(function(e){return e.clientId!==a.noteClientId}),n}),KP),"dataEntriesNotes",{}),LD=Object(_p.b)((YP={},Object(Ut.a)(YP,Wh.LOAD_NEW_DATA_ENTRY,function(e,t){var n=Object(se.a)({},e),a=t.payload;return n[a.key]=a.dataEntryMeta,n}),Object(Ut.a)(YP,zh.LOAD_EDIT_DATA_ENTRY,function(e,t){var n=Object(se.a)({},e),a=t.payload;return n[a.key]=a.dataEntryMeta,n}),Object(Ut.a)(YP,Yh.LOAD_VIEW_DATA_ENTRY,function(e,t){var n=Object(se.a)({},e),a=t.payload;return n[a.key]=a.dataEntryMeta,n}),YP),"dataEntriesFieldsMeta"),MD=Object(_p.b)((qP={},Object(Ut.a)(qP,Wh.LOAD_NEW_DATA_ENTRY,function(e,t){var n=Object(se.a)({},e),a=t.payload;return n[a.key]=Object.keys(a.dataEntryUI).reduce(function(e,t){return e[t]=Object(se.a)({},a.dataEntryUI[t],{touched:!1}),e},{}),n}),Object(Ut.a)(qP,zh.LOAD_EDIT_DATA_ENTRY,function(e,t){var n=Object(se.a)({},e),a=t.payload;return n[a.key]=Object.keys(a.dataEntryUI).reduce(function(e,t){return e[t]=Object(se.a)({},a.dataEntryUI[t],{touched:!1}),e},{}),n}),Object(Ut.a)(qP,Yh.LOAD_VIEW_DATA_ENTRY,function(e,t){var n=Object(se.a)({},e),a=t.payload;return n[a.key]=Object.keys(a.dataEntryUI).reduce(function(e,t){return e[t]=Object(se.a)({},a.dataEntryUI[t],{touched:!1}),e},{}),n}),Object(Ut.a)(qP,Tf,function(e,t){var n=Object(se.a)({},e),a=t.payload,r=ff(a.dataEntryId,a.itemId);n[r]=Object(se.a)({},n[r]);var o=n[r];return o[a.fieldId]=Object(se.a)({},o[a.fieldId],a.valueMeta,{modified:!0}),n}),qP),"dataEntriesFieldsUI"),BD=Object(_p.b)((XP={},Object(Ut.a)(XP,Wh.LOAD_NEW_DATA_ENTRY,function(e,t){var n=Object(se.a)({},e);return n[t.payload.key]=[],n}),Object(Ut.a)(XP,zh.LOAD_EDIT_DATA_ENTRY,function(e,t){var n=Object(se.a)({},e),a=t.payload;return n[a.key]=a.dataEntryRelationships?Object(We.a)(a.dataEntryRelationships):[],n}),Object(Ut.a)(XP,xf,function(e,t){var n=Object(se.a)({},e),a=t.payload,r=ff(a.dataEntryId,a.itemId);return n[r]=e[r]?[].concat(Object(We.a)(e[r]),[Object(se.a)({},a.relationship)]):[Object(se.a)({},a.relationship)],n}),Object(Ut.a)(XP,Ff,function(e,t){var n=Object(se.a)({},e),a=t.payload,r=ff(a.dataEntryId,a.itemId);return n[r]=e[r].filter(function(e){return e.clientId!==a.relationshipClientId}),n}),XP),"dataEntriesRelationships",{}),VD=Object(_p.b)((ZP={},Object(Ut.a)(ZP,Wh.LOAD_NEW_DATA_ENTRY,function(e,t){var n=Object(se.a)({},e);return n[t.payload.key]=null,n}),Object(Ut.a)(ZP,zh.LOAD_EDIT_DATA_ENTRY,function(e,t){var n=Object(se.a)({},e);return n[t.payload.key]=null,n}),Object(Ut.a)(ZP,Rh.SEARCH_GROUP_RESULT_COUNT_RETRIVED,function(e,t){var n=t.payload,a=n.count,r=n.dataEntryKey,o=n.groupId;return Object(se.a)({},e,Object(Ut.a)({},r,Object(se.a)({},e[r],Object(Ut.a)({},o,Object(se.a)({},e[r]&&e[r][o],{count:a})))))}),Object(Ut.a)(ZP,Rh.SEARCH_GROUP_RESULT_COUNT_RETRIEVAL_FAILED,function(e,t){var n=t.payload,a=n.error,r=n.dataEntryKey,o=n.groupId;return Object(se.a)({},e,Object(Ut.a)({},r,Object(se.a)({},e[r],Object(Ut.a)({},o,Object(se.a)({},e[r]&&e[r][o],{countError:a})))))}),Object(Ut.a)(ZP,Rh.ABORT_SEARCH_GROUP_COUNT_SEARCH,function(e,t){var n=t.payload,a=n.dataEntryKey,r=n.groupId;return Object(se.a)({},e,Object(Ut.a)({},a,Object(se.a)({},e[a],Object(Ut.a)({},r,null))))}),ZP),"dataEntriesSearchGroupsResults"),GD=Object(_p.b)((JP={},Object(Ut.a)(JP,Rh.START_SEARCH_GROUP_COUNT_SEARCH,function(e,t){var n=t.payload,a=n.dataEntryKey,r=n.searchGroupId,o=n.values;return Object(se.a)({},e,Object(Ut.a)({},a,Object(se.a)({},e[a],Object(Ut.a)({},r,Object(se.a)({},o)))))}),Object(Ut.a)(JP,Rh.ABORT_SEARCH_GROUP_COUNT_SEARCH,function(e,t){var n=t.payload,a=n.dataEntryKey,r=n.groupId;return Object(se.a)({},e,Object(Ut.a)({},a,Object(se.a)({},e[a],Object(Ut.a)({},r,null))))}),Object(Ut.a)(JP,Wh.LOAD_NEW_DATA_ENTRY,function(e,t){var n=t.payload.key;return Object(se.a)({},e,Object(Ut.a)({},n,null))}),Object(Ut.a)(JP,zh.LOAD_EDIT_DATA_ENTRY,function(e,t){var n=t.payload.key;return Object(se.a)({},e,Object(Ut.a)({},n,null))}),JP),"dataEntriesSearchGroupsPreviousValues"),WD=Object(_p.b)((QP={},Object(Ut.a)(QP,Wh.LOAD_NEW_DATA_ENTRY,function(e,t){var n=t.payload.key;return Object(se.a)({},e,Object(Ut.a)({},n,null))}),Object(Ut.a)(QP,zh.LOAD_EDIT_DATA_ENTRY,function(e,t){var n=t.payload.key;return Object(se.a)({},e,Object(Ut.a)({},n,null))}),Object(Ut.a)(QP,Rh.FILTER_SEARCH_GROUP_FOR_COUNT_TO_BE_EXECUTED,function(e,t){var n=t.payload,a=n.uid,r=n.dataEntryKey;return Object(se.a)({},e,Object(Ut.a)({},r,[].concat(Object(We.a)(e[r]||[]),[a])))}),Object(Ut.a)(QP,Rh.SEARCH_GROUP_RESULT_COUNT_RETRIVED,function(e,t){var n=t.payload,a=n.uids,r=n.dataEntryKey,o=Object(We.a)((e[r]||[]).filter(function(e){return!a.includes(e)}));return Object(se.a)({},e,Object(Ut.a)({},r,o))}),Object(Ut.a)(QP,Rh.SEARCH_GROUP_RESULT_COUNT_RETRIEVAL_FAILED,function(e,t){var n=t.payload,a=n.uids,r=n.dataEntryKey,o=Object(We.a)((e[r]||[]).filter(function(e){return!a.includes(e)}));return Object(se.a)({},e,Object(Ut.a)({},r,o))}),Object(Ut.a)(QP,Rh.ABORT_SEARCH_GROUP_COUNT_SEARCH,function(e,t){var n=t.payload,a=n.uids,r=n.dataEntryKey,o=Object(We.a)((e[r]||[]).filter(function(e){return!a.includes(e)}));return Object(se.a)({},e,Object(Ut.a)({},r,o))}),Object(Ut.a)(QP,Rh.CANCEL_SEARCH_GROUP_COUNT_SEARCH,function(e,t){var n=t.payload,a=n.uid,r=n.dataEntryKey,o=Object(We.a)((e[r]||[]).filter(function(e){return a!==e}));return Object(se.a)({},e,Object(Ut.a)({},r,o))}),Object(Ut.a)(QP,ef,function(e,t){var n=t.payload,a=n.formId,r=n.validatingUid,o=[].concat(Object(We.a)(e[a]||[]),[r]),i=new Set(o);return Object(se.a)({},e,Object(Ut.a)({},a,Array.from(i)))}),Object(Ut.a)(QP,$p,function(e,t){var n=t.payload,a=n.formId,r=n.validatingUids,o=(e[a]||[]).filter(function(e){return!r.includes(e)});return Object(se.a)({},e,Object(Ut.a)({},a,o))}),Object(Ut.a)(QP,Sf,function(e,t){var n=t.payload,a=n.formId,r=n.updateCompleteUid,o=(e[a]||[]).filter(function(e){return e!==r});return Object(se.a)({},e,Object(Ut.a)({},a,o))}),Object(Ut.a)(QP,nf,function(e,t){var n=t.payload,a=n.formId,r=n.uid;return Object(se.a)({},e,Object(Ut.a)({},a,[].concat(Object(We.a)(e[a]||[]),[r])))}),Object(Ut.a)(QP,af,function(e,t){var n=t.payload,a=n.formId,r=n.uid,o=(e[a]||[]).filter(function(e){return e!==r});return Object(se.a)({},e,Object(Ut.a)({},a,o))}),Object(Ut.a)(QP,rf,function(e,t){var n=t.payload,a=n.formId,r=n.uid,o=(e[a]||[]).filter(function(e){return e!==r});return Object(se.a)({},e,Object(Ut.a)({},a,o))}),Object(Ut.a)(QP,wf,function(e,t){var n=t.payload,a=n.dataEntryId,r=n.itemId,o=n.uid,i=ff(a,r);return Object(se.a)({},e,Object(Ut.a)({},i,[].concat(Object(We.a)(e[i]||[]),[o])))}),Object(Ut.a)(QP,Rf,function(e,t){var n=t.payload,a=n.dataEntryId,r=n.itemId,o=n.uid,i=ff(a,r),c=(e[i]||[]).filter(function(e){return e!==o});return Object(se.a)({},e,Object(Ut.a)({},i,c))}),QP),"dataEntriesInProgressList"),HD="GoingOnlineExecutedBatch",zD="GoingOnlineExecuted",KD="GetEventListOnReconnect",YD="CleanUpEventListInLoading",qD=function(){return le(YD)()},XD=Object(_p.b)(($P={},Object(Ut.a)($P,rx,function(e,t){var n=Object(se.a)({},e),a=t.payload.eventContainers;return n.main={order:a?a.map(function(e){return e.event.eventId}):[],type:"event"},n}),Object(Ut.a)($P,fT,function(e,t){var n=Object(se.a)({},e),a=t.payload.eventContainers;return n.main={order:a?a.map(function(e){return e.event.eventId}):[],type:"event"},n}),Object(Ut.a)($P,vC,function(e,t){var n=Object(se.a)({},e),a=t.payload,r=a.listId,o=a.itemId;return n[r]={order:[].concat(Object(We.a)(e[r]?e[r].order:[]),[o])},n}),Object(Ut.a)($P,yC,function(e,t){var n=Object(se.a)({},e),a=t.payload,r=a.listId,o=a.itemId;return n[r]={order:[o].concat(Object(We.a)(e[r]?e[r].order:[]))},n}),Object(Ut.a)($P,EC,function(e,t){var n=Object(se.a)({},e),a=t.payload,r=a.listId,o=a.itemId;return n[r]={order:e[r]?e[r].order.filter(function(e){return e!==o}):[]},n}),Object(Ut.a)($P,_C,function(e,t){var n=Object(se.a)({},e);return n[t.payload.listId]={order:[]},n}),$P),"workingLists"),ZD=function(e){return Object(se.a)({},e,{main:Object(se.a)({},e.main,{next:Object(se.a)({},e.main?e.main.next:null,{sortById:"eventDate",sortByDirection:"desc",filters:e.main&&e.main.filters?Object.keys(e.main.filters).reduce(function(e,t){return e[t]=null,e},{}):null})})})},JD=function(e,t){var n=t.payload;return n.nextProps.programId!==n.prevProps.programId?ZD(e):e},QD=Object(_p.b)((eD={},Object(Ut.a)(eD,rx,function(e,t){var n=Object(se.a)({},e),a=t.payload,r=n.main,o=n.main&&n.main.next,i=Object(se.a)({},r?r.filters:null,o?o.filters:null),c=Object.keys(i).reduce(function(e,t){return i[t]&&(e[t]=i[t]),e},{});return n.main=Object(se.a)({},r,o,a.argsWithDefaults,a.pagingData,{filters:c,next:{}}),n}),Object(Ut.a)(eD,ox,function(e){return Object(se.a)({},e,{main:Object(se.a)({},e.main,{next:{}})})}),Object(Ut.a)(eD,fT,function(e,t){var n=Object(se.a)({},e),a=t.payload.pagingData,r=n.main.next;return n.main=Object(se.a)({},n.main,r,a,{filters:Object(se.a)({},n.main.filters,n.main.next.filters),next:{}}),n}),Object(Ut.a)(eD,mT,function(e){var t=Object(se.a)({},e);return t.main=Object(se.a)({},t.main,{next:{}}),t}),Object(Ut.a)(eD,RT,function(e,t){var n=Object(se.a)({},e),a=t.payload;return n.main=Object(se.a)({},n.main,{next:Object(se.a)({},n.main.next,{currentPage:a})}),n}),Object(Ut.a)(eD,hT,function(e,t){var n=Object(se.a)({},e),a=t.payload,r=a.id,o=a.direction;return n.main=Object(se.a)({},n.main,{next:Object(se.a)({},n.main.next,{sortById:r,sortByDirection:o,currentPage:1})}),n}),Object(Ut.a)(eD,kT,function(e,t){var n=Object(se.a)({},e),a=t.payload;return n.main=Object(se.a)({},n.main,{next:Object(se.a)({},n.main.next,{rowsPerPage:a,currentPage:1})}),n}),Object(Ut.a)(eD,_R,function(e,t){var n=Object(se.a)({},e),a=t.payload;return n.main=Object(se.a)({},n.main,{next:Object(se.a)({},n.main.next,{filters:Object(se.a)({},n.main.next?n.main.next.filters:null,Object(Ut.a)({},a.itemId,a.requestData))})}),n}),Object(Ut.a)(eD,jR,function(e,t){var n=Object(se.a)({},e),a=t.payload.itemId,r=Object(se.a)({},n.main.next?n.main.next.filters:null,Object(Ut.a)({},a,null));return n.main=Object(se.a)({},n.main,{next:Object(se.a)({},n.main.next,{filters:r})}),n}),Object(Ut.a)(eD,_C,function(e,t){var n=Object(se.a)({},e);return n[t.payload.listId]=t.payload.meta,n}),Object(Ut.a)(eD,_n,ZD),Object(Ut.a)(eD,cx,JD),Object(Ut.a)(eD,fI.UPDATE_SELECTIONS_FROM_URL,JD),Object(Ut.a)(eD,bx,function(e,t){var n=t.payload;return n.eventContainer.event.programId!==n.prevProgramId?ZD(e):e}),Object(Ut.a)(eD,TA,function(e,t){var n=t.payload;return n.eventContainer.event.programId!==n.prevProgramId?ZD(e):e}),Object(Ut.a)(eD,YD,function(e){return Object(se.a)({},e,{main:Object(se.a)({},e.main,{next:{}})})}),eD),"workingListsMeta"),$D=function(e){return Object(se.a)({},e,{isLoading:!0})},eU=function(e,t){return Object(se.a)({},e,t,{isLoading:!1,isUpdating:!1,isUpdatingWithDialog:!1})},tU=Object(_p.b)((tD={},Object(Ut.a)(tD,nx,function(e){var t=Object(se.a)({},e);return t.main=$D(t.main),t}),Object(Ut.a)(tD,aC,function(e){var t=Object(se.a)({},e);return t.main=$D(t.main),t}),Object(Ut.a)(tD,oC,function(e){var t=Object(se.a)({},e);return t.main=$D(t.main),t}),Object(Ut.a)(tD,cC,function(e){var t=Object(se.a)({},e);return t.main=$D(t.main),t}),Object(Ut.a)(tD,fx,function(e){var t=Object(se.a)({},e);return t.main=$D(t.main),t}),Object(Ut.a)(tD,RT,function(e){var t=Object(se.a)({},e);return t.main=$D(t.main),t}),Object(Ut.a)(tD,kT,function(e){var t=Object(se.a)({},e);return t.main=$D(t.main),t}),Object(Ut.a)(tD,hT,function(e){var t=Object(se.a)({},e);return t.main=$D(t.main),t}),Object(Ut.a)(tD,_T,function(e){var t=Object(se.a)({},e);return t.main=Object(se.a)({},t.main,{isUpdating:!0}),t}),Object(Ut.a)(tD,jT,function(e){var t=Object(se.a)({},e);return t.main=Object(se.a)({},t.main,{isUpdatingWithDialog:!0}),t}),Object(Ut.a)(tD,rx,function(e){var t=Object(se.a)({},e);return t.main=eU(t.main,{hasBeenLoaded:!0,dataLoadingError:null}),t}),Object(Ut.a)(tD,fT,function(e){var t=Object(se.a)({},e);return t.main=eU(t.main,{dataLoadingError:null}),t}),Object(Ut.a)(tD,ox,function(e,t){var n=Object(se.a)({},e);return n.main=eU({},{dataLoadingError:t.payload}),n}),Object(Ut.a)(tD,mT,function(e){var t=Object(se.a)({},e);return t.main=eU({},{dataLoadingError:null}),t}),Object(Ut.a)(tD,Yb,function(e){var t=Object(se.a)({},e);return t.main=$D(t.main),t}),Object(Ut.a)(tD,Xb,function(e){var t=Object(se.a)({},e);return t.main=$D(t.main),t}),Object(Ut.a)(tD,Zb,function(e){var t=Object(se.a)({},e);return t.main=eU(t.main,{}),t}),Object(Ut.a)(tD,$b,function(e){var t=Object(se.a)({},e);return t.main=eU(t.main,{}),t}),Object(Ut.a)(tD,JN,function(e){var t=Object(se.a)({},e);return t.main=$D(t.main),t}),Object(Ut.a)(tD,eA,function(e){var t=Object(se.a)({},e);return t.main=eU(t.main,{}),t}),Object(Ut.a)(tD,tA,function(e){var t=Object(se.a)({},e);return t.main=$D(t.main),t}),Object(Ut.a)(tD,nA,function(e){var t=Object(se.a)({},e);return t.main=eU(t.main,{}),t}),Object(Ut.a)(tD,PA,function(e){var t=Object(se.a)({},e);return t.main=$D(t.main),t}),Object(Ut.a)(tD,xA,function(e){var t=Object(se.a)({},e);return t.main=eU(t.main,{}),t}),Object(Ut.a)(tD,KD,function(e){var t=Object(se.a)({},e);return t.main=$D(t.main),t}),Object(Ut.a)(tD,YD,function(e){return Object(se.a)({},e,{main:eU(e.main,{})})}),tD),"workingListsUI"),nU=function(e){return Object(se.a)({},e,{main:null})},aU=function(e,t){var n=t.payload;return n.nextProps.programId!==n.prevProps.programId?nU(e):e},rU=Object(_p.b)((nD={},Object(Ut.a)(nD,rx,function(e,t){if(!t.payload.columnsOrder)return e;var n=Object(se.a)({},e);return n.main=t.payload.columnsOrder,n}),Object(Ut.a)(nD,gk,function(e,t){var n=Object(se.a)({},e);return n.main=Object(We.a)(t.payload),n}),Object(Ut.a)(nD,_C,function(e,t){var n=Object(se.a)({},e);return n[t.payload.listId]=Object(We.a)(t.payload.columnsOrder),n}),Object(Ut.a)(nD,_n,nU),Object(Ut.a)(nD,cx,aU),Object(Ut.a)(nD,fI.UPDATE_SELECTIONS_FROM_URL,aU),Object(Ut.a)(nD,bx,function(e,t){var n=t.payload;return n.eventContainer.event.programId!==n.prevProgramId?nU(e):e}),Object(Ut.a)(nD,TA,function(e,t){var n=t.payload;return n.eventContainer.event.programId!==n.prevProgramId?nU(e):e}),nD),"workingListsColumnsOrder"),oU=Object(_p.b)((aD={},Object(Ut.a)(aD,rx,function(e,t){var n=Object(se.a)({},e);return n.main=t.payload.selections,n}),Object(Ut.a)(aD,_C,function(e,t){var n=Object(se.a)({},e);return n[t.payload.listId]=t.payload.selections,n}),Object(Ut.a)(aD,_n,function(e){return Object(se.a)({},e,{main:null})}),Object(Ut.a)(aD,cx,function(e,t){var n=t.payload;return n.nextProps.programId!==n.prevProps.programId?Object(se.a)({},e,{main:null}):e}),Object(Ut.a)(aD,fI.UPDATE_SELECTIONS_FROM_URL,function(e,t){var n=t.payload;return n.nextProps.programId!==n.prevProps.programId?Object(se.a)({},e,{main:null}):e}),Object(Ut.a)(aD,bx,function(e,t){var n=t.payload;return n.eventContainer.event.programId!==n.prevProgramId?Object(se.a)({},e,{main:null}):e}),Object(Ut.a)(aD,TA,function(e,t){var n=t.payload;return n.eventContainer.event.programId!==n.prevProgramId?Object(se.a)({},e,{main:null}):e}),aD),"workingListsContext"),iU=function(e,t){var n=t.payload;return n.nextProps.programId!==n.prevProps.programId?Object(se.a)({},e,{main:{}}):e},cU=Object(_p.b)((rD={},Object(Ut.a)(rD,ER,function(e,t){var n=t.payload,a=Object(se.a)({},e);return a.main=Object(se.a)({},a.main,{next:Object(se.a)({},a.main?a.main.next:null,Object(Ut.a)({},n.itemId,n.value))}),a}),Object(Ut.a)(rD,jR,function(e,t){var n,a=t.payload.itemId,r=Object(se.a)({},e);return r.main=Object(se.a)({},r.main,(n={},Object(Ut.a)(n,a,null),Object(Ut.a)(n,"next",{}),n)),r}),Object(Ut.a)(rD,_R,function(e){var t=Object(se.a)({},e);return t.main=Object(se.a)({},t.main,t.main?t.main.next:null,{next:{}}),t}),Object(Ut.a)(rD,IR,function(e){var t=Object(se.a)({},e);return t.main=Object(se.a)({},t.main,{next:{}}),t}),Object(Ut.a)(rD,_n,function(e){return Object(se.a)({},e,{main:{}})}),Object(Ut.a)(rD,cx,iU),Object(Ut.a)(rD,fI.UPDATE_SELECTIONS_FROM_URL,iU),Object(Ut.a)(rD,bx,function(e,t){var n=t.payload;return n.eventContainer.event.programId!==n.prevProgramId?Object(se.a)({},e,{main:{}}):e}),Object(Ut.a)(rD,TA,function(e,t){var n=t.payload;return n.eventContainer.event.programId!==n.prevProgramId?Object(se.a)({},e,{main:{}}):e}),rD),"workingListFiltersEdit"),sU=function(e){return Object(se.a)({},e,{main:Object(se.a)({},e.main,{next:e.main?Object.keys(e.main).reduce(function(e,t){return"next"!==t&&(e[t]=null),e},{}):null})})},lU=function(e,t){var n=t.payload;return n.nextProps.programId!==n.prevProps.programId?sU(e):e},uU=Object(_p.b)((oD={},Object(Ut.a)(oD,rx,function(e){var t=Object(se.a)({},e),n=t.main?t.main.next:null,a=Object(se.a)({},t.main,n),r=Object.keys(a).reduce(function(e,t){return a[t]&&(e[t]=a[t]),e},{});return t.main=Object(se.a)({},r,{next:{}}),t}),Object(Ut.a)(oD,ox,function(e){return Object(se.a)({},e,{main:{}})}),Object(Ut.a)(oD,fT,function(e){var t=Object(se.a)({},e),n=t.main.next;return t.main=Object(se.a)({},t.main,n,{next:{}}),t}),Object(Ut.a)(oD,mT,function(e){var t=Object(se.a)({},e);return t.main=Object(se.a)({},t.main,{next:{}}),t}),Object(Ut.a)(oD,_R,function(e,t){var n=Object(se.a)({},e),a=t.payload;return n.main=Object(se.a)({},n.main,{next:Object(se.a)({},n.main?n.main.next:null,Object(Ut.a)({},a.itemId,a.appliedText))}),n}),Object(Ut.a)(oD,jR,function(e,t){var n=Object(se.a)({},e),a=t.payload.itemId;return n.main=Object(se.a)({},n.main,{next:Object(se.a)({},n.main?n.main.next:null,Object(Ut.a)({},a,null))}),n}),Object(Ut.a)(oD,_n,sU),Object(Ut.a)(oD,cx,lU),Object(Ut.a)(oD,fI.UPDATE_SELECTIONS_FROM_URL,lU),Object(Ut.a)(oD,bx,function(e,t){var n=t.payload;return n.eventContainer.event.programId!==n.prevProgramId?sU(e):e}),Object(Ut.a)(oD,TA,function(e,t){var n=t.payload;return n.eventContainer.event.programId!==n.prevProgramId?sU(e):e}),Object(Ut.a)(oD,YD,function(e){return Object(se.a)({},e,{main:Object(se.a)({},e.main,{next:{}})})}),oD),"workingListsAppliedFilters"),dU=function(e,t){var n=t.payload;return n.nextProps.programId!==n.prevProps.programId?{}:e},pU=Object(_p.b)((iD={},Object(Ut.a)(iD,CR,function(e,t){return Object(se.a)({},e,Object(Ut.a)({},t.payload.id,!0))}),Object(Ut.a)(iD,TR,function(e,t){return t.payload.includeFilters}),Object(Ut.a)(iD,_n,function(){return{}}),Object(Ut.a)(iD,cx,dU),Object(Ut.a)(iD,fI.UPDATE_SELECTIONS_FROM_URL,dU),Object(Ut.a)(iD,bx,function(e,t){var n=t.payload;return n.eventContainer.event.programId!==n.prevProgramId?{}:e}),Object(Ut.a)(iD,TA,function(e,t){var n=t.payload;return n.eventContainer.event.programId!==n.prevProgramId?{}:e}),iD),"workingListsUserSelectedFilters"),fU=Object(_p.b)((cD={},Object(Ut.a)(cD,cx,function(e){var t=Object(se.a)({},e);return t.isLoading=!0,t}),Object(Ut.a)(cD,ux,function(e,t){var n=Object(se.a)({},e);return n.isLoading=!1,n.selectionsError=t.payload,n}),Object(Ut.a)(cD,lx,function(e,t){var n=Object(se.a)({},e);return n.isLoading=!1,n.selectionsError=t.payload,n}),Object(Ut.a)(cD,px,function(e,t){var n=Object(se.a)({},e);return n.isLoading=!1,n.selectionsError=t.payload,n}),Object(Ut.a)(cD,fx,function(e){var t=Object(se.a)({},e);return t.isLoading=!1,t.selectionsError=null,t}),Object(Ut.a)(cD,SI,function(e){return Object(se.a)({},e,{selectionsError:null})}),Object(Ut.a)(cD,hx,function(e){return Object(se.a)({},e,{selectionsError:null})}),Object(Ut.a)(cD,CA,function(e){return Object(se.a)({},e,{selectionsError:null})}),cD),"mainPage"),mU="OpenNewEventPage",hU=Object(_p.b)((sD={},Object(Ut.a)(sD,EI,function(){return{isLoading:!0}}),Object(Ut.a)(sD,II,function(e,t){var n=Object(se.a)({},e);return n.isLoading=!1,n.selectionsError=t.payload,n}),Object(Ut.a)(sD,jI,function(e,t){var n=Object(se.a)({},e);return n.isLoading=!1,n.selectionsError=t.payload,n}),Object(Ut.a)(sD,TI,function(e,t){var n=Object(se.a)({},e);return n.isLoading=!1,n.selectionsError=t.payload,n}),Object(Ut.a)(sD,SI,function(e){var t=Object(se.a)({},e);return t.isLoading=!1,t.selectionsError=null,t.dataEntryIsLoading=!0,t}),Object(Ut.a)(sD,mU,function(e){var t=Object(se.a)({},e);return t.dataEntryIsLoading=!0,t.selectionsError=null,t.showAddRelationship=!1,t}),Object(Ut.a)(sD,LI,function(e){var t=Object(se.a)({},e);return t.dataEntryIsLoading=!0,t.showAddRelationship=!1,t}),Object(Ut.a)(sD,JI,function(e){var t=Object(se.a)({},e);return t.dataEntryIsLoading=!0,t.showAddRelationship=!1,t}),Object(Ut.a)(sD,uC,function(e){var t=Object(se.a)({},e);return t.dataEntryIsLoading=!0,t.showAddRelationship=!1,t}),Object(Ut.a)(sD,eg,function(e){var t=Object(se.a)({},e);return t.dataEntryIsLoading=!1,t}),Object(Ut.a)(sD,zb,function(e){var t=Object(se.a)({},e);return t.dataEntryIsLoading=!1,t.showAddRelationship=!1,t}),Object(Ut.a)(sD,sg,function(e){return Object(se.a)({},e,{showAddRelationship:!0})}),Object(Ut.a)(sD,sO,function(e){return Object(se.a)({},e,{showAddRelationship:!1})}),Object(Ut.a)(sD,lO,function(e,t){return Object(se.a)({},e,{recentlyAddedRelationshipId:t.payload.relationshipId})}),Object(Ut.a)(sD,bg,function(e){return Object(se.a)({},e,{recentlyAddedRelationshipId:null})}),Object(Ut.a)(sD,cO,function(e){var t=Object(se.a)({},e);return t.showAddRelationship=!1,t}),Object(Ut.a)(sD,rO,function(e,t){var n=Object(se.a)({},e);return n.formHorizontal=t.payload.formHorizontal,n}),Object(Ut.a)(sD,og,function(e,t){var n=Object(se.a)({},e);return n.saveTypes=t.payload.saveTypes,n}),sD),"newEventPage"),bU=Object(_p.b)((lD={},Object(Ut.a)(lD,hx,function(e,t){var n=Object(se.a)({},e);return n.eventId=t.payload.eventId,n.isLoading=!0,n.loadError=null,n}),Object(Ut.a)(lD,gx,function(e,t){var n=Object(se.a)({},e);return n.isLoading=!1,n.loadError=t.payload,n}),Object(Ut.a)(lD,Ox,function(e){var t=Object(se.a)({},e);return t.isLoading=!1,t.dataEntryIsLoading=!0,t}),Object(Ut.a)(lD,vx,function(e){var t=Object(se.a)({},e);return t.isLoading=!1,t.dataEntryIsLoading=!0,t}),Object(Ut.a)(lD,qN,function(e){var t=Object(se.a)({},e);return t.dataEntryIsLoading=!1,t}),Object(Ut.a)(lD,XN,function(e,t){var n=Object(se.a)({},e);return n.dataEntryIsLoading=!1,n.dataEntryLoadError=t.payload,n}),Object(Ut.a)(lD,bT,function(e,t){return Object(se.a)({},e,{eventId:t.payload,isLoading:!1,dataEntryIsLoading:!0,loadError:null})}),lD),"editEventPage"),gU="ViewEventDataEntryLoadedForViewSingleEvent",OU="PrerequisitesErrorLoadingViewEventDataEntryForViewSingleEvent",vU=function(e,t,n,a){var r=_w,o=jw,i=[{id:"eventDate",type:"DATE"},{clientId:"geometry",dataEntryId:"geometry",onConvertIn:Dy(n),onConvertOut:Py},{clientId:"status",dataEntryId:"complete",onConvertIn:function(e){return"COMPLETED"===e?"true":"false"},onConvertOut:Ly}],c=ff(r,o),s=function(e,t,n,a,r,o,i){var c=r?Mh(r):{},s=r?Bh(r,n):{},l=r?Gh(s,r):{},u=Vh(a,o),d=ff(e,t);return[le(Yh.LOAD_VIEW_DATA_ENTRY)({key:d,itemId:t,dataEntryId:e,dataEntryMeta:c,dataEntryValues:s,extraProps:i,dataEntryUI:l}),Lh(d,u)]}(r,o,e.event,e.values,i,n,{eventId:e.event.eventId}),l=Object(se.a)({},e.event,e.values);return[].concat(Object(We.a)(s),Object(We.a)(Jv(a,n,c,t,l,[l])),[le(gU)()])},yU=Object(_p.b)((uD={},Object(Ut.a)(uD,CA,function(e,t){return{eventDetailsSection:{},notesSection:{isLoading:!0},relationshipsSection:{isLoading:!0},eventId:t.payload.eventId,dataEntryIsLoading:!0,isLoading:!0}}),Object(Ut.a)(uD,NA,function(e,t){var n=Object(se.a)({},e);return n.eventContainer=Object(se.a)({},t.payload.eventContainer),n}),Object(Ut.a)(uD,MA,function(e,t){return Object(se.a)({},e,{loadError:t.payload.error})}),Object(Ut.a)(uD,SA,function(e,t){var n=Object(se.a)({},e);return n.isLoading=!1,n.loadError=t.payload,n}),Object(Ut.a)(uD,RA,function(e,t){var n=Object(se.a)({},e);return n.isLoading=!1,n.dataEntryIsLoading=!0,n.eventContainer=Object(se.a)({},t.payload.eventContainer),n}),Object(Ut.a)(uD,kA,function(e,t){var n=Object(se.a)({},e);return n.isLoading=!1,n.dataEntryIsLoading=!0,n.eventContainer=Object(se.a)({},t.payload.eventContainer),n}),Object(Ut.a)(uD,gU,function(e){var t=Object(se.a)({},e);return t.dataEntryIsLoading=!1,t.eventDetailsSection=Object(se.a)({},t.eventDetailsSection),t}),Object(Ut.a)(uD,OU,function(e,t){var n=Object(se.a)({},e);return n.dataEntryIsLoading=!1,n.dataEntryLoadError=t.payload,n}),Object(Ut.a)(uD,gT,function(e,t){return{eventDetailsSection:{},notesSection:{isLoading:!0},relationshipsSection:{isLoading:!0},eventId:t.payload,dataEntryIsLoading:!0}}),Object(Ut.a)(uD,DA,function(e){return Object(se.a)({},e,{showAddRelationship:!0})}),Object(Ut.a)(uD,oF,function(e){return Object(se.a)({},e,{relationshipsSection:Object(se.a)({},e.relationshipsSection,{isLoading:!1})})}),Object(Ut.a)(uD,cF,function(e){return Object(se.a)({},e,{showAddRelationship:!1})}),Object(Ut.a)(uD,iF,function(e){var t=Object(se.a)({},e);return t.showAddRelationship=!1,t}),Object(Ut.a)(uD,NF,function(e){return Object(se.a)({},e,{notesSection:Object(se.a)({},e.notesSection,{isLoading:!1})})}),Object(Ut.a)(uD,PF,function(e,t){return Object(se.a)({},e,{notesSection:Object(se.a)({},e.notesSection,{fieldValue:t.payload.value})})}),Object(Ut.a)(uD,yw,function(e,t){return Object(se.a)({},e,{eventDetailsSection:Object(se.a)({},e.eventDetailsSection)})}),Object(Ut.a)(uD,Ew,function(e,t){return Object(se.a)({},e,{eventDetailsSection:Object(se.a)({},e.eventDetailsSection,{showEditEvent:!0})})}),Object(Ut.a)(uD,fw,function(e,t){return Object(se.a)({},e,{eventDetailsSection:Object(se.a)({},e.eventDetailsSection,{showEditEvent:!1})})}),Object(Ut.a)(uD,mw,function(e,t){return Object(se.a)({},e,{saveInProgress:!0,eventDetailsSection:Object(se.a)({},e.eventDetailsSection,{showEditEvent:!1})})}),Object(Ut.a)(uD,gw,function(e,t){return t.meta.eventId!==e.eventId?e:Object(se.a)({},e,{saveInProgress:!1})}),Object(Ut.a)(uD,bw,function(e,t){return t.meta.eventId!==e.eventId?e:Object(se.a)({},e,{saveInProgress:!1,eventHasChanged:!0})}),Object(Ut.a)(uD,UA,function(e,t){return Object(se.a)({},e,{prevEventContainer:Object(se.a)({},e.eventContainer),eventContainer:Object(se.a)({},t.payload.eventContainer)})}),uD),"viewEventPage"),EU=Object(_p.b)((dD={},Object(Ut.a)(dD,nT,function(e){var t=Object(se.a)({},e);return t.isLoading=!0,t}),Object(Ut.a)(dD,rT,function(e,t){var n=Object(se.a)({},e);return n.isLoading=!1,n.selectionsError=t.payload.error,n}),Object(Ut.a)(dD,iT,function(e){var t=Object(se.a)({},e);return t.isLoading=!1,t.selectionsError=null,t.dataEntryIsLoading=!0,t}),Object(Ut.a)(dD,cT,function(e,t){var n=Object(se.a)({},e);return n.isLoading=!1,n.selectionsError=t.payload.error,n}),Object(Ut.a)(dD,uT,function(e){return Object(se.a)({},e,{dataEntryIsLoading:!1})}),dD),"newEnrollmentPage"),_U=Object(_p.b)((pD={},Object(Ut.a)(pD,dj,function(){return{}}),Object(Ut.a)(pD,pj,function(e,t){return Object(se.a)({},e,{selectedRelationshipType:t.payload.selectedRelationshipType,findMode:null})}),Object(Ut.a)(pD,mj,function(e,t){return Object(se.a)({},e,{findMode:t.payload.findMode,searching:!1})}),Object(Ut.a)(pD,hj,function(e){return Object(se.a)({},e,{searching:!0})}),Object(Ut.a)(pD,bj,function(e){return Object(se.a)({},e,{searching:!1})}),pD),"newRelationship",{}),jU=Object(_p.b)((fD={},Object(Ut.a)(fD,mj,function(){return{loading:!0}}),Object(Ut.a)(fD,Oj,function(e,t){var n=t.payload,a=n.programId,r=n.orgUnit;return Object(se.a)({},e,{programId:a,orgUnit:r,dataEntryIsLoading:!1,loading:!1})}),Object(Ut.a)(fD,vj,function(e,t){return Object(se.a)({},e,{error:t.payload.errorMessage,loading:!1})}),Object(Ut.a)(fD,qE,function(e,t){var n=t.payload.programId;return Object(se.a)({},e,{programId:n,dataEntryIsLoading:!0})}),Object(Ut.a)(fD,XE,function(e,t){var n=t.payload,a=n.orgUnit,r=n.resetProgramSelection;return Object(se.a)({},e,{orgUnit:a,programId:r?null:e.programId,dataEntryIsLoading:!0})}),Object(Ut.a)(fD,JE,function(e){return Object(se.a)({},e,{orgUnit:null,dataEntryIsLoading:!0})}),Object(Ut.a)(fD,_j,function(e){return Object(se.a)({},e,{dataEntryIsLoading:!1,dataEntryError:null})}),Object(Ut.a)(fD,Ij,function(e,t){return Object(se.a)({},e,{dataEntryIsLoading:!1,dataEntryError:t.payload.errorMessage})}),Object(Ut.a)(fD,jj,function(e){return Object(se.a)({},e,{dataEntryIsLoading:!1,dataEntryError:null})}),fD),"newRelationshipRegisterTei"),IU=Object(_p.b)((mD={},Object(Ut.a)(mD,T_,function(e){return Object(se.a)({},e,{isLoading:!0})}),Object(Ut.a)(mD,S_,function(e,t){return Object(se.a)({},e,{isLoading:!1,isUpdating:!1,teis:t.payload.teis,loadError:!1,paginationData:Object(se.a)({},e.paginationData,t.payload.paginationData)})}),Object(Ut.a)(mD,R_,function(e){return Object(se.a)({},e,{isLoading:!1,isUpdating:!1,loadError:!0})}),Object(Ut.a)(mD,k_,function(e,t){return Object(se.a)({},e,{isUpdating:!0,paginationData:Object(se.a)({},e.paginationData,{currentPage:t.payload.page})})}),mD),"newRelationshipRegisterTeiDuplicatesReview"),CU="CoreLoad",TU="CoreLoadSucess",SU="CoreLoadFailed",RU="OrgUnitCaptureRootsLoadSuccess",kU="OrgUnitSearchRootsLoadSuccess",NU=function(e){return le(RU)({roots:e})},AU=function(e){return le(kU)({roots:e})},wU=Object(_p.b)((hD={},Object(Ut.a)(hD,Ox,function(e,t){var n=Object(se.a)({},e),a=t.payload.orgUnit;return n[a.id]=a,n}),Object(Ut.a)(hD,RA,function(e,t){var n=Object(se.a)({},e),a=t.payload.orgUnit;return n[a.id]=a,n}),Object(Ut.a)(hD,ix,function(e,t){return Object(se.a)({},e,Object(Ut.a)({},t.payload.id,t.payload))}),Object(Ut.a)(hD,sx,function(e,t){return Object(se.a)({},e,Object(Ut.a)({},t.payload.id,t.payload))}),Object(Ut.a)(hD,_I,function(e,t){return Object(se.a)({},e,Object(Ut.a)({},t.payload.id,t.payload))}),Object(Ut.a)(hD,aT,function(e,t){return Object(se.a)({},e,Object(Ut.a)({},t.payload.orgUnit.id,t.payload.orgUnit))}),Object(Ut.a)(hD,gn,function(e,t){var n=Object(se.a)({},e),a=t.payload;return n[a.id]=a,n}),Object(Ut.a)(hD,aC,function(e,t){var n=Object(se.a)({},e),a=t.payload.orgUnit;return n[a.id]=a,n}),Object(Ut.a)(hD,fI.SET_ORG_UNIT,function(e,t){var n=Object(se.a)({},e),a=t.payload.orgUnit;return n[a.id]=a,n}),hD),"organisationUnits"),FU=Object(_p.b)((bD={},Object(Ut.a)(bD,kU,function(e,t){return Object(se.a)({},e,{searchRoots:{roots:t.payload.roots}})}),Object(Ut.a)(bD,RU,function(e,t){return Object(se.a)({},e,{captureRoots:{roots:t.payload.roots}})}),bD),"organisationUnitRoots"),xU=function(e){return jc("regUnit",null),Object(se.a)({},e,{searchRoots:null,searchText:null,key:"reset_reg_units"})},PU=Object(_p.b)((gD={},Object(Ut.a)(gD,Tc,function(e,t){return{searchRoots:null,searchText:null,userRoots:t.payload.roots,key:"user_init"}}),Object(Ut.a)(gD,Sc,function(){return{searchRoots:null,searchText:null,userRoots:null,key:"user_init_failed"}}),Object(Ut.a)(gD,Rc,function(e,t){return Object(se.a)({},e,{searchText:t.payload.searchText})}),Object(Ut.a)(gD,kc,function(e){return jc("regUnit",null),Object(se.a)({},e,{searchText:null,searchRoots:null,key:"clear"})}),Object(Ut.a)(gD,Nc,function(e,t){return Object(se.a)({},e,t.payload,{isLoading:!1,key:t.payload.searchText})}),Object(Ut.a)(gD,Ac,function(e,t){return Object(se.a)({},e,{searchRoots:[],isLoading:!1,key:t.payload.searchText})}),Object(Ut.a)(gD,wc,function(e){return Object(se.a)({},e,{isLoading:!0})}),Object(Ut.a)(gD,rC,xU),Object(Ut.a)(gD,dx,xU),Object(Ut.a)(gD,fI.RESET_ORG_UNIT_ID,xU),Object(Ut.a)(gD,CI,xU),Object(Ut.a)(gD,wI,xU),Object(Ut.a)(gD,zI,xU),Object(Ut.a)(gD,oT,xU),gD),"registeringUnitList"),DU="NetworkStatusChange",UU=Object(_p.b)(Object(Ut.a)({},DU,function(e,t){var n=Object(se.a)({},e);return t.payload.status?n.offlineSince=0:n.offlineSince=Date.now(),n}),"networkStatus",{}),LU=Object(_p.b)((OD={},Object(Ut.a)(OD,kI,function(e,t){var n=Object(se.a)({},e),a=t.payload.event;return n[a.eventId]=a,n}),Object(Ut.a)(OD,_C,function(e,t){if("recentlyAddedEvents"===t.payload.listId){return{}}return e}),OD),"recentlyAddedEvents",{}),MU=Object(_p.b)((vD={},Object(Ut.a)(vD,kI,function(e,t){var n=Object(se.a)({},e);return n[t.payload.event.eventId]=t.payload.eventValues,n}),Object(Ut.a)(vD,_C,function(e,t){if("recentlyAddedEvents"===t.payload.listId){return{}}return e}),vD),"recentlyAddedEventsValues",{}),BU=Object(_p.b)((yD={},Object(Ut.a)(yD,KO,function(e,t){return Object(se.a)({},e,Object(Ut.a)({},t.payload.searchId,{selectedOrgUnitScope:"ACCESSIBLE",openSearchGroupSection:"0",selectedProgramId:t.payload.programId,selectedTrackedEntityTypeId:t.payload.trackedEntityTypeId}))}),Object(Ut.a)(yD,YO,function(e,t){return Object(se.a)({},e,Object(Ut.a)({},t.payload.searchId,Object(se.a)({},e[t.payload.searchId],{searchResults:{formId:t.payload.formId,searchGroupId:t.payload.searchGroupId,resultsLoading:!0}})))}),Object(Ut.a)(yD,ZO,function(e,t){var n=t.payload.data,a=t.payload.searchId,r=n.trackedEntityInstanceContainers?n.trackedEntityInstanceContainers.map(function(e){return{id:e.id,values:e.values}}):[];return Object(se.a)({},e,Object(Ut.a)({},a,Object(se.a)({},e[a],{searchResults:Object(se.a)({},e[a].searchResults,{resultsLoading:!1,teis:r,paging:n.pagingData})})))}),Object(Ut.a)(yD,XO,function(e,t){var n=t.payload.searchId;return Object(se.a)({},e,Object(Ut.a)({},n,Object(se.a)({},e[n],{searchResults:Object(se.a)({},e[n].searchResults,{resultsLoading:!1,teis:[],paging:null})})))}),Object(Ut.a)(yD,hO,function(e,t){var n=t.payload.searchId;return Object(se.a)({},e,Object(Ut.a)({},n,Object(se.a)({},e[n],{orgUnitsLoading:!0,orgUnitsSearchText:t.payload.searchText})))}),Object(Ut.a)(yD,bO,function(e,t){var n=t.payload.searchId;return jc(n,null),Object(se.a)({},e,Object(Ut.a)({},n,Object(se.a)({},e[n],{orgUnitsLoading:!1,orgUnitsSearchText:null,orgUnitsRoots:null})))}),Object(Ut.a)(yD,gO,function(e,t){var n=t.payload.searchId;return Object(se.a)({},e,Object(Ut.a)({},n,Object(se.a)({},e[n],{orgUnitsLoading:!1,orgUnitsSearchText:t.payload.searchText,orgUnitsRoots:t.payload.roots})))}),Object(Ut.a)(yD,OO,function(e,t){var n=t.payload.searchId;return jc(n,null),Object(se.a)({},e,Object(Ut.a)({},n,Object(se.a)({},e[n],{orgUnitsLoading:!1,orgUnitsSearchText:null,orgUnitsRoots:null})))}),Object(Ut.a)(yD,vO,function(e,t){var n=t.payload.searchId;return Object(se.a)({},e,Object(Ut.a)({},n,Object(se.a)({},e[n],{selectedOrgUnitScope:t.payload.orgUnitScope})))}),Object(Ut.a)(yD,yO,function(e,t){var n=t.payload.searchId;return Object(se.a)({},e,Object(Ut.a)({},n,Object(se.a)({},e[n],{selectedOrgUnit:t.payload.orgUnit})))}),Object(Ut.a)(yD,JO,function(e,t){var n=t.payload.searchId;return Object(se.a)({},e,Object(Ut.a)({},n,Object(se.a)({},e[n],{selectedProgramId:t.payload.programId,selectedTrackedEntityTypeId:t.payload.trackedEntityTypeId,openSearchGroupSection:"0"})))}),Object(Ut.a)(yD,qO,function(e,t){var n=t.payload.searchId,a=t.payload.formId;return Object(se.a)({},e,Object(Ut.a)({},n,Object(se.a)({},e[n],Object(Ut.a)({},a,Object(se.a)({},e[n]?e[n][a]:{},{validationFailed:!0})))))}),Object(Ut.a)(yD,QO,function(e,t){var n=t.payload.searchId;return Object(se.a)({},e,Object(Ut.a)({},n,Object(se.a)({},e[n],{searchResults:null})))}),Object(Ut.a)(yD,$O,function(e,t){var n=t.payload.searchId;return Object(se.a)({},e,Object(Ut.a)({},n,Object(se.a)({},e[n],{searchResults:null})))}),Object(Ut.a)(yD,ev,function(e,t){var n=t.payload.searchId;return Object(se.a)({},e,Object(Ut.a)({},n,Object(se.a)({},e[n],{searchResults:Object(se.a)({},e[n].searchResults,{resultsLoading:!0})})))}),Object(Ut.a)(yD,tv,function(e,t){var n=t.payload.searchId;return Object(se.a)({},e,Object(Ut.a)({},n,Object(se.a)({},e[n],{openSearchGroupSection:t.payload.searchGroupId})))}),yD),"teiSearch",{}),VU="SetNotes",GU="AddTTNote",WU="RemoveNote",HU=function(e,t){return le(VU)({key:e,notes:t})},zU=Object(_p.b)((ED={},Object(Ut.a)(ED,VU,function(e,t){return Object(se.a)({},e,Object(Ut.a)({},t.payload.key,t.payload.notes))}),Object(Ut.a)(ED,GU,function(e,t){var n=t.payload.key,a=t.payload.note;return Object(se.a)({},e,Object(Ut.a)({},n,[].concat(Object(We.a)(e[n]),[a])))}),Object(Ut.a)(ED,WU,function(e,t){var n=t.payload.key,a=t.payload.noteClientId;return Object(se.a)({},e,Object(Ut.a)({},n,e[n].filter(function(e){return e.clientId!==a})))}),ED),"notes"),KU="SetRelationships",YU="AddRelationship",qU="UpdateRelationship",XU="RemoveRelationship",ZU=function(e,t){return le(KU)({key:e,relationships:t})},JU=function(e,t){return le(XU)({key:e,relationshipClientId:t})},QU=Object(_p.b)((_D={},Object(Ut.a)(_D,KU,function(e,t){return Object(se.a)({},e,Object(Ut.a)({},t.payload.key,t.payload.relationships))}),Object(Ut.a)(_D,YU,function(e,t){var n=t.payload.key,a=t.payload.relationship;return Object(se.a)({},e,Object(Ut.a)({},n,[].concat(Object(We.a)(e[n]),[a])))}),Object(Ut.a)(_D,qU,function(e,t){var n=t.payload.key,a=t.payload.updatedRelationship,r=e[n].findIndex(function(e){return e.clientId===a.clientId}),o=Object(We.a)(e[n]);return o[r]=a,Object(se.a)({},e,Object(Ut.a)({},n,o))}),Object(Ut.a)(_D,XU,function(e,t){var n=t.payload.key,a=t.payload.relationshipClientId;return Object(se.a)({},e,Object(Ut.a)({},n,e[n].filter(function(e){return e.clientId!==a})))}),_D),"relationships"),$U=Object(_p.b)((jD={},Object(Ut.a)(jD,Fy,function(e,t){var n=t.payload,a=n.dataEntryId,r=n.generatedUniqueValues;return Object(se.a)({},e,Object(Ut.a)({},a,Object(se.a)({},e[a],r)))}),Object(Ut.a)(jD,rE,function(e,t){var n=t.payload,a=n.dataEntryId,r=n.generatedUniqueValues;return Object(se.a)({},e,Object(Ut.a)({},a,Object(se.a)({},e[a],r)))}),Object(Ut.a)(jD,xf,function(e,t){var n=t.payload.newToEntity;return n?Object(se.a)({},e,Object(Ut.a)({},n.dataEntryId,void 0)):e}),Object(Ut.a)(jD,cF,function(e,t){var n=t.payload.entity;return n.id?e:Object(se.a)({},e,Object(Ut.a)({},n.dataEntryId,void 0))}),jD),"generatedUniqueValuesCache"),eL="AppLoad",tL="AppLoadSuccess",nL="AppLoadFailed",aL=function(){return le(eL)()},rL=function(e){var t;return Object(_p.b)(Object(se.a)({},e,(t={},Object(Ut.a)(t,cx,function(e,t){return Object(se.a)({},e,{page:t.payload.nextPage})}),Object(Ut.a)(t,EI,function(e,t){return Object(se.a)({},e,{page:t.payload.nextPage})}),Object(Ut.a)(t,hx,function(e,t){return Object(se.a)({},e,{page:t.payload.page})}),Object(Ut.a)(t,CA,function(e,t){return Object(se.a)({},e,{page:t.payload.page})}),Object(Ut.a)(t,nT,function(e,t){return Object(se.a)({},e,{page:t.payload.nextPage})}),Object(Ut.a)(t,mU,function(e){var t=Object(se.a)({},e);return t.page="newEvent",t.locationSwitchInProgress=!0,t}),Object(Ut.a)(t,uC,function(e){var t=Object(se.a)({},e);return t.page="newEvent",t.locationSwitchInProgress=!0,t}),Object(Ut.a)(t,LI,function(e){var t=Object(se.a)({},e);return t.page="newEvent",t.locationSwitchInProgress=!0,t}),Object(Ut.a)(t,JI,function(e){var t=Object(se.a)({},e);return t.page="newEvent",t.locationSwitchInProgress=!0,t}),Object(Ut.a)(t,Yb,function(e){var t=Object(se.a)({},e);return t.page=null,t.locationSwitchInProgress=!0,t}),Object(Ut.a)(t,Xb,function(e){var t=Object(se.a)({},e);return t.page=null,t.locationSwitchInProgress=!0,t}),Object(Ut.a)(t,iI,function(e){var t=Object(se.a)({},e);return t.page=null,t.locationSwitchInProgress=!0,t}),Object(Ut.a)(t,JN,function(e){var t=Object(se.a)({},e);return t.page=null,t.locationSwitchInProgress=!0,t}),Object(Ut.a)(t,tA,function(e){var t=Object(se.a)({},e);return t.page=null,t.locationSwitchInProgress=!0,t}),Object(Ut.a)(t,PA,function(e){var t=Object(se.a)({},e);return t.page=null,t.locationSwitchInProgress=!0,t}),Object(Ut.a)(t,bT,function(e){return Object(se.a)({},e,{page:"editEvent",locationSwitchInProgress:!0})}),Object(Ut.a)(t,gT,function(e){return Object(se.a)({},e,{page:"viewEvent",locationSwitchInProgress:!0})}),Object(Ut.a)(t,bn,function(e){return Object(se.a)({},e,{page:null,locationSwitchInProgress:!0})}),Object(Ut.a)(t,On,function(e){return Object(se.a)({},e,{page:null,locationSwitchInProgress:!0})}),Object(Ut.a)(t,"@@router/LOCATION_CHANGE",function(e){var t=Object(se.a)({},e);return t.locationSwitchInProgress=!1,t}),Object(Ut.a)(t,"Offline/STATUS_CHANGED",function(e,t){return t.payload.online?Object(se.a)({},e,{goingOnlineInProgress:!0}):e}),Object(Ut.a)(t,zD,function(e){return Object(se.a)({},e,{goingOnlineInProgress:!1})}),Object(Ut.a)(t,rC,function(e){var t=Object(se.a)({},e);return t.locationSwitchInProgress=!0,t}),Object(Ut.a)(t,aC,function(e){var t=Object(se.a)({},e);return t.locationSwitchInProgress=!0,t}),Object(Ut.a)(t,oC,function(e){var t=Object(se.a)({},e);return t.locationSwitchInProgress=!0,t}),Object(Ut.a)(t,iC,function(e){var t=Object(se.a)({},e);return t.locationSwitchInProgress=!0,t}),Object(Ut.a)(t,wI,function(e){return Object(se.a)({},e,{page:null,locationSwitchInProgress:!0})}),Object(Ut.a)(t,AI,function(e){var t=Object(se.a)({},e);return t.locationSwitchInProgress=!0,t}),Object(Ut.a)(t,FI,function(e){var t=Object(se.a)({},e);return t.locationSwitchInProgress=!0,t}),Object(Ut.a)(t,xI,function(e){return Object(se.a)({},e,{page:null,locationSwitchInProgress:!0})}),Object(Ut.a)(t,DI,function(e){return Object(se.a)({},e,{page:null,locationSwitchInProgress:!0})}),Object(Ut.a)(t,fI.RESET_ORG_UNIT_ID,function(e){var t=Object(se.a)({},e);return t.locationSwitchInProgress=!0,t}),Object(Ut.a)(t,fI.SET_ORG_UNIT,function(e){var t=Object(se.a)({},e);return t.locationSwitchInProgress=!0,t}),Object(Ut.a)(t,fI.SET_PROGRAM_ID,function(e){var t=Object(se.a)({},e);return t.locationSwitchInProgress=!0,t}),Object(Ut.a)(t,fI.RESET_PROGRAM_ID,function(e){var t=Object(se.a)({},e);return t.locationSwitchInProgress=!0,t}),t)),"app")}((ID={},Object(Ut.a)(ID,eL,function(e){return Object(se.a)({},e,{initDone:!1})}),Object(Ut.a)(ID,tL,function(e,t){var n=Object(se.a)({},e);return n.someRandomData=t.payload,n.initDone=!0,n}),Object(Ut.a)(ID,nL,function(e,t){var n=t.payload.error;return Object(se.a)({},e,{initDone:!0,error:n})}),ID)),oL="SelectionsCompletenessCalculated",iL=function(e,t){var n=t.payload.id;return Object(se.a)({},e,{orgUnitId:n,complete:!1})},cL=function(e){var t=e.attributeCategoryOptions;if(!t)return null;var n=Je.get(e.programId);if(!n)return null;var a=n.categoryCombination;return a?t.split(";").reduce(function(e,t){var n=a.getCategoryForOptionId(t);return n&&(e[n.id]=t),e},{}):null};function sL(e,t,n){var a=Object(We.a)(e);return a.push({message:t,action:n,feedbackType:"ERROR"}),a}function lL(e,t){return{message:e,action:t,feedbackType:"ERROR"}}var uL,dL=[rL,function(e){var t;return Object(_p.b)(Object(se.a)({},e,(t={},Object(Ut.a)(t,oL,function(e,t){return Object(se.a)({},e,{complete:t.payload.isComplete})}),Object(Ut.a)(t,_n,function(e){return Object(se.a)({},e,{programId:null,complete:!1})}),Object(Ut.a)(t,nx,function(e,t){return Object(se.a)({},e,t.payload,{complete:!1})}),Object(Ut.a)(t,cx,function(e,t){var n=t.payload.nextProps;return Object(se.a)({},e,n,{categories:null,complete:!1})}),Object(Ut.a)(t,dx,function(e){return Object(se.a)({},e,{orgUnitId:null})}),Object(Ut.a)(t,EI,function(e,t){var n=t.payload.nextProps;return Object(se.a)({},e,n,{categories:null,complete:!1})}),Object(Ut.a)(t,CI,function(e){return Object(se.a)({},e,{orgUnitId:null})}),Object(Ut.a)(t,nT,function(e,t){var n=t.payload.nextProps;return Object(se.a)({},e,n,{categories:null,complete:!1})}),Object(Ut.a)(t,oT,function(e){return Object(se.a)({},e,{orgUnitId:null})}),Object(Ut.a)(t,bx,function(e,t){var n=t.payload.eventContainer.event,a=cL(n);return Object(se.a)({},e,{programId:n.programId,orgUnitId:n.orgUnitId,categories:a,complete:!0})}),Object(Ut.a)(t,TA,function(e,t){var n=t.payload.eventContainer.event,a=cL(n);return Object(se.a)({},e,{programId:n.programId,orgUnitId:n.orgUnitId,categories:a,complete:!0})}),Object(Ut.a)(t,rC,function(e){var t=Object(se.a)({},e,{orgUnitId:null});return t.complete=!1,t}),Object(Ut.a)(t,aC,function(e,t){var n=t.payload.id;return Object(se.a)({},e,{orgUnitId:n,complete:!1})}),Object(Ut.a)(t,oC,function(e,t){var n=t.payload,a=Object(se.a)({},e,{programId:n});return a.complete=!1,a}),Object(Ut.a)(t,cC,function(e,t){var n={};e.categories?(n=Object.assign({},e.categories))[t.payload.categoryId]=t.payload.categoryOptionId:n[t.payload.categoryId]=t.payload.categoryOptionId;var a=Object(se.a)({},e,{categories:n});return a.complete=!1,a}),Object(Ut.a)(t,sC,function(e,t){var n={};e.categories?(n=Object.assign({},e.categories))[t.payload]=null:n[t.payload]=null;var a=Object(se.a)({},e,{categories:n});return a.complete=!1,a}),Object(Ut.a)(t,lC,function(e){return Object(se.a)({},e,{categories:null})}),Object(Ut.a)(t,wI,function(e){var t=Object(se.a)({},e,{orgUnitId:null});return t.complete=!1,t}),Object(Ut.a)(t,AI,iL),Object(Ut.a)(t,FI,function(e,t){var n=t.payload,a=Object(se.a)({},e,{programId:n});return a.complete=!1,a}),Object(Ut.a)(t,PI,function(e,t){var n={};e.categories?(n=Object.assign({},e.categories))[t.payload.categoryId]=t.payload.categoryOptionId:n[t.payload.categoryId]=t.payload.categoryOptionId;var a=Object(se.a)({},e,{categories:n});return a.complete=!1,a}),Object(Ut.a)(t,DI,function(e,t){var n={};e.categories?(n=Object.assign({},e.categories))[t.payload]=null:n[t.payload]=null;var a=Object(se.a)({},e,{categories:n});return a.complete=!1,a}),Object(Ut.a)(t,UI,function(e){return Object(se.a)({},e,{categories:null})}),Object(Ut.a)(t,fI.RESET_ORG_UNIT_ID,function(e){var t=Object(se.a)({},e,{orgUnitId:null});return t.complete=!1,t}),Object(Ut.a)(t,fI.SET_ORG_UNIT,iL),Object(Ut.a)(t,fI.SET_PROGRAM_ID,function(e,t){var n=t.payload,a=Object(se.a)({},e,{programId:n});return a.complete=!1,a}),Object(Ut.a)(t,fI.SET_CATEGORY_OPTION,function(e,t){var n={};e.categories?(n=Object.assign({},e.categories))[t.payload.categoryId]=t.payload.categoryOptionId:n[t.payload.categoryId]=t.payload.categoryOptionId;var a=Object(se.a)({},e,{categories:n});return a.complete=!1,a}),Object(Ut.a)(t,fI.RESET_CATEGORY_OPTION,function(e,t){var n={};e.categories?(n=Object.assign({},e.categories))[t.payload]=null:n[t.payload]=null;var a=Object(se.a)({},e,{categories:n});return a.complete=!1,a}),Object(Ut.a)(t,fI.RESET_ALL_CATEGORY_OPTIONS,function(e){return Object(se.a)({},e,{categories:null})}),t)),"currentSelections")}({}),CD,TD,SD,RD,wD,FD,xD,PD,DD,UD,BD,LD,MD,VD,GD,WD,function(e){var t;return Object(_p.b)(Object(se.a)({},e,(t={},Object(Ut.a)(t,pe,function(e){var t=Object(We.a)(e);return t.shift(),t}),Object(Ut.a)(t,_f,function(e,t){return sL(e,t.payload.error,t.payload.action)}),Object(Ut.a)(t,ND,function(e,t){return sL(e,t.payload)}),Object(Ut.a)(t,ox,function(e,t){return sL(e,t.payload)}),Object(Ut.a)(t,$b,function(e,t){var n=t.payload,a=ld()(n)?n:n.message,r=rc()(n)?n:null;return O.a.error(Object(ze.b)(a||c.a.t("Error saving event"))(r)),[].concat(Object(We.a)(e),[lL(c.a.t("Could not save event. See log for details"))])}),Object(Ut.a)(t,eA,function(e,t){var n=t.payload,a=ld()(n)?n:n.message,r=rc()(n)?n:null;return O.a.error(Object(ze.b)(a||c.a.t("Error saving event"))(r)),[].concat(Object(We.a)(e),[lL(c.a.t("Could not save event. See log for details"))])}),Object(Ut.a)(t,mT,function(e,t){return[].concat(Object(We.a)(e),[lL(t.payload)])}),Object(Ut.a)(t,rf,function(e,t){return sL(e,t.payload.message)}),Object(Ut.a)(t,rg,function(e,t){var n=t.payload,a=ld()(n)?n:n.message,r=rc()(n)?n:null;return O.a.error(Object(ze.b)(a||c.a.t("Error saving event"))(r)),[].concat(Object(We.a)(e),[lL(c.a.t("Could not save event. See log for details"))])}),Object(Ut.a)(t,Sc,function(e,t){return sL(e,c.a.t(t.payload.message))}),Object(Ut.a)(t,Ac,function(e,t){return sL(e,c.a.t(t.payload.message))}),Object(Ut.a)(t,Pf,function(e,t){return sL(e,t.payload.message)}),Object(Ut.a)(t,dF,function(e,t){return sL(e,t.payload.message)}),Object(Ut.a)(t,ZE,function(e){return sL(e,c.a.t("Organisation unit search failed. See log for details"))}),t)),"feedbacks",[])}(Object(Ut.a)({},tL,function(e){var t=LP();return t.Adapters[0]!==t.adapterType?[].concat(Object(We.a)(e),[{message:{title:c.a.t("Compatibility mode"),content:c.a.t("This app is currently running in compatibility mode due to browser restrictions. For better performance, use another browser or exit private mode if this is currently in use.")},feedbackType:"ERROR",displayType:"dialog"}]):e})),Sp,Ap,kp,Rp,wp,Fp,Pp,xp,Dp,Up,XD,QD,tU,rU,oU,cU,uU,pU,fU,hU,bU,yU,EU,_U,jU,IU,wU,FU,PU,UU,LU,MU,BU,zU,QU,$U],pL=(uL={},Object(Ut.a)(uL,ct.FILE_RESOURCE,function(e,t,n){var a=$l.config.baseUrl;return ye().get("fileResources/".concat(e)).then(function(e){return{name:e.name,value:e.id,url:"".concat(a,"/events/files?dataElementUid=").concat(n,"&eventUid=").concat(t)}}).catch(function(a){return O.a.warn(Object(ze.b)("Could not get subvalue")({value:e,eventId:t,metaElementId:n,error:a})),null})}),Object(Ut.a)(uL,ct.IMAGE,function(e,t,n){var a=$l.config.baseUrl;return ye().get("fileResources/".concat(e)).then(function(e){return{name:e.name,value:e.id,url:"".concat(a,"/events/files?dataElementUid=").concat(n,"&eventUid=").concat(t)}}).catch(function(a){return O.a.warn(Object(ze.b)("Could not get subvalue")({value:e,eventId:t,metaElementId:n,error:a})),null})}),Object(Ut.a)(uL,ct.ORGANISATION_UNIT,function(e,t,n){var a=e.split("/"),r=a[a.length-1];return _e().models.organisationUnits.get(r).then(function(e){return{id:e.id,code:e.code,name:e.displayName,path:e.path}}).catch(function(a){return O.a.warn(Object(ze.b)("Could not get subvalue")({value:e,eventId:t,metaElementId:n,error:a})),null})}),uL);function fL(e,t,n){return mL.apply(this,arguments)}function mL(){return(mL=Object(o.a)(r.a.mark(function e(t,n,a){var i;return r.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(a){e.next=2;break}return e.abrupt("return",null);case 2:return i=n.getElementsById(),e.abrupt("return",Object.keys(a).reduce(function(){var e=Object(o.a)(r.a.mark(function e(n,o){var c,s,l,u,d;return r.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,n;case 2:if(c=e.sent,s=a[o],l=i[o],!Object(ft.a)(s)||null===s||!l){e.next=12;break}if(!(u=pL[l.type])){e.next=12;break}return e.next=10,u(s,t,o);case 10:d=e.sent,c[o]=d;case 12:return e.abrupt("return",c);case 13:case"end":return e.stop()}},e)}));return function(t,n){return e.apply(this,arguments)}}(),Promise.resolve(a)));case 4:case"end":return e.stop()}},e)}))).apply(this,arguments)}var hL={PROGRAM_NOT_FOUND:"Program not found",STAGE_NOT_FOUND:"Stage not found"};var bL={event:"eventId",program:"programId",programStage:"programStageId",orgUnit:"orgUnitId",trackedEntityInstance:"trackedEntityInstanceId",enrollment:"enrollmentId"};function gL(e){return Object.keys(e).reduce(function(t,n){if("dataValues"!==n){var a=function(e,t){return"eventDate"===t||"dueDate"===t||"completedDate"===t?yd(e,ct.DATE):e}(e[n],n);t[bL[n]||n]=a}return t},{})}function OL(e){return vL.apply(this,arguments)}function vL(){return(vL=Object(o.a)(r.a.mark(function e(t){var n,a,o,i,c,s;return r.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(n=Je.get(t.program)){e.next=4;break}return O.a.error(Object(ze.b)(hL.PROGRAM_NOT_FOUND)({fn:"convertToClientEvent",event:t})),e.abrupt("return",null);case 4:if(a=n.getStage(t.programStage)){e.next=8;break}return O.a.error(Object(ze.b)(hL.STAGE_NOT_FOUND)({fn:"convertToClientEvent",event:t})),e.abrupt("return",null);case 8:return o=a.stageForm,r=t.dataValues,i=r?r.reduce(function(e,t){return e[t.dataElement]=t.value,e},{}):r,c=o.convertValues(i,yd),e.next=13,fL(t.event,o,c);case 13:return s=gL(t),e.abrupt("return",{id:s.eventId,event:s,values:c||{}});case 15:case"end":return e.stop()}var r},e)}))).apply(this,arguments)}function yL(e){return EL.apply(this,arguments)}function EL(){return(EL=Object(o.a)(r.a.mark(function e(t){var n,a,o;return r.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=ye(),e.next=3,n.get("events/".concat(t));case 3:return a=e.sent,o=OL(a),e.abrupt("return",o);case 6:case"end":return e.stop()}},e)}))).apply(this,arguments)}function _L(e){return jL.apply(this,arguments)}function jL(){return(jL=Object(o.a)(r.a.mark(function e(t){var n,a,i,c;return r.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=ye(),e.next=3,n.get("events",Object(se.a)({},t,{totalPages:!0}));case 3:if(!(a=e.sent)||!a.events){e.next=10;break}return e.next=7,a.events.reduce(function(){var e=Object(o.a)(r.a.mark(function e(t,n){var a,o;return r.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t;case 2:return a=e.sent,e.next=5,OL(n);case 5:return(o=e.sent)&&a.push(o),e.abrupt("return",a);case 8:case"end":return e.stop()}},e)}));return function(t,n){return e.apply(this,arguments)}}(),Promise.resolve([]));case 7:e.t0=e.sent,e.next=11;break;case 10:e.t0=null;case 11:return i=e.t0,c={rowsCount:a.pager.total,rowsPerPage:a.pager.pageSize,currentPage:a.pager.page},e.abrupt("return",{eventContainers:i,pagingData:c});case 14:case"end":return e.stop()}},e)}))).apply(this,arguments)}var IL={programId:"program",orgUnitId:"orgUnit",rowsPerPage:"pageSize",currentPage:"page"},CL=function(e){return e.reduce(function(e,t){return t.isMainProperty&&(e[t.id]=!0),e},{})},TL=function(e,t){var n=Object(se.a)({},e,{order:"".concat(e.sortById,":").concat(e.sortByDirection)},function(e,t){var n=e?Object.keys(e).filter(function(n){return null!=e[n]&&!t[n]}).reduce(function(t,n){var a=e[n];if(Array.isArray(a)){var r=a.map(function(e){return"".concat(n,":").concat(e)});t=[].concat(Object(We.a)(t),Object(We.a)(r))}else t.push("".concat(n,":").concat(a));return t},[]):null;return n&&n.length>0?{filter:n}:null}(e.filters,t),function(e,t){return e?Object.keys(e).filter(function(n){return t[n]&&null!=e[n]}).reduce(function(t,n){var a=e[n],r={};return"eventDate"===n?Array.isArray(a)?r=a.reduce(function(e,t){return t.startsWith("ge")?e.startDate=t.replace("ge:",""):e.endDate=t.replace("le:",""),e},{}):a.startsWith("ge")?r.startDate=a.replace("ge:",""):r.endDate=a.replace("le:",""):"status"===n&&a.startsWith("eq:")&&(r.status=a.replace("eq:","")),Object(se.a)({},t,r)},{}):null}(e.filters,t),function(e,t){if(!e)return null;var n=Je.get(t);if(!n)return null;var a=n.categoryCombination;return a?{attributeCc:a.id,attributeCos:Object.keys(e).map(function(t){return e[t]}).join(";")}:null}(e.categories,e.programId));return n.hasOwnProperty("categories")&&delete n.categories,n.hasOwnProperty("sortById")&&delete n.sortById,n.hasOwnProperty("sortByDirection")&&delete n.sortByDirection,n.hasOwnProperty("filters")&&delete n.filters,n.hasOwnProperty("rowsCount")&&delete n.rowsCount,Object.keys(n).reduce(function(e,t){return IL[t]?e[IL[t]]=n[t]:e[t]=n[t],e},{})},SL=function(){var e=Object(o.a)(r.a.mark(function e(t,n){var a,o,i;return r.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(n){e.next=4;break}return e.next=3,OC(t.programId);case 3:a=e.sent;case 4:return o=CL(a||n),e.next=7,_L(TL(Object(se.a)({},t,{page:1}),o));case 7:if(i=e.sent,!a){e.next=10;break}return e.abrupt("return",Object(se.a)({},i,{columnsOrder:a}));case 10:return e.abrupt("return",i);case 11:case"end":return e.stop()}},e)}));return function(t,n){return e.apply(this,arguments)}}(),RL="UpdateEventListAfterSaveOrUpdateForSingleEvent",kL=function(){return le(RL)()},NL="Working list could not be loaded",AL="Working list could not be updated",wL=function(e,t){var n=function(e){var t=e.currentSelections,n=t.programId,a=t.orgUnitId,r=t.categories,o=e.workingListsMeta.main||{},i=e.workingListsMeta.main&&e.workingListsMeta.main.next||{},c=Object(se.a)({},o,i,{filters:Object(se.a)({},o.filters,i.filters)});return c.hasOwnProperty("next")&&delete c.next,Object(se.a)({programId:n,orgUnitId:a,categories:r},c)}(e),a=Object(se.a)({},n,t),r={rowsPerPage:a.rowsPerPage||15,sortById:a.sortById||"eventDate",sortByDirection:a.sortByDirection||"desc"},o=Object(se.a)({},a,r),i=o.programId,c=o.orgUnitId,s=o.categories;return SL(o,e.workingListsColumnsOrder.main).then(function(e){return function(e){return le(rx)(e)}(Object(se.a)({},e,{argsWithDefaults:r,selections:{programId:i,orgUnitId:c,categories:s}}))}).catch(function(e){return O.a.error(Object(ze.b)(NL)({error:e})),t=NL,le(ox)(t);var t})},FL=function(e,t){var n=function(e){var t=e.workingListsContext.main,n=t.programId,a=t.orgUnitId,r=t.categories,o=e.workingListsMeta.main,i=e.workingListsMeta.main.next,c=Object(se.a)({},o,i,{filters:Object(se.a)({},o.filters,i.filters)});return c.hasOwnProperty("next")&&delete c.next,Object(se.a)({programId:n,orgUnitId:a,categories:r},c)}(e);return function(e,t){var n=t?CL(t):{};return _L(TL(e,n))}(Object(se.a)({},n,t),e.workingListsColumnsOrder.main).then(function(e){return function(e){return le(fT)(e)}(e)}).catch(function(e){return O.a.error(Object(ze.b)(AL)({error:e})),t=AL,le(mT)(t);var t})},xL=(n(371),{paging:!1}),PL={GET:"get",LIST:"list",LIST_WITH_PAGER:"listWithPager"};function DL(e,t,n,a){return UL.apply(this,arguments)}function UL(){return(UL=Object(o.a)(r.a.mark(function e(t,n,a,o){var i;return r.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.models[n].list(a);case 2:if(i=e.sent,o!==PL.LIST_WITH_PAGER){e.next=5;break}return e.abrupt("return",i);case 5:return e.abrupt("return",Object(We.a)(i.values()));case 6:case"end":return e.stop()}},e)}))).apply(this,arguments)}function LL(e,t,n,a){return ML.apply(this,arguments)}function ML(){return(ML=Object(o.a)(r.a.mark(function e(t,n,a,o){var i,c,s,l,u,d;return r.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(i=_e(),c=Object(se.a)({},xL,a),n!==PL.GET){e.next=12;break}if(a&&(a.id||0===a.id)){e.next=6;break}return O.a.warn(Object(ze.b)("no id supplied to getData")({queryParams:a,d2ModelName:t,getterType:n})),e.abrupt("return",null);case 6:return l=a.id,u=Object(Fe.a)(a,["id"]),e.next=9,i.models[t][n](l,u);case 9:s=e.sent,e.next=15;break;case 12:return e.next=14,DL(i,t,c,n);case 14:s=e.sent;case 15:return d=o?o(s):s,e.abrupt("return",d);case 17:case"end":return e.stop()}},e)}))).apply(this,arguments)}var BL=function(){function e(t){Object(A.a)(this,e),t&&t(this)}return Object(w.a)(e,[{key:"updateQueryParams",value:function(e){this.queryParams=Object(se.a)({},this.queryParams,e)}},{key:"setFilter",value:function(e){var t=this.queryParams&&this.queryParams.filter?this.queryParams.filter:[];ld()(t)&&(t=[t]),this.queryParams=Object(se.a)({},this.queryParams,{filter:[].concat(Object(We.a)(t),[e])})}},{key:"get",value:function(){return LL(this.modelName,this.modelGetterType,this.queryParams,this.converter)}}]),e}(),VL=function(e){return new BL(function(t){t.modelName="organisationUnits",t.modelGetterType=PL.GET,t.queryParams={id:e,fields:"id,displayName"},t.converter=function(e){return{id:e.id,name:e.displayName}}})},GL="Could not get event from state",WL=function(e,t,n,a,r){var o,i=e.getState(),c=ff(t,n),s=i.dataEntries[t].eventId,l=i.events[s],u=Tt(l),d=i.currentSelections.orgUnitId,p=i.organisationUnits[d];if(u.error){var f=u.stage?u.stage.stageForm:null;O.a.error(Object(ze.b)(GL)({method:"runRulesForEditSingleEventEpic"})),o=Jv(u.program,f,c,p)}else{var m=u.stage.stageForm,h=ny(i,m,c,r),b=ay(i,n,t,l,m);b=Object(se.a)({},i.events[s],b);var g=Object(se.a)({},h,b);o=Jv(u.program,m,c,p,g,[g])}return Object(Le.batchActions)([].concat(Object(We.a)(o),[Lf(t,n,a)]),zN)},HL=function(e,t){if(!e.currentSelections.complete)return!1;var n=t.meta.selections,a=e.currentSelections;return NI(n,a)},zL=(n(721),n(226)),KL=function(e,t){var n=[];return e&&n.push("programId=".concat(e)),t&&n.push("orgUnitId=".concat(t)),n.join("&")},YL="BatchOpenTeiSearch";function qL(e,t,n){return"".concat(e,"-").concat(t,"-").concat(n)}var XL,ZL=function(e,t){return"".concat(t,":eq:").concat(e)};function JL(e,t){return"".concat(t,":ge:").concat(e.from,":le:").concat(e.to)}var QL=(XL={},Object(Ut.a)(XL,ct.TEXT,function(e,t){return"".concat(t,":like:").concat(e)}),Object(Ut.a)(XL,ct.NUMBER_RANGE,JL),Object(Ut.a)(XL,ct.DATE_RANGE,JL),Object(Ut.a)(XL,ct.DATETIME_RANGE,JL),XL);function $L(e,t,n){return e||0===e||!1===e?QL[t]?QL[t](e,n.id):ZL(e,n.id):e}function eM(e,t,n){return e||0===e||!1===e?ZL(e,n.id):e}var tM=Object(Ut.a)({},ct.IMAGE,function(e,t,n){var a=$l.config.baseUrl;return ye().get("fileResources/".concat(e)).then(function(e){return{name:e.name,value:e.id,url:"".concat(a,"/trackedEntityInstances/").concat(t,"/").concat(n,"/image")}}).catch(function(a){return O.a.warn(Object(ze.b)("Could not get subvalue")({value:e,teiId:t,attributeId:n,error:a})),null})});function nM(e,t,n){return aM.apply(this,arguments)}function aM(){return(aM=Object(o.a)(r.a.mark(function e(t,n,a){var i;return r.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(a){e.next=2;break}return e.abrupt("return",null);case 2:return i=n.toHashMap("id"),e.abrupt("return",Object.keys(a).reduce(function(){var e=Object(o.a)(r.a.mark(function e(n,o){var c,s,l,u,d;return r.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,n;case 2:if(c=e.sent,s=a[o],l=i[o],!Object(ft.a)(s)||!l){e.next=12;break}if(!(u=tM[l.type])){e.next=12;break}return e.next=10,u(s,t,o);case 10:d=e.sent,c[o]=d;case 12:return e.abrupt("return",c);case 13:case"end":return e.stop()}},e)}));return function(t,n){return e.apply(this,arguments)}}(),Promise.resolve(a)));case 4:case"end":return e.stop()}},e)}))).apply(this,arguments)}function rM(e,t){return oM.apply(this,arguments)}function oM(){return(oM=Object(o.a)(r.a.mark(function e(t,n){var a,o;return r.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.attributes,a=r?r.reduce(function(e,t){return e[t.attribute]=t.value,e},{}):r,o=Bt(a,n,yd),e.next=4,nM(t.trackedEntityInstance,n,o);case 4:return e.abrupt("return",{id:t.trackedEntityInstance,tei:t,values:o});case 5:case"end":return e.stop()}var r},e)}))).apply(this,arguments)}function iM(){return(iM=Object(o.a)(r.a.mark(function e(t,n){var a,i,c,s;return r.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return a=ye(),e.next=3,a.get("trackedEntityInstances",Object(se.a)({},t,{totalPages:!0}));case 3:if(!(i=e.sent)||!i.trackedEntityInstances){e.next=10;break}return e.next=7,i.trackedEntityInstances.reduce(function(){var e=Object(o.a)(r.a.mark(function e(t,a){var o,i;return r.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t;case 2:return o=e.sent,e.next=5,rM(a,n);case 5:return(i=e.sent)&&o.push(i),e.abrupt("return",o);case 8:case"end":return e.stop()}},e)}));return function(t,n){return e.apply(this,arguments)}}(),Promise.resolve([]));case 7:e.t0=e.sent,e.next=11;break;case 10:e.t0=null;case 11:return c=e.t0,s={rowsCount:i.pager.total,rowsPerPage:i.pager.pageSize,currentPage:i.pager.page},e.abrupt("return",{trackedEntityInstanceContainers:c,pagingData:s});case 14:case"end":return e.stop()}},e)}))).apply(this,arguments)}var cM=function(e,t,n,a,r){var o,i,c,s,l=e.teiSearch[t],u=e.formsValues[n],d=l.selectedProgramId,p=l.selectedTrackedEntityTypeId,f=l.selectedOrgUnit,m=l.selectedOrgUnitScope,h=rv(p,d)[a],b=h.unique?eM:$L,g=h.searchForm.convertValues(u,function(e,t,n){return b(id(bd(e,t),t),t,n)}),O=Object.keys(g).reduce(function(e,t){var n=g[t];return Object(et.a)(n)?[].concat(Object(We.a)(e),Object(We.a)(n)):[].concat(Object(We.a)(e),[n])},[]).filter(function(e){return null!==e&&void 0!==e});return function(e,t){return iM.apply(this,arguments)}(Object(se.a)({filter:O},(c=f,"ACCESSIBLE"!==(s=m)?{ou:c&&c.id,ouMode:s}:{ouMode:s}),(i=p,(o=d)?{program:o}:{trackedEntityType:i}),function(e){return e?{page:e,pageSize:5}:{pageSize:5}}(r)),d?It(d).attributes:Dt(p).attributes).then(function(e){return function(e,t,n,a){return le(ZO)({data:e,formId:t,searchGroupId:n,searchId:a})}(e,n,a,t)}).catch(function(e){return function(e,t,n){return le(XO)({formId:e,searchGroupId:t,searchId:n})}(n,a,t)})},sM=function(e,t){return e.type===Uh.ADD_FORM_DATA&&e.payload.formId===t},lM=function(e,t,n){return dP()(e.payload)?e.payload.some(function(e){return sM(e,t)}):sM(e,t)||function(e,t,n){return e.type===ul&&e.payload.formId===t&&e.payload.elementId===n}(e,t,n)},uM=function(e,t){return e.type===KO&&e.payload.searchId===t},dM=function(e,t){return dP()(e.payload)?e.payload.some(function(e){return uM(e,t)}):uM(e,t)||function(e,t){return e.type===hO&&e.payload.searchId===t}(e,t)},pM={TRACKED_ENTITY_INSTANCE:function(e){var t=e.trackedEntityInstance,n=Dt(t.trackedEntityType),a=t.attributes.reduce(function(e,t){return e[t.attribute]=t.value,e},{});return{id:t.trackedEntityInstance,name:Uv(a,n.attributes,n.name),type:"TRACKED_ENTITY_INSTANCE"}},PROGRAM_STAGE_INSTANCE:function(e){var t=e.event,n=Je.get(t.program);if(!n)return null;var a=n.getStage(t.programStage);return a?{id:t.event,name:"".concat(a.name," event"),type:"PROGRAM_STAGE_INSTANCE"}:null}};function fM(e,t){var n=t.find(function(t){return t.id===e.relationshipType});return n?{id:e.relationship,clientId:e.relationship,relationshipType:{id:n.id,name:n.name},from:pM[n.from.entity](e.from),to:pM[n.to.entity](e.to)}:null}function mM(){return(mM=Object(o.a)(r.a.mark(function e(t,n){var a,o;return r.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return a=ye(),e.next=3,a.get("relationships",Object(se.a)({},t));case 3:return o=e.sent,e.abrupt("return",o&&dP()(o)?o.map(function(e){return fM(e,n)}):null);case 5:case"end":return e.stop()}},e)}))).apply(this,arguments)}function hM(e,t){return function(e,t){return mM.apply(this,arguments)}({event:e},Et(t).getStageThrowIfNull().relationshipTypes)}var bM="CoreLoadSuccessBatch",gM="id,displayName,path,publicAccess,access,lastUpdated,children[id,displayName,publicAccess,access,path,children::isNotEmpty]";function OM(){var e=Ee();if(!e.teiSearchOrganisationUnits||0===e.teiSearchOrganisationUnits.length)return Promise.resolve(Ic("captureRoots"));var t=e.teiSearchOrganisationUnits.map(function(e){return e.id}).join(",");return _e().models.organisationUnits.list({fields:gM,filter:"id:in:[".concat(t,"]"),paging:!1}).then(function(e){return e.toArray()})}function vM(){return yM.apply(this,arguments)}function yM(){return(yM=Object(o.a)(r.a.mark(function e(){var t,n;return r.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Ee().getOrganisationUnits({defaultFields:gM,paging:!1}).then(function(e){return e.toArray()});case 2:return jc("captureRoots",t=e.sent),n=t.map(function(e){return{id:e.id,path:e.path,displayName:e.displayName}}),e.abrupt("return",NU(n));case 6:case"end":return e.stop()}},e)}))).apply(this,arguments)}function EM(){return _M.apply(this,arguments)}function _M(){return(_M=Object(o.a)(r.a.mark(function e(){var t,n;return r.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,OM();case 2:return jc("searchRoots",t=e.sent),n=t.map(function(e){return{id:e.id,path:e.path,displayName:e.displayName}}),e.abrupt("return",AU(n));case 6:case"end":return e.stop()}},e)}))).apply(this,arguments)}function jM(){return(jM=Object(o.a)(r.a.mark(function e(){var t,n;return r.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,vM();case 2:return t=e.sent,e.next=5,EM();case 5:return n=e.sent,e.abrupt("return",[t,n]);case 7:case"end":return e.stop()}},e)}))).apply(this,arguments)}var IM=Jh.a.apply(void 0,[function(e,t){return e.ofType(aC,AI,HI,fI.SET_ORG_UNIT).filter(function(e){return function(e,t){if(!t)return!1;var n=Je.get(t);return!n||!n.organisationUnits||!n.organisationUnits[e]}(e.payload.id,t.getState().currentSelections.programId)}).map(function(){return jn()})},function(e,t){return e.ofType(nx,fx,SI,aC,oC,cC,AI,FI,PI,HI,KI,qI,fI.SET_ORG_UNIT,fI.SET_PROGRAM_ID,fI.SET_CATEGORY_OPTION,iT).map(function(){return function(e){return le(oL)({isComplete:e})}(function(e){if(!e.orgUnitId||!e.programId)return!1;var t=e.programId&&Je.get(e.programId);return!(t&&t.categoryCombination&&Array.from(t.categoryCombination.categories.values()).some(function(t){return!e.categories||!e.categories[t.id]}))}(t.getState().currentSelections))})},function(e){return e.ofType(eL).map(function(){return le(CU)()})},function(e,t){return e.ofType(CU).concatMap(function(){return function(){return jM.apply(this,arguments)}().then(function(e){return t=e,Object(Le.batchActions)([].concat(Object(We.a)(t),[le(TU)()]),bM);var t}).catch(function(e){return function(e){return le(SU)({error:e})}(e)})})},function(e){return e.ofType(bM).map(function(){return e={headerBarHeight:48},le(tL)(e);var e})},function(e){return e.ofType(SU).map(function(e){var t,n=e.payload.error;return O.a.error(Object(ze.b)("load core failed")({error:n})),t="APP FAILED TO LOAD. SEE LOG FOR DETAILS",le(nL)({message:t})})},function(e,t){return e.ofType(nx,fx,aC,oC,cC).filter(function(){return!!t.getState().currentSelections.complete}).map(function(){return le(ax)()})},function(e){return e.ofType(nx).filter(function(e){return e.payload.orgUnitId}).switchMap(function(e){return ye().get("organisationUnits/".concat(e.payload.orgUnitId)).then(function(e){return t={id:e.id,name:e.displayName},le(ix)(t);var t})})},function(e,t){return e.ofType(ax).switchMap(function(){var n=wL(t.getState());return Object(qh.fromPromise)(n).takeUntil(e.ofType(RL,Jb,aA,FA,RT,kT,hT,jR,SR)).takeUntil(e.ofType(HD).filter(function(e){return e.payload.some(function(e){return e.type===KD})}))})},function(e,t){return e.ofType(Jb,aA,FA).switchMap(function(){var n=wL(t.getState());return Object(qh.fromPromise)(n).takeUntil(e.ofType(ax,RL,RT,kT,hT,jR,SR)).takeUntil(e.ofType(HD).filter(function(e){return e.payload.some(function(e){return e.type===KD})}))})},function(e,t){return e.ofType(RL).switchMap(function(){var n=t.getState(),a=n.workingListsContext.main,r=[ax,Jb,aA,FA,RT,kT,hT,jR,SR];if(a&&NI(a,n.currentSelections)){var o=FL(n);return Object(qh.fromPromise)(o).takeUntil(e.ofType.apply(e,r)).takeUntil(e.ofType(HD).filter(function(e){return e.payload.some(function(e){return e.type===KD})}))}var i=wL(n);return Object(qh.fromPromise)(i).takeUntil(e.ofType.apply(e,r)).takeUntil(e.ofType(HD).filter(function(e){return e.payload.some(function(e){return e.type===KD})}))})},function(e,t){return e.ofType(RT,kT,hT,jR,SR,ET).switchMap(function(){var n=t.getState(),a=FL(n);return Object(qh.fromPromise)(a).takeUntil(e.ofType(ax,Jb,aA,FA,RL)).takeUntil(e.ofType(HD).filter(function(e){return e.payload.some(function(e){return e.type===KD})}))})},function(e,t){return e.ofType(HD).filter(function(e){return e.payload.some(function(e){return e.type===KD})}).switchMap(function(){var n=t.getState(),a={programId:n.currentSelections.programId,orgUnitId:n.currentSelections.orgUnitId,categories:n.currentSelections.categories},r=n.workingListsContext.main,o=[ax,Jb,aA,FA,RL,RT,kT,hT,jR,SR];if(r&&NI(r,a)){var i=FL(n);return Object(qh.fromPromise)(i).takeUntil(e.ofType.apply(e,o))}var c=wL(n);return Object(qh.fromPromise)(c).takeUntil(e.ofType.apply(e,o))})},function(e){return e.ofType(cx).filter(function(e){return e.payload.nextProps.orgUnitId}).switchMap(function(e){return ye().get("organisationUnits/".concat(e.payload.nextProps.orgUnitId)).then(function(e){return t={id:e.id,name:e.displayName},le(sx)(t);var t}).catch(function(){return e=c.a.t("Could not get organisation unit"),le(ux)(e);var e})})},function(e){return e.ofType(cx).filter(function(e){return!e.payload.nextProps.orgUnitId}).map(function(){return le(dx)()})},function(e,t){return e.ofType(dx,sx).map(function(){var e=t.getState().currentSelections,n=e.programId,a=e.orgUnitId;if(n){var r=Je.get(n);if(!r)return mx(c.a.t("Program doesn't exist"));if(a&&!r.organisationUnits[a])return mx(c.a.t("Selected program is invalid for registering unit"))}return le(fx)()})},function(e){return e.ofType(EI).filter(function(e){return e.payload.nextProps.orgUnitId}).switchMap(function(e){return ye().get("organisationUnits/".concat(e.payload.nextProps.orgUnitId)).then(function(e){return t={id:e.id,name:e.displayName},le(_I)(t);var t}).catch(function(){return e=c.a.t("Could not get organisation unit"),le(II)(e);var e})})},function(e){return e.ofType(EI).filter(function(e){return!e.payload.nextProps.orgUnitId}).map(function(){return le(CI)()})},function(e,t){return e.ofType(_I,CI).map(function(){var e=t.getState().currentSelections,n=e.programId,a=e.orgUnitId;if(n){var r=Je.get(n);if(!r)return RI(c.a.t("Program doesn't exist"));if(a&&!r.organisationUnits[a])return RI(c.a.t("Selected program is invalid for registering unit"))}return le(SI)()})},function(e,t){return e.ofType(LI,JI,uC).map(function(){var e=t.getState().currentSelections,n=function(e,t){var n=[];return e&&n.push("programId=".concat(e)),t&&n.push("orgUnitId=".concat(t)),n.join("&")}(e.programId,e.orgUnitId);return Object(M.b)("/newEvent/".concat(n))})},function(e,t){return e.ofType(LI,JI,uC,SI,fI.SET_PROGRAM_ID,fI.SET_ORG_UNIT,fI.SET_CATEGORY_OPTION).map(function(){var e=t.getState();if(!e.currentSelections.complete)return le(eg)();var n=e.currentSelections.programId,a=e.currentSelections.orgUnitId,r=e.organisationUnits[a],o=gt(n);o.error&&O.a.error(Object(ze.b)(jC)({method:"openNewEventInDataEntryEpic"}));var i=o.stage&&o.stage.stageForm;return Object(Le.batchActions)(Object(We.a)(function(e,t,n){var a=Hh("singleEvent","newEvent",gC),r=Jv(e,t,bC,n);return[].concat(Object(We.a)(a),Object(We.a)(r),[le(zb)()])}(o.program,i,r)),Vb)})},function(e,t){return e.ofType(fI.OPEN_NEW_EVENT_FROM_NEW_EVENT_PAGE,Hb).map(function(){var e=t.getState(),n=e.currentSelections.programId,a=e.currentSelections.orgUnitId,r=e.organisationUnits[a],o=gt(n);o.error&&O.a.error(Object(ze.b)(jC)({method:"resetDataEntryForNewEventEpic"}));var i=o.stage&&o.stage.stageForm;return Object(Le.batchActions)(Object(We.a)(function(e,t,n){var a=Hh("singleEvent","newEvent",gC),r=Jv(e,t,bC,n);return[].concat(Object(We.a)(a),Object(We.a)(r),[le(ig)()])}(o.program,i,r)),Gb)})},function(e,t){return e.ofType(LI,JI,uC,SI,fI.SET_CATEGORY_OPTION,fI.SET_ORG_UNIT,fI.SET_PROGRAM_ID).filter(function(){return t.getState().currentSelections.complete}).switchMap(function(){var e=t.getState(),n={sortById:"created",sortByDirection:"desc"};return OC(e.currentSelections.programId).then(function(t){return a="recentlyAddedEvents",r=t,o=n,i=e.currentSelections,le(_C)({listId:a,columnsOrder:r,meta:o,selections:i});var a,r,o,i})})},function(e,t){return e.ofType(Mb).map(function(e){return e.payload.find(function(e){return e.type===Kb})}).map(function(e){var n=e.payload,a=n.dataEntryId,r=n.itemId,o=n.uid;return IC(t,a,r,o)})},function(e,t){return e.ofType(Bb).map(function(e){return e.payload.find(function(e){return e.type===Kb})}).map(function(e){var n=e.payload,a=n.dataEntryId,r=n.itemId,o=n.uid,i={elementId:n.elementId,value:n.value,valid:n.uiState.valid};return IC(t,a,r,o,i)})},function(e,t){return e.ofType(Yb).map(function(){var e=t.getState(),n=e.currentSelections.programId,a=e.currentSelections.orgUnitId;return Object(M.b)("/programId=".concat(n,"&orgUnitId=").concat(a))})},function(e,t){return e.ofType(Yb).map(function(e){var n=t.getState(),a=e.payload,r=ff(a.dataEntryId,a.eventId),o=a.formFoundation,i=RC(n,r,o),c=i.formClientValues,s=i.mainDataClientValues;return function(e,t,n){var a=qb;return le(a)({selections:n},{offline:{effect:{url:"events",method:Db,data:e},commit:{type:lg,meta:{selections:n,relationshipData:t,triggerAction:a}},rollback:{type:$b,meta:{selections:n}}}})}(TC(n,o,c,s),n.dataEntriesRelationships[r],n.currentSelections)})},function(e,t){return e.ofType(Xb).map(function(){var e=t.getState(),n=e.currentSelections.programId,a=e.currentSelections.orgUnitId;return Object(M.b)("/programId=".concat(n,"&orgUnitId=").concat(a))})},function(e,t){return e.ofType(Xb).map(function(){var e=t.getState();if(!e.offline.online)return yg();if(Object.keys(e.recentlyAddedEvents).length>0)return Eg();var n=e.workingListsContext.main;if(!n)return Eg();var a=e.currentSelections;return a.complete&&!NI(n,a)?Eg():yg()})},function(e,t){return e.ofType(iI).map(function(){var e=t.getState().currentSelections,n=function(e,t){var n=[];return e&&n.push("programId=".concat(e)),t&&n.push("orgUnitId=".concat(t)),n.join("&")}(e.programId,e.orgUnitId);return Object(M.b)("/".concat(n))})},function(e,t){return e.ofType(hx).switchMap(function(e){var n=e.payload.eventId,a=t.getState().currentSelections.programId;return yL(n).then(function(e){return e?function(e,t){return le(bx)({eventContainer:e,prevProgramId:t})}(e,a):jx(c.a.t("Event could not be loaded. Are you sure it exists?"))}).catch(function(e){var t=sf(e),n=t.message,a=t.details;return O.a.error(Object(ze.b)(n||c.a.t("Event could not be loaded"))(a)),jx(c.a.t("Event could not be loaded. Are you sure it exists?"))})})},function(e){return e.ofType(bx).switchMap(function(e){var t=e.payload.eventContainer;return VL(t.event.orgUnitId).get().then(function(e){return function(e,t){return le(Ox)({orgUnit:e,eventContainer:t})}(e,t)}).catch(function(e){var n=sf(e),a=n.message,r=n.details;return O.a.error(Object(ze.b)(a||c.a.t("Organisation unit could not be loaded"))(r)),function(e){return le(vx)({eventContainer:e})}(t)})})},function(e){return e.ofType(Ox,vx,yx).map(function(e){var t,n=e.payload.eventContainer,a=e.payload.orgUnit,r=Tt(n.event);if(r.error)return t=r.error,le(XN)(t);var o=r.stage.stageForm,i=r.program;return Object(Le.batchActions)(uA(n,a,o,i))})},function(e,t){return e.ofType(WN).map(function(e){return e.payload.find(function(e){return e.type===ZN})}).map(function(e){var n=e.payload,a=n.dataEntryId,r=n.itemId,o=n.uid;return WL(t,a,r,o)})},function(e,t){return e.ofType(HN).map(function(e){return e.payload.find(function(e){return e.type===ZN})}).map(function(e){var n=e.payload,a=n.elementId,r=n.value,o=n.uiState,i=n.dataEntryId,c=n.itemId,s=n.uid,l={elementId:a,value:r,valid:o.valid};return WL(t,i,c,s,l)})},function(e,t){return e.ofType(JN).map(function(){var e=t.getState(),n=e.currentSelections.programId,a=e.currentSelections.orgUnitId;return Object(M.b)("/programId=".concat(n,"&orgUnitId=").concat(a))})},function(e,t){return e.ofType(JN).map(function(e){var n=t.getState(),a=e.payload,r=ff(a.dataEntryId,a.itemId),o=n.dataEntries[a.dataEntryId].eventId,i=n.formsValues[r],c=n.dataEntriesFieldsValue[r],s=n.dataEntriesFieldsMeta[r],l=n.events[o],u=a.formFoundation,d=CC(u,i,c,s,l),p=d.formClientValues,f=d.dataEntryClientValues,m=Object(se.a)({},l,f,{notes:[]}),h=u.convertValues(p,id),b=Mg(m);return"COMPLETED"!==b.status||l.completedDate||(b.completedDate=Se().format("YYYY-MM-DD")),function(e,t,n){return le(QN)({selections:n},{offline:{effect:{url:"events/".concat(e),method:Ub,data:t},commit:{type:$N,meta:{selections:n}},rollback:{type:eA,meta:{selections:n}}}})}(o,Object(se.a)({},b,{dataValues:Object.keys(h).map(function(e){return{dataElement:e,value:h[e]}})}),n.currentSelections)})},function(e,t){return e.ofType(tA).map(function(){var e=t.getState(),n=e.currentSelections.programId,a=e.currentSelections.orgUnitId;return Object(M.b)("/programId=".concat(n,"&orgUnitId=").concat(a))})},function(e,t){return e.ofType(tA).map(function(){var e=t.getState();if(!e.offline.online)return pA();var n=e.workingListsContext.main;if(!n)return fA();var a=e.currentSelections;return a.complete&&!NI(n,a)?fA():pA()})},function(e,t){return e.ofType(rA).map(function(e){var n=t.getState(),a=e.payload,r=n.dataEntries[a.dataEntryId].eventId,o=Ee().username,i={event:r,notes:[{value:a.note}]},c={value:a.note,storedBy:o,storedDate:Se().toISOString(),clientId:Object(kj.a)()},s=Object(se.a)({},c,{storedDate:Ju(c.storedDate,ct.DATETIME)}),l={dataEntryId:a.dataEntryId,itemId:a.itemId,eventId:r,noteClientId:c.clientId};return Object(Le.batchActions)([bA(r,i,n.currentSelections,l),Mf(a.dataEntryId,a.itemId,s),Ix(r,c)],KN)})},function(e){return e.ofType(cg).map(function(e){var t=e.payload,n=Ee().username,a=Se().toISOString(),r={value:t.note,storedBy:n,storedDate:Ju(a,ct.DATETIME),clientId:Object(kj.a)()};return Mf(t.dataEntryId,t.itemId,r)})},function(e){return e.ofType(cA).map(function(e){var t,n,a,r=e.meta.context;return Object(Le.batchActions)([(t=r.dataEntryId,n=r.itemId,a=r.noteClientId,le(Nf)({dataEntryId:t,itemId:n,noteClientId:a})),Cx(r.eventId,r.noteClientId)],YN)})},function(e){return e.ofType(bT).map(function(e){return Object(M.b)("/editEvent/".concat(e.payload))})},function(e,t){return e.ofType(bT).map(function(e){var n=e.payload,a=t.getState(),r=a.events[n];return function(e,t){return le(yx)({eventContainer:e,orgUnit:t})}({event:r,values:a.eventsValues[n],id:r.eventId},a.organisationUnits[r.orgUnitId])})},function(e){return e.ofType(zL.OFFLINE_STATUS_CHANGED).map(function(e){return t=e.payload.online,le(DU)({status:t});var t})},function(e,t){return e.ofType("Offline/STATUS_CHANGED").filter(function(e){return!!e.payload.online}).map(function(){var e=[le(zD)()];return!!t.getState().currentSelections.complete&&(e=[].concat(Object(We.a)(e),[le(KD)()])),Object(Le.batchActions)(e,HD)})},function(e,t){return e.ofType(Qb,$N).filter(function(e){var n=t.getState();return HL(n,e)}).map(function(){return kL()})},function(e,t){return e.ofType(bn).map(function(){var e=t.getState().currentSelections,n=e.programId,a=e.orgUnitId,r=KL(n,a);return Object(M.b)("/".concat(r))})},function(e,t){return e.ofType(On).map(function(){var e=t.getState().currentSelections,n=e.programId,a=e.orgUnitId,r=KL(n,a);return Object(M.b)("/".concat(r))})},function(e,t){return e.ofType(En).map(function(){var e=t.getState().currentSelections,n=e.programId,a=e.orgUnitId,r=KL(n,a);return Object(M.b)("/".concat(r))})},function(e,t){return e.ofType(rC,aC,oC,iC,dC,pC).map(function(){var e=t.getState().currentSelections,n=function(e,t){var n=[];return e&&n.push("programId=".concat(e)),t&&n.push("orgUnitId=".concat(t)),n.join("&")}(e.programId,e.orgUnitId);return Object(M.b)("/".concat(n))})},function(e,t){return e.ofType(wI,AI,FI,xI,DI,MI,BI).map(function(){var e=t.getState().currentSelections,n=function(e,t){var n=[];return e&&n.push("programId=".concat(e)),t&&n.push("orgUnitId=".concat(t)),n.join("&")}(e.programId,e.orgUnitId);return Object(M.b)("/".concat(n))})},function(e,t){return e.ofType(fI.RESET_ORG_UNIT_ID,fI.SET_ORG_UNIT,fI.SET_PROGRAM_ID,fI.RESET_PROGRAM_ID,hI).map(function(){var e=t.getState().currentSelections,n=e.programId,a=e.orgUnitId,r=kC(n,a);return Object(M.b)("/newEvent/".concat(r))})},function(e,t){return e.ofType(mI).map(function(){var e=t.getState().currentSelections,n=e.programId,a=e.orgUnitId,r=kC(n,a);return Object(M.b)("/".concat(r))})},function(e,t){return e.ofType(gk).map(function(){var e,n=t.getState(),a=n.workingListsAppliedFilters&&n.workingListsAppliedFilters.main||{},r=n.workingListsAppliedFilters&&n.workingListsAppliedFilters.main&&n.workingListsAppliedFilters.main.next||{},o=Object.keys(a).reduce(function(e,t){return a[t]&&"next"!==t&&(e[t]=!0),e},{}),i=Object.keys(r).reduce(function(e,t){return r[t]&&(e[t]=!0),e},{});return e=Object(se.a)({},o,i),le(TR)({includeFilters:e})})},function(e,t){return e.ofType(tg).map(function(e){var n,a,r,o,i=t.getState(),c=e.payload,s=c.formFoundation,l=ff(c.dataEntryId,c.eventId),u=RC(i,l,s),d=u.formClientValues,p=u.mainDataClientValues,f=TC(i,s,d,p),m=Object(se.a)({},p,{eventId:Object(kj.a)(),programId:i.currentSelections.programId,programStageId:s.id,orgUnitId:i.currentSelections.orgUnitId}),h=Object(se.a)({},d,{created:Se().toISOString()}),b=i.dataEntriesRelationships[l];return Object(Le.batchActions)([_g(f,b,i.currentSelections,m.eventId),(r=m,o=h,le(kI)({event:r,eventValues:o})),(n="recentlyAddedEvents",a=m.eventId,le(yC)({listId:n,itemId:a}))],Hb)})},function(e){return e.ofType(rg).map(function(e){var t,n,a=e.meta.clientId;return t="recentlyAddedEvents",n=a,le(EC)({listId:t,itemId:n})})},function(e){return e.ofType(OT).map(function(e){var t=e.payload.eventId;return Object(Le.batchActions)([TT(t),le(jT)({})],IT)})},function(e){return e.ofType(Rc).switchMap(function(e){var t=e.payload.searchText;return _e().models.organisationUnits.list({fields:["id,displayName,path,publicAccess,access,lastUpdated","children[id,displayName,publicAccess,access,path,children::isNotEmpty]"].join(","),paging:!0,withinUserHierarchy:!0,query:t,pageSize:15}).then(function(e){return{regUnitArray:e.toArray(),searchText:t}}).catch(function(e){return{error:e}})}).map(function(e){if(e.error)return O.a.error(Object(ze.b)("Could not retrieve registering unit list")({error:e.error,method:"searchRegisteringUnitListEpic"})),t="Could not retrieve registering unit list",le(Ac)({message:t});var t;jc("regUnit",e.regUnitArray);var n,a,r=e.regUnitArray.map(function(e){return{id:e.id,path:e.path,displayName:e.displayName}});return n=r,a=e.searchText,le(Nc)({roots:n,searchText:a})})},function(e){return e.ofType(Rc).switchMap(function(){return Object(qh.fromPromise)(new Promise(function(e){setTimeout(function(){return e()},500)})).takeUntil(e.ofType(Nc,Ac))}).map(function(){return le(wc)()})},function(e,t){return e.ofType(mj).filter(function(e){return e.payload.findMode&&"TEI_SEARCH"===e.payload.findMode}).map(function(e){var n=t.getState().newRelationship.selectedRelationshipType.to,a=n.programId,r=n.trackedEntityTypeId,o=a||r,i=rv(r,a),c=i?i.map(function(e,t){return Lh(qL("relationshipTeiSearch",o,t.toString()),{})}):[];return Object(Le.batchActions)([].concat(Object(We.a)(c),[nv("relationshipTeiSearch",a,r)]),YL)})},function(e){return e.ofType(YO).filter(function(e){return e.payload.searchId&&"relationshipTeiSearch"===e.payload.searchId}).map(function(){return le(hj)({})})},function(e){return e.ofType(QO,$O).filter(function(e){return e.payload.searchId&&"relationshipTeiSearch"===e.payload.searchId}).map(function(){return le(bj)({})})},function(e,t){return e.ofType(YO).switchMap(function(n){var a=t.getState(),r=n.payload,o=r.formId,i=r.searchGroupId,c=r.searchId,s=cM(a,c,o,i);return Object(qh.fromPromise)(s).takeUntil(e.ofType(YO,ev)).takeUntil(e.filter(function(e){return Object(et.a)(e.payload)&&e.payload.some(function(e){return e.type===KO})}))})},function(e,t){return e.ofType(ev).switchMap(function(n){var a=t.getState(),r=n.payload,o=r.pageNumber,i=r.searchId,c=a.teiSearch[i],s=cM(a,i,c.searchResults.formId,c.searchResults.searchGroupId,o);return Object(qh.fromPromise)(s).takeUntil(e.ofType(YO,ev)).takeUntil(e.filter(function(e){return Object(et.a)(e.payload)&&e.payload.some(function(e){return e.type===KO})}))})},function(e,t){return e.ofType(MO).map(function(e){var n=t.getState(),a=e.payload.searchId,r=e.payload.programId,o=n.teiSearch[a].selectedTrackedEntityTypeId,i=r||o;r&&(o=It(r).trackedEntityType.id);var c=[];o&&(c=rv(o,r));var s=c?c.map(function(e,t){return Lh(qL(a,i,t.toString()),{})}):[];return Object(Le.batchActions)([].concat(Object(We.a)(s),[av(a,r,o)]),HO)})},function(e,t){return e.ofType(QO).map(function(e){var n=t.getState(),a=e.payload.searchId,r=n.teiSearch[a],o=r.selectedProgramId||r.selectedTrackedEntityTypeId,i=rv(r.selectedTrackedEntityTypeId,r.selectedProgramId),c=i?i.map(function(e,t){return Lh(qL(a,o,t.toString()),{})}):[];return Object(Le.batchActions)(Object(We.a)(c),zO)})},function(e){return e.ofType(sg).map(function(){return gj()})},function(e,t){return e.ofType(sO).map(function(e){var n,a=t.getState(),r=a.dataEntriesRelationships[FC]||[],o=e.payload,i=o.entity,s=i.id?i:Aj(i.dataEntryId,i.itemId,a),l=i.id?null:{dataEntryId:i.dataEntryId},u={clientId:Object(kj.a)(),from:{id:"newEvent",name:c.a.t("This event"),type:"PROGRAM_STAGE_INSTANCE"},to:Object(se.a)({},s,{type:o.entityType}),relationshipType:Object(se.a)({},o.relationshipType)};return r.some(function(e){return e.relationshipType.id===u.relationshipType.id&&e.to.id&&e.to.id===u.to.id})?function(e,t,n){return le(Pf)({dataEntryId:e,itemId:t,message:n})}("singleEvent","newEvent",c.a.t("Relationship of type {{relationshipTypeName}} to {{entityName}} already exists",{entityName:u.to.name,relationshipTypeName:u.relationshipType.name})):Object(Le.batchActions)([(n=u.clientId,le(lO)({relationshipId:n})),Bf("singleEvent","newEvent",u,l)],uO)})},function(e,t){return e.ofType(lg).map(function(e){var t=e.meta;if(t.relationshipData){var n=e.payload.response.importSummaries[0].reference,a=e.meta.relationshipData.map(function(e){return Object(se.a)({},e,{from:Object(se.a)({},e.from,{id:n})})});return xC(a,e.meta.selections,e.meta.triggerAction)}return t.triggerAction===qb?Og(t.selections):t.triggerAction===ng?jg(t.selections):null})},function(e,t){return e.ofType(dg,pg,hg).map(function(e){var t=e.meta;return t.triggerAction===qb?Og(t.selections):t.triggerAction===ng?jg(t.selections):null})},function(e){return e.ofType(nT).filter(function(e){return e.payload.nextProps.orgUnitId}).switchMap(function(e){return ye().get("organisationUnits/".concat(e.payload.nextProps.orgUnitId)).then(function(e){return t={id:e.id,name:e.displayName},le(aT)({orgUnit:t});var t}).catch(function(){return e=c.a.t("Could not get organisation unit"),le(rT)({error:e});var e})})},function(e){return e.ofType(nT).filter(function(e){return!e.payload.nextProps.orgUnitId}).map(function(){return le(oT)()})},function(e,t){return e.ofType(aT,oT).map(function(){var e=t.getState().currentSelections,n=e.programId,a=e.orgUnitId;if(n){var r=Je.get(n);if(!r)return sT(c.a.t("Program doesn't exist"));if(!(r instanceof Xt))return sT(c.a.t("Program with programid {{programId}} isn't a tracker program. Enrollments can only be done in tracker programs.",{programId:n}));if(a&&!r.organisationUnits[a])return sT(c.a.t("Selected program is invalid for selected registering unit"))}return le(iT)()})},function(e,t){return e.ofType(iT).switchMap(function(){var e=t.getState();if(!e.currentSelections.complete)return le(lT)();var n,a=e.currentSelections.programId,r=e.currentSelections.orgUnitId,o=e.organisationUnits[r];try{var i=Nt(a);i instanceof Xt?n=i:O.a.error(Object(ze.b)(pT)({method:"openNewEnrollmentInDataEntryEpic",program:i}))}catch(s){O.a.error(Object(ze.b)(dT)({method:"openNewEnrollmentInDataEntryEpic",error:s,programId:a}))}var c=n&&n.enrollment.enrollmentForm;return Ky(n,c,o,"enrollment",[le(uT)()],[],e.generatedUniqueValuesCache.enrollment)})},function(e,t){return e.ofType(cy).map(function(e){return e.payload.find(function(e){return e.type===ry})}).map(function(e){var n=e.payload,a=n.innerPayload,r=n.searchActions,o=n.uid,i=n.programId,c=n.orgUnit,s=a.dataEntryId,l=a.itemId,u={elementId:a.elementId,value:a.value,valid:a.uiState.valid};return Zy(t,{programId:i,orgUnit:c,dataEntryId:s,itemId:l,uid:o},u,r)})},function(e,t){return e.ofType(sy).map(function(e){return e.payload.find(function(e){return e.type===ry})}).map(function(e){var n=e.payload,a=n.uid,r=n.programId,o=n.orgUnit,i=n.innerPayload,c=i.dataEntryId,s=i.itemId;return Zy(t,{dataEntryId:c,itemId:s,uid:a,programId:r,orgUnit:o})})},function(e,t){return e.ofType(YC).map(function(e){var n=t.getState(),a=e.payload,r=ff(a.dataEntryId,a.itemId),o=n.currentSelections.programId;return function(e,t){return le(KC)({selections:t},{offline:{effect:{url:"trackedEntityInstances",method:Db,data:e},commit:{type:qC,meta:{selections:t}},rollback:{type:XC,meta:{selections:t}}}})}(Yy(r,{programId:o,orgUnitId:n.currentSelections.orgUnitId},It(o).enrollment,n.formsValues[r],n.dataEntriesFieldsValue[r],n.dataEntriesFieldsMeta[r],{}),n.currentSelections)})},function(e,t){return e.ofType(ul).concatMap(function(t){var n=t.payload,a=n.formId,r=n.elementId,o=n.searchText;return Object(qh.fromPromise)(_e().models.organisationUnits.list({fields:["id,displayName,path,publicAccess,access,lastUpdated","children[id,displayName,publicAccess,access,path,children::isNotEmpty]"].join(","),paging:!1,query:o,withinUserSearchHierarchy:!0}).then(function(e){return{orgUnitArray:e.toArray(),searchText:o,formId:a,elementId:r}}).catch(function(e){return{error:e,formId:a,elementId:r}})).takeUntil(e.filter(function(e){return lM(e,a,r)}))}).map(function(e){if(e.error)return O.a.error(Object(ze.b)("Filter form field org units failed")({error:e.error,method:"FilterOrgUnitRootsEpic"})),function(e,t,n){return le(pl)({formId:e,elementId:t,errorMessage:n})}(e.formId,e.elementId,"Filter form field org units failed");var t=e.orgUnitArray,n=e.formId,a=e.elementId;return jc(ml(n,a),t),function(e,t,n){return le(dl)({formId:e,elementId:t,roots:n})}(n,a,t.map(function(e){return{id:e.id,path:e.path,displayName:e.displayName}}))})},function(e){return e.ofType(nf).concatMap(function(e){var t=e.payload,n=t.elementId,a=t.formBuilderId,r=t.formId,o=t.callback,i=t.uid,s=t.onSuccess,l=t.onError,u={valid:!0,touched:!0,errorMessage:null};return o().then(function(e){var t=function(e,t,n,a,r,o){return le(af)({value:e,uiState:t,elementId:n,formBuilderId:a,formId:r,uid:o})}(e,u,n,a,r,i);return s?s(t):t}).catch(function(e){var t=sf(e).message,o=c.a.t("Async field update failed");O.a.error(Object(ze.b)(t||o)({error:e}));var s=function(e,t,n,a,r,o){return le(rf)({message:e,uiState:t,elementId:n,formBuilderId:a,formId:r,uid:o})}(o,u,n,a,r,i);return l?l(s):s})})},function(e){return e.ofType(hO).concatMap(function(t){var n=t.payload.searchText,a=t.payload.searchId;return Object(qh.fromPromise)(_e().models.organisationUnits.list({fields:["id,displayName,path,publicAccess,access,lastUpdated","children[id,displayName,publicAccess,access,path,children::isNotEmpty]"].join(","),paging:!0,withinUserSearchHierarchy:!0,query:n,pageSize:15}).then(function(e){return{regUnitArray:e.toArray(),searchText:n,searchId:a}}).catch(function(e){return{error:e,searchId:a}})).takeUntil(e.filter(function(e){return dM(e,a)}))}).map(function(e){if(e.error)return O.a.error(Object(ze.b)("Could not retrieve registering unit list")({error:e.error,method:"searchRegisteringUnitListEpic"})),t=e.searchId,n="Could not retrieve registering unit list",le(OO)({searchId:t,error:n});var t,n,a=e.regUnitArray;jc(e.searchId,a);var r=e.regUnitArray.map(function(e){return{id:e.id,path:e.path,displayName:e.displayName}});return function(e,t,n){return le(gO)({searchId:e,roots:t,searchText:n})}(e.searchId,r,e.searchText)})},function(e,t){return e.ofType(gT).switchMap(function(e){var n=t.getState();return yL(e.payload).then(function(e){return e?function(e,t){return le(NA)({eventContainer:e,orgUnit:t})}(e,n.organisationUnits[e.event.orgUnitId]):HA(c.a.t("Event could not be loaded. Are you sure it exists?"))}).catch(function(e){var t=sf(e),n=t.message,a=t.details;return O.a.error(Object(ze.b)(n||c.a.t("Event could not be loaded"))(a)),HA(c.a.t("Event could not be loaded. Are you sure it exists?"))})})},function(e,t){return e.ofType(CA).switchMap(function(e){var n=e.payload.eventId,a=t.getState().currentSelections.programId;return yL(n).then(function(e){return e?function(e,t){return le(TA)({eventContainer:e,prevProgramId:t})}(e,a):BA(c.a.t("Event could not be loaded. Are you sure it exists?"))}).catch(function(e){var t=sf(e),n=t.message,a=t.details;return O.a.error(Object(ze.b)(n||c.a.t("Event could not be loaded"))(a)),BA(c.a.t("Event could not be loaded. Are you sure it exists?"))})})},function(e){return e.ofType(TA).switchMap(function(e){var t=e.payload.eventContainer;return VL(t.event.orgUnitId).get().then(function(e){return function(e,t){return le(RA)({orgUnit:e,eventContainer:t})}(e,t)}).catch(function(e){var n=sf(e),a=n.message,r=n.details;return O.a.error(Object(ze.b)(a||c.a.t("Organisation unit could not be loaded"))(r)),function(e){return le(kA)({eventContainer:e})}(t)})})},function(e){return e.ofType(gT).map(function(e){return Object(M.b)("/viewEvent/".concat(e.payload))})},function(e,t){return e.ofType(zI,HI,KI,YI,XI,QI,$I).map(function(){var e=t.getState().currentSelections,n=function(e,t){var n=[];return e&&n.push("programId=".concat(e)),t&&n.push("orgUnitId=".concat(t)),n.join("&")}(e.programId,e.orgUnitId);return Object(M.b)("/".concat(n))})},function(e,t){return e.ofType(PA).map(function(){var e=t.getState();if(!e.offline.online)return VA();var n=e.workingListsContext.main;if(!n)return GA();var a=e.currentSelections;return a.complete&&!NI(n,a)?GA():e.viewEventPage.eventHasChanged?GA():e.viewEventPage.saveInProgress?le(LA)():VA()})},function(e,t){return e.ofType(PA).map(function(){var e=t.getState(),n=e.currentSelections.programId,a=e.currentSelections.orgUnitId;return Object(M.b)("/programId=".concat(n,"&orgUnitId=").concat(a))})},function(e){return e.ofType(DA).map(function(){return gj()})},function(e,t){return e.ofType(cF).map(function(e){var n,a,r,o,i,s,l=t.getState(),u=l.viewEventPage.eventId,d=l.dataEntriesRelationships.viewEvent||[],p=e.payload,f=p.entity,m=f.id?f:Aj(f.dataEntryId,f.itemId,l),h=Object(kj.a)(),b={clientId:h,from:{id:u,name:c.a.t("This event"),type:"PROGRAM_STAGE_INSTANCE"},to:Object(se.a)({},m,{type:p.entityType}),relationshipType:Object(se.a)({},p.relationshipType)};if(d.some(function(e){return e.relationshipType.id===b.relationshipType.id&&e.to.id&&e.to.id===b.to.id}))return function(e){return le(dF)({message:e})}(c.a.t("Relationship of type {{relationshipTypeName}} to {{entityName}} already exists",{entityName:b.from.name,relationshipTypeName:b.relationshipType.name}));if(m.data)a=b,r=l.currentSelections,o=h,n=le(bF)({selections:r},{offline:{effect:{url:"trackedEntityInstances",method:Db,data:a.to.data,clientId:o},commit:{type:gF,meta:{clientData:a,selections:r,clientId:o}},rollback:{type:OF,meta:{clientData:a,selections:r,clientId:o}}}});else{var g={relationships:[AC(b)]};n=vF(g,l.currentSelections,h)}return Object(Le.batchActions)([(i="viewEvent",s=b,le(YU)({key:i,relationship:s})),n],aF)})},function(e){return e.ofType(uF).map(function(e){return JU("viewEvent",e.meta.clientId)})},function(e,t){return e.ofType(lF).map(function(e){var n=t.getState().relationships.viewEvent.find(function(t){return t.clientId===e.meta.clientId}),a=e.payload.response.importSummaries[0].reference;return function(e,t){return le(qU)({key:e,updatedRelationship:t})}("viewEvent",Object(se.a)({},n,{id:a}))})},function(e,t){return e.ofType(hF).map(function(e){var n=e.payload.clientId,a=t.getState(),r=a.relationships.viewEvent.find(function(e){return e.clientId===n});return Object(Le.batchActions)([JU("viewEvent",n),EF(r.id,n,a.currentSelections)],rF)})},function(e){return e.ofType(gF).map(function(e){var t=e.payload.response.importSummaries[0].reference,n=e.meta,a=n.clientData,r=n.selections,o=n.clientId,i=a.to;i.data=null,i.id=t;var c={relationships:[AC(a)]};return vF(c,r,o)})},function(e){return e.ofType(OF).map(function(e){return JU("viewEvent",e.meta.clientId)})},function(e,t){return e.ofType(AF).map(function(e){var n,a,r=t.getState(),o=e.payload,i=r.viewEventPage.eventId,c=Ee().username,s={event:i,notes:[{value:o.note}]},l={value:o.note,storedBy:c,storedDate:Ju(Se().toISOString(),ct.DATETIME),clientId:Object(kj.a)()};return Object(Le.batchActions)([DF(i,s,r.currentSelections,l.clientId),(n="viewEvent",a=l,le(GU)({key:n,note:a}))],kF)})},function(e){return e.ofType(FF).map(function(e){return t="viewEvent",n=e.meta.clientId,le(WU)({key:t,noteClientId:n});var t,n})},function(e,t){return e.ofType(RA,kA,NA).map(function(e){var t=e.payload.eventContainer,n=(t&&t.event&&t.event.notes||[]).map(function(e){return Object(se.a)({},e,{storedDate:Ju(e.storedDate,ct.DATETIME)})});return Object(Le.batchActions)([le(NF)(),HU("viewEvent",n)],RF)})},function(e){return e.ofType(RA,kA,NA).switchMap(function(e){var t=e.payload.eventContainer.event;return hM(t.eventId,t.programId).then(function(e){return Object(Le.batchActions)([le(oF)(),ZU("viewEvent",e||[])],nF)})})},function(e,t){return e.ofType(RA,kA,NA,UA,pw).filter(function(e){return function(e,t,n){return e.type!==t||dP()(e.payload)&&e.payload.some(function(e){return e.type===n})}(e,pw,UA)}).map(function(e){return function(e,t,n){return e.type===t&&dP()(e.payload)?e.payload.find(function(e){return e.type===n}):e}(e,pw,UA)}).filter(function(e){var n=e.payload.eventContainer.id,a=t.getState().viewEventPage||{};return a.eventId===n&&!a.showEditEvent}).map(function(e){var t,n=e.payload.eventContainer,a=e.payload.orgUnit,r=Tt(n.event);if(r.error)return t=r.error,le(OU)(t);var o=r.stage.stageForm,i=r.program;return Object(Le.batchActions)(vU(n,a,o,i))})},function(e,t){return e.ofType(yw).map(function(){var e,n=t.getState(),a=n.viewEventPage.eventContainer,r=n.organisationUnits[a.event.orgUnitId],o=Tt(a.event);if(o.error)return e=o.error,le(Ow)(e);var i=o.program,c=o.stage.stageForm;return Object(Le.batchActions)([le(Ew)()].concat(Object(We.a)(uA(a,r,c,i))))})},function(e,t){return e.ofType(mw).map(function(e){var n=t.getState(),a=e.payload,r=ff(a.dataEntryId,a.itemId),o=n.dataEntries[a.dataEntryId].eventId,i=n.formsValues[r],c=n.dataEntriesFieldsValue[r],s=n.dataEntriesFieldsMeta[r],l=n.events[o],u=a.formFoundation,d=CC(u,i,c,s,l),p=d.formClientValues,f=d.dataEntryClientValues,m=Object(se.a)({},l,f,{notes:[]}),h=u.convertValues(p,id),b=Mg(m);"COMPLETED"!==b.status||l.completedDate||(b.completedDate=Se().format("YYYY-MM-DD"));var g=n.viewEventPage.eventContainer,O=Object(se.a)({},g,{event:Object(se.a)({},g.event,f),values:Object(se.a)({},p)}),v=n.organisationUnits[O.event.orgUnitId],y=Object(se.a)({},b,{dataValues:Object.keys(h).map(function(e){return{dataElement:e,value:h[e]}})});return Object(Le.batchActions)([WA(O,v),vw(o,y,n.currentSelections)],pw)})},function(e,t){return e.ofType(gw).filter(function(e){var n=t.getState().viewEventPage||{};return n.eventId&&n.eventId===e.meta.eventId}).map(function(){var e=t.getState(),n=e.viewEventPage,a=n.prevEventContainer||n.eventContainer,r=e.organisationUnits[a.event.orgUnitId];return WA(a,r)})},function(e,t){return e.ofType(bw).filter(function(e){var n=t.getState(),a=null===n.app.page;return HL(n,e)&&a}).map(function(){return kL()})},function(e,t){return e.ofType(mj).filter(function(e){return e.payload.findMode&&e.payload.findMode===xv.TEI_REGISTER}).switchMap(function(n){var a,r=t.getState(),o=r.newRelationship.selectedRelationshipType.to,i=o.programId,s=o.trackedEntityTypeId,l=r.currentSelections.orgUnitId;if(i)try{a=function(e){var t;try{var n=It(e);n.access.data.write&&(t=n)}catch(a){throw O.a.error(Object(ze.b)("tracker program for id not found")({suggestedProgramId:e,error:a})),Error(c()("Metadata error. see log for details"))}return t}(i)}catch(h){return Promise.resolve(Ej(h))}var u=function(e,t){return t?t.organisationUnits[e]?e:null:e}(l,a);if(!u)return Promise.resolve(yj(a&&a.id));var d,p=r.organisationUnits[u];if(a){var f=Ky(a,a&&a.enrollment.enrollmentForm,p,"relationship",[yj(a.id,p)],[],r.generatedUniqueValuesCache.relationship);return Object(qh.fromPromise)(f).takeUntil(e.ofType(mj))}try{d=Dt(s)}catch(h){return O.a.error(Object(ze.b)("TET for id not found")({trackedEntityTypeId:s,error:h})),Promise.resolve(Ej(c.a.t("Metadata error. see log for details")))}var m=cE(d.teiRegistration.form,p,"relationship",[yj(null,p)],r.generatedUniqueValuesCache.relationship);return Object(qh.fromPromise)(m).takeUntil(e.ofType(mj))})},function(e,t){return e.ofType(qE,XE,JE).switchMap(function(){var n=t.getState(),a=n.newRelationshipRegisterTei,r=a.programId,o=a.orgUnit,i=n.newRelationship.selectedRelationshipType.to.trackedEntityTypeId;if(r&&o){var s;try{s=It(r)}catch(p){return O.a.error(Object(ze.b)("tracker program for id not found")({programId:r,error:p})),Promise.resolve(Tj(c.a.t("Metadata error. see log for details")))}var l=Ky(s,s&&s.enrollment.enrollmentForm,o,"relationship",[Cj()],[],n.generatedUniqueValuesCache.relationship);return Object(qh.fromPromise)(l).takeUntil(e.ofType(mj))}if(o){var u;try{u=Dt(i)}catch(p){return O.a.error(Object(ze.b)("TET for id not found")({TETTypeId:i,error:p})),Promise.resolve(Tj(c.a.t("Metadata error. see log for details")))}var d=cE(u.teiRegistration.form,o,"relationship",[Cj()],n.generatedUniqueValuesCache.relationship);return Object(qh.fromPromise)(d).takeUntil(e.ofType(mj))}return Promise.resolve(le(jj)())})},function(e,t){return e.ofType(T_,k_).switchMap(function(e){var n,a=e.type===k_,r=a?e.payload.page:1,o=t.getState(),i=o.newRelationshipRegisterTei,c=i.programId,s=i.orgUnit,l=o.newRelationship.selectedRelationshipType.to.trackedEntityTypeId,u=ff("relationship",o.dataEntries.relationship.itemId),d=o.formsValues[u];try{n=Sj(c,l)}catch(h){return Promise.resolve(A_())}var p=n.searchFoundation.getElements().map(function(e){var t=d[e.id];if(!t&&0!==t&&!1!==t)return null;var n=e.convertValue(t,Object(ze.d)(bd,id));return"".concat(e.id,":LIKE:").concat(n)}).filter(function(e){return e}),f=c?{program:c}:{trackedEntityType:l},m=Object(se.a)({ou:s.id,ouMode:"ACCESSIBLE",pageSize:5,page:r,totalPages:!a,filter:p},f);return ye().get("trackedEntityInstances",m).then(function(e){var t=Rj(c,l),n=e&&e.pager||{},r=a?null:{rowsCount:n.total,rowsPerPage:n.pageSize,currentPage:n.page};return function(e,t){return le(S_)({teis:e,paginationData:t})}((e&&e.trackedEntityInstances||[]).map(function(e){var n=(e.attributes||[]).reduce(function(e,t){return e[t.attribute]=t.value,e},{}),a=t.convertValues(n,yd);return{id:e.trackedEntityInstance,values:Object(se.a)({},a,{registrationDate:yd(e.created,ct.DATETIME),registrationUnit:yd(e.orgUnit,ct.TEXT),inactive:yd(e.inactive,ct.BOOLEAN)})}}),r)}).catch(function(){return A_()})})},function(e,t){return e.ofType(mg).map(function(e){var t=e.payload.response.importSummaries[0].reference,n=e.meta,a=n.relationshipData,r=n.relationshipClientId,o=n.selections,i=n.triggerAction,c=a.find(function(e){return e.clientId===r});return c.to.id=t,c.to.data=null,xC(a,o,i)})}].concat(Object(We.a)([nb([iy,Jy]),ab([zy,iE])])));function CM(e,t){var n=[Object(Jh.b)(IM),Object(M.c)(e)];"production"!==N.a.prod&&n.push(Object($x.createLogger)({}));var a=Object(_p.a)(dL),r=Object(Jx.combineReducers)(Object(se.a)({},a,{router:M.d})),o=Object(eP.createOffline)(Object(se.a)({},nP.a,{discard:lP,effect:iP,persistCallback:t,queue:sP,persistOptions:{storage:BP()}})),i=o.middleware,c=o.enhanceReducer,s=o.enhanceStore;return Object(Jx.createStore)(Object(Le.enableBatching)(c(r)),Object(Qx.composeWithDevTools)(Object(Jx.compose)(s,Jx.applyMiddleware.apply(void 0,n.concat([i])))))}var TM={PROGRAMS:"Programs",PROGRAM_RULES:"ProgramRules",PROGRAM_RULES_VARIABLES:"ProgramRulesVariables",PROGRAM_INDICATORS:"ProgramIndicators",OPTION_SETS:"OptionSets"},SM=function(){function e(t,n){Object(A.a)(this,e),t&&t(this),n&&(this.d2ModelName=n.modelName,this.d2ModelGetterType=n.modelGetterType,this.queryParams=n.queryParams,this.converter=n.converter)}return Object(w.a)(e,[{key:"load",value:function(e){return this.loader(e,this.objectStore,this.queryParams,this.d2ModelName,this.d2ModelGetterType,this.converter)}}]),e}();function RM(e,t,n,a,r,o){return kM.apply(this,arguments)}function kM(){return(kM=Object(o.a)(r.a.mark(function e(t,n,a,o,i,c){var s;return r.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,LL(o,i,a,c);case 2:if(!(s=e.sent)){e.next=6;break}return e.next=6,t.setAll(n,s);case 6:return e.abrupt("return",s);case 7:case"end":return e.stop()}},e)}))).apply(this,arguments)}function NM(e,t,n,a,r,o){return AM.apply(this,arguments)}function AM(){return(AM=Object(o.a)(r.a.mark(function e(t,n,a,o,i,c){var s,l;return r.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.getKeys(n);case 2:if(s=e.sent,!(s&&s.length>0)){e.next=6;break}return e.abrupt("return",null);case 6:return e.next=8,RM(t,n,a,o,i,c);case 8:return l=e.sent,e.abrupt("return",l);case 10:case"end":return e.stop()}},e)}))).apply(this,arguments)}function wM(e){return e&&0!==e.length?e.map(function(e){return{id:e.id,displayName:e.displayName,value:e.value}}):null}function FM(e){return e&&0!==e.length?e.map(function(e){return{id:e.id,displayName:e.displayName,level:e.level}}):null}function xM(e){return e&&0!==e.length?e.map(function(e){return{id:e.id,displayName:e.displayName,fromConstraint:e.fromConstraint,toConstraint:e.toConstraint,access:e.access}}):null}var PM=new BL(function(e){e.modelName="organisationUnits",e.modelGetterType=PL.LIST,e.queryParams={fields:"id,displayName,path,level,code,children[id,displayName,level,children[id]]"},e.converter=function(e){return e?e.map(function(e){return{id:e.id,displayName:e.displayName,path:e.path,level:e.level,code:e.code}}):[]}});var DM=new BL(function(e){e.modelName="programs",e.modelGetterType=PL.LIST,e.queryParams={fields:"id,version,programTrackedEntityAttributes[trackedEntityAttribute[id,optionSet[id,version]]],programStages[id,programStageDataElements[dataElement[id,optionSet[id,version]]]]"},e.converter=function(e){return e}});function UM(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"sortOrder";return e.sort(function(e,n){var a=t;return oe()(e[a])?oe()(n[a])?e[a]-n[a]:-1:1}),e}function LM(e){return e&&0!==e.size?Object(We.a)(e.toArray()):[]}function MM(e){var t=LM(e).map(function(e){var t=Object(se.a)({},e.dataValues);return t.programStageDataElements=t.programStageDataElements.filter(function(e){return e.dataElement}).map(function(e){var t;return e.dataElement.translations=(t=e.dataElement.translations)?t.reduce(function(e,t){return e[t.locale]||(e[t.locale]={}),e[t.locale][t.property]=t.value,e},{}):[],e}),t.programStageSections=function(e){var t=LM(e).map(function(e){return{id:e.id,displayName:e.displayName,sortOrder:e.sortOrder,dataElements:(t=e.dataElements,LM(t).map(function(e){return{id:e.id}}))};var t});return UM(t),t}(t.programStageSections),t.notificationTemplates=LM(t.notificationTemplates).map(function(e){return{id:e.id}}),t});return UM(t),t}function BM(e){return e?e.map(function(e){return function(e){var t=e.trackedEntityAttribute,n=Object(Fe.a)(e,["trackedEntityAttribute"]),a=t&&t.id;return a||O.a.error(Object(ze.b)("encountered a programAttribute without a trackedEntityAttributeId")({programAttribute:e})),Object(se.a)({},n,{trackedEntityAttributeId:a})}(e)}).filter(function(e){return e}):null}var VM=new BL(function(e){e.modelName="programs",e.modelGetterType=PL.LIST,e.queryParams={fields:"*,dataEntryForm[*],access[*],relatedProgram[id,displayName],relationshipType[id,displayName],trackedEntityType[id],categoryCombo[id,displayName,isDefault,categories[id,displayName]]organisationUnits[id,displayName],userRoles[id,displayName],programStages[*,dataEntryForm[*],programStageSections[id,displayName,description,sortOrder,dataElements[id]],programStageDataElements[*,dataElement[*,optionSet[id]]]],programTrackedEntityAttributes[*]"},e.converter=function(e){return e&&0!==e.length?e.map(function(e){return{id:e.id,access:e.access,name:e.name,displayName:e.displayName,displayShortName:e.displayShortName,created:e.created,description:e.displayDescription,version:e.version,categoryCombo:e.categoryCombo,programStages:MM(e.programStages),organisationUnits:(t=e.organisationUnits,LM(t).reduce(function(e,t){return e[t.id]={id:t.id,name:t.name,displayName:t.displayName},e},{})),programType:e.programType,style:e.style,trackedEntityTypeId:e.trackedEntityType&&e.trackedEntityType.id,programTrackedEntityAttributes:BM(e.programTrackedEntityAttributes),minAttributesRequiredToSearch:e.minAttributesRequiredToSearch,enrollmentDateLabel:e.enrollmentDateLabel,incidentDateLabel:e.incidentDateLabel,dataEntryForm:e.dataEntryForm,featureType:e.featureType,selectEnrollmentDatesInFuture:e.selectEnrollmentDatesInFuture,selectIncidentDatesInFuture:e.selectIncidentDatesInFuture,displayIncidentDate:e.displayIncidentDate};var t}):null}});function GM(e){var t;return((t=e)&&0!==t.size?Object(We.a)(t.toArray()):[]).map(function(e){return{id:e.id,content:e.content,data:e.data,location:e.location,dataElementId:e.dataElement&&e.dataElement.id,programRuleActionType:e.programRuleActionType,programStageId:e.programStage&&e.programStage.id,programStageSectionId:e.programStageSection&&e.programStageSection.id,trackedEntityAttributeId:e.trackedEntityAttribute&&e.trackedEntityAttribute.id,optionGroupId:e.optionGroup&&e.optionGroup.id,optionId:e.option&&e.option.id}})}var WM=new BL(function(e){e.modelName="programRules",e.modelGetterType=PL.LIST,e.queryParams={fields:"id,displayName,condition,description,program[id],programStage[id],priority,programRuleActions[id,content,location,data,programRuleActionType,programStageSection[id],dataElement[id],trackedEntityAttribute[id],programIndicator[id],programStage[id],optionGroup[id],option[id]]",filter:"program.id:in:"},e.converter=function(e){return e&&0!==e.length?e.map(function(e){return{id:e.id,condition:e.condition,description:e.description,displayName:e.displayName,programId:e.program.id,programRuleActions:GM(e.programRuleActions),priority:e.priority,programStageId:e.programStage&&e.programStage.id}}):null}}),HM=new BL(function(e){e.modelName="programRuleVariables",e.modelGetterType=PL.LIST,e.queryParams={fields:"id,displayName,programRuleVariableSourceType,program[id],programStage[id],dataElement[id],trackedEntityAttribute[id],useCodeForOptionSet",filter:"program.id:in:"},e.converter=function(e){return e&&0!==e.length?e.map(function(e){return{id:e.id,dataElementId:e.dataElement&&e.dataElement.id,trackedEntityAttributeId:e.trackedEntityAttribute&&e.trackedEntityAttribute.id,displayName:e.displayName,programId:e.program&&e.program.id,programStageId:e.programStage&&e.programStage.id,programRuleVariableSourceType:e.programRuleVariableSourceType,useNameForOptionSet:!!oe()(e.useCodeForOptionSet)&&!e.useCodeForOptionSet}}):null}}),zM=new BL(function(e){e.modelName="programIndicators",e.modelGetterType=PL.LIST,e.queryParams={fields:"id,displayName,code,shortName,displayInForm,expression,displayDescription,description,filter,program[id]",filter:"program.id:in"},e.converter=function(e){return e&&0!==e.length?e.map(function(e){return{id:e.id,displayName:e.displayName,code:e.code,shortName:e.shortName,displayInForm:e.displayInForm,expression:e.expression,displayDescription:e.displayDescription,description:e.description,filter:e.filter,programId:e.program&&e.program.id}}):null}});var KM=50;function YM(e,t,n){return qM.apply(this,arguments)}function qM(){return(qM=Object(o.a)(r.a.mark(function e(t,n,a){var o,i;return r.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t){e.next=2;break}return e.abrupt("return",null);case 2:return o={},e.next=5,Promise.all(t.map(function(e){return n.get(a,e.id).then(function(t){o[e.id]=t})}));case 5:return i=t.filter(function(e){var t=o[e.id];return!t||t.version!==e.version}),e.abrupt("return",i.length>0?i:null);case 7:case"end":return e.stop()}},e)}))).apply(this,arguments)}function XM(e,t,n){return VM.updateQueryParams({filter:"id:in:[".concat(e.map(function(e){return e.id}).toString(),"]")}),function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"programs",t=arguments.length>1?arguments[1]:void 0;return new SM(function(t){t.loader=RM,t.objectStore=e},t)}(t,VM).load(n)}function ZM(e,t,n){return zM.updateQueryParams({filter:"program.id:in:[".concat(e.map(function(e){return e.id}).toString(),"]")}),function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"programIndicators",t=arguments.length>1?arguments[1]:void 0;return new SM(function(t){t.loader=RM,t.objectStore=e},t)}(t,zM).load(n)}function JM(e,t,n){return WM.updateQueryParams({filter:"program.id:in:[".concat(e.map(function(e){return e.id}).toString(),"]")}),function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"programRules",t=arguments.length>1?arguments[1]:void 0;return new SM(function(t){t.loader=RM,t.objectStore=e},t)}(t,WM).load(n)}function QM(e,t,n){return HM.updateQueryParams({filter:"program.id:in:[".concat(e.map(function(e){return e.id}).toString(),"]")}),function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"programRulesVariables",t=arguments.length>1?arguments[1]:void 0;return new SM(function(t){t.loader=RM,t.objectStore=e},t)}(t,HM).load(n)}function $M(e){if(!e)return[];return e.reduce(function(e,t){if(t.programStages){var n=function(e){var t=e.reduce(function(e,t){var n=function(e){var t=e.programStageDataElements;if(!t)return null;var n=t.reduce(function(e,t){var n=t.dataElement&&t.dataElement.optionSet;return n&&e.push(n),e},[]);return n.length>0?n:null}(t);return n&&(e=[].concat(Object(We.a)(e),Object(We.a)(n))),e},[]);return t.length>0?t:null}(Object(We.a)(t.programStages.values()));n&&(e=[].concat(Object(We.a)(e),Object(We.a)(n)))}return e},[])}function eB(e){return e?e.reduce(function(e,t){if(t.programTrackedEntityAttributes){var n=t.programTrackedEntityAttributes.map(function(e){return e.trackedEntityAttributeId}).filter(function(e){return e});return[].concat(Object(We.a)(e),Object(We.a)(n))}return e},[]):[]}function tB(e){return e?e.reduce(function(e,t){var n=t.categoryCombo&&t.categoryCombo.categories;return n?[].concat(Object(We.a)(e),Object(We.a)(n)):[]},[]):[]}function nB(e,t){return aB.apply(this,arguments)}function aB(){return(aB=Object(o.a)(r.a.mark(function e(t,n){var a,o,i,c,s,l;return r.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,DM.get();case 2:return a=e.sent,o=$M(a),e.next=6,YM(a,t,n[TM.PROGRAMS]);case 6:return i=e.sent,c=Object(ze.a)(i,KM),e.next=10,Promise.all(c.map(function(e){return XM(e,n[TM.PROGRAMS],t).then(function(e){return JM(e,n[TM.PROGRAM_RULES],t).then(function(){return QM(e,n[TM.PROGRAM_RULES_VARIABLES],t)}).then(function(){return ZM(e,n[TM.PROGRAM_INDICATORS],t)}).then(function(){return e})})}));case 10:return s=e.sent,l=s.filter(function(e){return e}).reduce(function(e,t){return[].concat(Object(We.a)(e),Object(We.a)(t))},[]),e.abrupt("return",{optionSetsMeta:o,trackedEntityAttributeIds:eB(l),categoryIds:tB(l)});case 13:case"end":return e.stop()}},e)}))).apply(this,arguments)}var rB=new BL(function(e){e.modelName="trackedEntityAttributes",e.modelGetterType=PL.LIST,e.queryParams={fields:":all,optionSet[id,version],trackedEntity[id,displayName]"},e.converter=function(e){return e}});var oB=50;function iB(e,t,n){return rB.updateQueryParams({filter:"id:in:[".concat(e.toString(),"]")}),function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"trackedEntityAttributes",t=arguments.length>1?arguments[1]:void 0;return new SM(function(t){t.loader=RM,t.objectStore=e},t)}(t,rB).load(n)}function cB(e,t,n){return sB.apply(this,arguments)}function sB(){return(sB=Object(o.a)(r.a.mark(function e(t,n,a){var o;return r.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return o=Object(ze.a)(a,oB),e.next=3,Promise.all(o.map(function(e){return iB(e,n,t)}));case 3:case"end":return e.stop()}},e)}))).apply(this,arguments)}function lB(e){return e&&0!==e.length?e.map(function(e){return{id:e.id,displayName:e.displayName,trackedEntityTypeAttributes:e.trackedEntityTypeAttributes}}):null}var uB=new BL(function(e){e.modelName="trackedEntityTypes",e.modelGetterType=PL.LIST,e.queryParams={fields:"id, trackedEntityTypeAttributes[trackedEntityAttribute[optionSet[id,version]]]"},e.converter=lB});function dB(e){return e?e.map(function(e){return function(e){var t=e.trackedEntityAttribute,n=Object(Fe.a)(e,["trackedEntityAttribute"]),a=t&&t.id;return a||O.a.error(Object(ze.b)("encountered a trackedEntityTypeAttribute without a trackedEntityAttribe id")({typeAttribute:e})),Object(se.a)({},n,{trackedEntityAttributeId:a})}(e)}).filter(function(e){return e}):null}function pB(e){return e&&0!==e.length?e.map(function(e){return{id:e.id,displayName:e.displayName,trackedEntityTypeAttributes:dB(e.trackedEntityTypeAttributes),translations:e.translations,featureType:e.featureType,access:e.access,minAttributesRequiredToSearch:e.minAttributesRequiredToSearch,maxTeiCountToReturn:e.maxTeiCountToReturn,displayDescription:e.displayDescription}}):null}var fB=new BL(function(e){e.modelName="trackedEntityTypes",e.modelGetterType=PL.LIST,e.queryParams={fields:"*, trackedEntityTypeAttributes[*]"},e.converter=pB});function mB(e,t,n){return hB.apply(this,arguments)}function hB(){return(hB=Object(o.a)(r.a.mark(function e(t,n,a){var o,i,c;return r.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t.updateQueryParams({page:n,pageSize:a}),e.next=3,t.get();case 3:if(o=e.sent,!(i=o&&Object(We.a)(o.values()))||i.length!==a){e.next=10;break}return e.next=8,mB(t,n+=1,a);case 8:return c=e.sent,e.abrupt("return",[].concat(Object(We.a)(i),Object(We.a)(c)));case 10:return e.abrupt("return",i||[]);case 11:case"end":return e.stop()}},e)}))).apply(this,arguments)}function bB(e){return gB.apply(this,arguments)}function gB(){return(gB=Object(o.a)(r.a.mark(function e(t){var n,a;return r.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return(n=new BL(function(e){e.modelName="categoryOptions",e.modelGetterType=PL.LIST_WITH_PAGER,e.queryParams={fields:"id,displayName,categories, organisationUnits, access[*]",paging:!0,totalPages:!1}})).setFilter("categories.id:in:[".concat(t.toString(),"]")),n.setFilter("access.data.read:in:[true]"),e.next=5,mB(n,1,1e4);case 5:return a=e.sent,e.abrupt("return",a);case 7:case"end":return e.stop()}},e)}))).apply(this,arguments)}function OB(e){return e.reduce(function(e,t){return t.reduce(function(e,t){return e=t.categories.toArray().reduce(function(e,n){var a=e[n.id]||new Map,r=t.organisationUnits?t.organisationUnits.toArray():[];return e[n.id]=a.set(t.id,{id:t.id,displayName:t.displayName,access:t.access,organisationUnitIds:r&&r.length>0?r.reduce(function(e,t){return e[t.id]=!0,e},{}):null}),e},e)},e)},{})}function vB(e,t){return e.map(function(e){return{id:e.id,displayName:e.displayName,categoryOptions:t[e.id]?Object(We.a)(t[e.id].values()):[]}})}function yB(e,t,n){return EB.apply(this,arguments)}function EB(){return(EB=Object(o.a)(r.a.mark(function e(t,n,a){var o,i,c,s,l,u;return r.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return o=Object(We.a)(new Map(a.map(function(e){return[e.id,e]})).values()),i=o.map(function(e){return e.id}),c=Object(ze.a)(i,50),e.next=5,Promise.all(c.map(function(e){return bB(e)}));case 5:return s=e.sent,l=OB(s),u=vB(o,l),e.next=10,t.setAll(n,u);case 10:case"end":return e.stop()}},e)}))).apply(this,arguments)}var _B=50;function jB(e,t,n){return IB.apply(this,arguments)}function IB(){return(IB=Object(o.a)(r.a.mark(function e(t,n,a){var o,i,c;return r.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t.updateQueryParams({page:n,pageSize:a}),e.next=3,t.get();case 3:if(o=e.sent,!(i=o&&Object(We.a)(o.values()))||i.length!==a){e.next=10;break}return e.next=8,jB(t,n+=1,a);case 8:return c=e.sent,e.abrupt("return",[].concat(Object(We.a)(i),Object(We.a)(c)));case 10:return e.abrupt("return",i||[]);case 11:case"end":return e.stop()}},e)}))).apply(this,arguments)}function CB(e){return TB.apply(this,arguments)}function TB(){return(TB=Object(o.a)(r.a.mark(function e(t){var n,a;return r.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return(n=new BL(function(e){e.modelName="optionSets",e.modelGetterType=PL.LIST_WITH_PAGER,e.queryParams={fields:"id,displayName,version,valueType,options[id,displayName,code,style, translations]",paging:!0,totalPages:!1}})).setFilter("id:in:[".concat(t.toString(),"]")),e.next=4,jB(n,1,1e4);case 4:return a=e.sent,e.abrupt("return",a);case 6:case"end":return e.stop()}},e)}))).apply(this,arguments)}function SB(e){return RB.apply(this,arguments)}function RB(){return(RB=Object(o.a)(r.a.mark(function e(t){var n,a;return r.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return(n=new BL(function(e){e.modelName="optionGroups",e.modelGetterType=PL.LIST_WITH_PAGER,e.queryParams={fields:"id,displayName,options[id],optionSet[id]",paging:!0,totalPages:!1}})).setFilter("optionSet.id:in:[".concat(t.toString(),"]")),e.next=4,jB(n,1,1e4);case 4:return a=e.sent,e.abrupt("return",a);case 6:case"end":return e.stop()}},e)}))).apply(this,arguments)}function kB(e,t,n){return NB.apply(this,arguments)}function NB(){return(NB=Object(o.a)(r.a.mark(function e(t,n,a){var i;return r.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return i=[],e.next=3,t.asyncForEach(function(){var e=Object(o.a)(r.a.mark(function e(t){var o;return r.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,a.get(n,t.id);case 2:(o=e.sent)&&o.version===t.version||i.push(t.id);case 4:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}());case 3:return e.abrupt("return",i);case 4:case"end":return e.stop()}},e)}))).apply(this,arguments)}var AB=function(e){return e.reduce(function(e,t){return n=e,t.reduce(function(e,t){return e[t.optionSet.id]=[].concat(Object(We.a)(e[t.optionSet.id]||[]),[t]),e},n);var n},{})},wB=function(e){return e.reduce(function(e,t){return[].concat(Object(We.a)(e),Object(We.a)(t))},[])},FB=function(e,t){return e.map(function(e){return{id:e.id,displayName:e.displayName,version:e.version,valueType:e.valueType,translations:e.translations,options:e.options&&Object(We.a)(e.options.values()).map(function(e){return{id:e.id,displayName:e.displayName,code:e.code,style:e.style,translations:e.translations}}),optionGroups:t[e.id]&&t[e.id].map(function(e){return{id:e.id,displayName:e.displayName,options:e.options&&Object(We.a)(e.options.values()).map(function(e){return e.id})}})}})};function xB(e,t,n){return PB.apply(this,arguments)}function PB(){return(PB=Object(o.a)(r.a.mark(function e(t,n,a){var o,i,c,s,l,u,d,p;return r.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return o=a.reduce(function(e,t){return e.find(function(e){return e.id===t.id})||e.push(t),e},[]),e.next=3,kB(o,n,t);case 3:return i=e.sent,c=Object(ze.a)(i,_B),e.next=7,Promise.all(c.map(function(e){return CB(e)}));case 7:return s=e.sent,e.next=10,Promise.all(c.map(function(e){return SB(e)}));case 10:return l=e.sent,u=wB(s),d=AB(l),p=FB(u,d),e.next=16,t.setAll(n,p);case 16:case"end":return e.stop()}},e)}))).apply(this,arguments)}function DB(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"trackedEntityTypes",t=arguments.length>1?arguments[1]:void 0;return new SM(function(t){t.loader=NM,t.objectStore=e},t)}function UB(e){return e?e.reduce(function(e,t){var n=t.trackedEntityTypeAttributes&&t.trackedEntityTypeAttributes.reduce(function(e,t){return t.trackedEntityAttribute&&t.trackedEntityAttribute.optionSet&&e.push(t.trackedEntityAttribute.optionSet),e},[]);return n&&(e=[].concat(Object(We.a)(e),Object(We.a)(n))),e},[]):[]}function LB(e,t){return MB.apply(this,arguments)}function MB(){return(MB=Object(o.a)(r.a.mark(function e(t,n){var a,o,i,c,s;return r.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,uB.get();case 2:return a=e.sent,o=UB(a),i=DB(n,fB),e.next=7,i.load(t);case 7:return c=e.sent,s=[],c&&(s=c.reduce(function(e,t){if(t.trackedEntityTypeAttributes){var n=t.trackedEntityTypeAttributes.map(function(e){return e.trackedEntityAttributeId}).filter(function(e){return e});return[].concat(Object(We.a)(e),Object(We.a)(n))}return e},s)),e.abrupt("return",{trackedEntityAttributeIds:s,optionSetsMeta:o});case 11:case"end":return e.stop()}},e)}))).apply(this,arguments)}var BB="accessHistory",VB={LOCAL_STORAGE:1,INDEXED_DB:5},GB={DESTROY_FAILED:"Could not delete user storage"};function WB(e,t){return HB.apply(this,arguments)}function HB(){return(HB=Object(o.a)(r.a.mark(function e(t,n){var a,o,i,c,s;return r.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return a=n.name,e.next=3,t.get(jP.USER_CACHES,BB);case 3:return o=e.sent,i=o&&o.values,c=i?i.filter(function(e){return e!==a}):[],s=[a].concat(Object(We.a)(c)),e.next=9,t.set(jP.USER_CACHES,{id:BB,values:s});case 9:return e.abrupt("return",s);case 10:case"end":return e.stop()}},e)}))).apply(this,arguments)}function zB(e,t){return KB.apply(this,arguments)}function KB(){return(KB=Object(o.a)(r.a.mark(function e(t,n){var a,i,c,s;return r.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(a=n.adapterType,i=a===vP?VB.LOCAL_STORAGE:VB.INDEXED_DB,!(t.length>i)){e.next=9;break}return c=t.slice(i),s=t.slice(0,i),e.next=7,c.asyncForEach(function(){var e=Object(o.a)(r.a.mark(function e(t){var n;return r.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=new mP(t,1,[a]),e.prev=1,e.next=4,n.destroy();case 4:e.next=9;break;case 6:e.prev=6,e.t0=e.catch(1),O.a.warn(Object(up.a)(GB.DESTROY_FAILED)({cache:t,error:e.t0}));case 9:case"end":return e.stop()}},e,null,[[1,6]])}));return function(t){return e.apply(this,arguments)}}());case 7:return e.next=9,n.set(jP.USER_CACHES,{id:BB,values:s});case 9:case"end":return e.stop()}},e)}))).apply(this,arguments)}function YB(){return(YB=Object(o.a)(r.a.mark(function e(){var t,n,a;return r.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=LP(),n=MP(),e.next=4,WB(t,n);case 4:return a=e.sent,e.next=7,zB(a,t);case 7:case"end":return e.stop()}},e)}))).apply(this,arguments)}var qB=function(){return YB.apply(this,arguments)},XB=[function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"constants";return new SM(function(t){t.converter=wM,t.d2ModelGetterType=PL.LIST,t.d2ModelName="constants",t.loader=NM,t.objectStore=e,t.queryParams={fields:"id,displayName,value"}})}(EP.CONSTANTS),function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"ouLevels";return new SM(function(t){t.converter=FM,t.d2ModelGetterType=PL.LIST,t.d2ModelName="organisationUnitLevels",t.loader=NM,t.objectStore=e,t.queryParams={fields:"id,displayName,level",filter:"level:gt:1"}})}(EP.ORGANISATION_UNIT_LEVELS),function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"relationshipTypes";return new SM(function(t){t.converter=xM,t.d2ModelGetterType=PL.LIST,t.d2ModelName="relationshipTypes",t.loader=NM,t.objectStore=e,t.queryParams={fields:"id,displayName,fromConstraint[*],toConstraint[*],access[*]"}})}(EP.RELATIONSHIP_TYPES),function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"organisationUnits",t=arguments.length>1?arguments[1]:void 0;return new SM(function(t){t.loader=RM,t.objectStore=e},t)}(EP.ORGANISATION_UNITS,PM)];function ZB(e){return JB.apply(this,arguments)}function JB(){return(JB=Object(o.a)(r.a.mark(function e(t){return r.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,XB.asyncForEach(function(e){return e.load(t)});case 2:case"end":return e.stop()}},e)}))).apply(this,arguments)}function QB(e){var t=new Set(e);return Array.from(t)}function $B(){return eV.apply(this,arguments)}function eV(){return(eV=Object(o.a)(r.a.mark(function e(){var t,n,a,o,i,c,s,l,u;return r.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=MP(),e.next=3,qB();case 3:return e.next=5,ZB(n);case 5:return e.next=7,nB(n,(t={},Object(Ut.a)(t,TM.PROGRAMS,EP.PROGRAMS),Object(Ut.a)(t,TM.PROGRAM_RULES,EP.PROGRAM_RULES),Object(Ut.a)(t,TM.PROGRAM_RULES_VARIABLES,EP.PROGRAM_RULES_VARIABLES),Object(Ut.a)(t,TM.PROGRAM_INDICATORS,EP.PROGRAM_INDICATORS),Object(Ut.a)(t,TM.OPTION_SETS,EP.OPTION_SETS),t));case 7:return a=e.sent,o=a.optionSetsMeta,i=a.trackedEntityAttributeIds,c=a.categoryIds,e.next=13,LB(n,EP.TRACKED_ENTITY_TYPES);case 13:return s=e.sent,l=s.trackedEntityAttributeIds,u=s.optionSetsMeta,e.next=18,cB(n,EP.TRACKED_ENTITY_ATTRIBUTES,QB([].concat(Object(We.a)(i),Object(We.a)(l))));case 18:return e.next=20,yB(n,EP.CATEGORIES,c);case 20:return e.next=22,xB(n,EP.OPTION_SETS,[].concat(Object(We.a)(o),Object(We.a)(u)));case 22:case"end":return e.stop()}},e)}))).apply(this,arguments)}var tV=n(968),nV=n.n(tV),aV=function(){var e=Object(o.a)(r.a.mark(function e(t){var n;return r.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n="".concat(ye().baseUrl,"/icons/").concat(t,"/icon.svg"),e.abrupt("return",n);case 2:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),rV=function(){var e=Object(o.a)(r.a.mark(function e(t){var n;return r.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t){e.next=2;break}return e.abrupt("return",nV.a);case 2:return e.prev=2,e.next=5,aV(t);case 5:n=e.sent,e.next=11;break;case 8:e.prev=8,e.t0=e.catch(2),n=nV.a;case 11:return e.abrupt("return",n);case 12:case"end":return e.stop()}},e,null,[[2,8]])}));return function(t){return e.apply(this,arguments)}}();function oV(e){return e.toLowerCase().replace(/_(.)/g,function(e,t){return t.toUpperCase()})}var iV=function(){function e(t,n){Object(A.a)(this,e),this.cachedOptionSets=t,this.locale=n}return Object(w.a)(e,null,[{key:"_buildOptionIcon",value:function(){var e=Object(o.a)(r.a.mark(function e(){var t,n,a,o=arguments;return r.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t=o.length>0&&void 0!==o[0]?o[0]:{},n=t&&t.icon){e.next=4;break}return e.abrupt("return",null);case 4:return e.prev=4,e.next=7,aV(n);case 7:return a=e.sent,e.abrupt("return",new Xe(function(e){t.color&&(e.color=t.color),e.data=a}));case 11:return e.prev=11,e.t0=e.catch(4),e.abrupt("return",null);case 14:case"end":return e.stop()}},e,null,[[4,11]])}));return function(){return e.apply(this,arguments)}}()},{key:"getRenderType",value:function(e){return e&&oV(e)}}]),Object(w.a)(e,[{key:"_getTranslation",value:function(e,t){var n=this;if(this.locale){var a=e.find(function(e){return e.property===t&&e.locale===n.locale});return a&&a.value}return null}},{key:"build",value:function(){var t=Object(o.a)(r.a.mark(function t(n,a,i,c,s){var l,u,d,p,f,m=this;return r.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(l=this.cachedOptionSets.get(a)){t.next=4;break}return O.a.warn(Object(ze.b)(e.OPTION_SET_NOT_FOUND)({id:a})),t.abrupt("return",null);case 4:return n.type=s(l.valueType),u=l.options.map(function(){var t=Object(o.a)(r.a.mark(function t(n){var a;return r.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e._buildOptionIcon(n.style);case 2:return a=t.sent,t.abrupt("return",new tt(function(t){t.id=n.id,t.value=n.code,t.text=m._getTranslation(n.translations,e.translationPropertyNames.NAME)||n.displayName,t.icon=a}));case 4:case"end":return t.stop()}},t)}));return function(e){return t.apply(this,arguments)}}()),t.next=8,Promise.all(u);case 8:return d=t.sent,p=l.optionGroups&&new Map(l.optionGroups.map(function(e){return[e.id,new nt(function(t){t.id=e.id,t.optionIds=new Map(e.options.map(function(e){return[e,e]}))})]})),(f=new it(l.id,d,p,n,Od)).inputType=e.getRenderType(c)||(i?at.VERTICAL_RADIOBUTTONS:null),t.abrupt("return",f);case 13:case"end":return t.stop()}},t,this)}));return function(e,n,a,r,o){return t.apply(this,arguments)}}()}]),e}();iV.OPTION_SET_NOT_FOUND="Optionset not found",iV.translationPropertyNames={NAME:"NAME",DESCRIPTION:"DESCRIPTION",SHORT_NAME:"SHORT_NAME"};var cV,sV=iV,lV="NAME",uV="DESCRIPTION",dV="SHORT_NAME",pV=(cV={},Object(Ut.a)(cV,ct.NUMBER,ct.NUMBER_RANGE),Object(Ut.a)(cV,ct.INTEGER,ct.INTEGER_RANGE),Object(Ut.a)(cV,ct.INTEGER_POSITIVE,ct.INTEGER_POSITIVE_RANGE),Object(Ut.a)(cV,ct.INTEGER_ZERO_OR_POSITIVE,ct.INTEGER_ZERO_OR_POSITIVE_RANGE),Object(Ut.a)(cV,ct.INTEGER_NEGATIVE,ct.INTEGER_NEGATIVE_RANGE),Object(Ut.a)(cV,ct.DATE,ct.DATE_RANGE),Object(Ut.a)(cV,ct.DATETIME,ct.DATETIME_RANGE),Object(Ut.a)(cV,ct.TIME,ct.TIME_RANGE),cV),fV=function(){function e(t,n){Object(A.a)(this,e),this.cachedTrackedEntityAttributes=t,this.locale=n}return Object(w.a)(e,null,[{key:"_getSearchAttributeValueType",value:function(e,t){var n=pV[e];return!t&&n?n:e}}]),Object(w.a)(e,[{key:"_getAttributeTranslation",value:function(e,t){var n=this;if(this.locale){var a=e.find(function(e){return e.property===t&&e.locale===n.locale});return a&&a.value}return null}},{key:"_buildElement",value:function(){var t=Object(o.a)(r.a.mark(function t(n){var a,o,i=this;return r.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return a=n.trackedEntityAttribute,o=new ut(function(t){t.id=a.id,t.name=i._getAttributeTranslation(a.translations,lV)||a.displayName,t.shortName=i._getAttributeTranslation(a.translations,dV)||a.displayShortName,t.formName=i._getAttributeTranslation(a.translations,lV)||a.displayName,t.description=i._getAttributeTranslation(a.translations,uV)||a.description,t.displayInForms=!0,t.displayInReports=n.displayInList,t.compulsory=!!a.unique,t.disabled=!1,t.type=e._getSearchAttributeValueType(a.valueType,a.unique)}),t.next=4,Promise.resolve();case 4:return t.abrupt("return",o);case 5:case"end":return t.stop()}},t)}));return function(e){return t.apply(this,arguments)}}()},{key:"_buildSection",value:function(){var e=Object(o.a)(r.a.mark(function e(t){var n,a=this;return r.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=new mt(function(e){e.id=mt.MAIN_SECTION_ID,e.showContainer=!1}),e.next=3,t.asyncForEach(function(){var e=Object(o.a)(r.a.mark(function e(t){var o;return r.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,a._buildElement(t);case 2:(o=e.sent)&&n.addElement(o);case 4:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}());case 3:return e.abrupt("return",n);case 4:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}()},{key:"_buildRenderFoundation",value:function(){var e=Object(o.a)(r.a.mark(function e(t){var n;return r.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=new Vt,e.t0=n,e.next=4,this._buildSection(t);case 4:return e.t1=e.sent,e.t0.addSection.call(e.t0,e.t1),e.abrupt("return",n);case 7:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"_buildSearchGroup",value:function(){var e=Object(o.a)(r.a.mark(function e(t,n,a){var o;return r.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return o=new At,e.next=3,this._buildRenderFoundation(n);case 3:return o.searchForm=e.sent,"main"===t?(o.minAttributesRequiredToSearch=a,o.id="main"):(o.unique=!0,o.id="unique"),e.abrupt("return",o);case 6:case"end":return e.stop()}},e,this)}));return function(t,n,a){return e.apply(this,arguments)}}()},{key:"getTrackedEntityAttribute",value:function(e){var t=e.trackedEntityAttributeId,n=t?this.cachedTrackedEntityAttributes.get(t):null;return n||O.a.error(Object(ze.b)("Tried to create a searchAttribute where trackedEntityAttributeId was not specified or the trackedEntityAttribute could not be retrieved from the cache")({attribute:e})),n}},{key:"build",value:function(e,t){var n=this,a=e.map(function(e){return Object(se.a)({},e,{trackedEntityAttribute:n.getTrackedEntityAttribute(e)})}).filter(function(e){return e.trackedEntityAttribute&&(e.searchable||e.trackedEntityAttribute.unique)}).reduce(function(e,t){return t.trackedEntityAttribute.unique?e[t.trackedEntityAttribute.id]=[t]:e.main=e.main?[].concat(Object(We.a)(e.main),[t]):[t],e},{}),r=Object.keys(a).map(function(e){return n._buildSearchGroup(e,a[e],t)});return Promise.all(r)}}]),e}();fV.errorMessages={TRACKED_ENTITY_ATTRIBUTE_NOT_FOUND:"Tracked entity attribute not found"};var mV=fV,hV=function(){function e(t,n,a){Object(A.a)(this,e),this.cachedTrackedEntityAttributes=t,this.locale=a,this.optionSetFactory=new sV(n,a)}return Object(w.a)(e,null,[{key:"buildtetFeatureType",value:function(e){return new ut(function(t){t.id="FEATURETYPE_".concat(e),t.name="POINT"===e?c.a.t("Coordinate"):c.a.t("Area"),t.formName=t.name,t.compulsory=!1,t.displayInForms=!0,t.disabled=!1,t.type="POINT"===e?ct.COORDINATE:ct.POLYGON})}}]),Object(w.a)(e,[{key:"_getAttributeTranslation",value:function(e,t){var n=this;if(this.locale){var a=e.find(function(e){return e.property===t&&e.locale===n.locale});return a&&a.value}return null}},{key:"build",value:function(){var t=Object(o.a)(r.a.mark(function t(n){var a,o,i=this;return r.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(a=n.trackedEntityAttributeId&&this.cachedTrackedEntityAttributes.get(n.trackedEntityAttributeId)){t.next=4;break}return O.a.error(Object(ze.b)(e.errorMessages.TRACKED_ENTITY_ATTRIBUTE_NOT_FOUND)({cachedProgramTrackedEntityAttribute:n})),t.abrupt("return",null);case 4:if(o=new ut(function(t){t.id=a.id,t.compulsory=n.mandatory,t.name=i._getAttributeTranslation(a.translations,e.translationPropertyNames.NAME)||a.displayName,t.shortName=i._getAttributeTranslation(a.translations,e.translationPropertyNames.SHORT_NAME)||a.displayShortName,t.formName=t.name,t.description=i._getAttributeTranslation(a.translations,e.translationPropertyNames.DESCRIPTION)||a.description,t.displayInForms=!0,t.displayInReports=n.displayInList,t.disabled=!1,t.type=a.valueType}),a.unique&&(o.unique=new lt(function(e){e.scope=a.orgunitScope?st.ORGANISATION_UNIT:st.ENTIRE_SYSTEM,e.onValidate=function(t){var n,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=Object(ze.d)(bd,id)(t,a.valueType);if(r.onGetUnsavedAttributeValues){var c=r.onGetUnsavedAttributeValues(o.id);if(c)if(c.find(function(e){return e===i}))return{valid:!1,data:{attributeValueExistsUnsaved:!0}}}if(e.scope===st.ORGANISATION_UNIT){var s=r.orgUnitId;n=ye().get("trackedEntityInstances",{ou:s,filter:"".concat(o.id,":EQ:").concat(i)})}else n=ye().get("trackedEntityInstances",{ouMode:"ACCESSIBLE",filter:"".concat(o.id,":EQ:").concat(i)});return n.then(function(e){var t=e.trackedEntityInstances&&e.trackedEntityInstances[0]||{},n={id:t.trackedEntityInstance,tetId:t.trackedEntityType};return{valid:0===e.trackedEntityInstances.length,data:n}})},a.pattern&&(e.generatable=!!a.pattern)})),!a.optionSet||!a.optionSet.id){t.next=10;break}return t.next=9,this.optionSetFactory.build(o,a.optionSet.id,n.renderOptionsAsRadio,null,function(e){return e});case 9:o.optionSet=t.sent;case 10:return t.abrupt("return",o);case 11:case"end":return t.stop()}},t,this)}));return function(e){return t.apply(this,arguments)}}()}]),e}();hV.translationPropertyNames={NAME:"NAME",DESCRIPTION:"DESCRIPTION",SHORT_NAME:"SHORT_NAME"},hV.errorMessages={TRACKED_ENTITY_ATTRIBUTE_NOT_FOUND:"TrackedEntityAttributeId missing from programTrackedEntityAttribute or trackedEntityAttribute not found"};var bV=hV,gV=function(){function e(t,n,a,r,o){Object(A.a)(this,e),this.locale=r,this.trackedEntityTypeCollection=o,this.cachedTrackedEntityAttributes=t,this.cachedTrackedEntityTypes=a,this.dataElementFactory=new bV(t,n,r)}return Object(w.a)(e,null,[{key:"_addLabels",value:function(e,t){t.enrollmentDateLabel&&(e.enrollmentDateLabel=t.enrollmentDateLabel),t.incidentDateLabel&&(e.incidentDateLabel=t.incidentDateLabel)}},{key:"_addFlags",value:function(e,t){e.allowFutureEnrollmentDate=t.selectEnrollmentDatesInFuture,e.allowFutureIncidentDate=t.selectIncidentDatesInFuture,e.showIncidentDate=t.displayIncidentDate}},{key:"_getFeatureType",value:function(e){return e?ri(e.toLowerCase()):"None"}}]),Object(w.a)(e,[{key:"_buildTetFeatureTypeField",value:function(e){var t=e&&this.cachedTrackedEntityTypes.get(e);if(!t)return null;var n=t.featureType;return n&&["POINT","POLYGON"].includes(n)?bV.buildtetFeatureType(n):null}},{key:"_buildSection",value:function(){var e=Object(o.a)(r.a.mark(function e(t,n){var a,i,s=this;return r.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(a=this._buildTetFeatureTypeField(n),t&&!(t.length<=0)||a){e.next=3;break}return e.abrupt("return",null);case 3:if(i=new mt(function(e){e.id=mt.MAIN_SECTION_ID,e.name=c.a.t("Profile")}),a&&i.addElement(a),!(t&&t.length>0)){e.next=8;break}return e.next=8,t.asyncForEach(function(){var e=Object(o.a)(r.a.mark(function e(t){var n;return r.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,s.dataElementFactory.build(t);case 2:(n=e.sent)&&i.addElement(n);case 4:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}());case 8:return e.abrupt("return",i);case 9:case"end":return e.stop()}},e,this)}));return function(t,n){return e.apply(this,arguments)}}()},{key:"_buildEnrollmentForm",value:function(){var t=Object(o.a)(r.a.mark(function t(n){var a,o,i;return r.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return a=new Vt(function(t){t.featureType=e._getFeatureType(n.featureType),t.name=n.displayName}),t.next=3,this._buildSection(n.programTrackedEntityAttributes,n.trackedEntityTypeId);case 3:if((o=t.sent)&&a.addSection(o),n.dataEntryForm){o||(o=new mt(function(e){e.id=mt.MAIN_SECTION_ID})),o.showContainer=!1,i=n.dataEntryForm;try{a.customForm=new ht.a(function(e){e.id=i.id,e.data=i.htmlCode})}catch(r){O.a.error(Object(ze.b)(e.errorMessages.CUSTOM_FORM_TEMPLATE_ERROR)({template:i.htmlCode,error:r,method:"buildEnrollment"}))}}return t.abrupt("return",a);case 7:case"end":return t.stop()}},t,this)}));return function(e){return t.apply(this,arguments)}}()},{key:"_buildInputSearchGroupFoundation",value:function(t,n){var a=this,r=(t.programTrackedEntityAttributes||[]).reduce(function(e,t){if(!t.trackedEntityAttributeId)return O.a.error(Object(ze.b)("TrackedEntityAttributeId missing from programTrackedEntityAttribute")({programTeiAttribute:t})),e;var n=a.cachedTrackedEntityAttributes.get(t.trackedEntityAttributeId);return n?e[n.id]=n:O.a.error(Object(ze.b)("could not retrieve tei attribute")({programTeiAttribute:t})),e},{}),o=n.searchForm,i=new Vt,c=new mt(function(e){e.id=mt.MAIN_SECTION_ID});return Array.from(o.getSection(mt.MAIN_SECTION_ID).elements.entries()).map(function(e){return e[1]}).forEach(function(t){var n=e._buildSearchGroupElement(t,r[t.id]);n&&c.addElement(n)}),i.addSection(c),i}},{key:"_buildInputSearchGroups",value:function(e){var t=this;return(arguments.length>1&&void 0!==arguments[1]?arguments[1]:[]).filter(function(e){return!e.unique}).map(function(n){return new wt(function(a){a.id=n.id,a.minAttributesRequiredToSearch=n.minAttributesRequiredToSearch,a.searchFoundation=t._buildInputSearchGroupFoundation(e,n),a.onSearch=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=t.orgUnitId,a=t.program;return ye().get("trackedEntityInstances/count.json",{ou:n,program:a,ouMode:"ACCESSIBLE",filter:Object.keys(e).filter(function(t){return e[t]||0===e[t]||!1===e[t]}).map(function(t){return"".concat(t,":LIKE:").concat(e[t])}),pageSize:1,page:1,totalPages:!0})}})})}},{key:"build",value:function(){var t=Object(o.a)(r.a.mark(function t(n){var a,o,i=this,c=arguments;return r.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return a=c.length>1&&void 0!==c[1]?c[1]:[],o=new Yt(function(t){if(e._addLabels(t,n),e._addFlags(t,n),n.trackedEntityTypeId){var r=i.trackedEntityTypeCollection.get(n.trackedEntityTypeId);r&&(t.trackedEntityType=r)}t.inputSearchGroups=i._buildInputSearchGroups(n,a)}),t.next=4,this._buildEnrollmentForm(n);case 4:return o.enrollmentForm=t.sent,t.abrupt("return",o);case 6:case"end":return t.stop()}},t,this)}));return function(e){return t.apply(this,arguments)}}()}],[{key:"_buildSearchGroupElement",value:function(e,t){return new ut(function(n){n.id=e.id,n.name=e.name,n.shortName=e.shortName,n.formName=e.formName,n.description=e.description,n.displayInForms=!0,n.displayInReports=e.displayInReports,n.compulsory=e.compulsory,n.disabled=e.disabled,n.type=t.valueType,n.optionSet=e.optionSet})}}]),e}();gV.errorMessages={CUSTOM_FORM_TEMPLATE_ERROR:"Error in custom form template"};var OV=gV;var vV=function(){function e(t,n){Object(A.a)(this,e),this.locale=n,this.optionSetFactory=new sV(t,n)}return Object(w.a)(e,null,[{key:"_getDataElementType",value:function(e){return{}[e]||e}},{key:"_buildDataElementIconAsync",value:function(){var e=Object(o.a)(r.a.mark(function e(){var t,n,a,o=arguments;return r.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t=o.length>0&&void 0!==o[0]?o[0]:{},n=t&&t.icon){e.next=4;break}return e.abrupt("return",null);case 4:return e.prev=4,e.next=7,aV(n);case 7:return a=e.sent,e.abrupt("return",new Xe(function(e){t.color&&(e.color=t.color),e.data=a}));case 11:return e.prev=11,e.t0=e.catch(4),e.abrupt("return",null);case 14:case"end":return e.stop()}},e,null,[[4,11]])}));return function(){return e.apply(this,arguments)}}()}]),Object(w.a)(e,[{key:"_getDataElementTranslation",value:function(e,t){return this.locale&&e.translations[this.locale]&&e.translations[this.locale][t]}},{key:"build",value:function(){var t=Object(o.a)(r.a.mark(function t(n){var a,o,i=this;return r.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(n.dataElement){t.next=3;break}return O.a.error(Object(ze.b)("programStageDataElement does not contain a dataElement")({programStageDataElement:n})),t.abrupt("return",null);case 3:return a=n.dataElement,o=new ut(function(t){t.id=a.id,t.name=i._getDataElementTranslation(a,e.propertyNames.NAME)||a.displayName,t.shortName=i._getDataElementTranslation(a,e.propertyNames.SHORT_NAME)||a.displayShortName,t.formName=i._getDataElementTranslation(a,e.propertyNames.FORM_NAME)||a.displayFormName,t.description=i._getDataElementTranslation(a,e.propertyNames.DESCRIPTION)||a.description,t.displayInForms=!0,t.displayInReports=n.displayInReports,t.compulsory=n.compulsory,t.disabled=!1,t.type=e._getDataElementType(a.valueType)}),t.next=7,e._buildDataElementIconAsync(a.style);case 7:if(o.icon=t.sent,!a.optionSet||!a.optionSet.id){t.next=12;break}return t.next=11,this.optionSetFactory.build(o,a.optionSet.id,n.renderOptionsAsRadio,n.renderType&&n.renderType.DESKTOP&&n.renderType.DESKTOP.type,e._getDataElementType);case 11:o.optionSet=t.sent;case 12:return t.abrupt("return",o);case 13:case"end":return t.stop()}},t,this)}));return function(e){return t.apply(this,arguments)}}()}]),e}();vV.propertyNames={NAME:"NAME",DESCRIPTION:"DESCRIPTION",SHORT_NAME:"SHORT_NAME",FORM_NAME:"FORM_NAME"};var yV=vV,EV=function(){function e(t){Object(A.a)(this,e),this.cachedRelationshipTypes=t}return Object(w.a)(e,[{key:"_relationshipConstraintIsStage",value:function(t){return t.relationshipEntity===e.RELATIONSHIP_ENTITY_NAME&&(!t.programStage&&t.program&&t.program.id===this.currentProgramId||t.programStage&&t.programStage.id===this.currentProgramStageId)}},{key:"_convertConstraint",value:function(e){var t={entity:e.relationshipEntity,programId:e.program?e.program.id:null,programStageId:e.programStage?e.programStage.id:null,trackedEntityTypeId:e.trackedEntityType?e.trackedEntityType.id:null};return!t.programStageId&&this._relationshipConstraintIsStage(e)&&(t.programStageId=this.currentProgramStageId),t}},{key:"_buildRelationshipType",value:function(e){var t=this;return new Gt(function(n){n.id=e.id,n.name=e.displayName,n.from=t._convertConstraint(e.fromConstraint),n.to=t._convertConstraint(e.toConstraint),n.access=e.access})}},{key:"build",value:function(e,t){var n=this;return this.currentProgramId=e,this.currentProgramStageId=t,this.cachedRelationshipTypes.filter(function(e){return e.access.data.read&&(n._relationshipConstraintIsStage(e.fromConstraint)||n._relationshipConstraintIsStage(e.toConstraint))}).map(function(e){return n._buildRelationshipType(e)})}}]),e}();EV.RELATIONSHIP_ENTITY_NAME="PROGRAM_STAGE_INSTANCE";var _V=EV,jV=function(){function e(t,n,a){Object(A.a)(this,e),this.cachedOptionSets=t,this.locale=a,this.relationshipTypesFactory=new _V(n),this.dataElementFactory=new yV(t,a)}return Object(w.a)(e,[{key:"_buildSection",value:function(){var e=Object(o.a)(r.a.mark(function e(t,n){var a,i=this;return r.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(a=new mt(function(e){e.id=n.id,e.name=n.displayName}),!n.dataElements){e.next=4;break}return e.next=4,n.dataElements.asyncForEach(function(){var e=Object(o.a)(r.a.mark(function e(n){var o,c,s;return r.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(o=n.id,c=t[o]){e.next=5;break}return O.a.error(Object(ze.b)("could not find programStageDataElement")({sectionDataElement:n})),e.abrupt("return");case 5:return e.next=7,i.dataElementFactory.build(c);case 7:(s=e.sent)&&a.addElement(s);case 9:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}());case 4:return e.abrupt("return",a);case 5:case"end":return e.stop()}},e)}));return function(t,n){return e.apply(this,arguments)}}()},{key:"_buildMainSection",value:function(){var e=Object(o.a)(r.a.mark(function e(t){var n,a=this;return r.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(n=new mt(function(e){e.id=mt.MAIN_SECTION_ID}),!t){e.next=4;break}return e.next=4,t.asyncForEach(function(){var e=Object(o.a)(r.a.mark(function e(t){var o;return r.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,a.dataElementFactory.build(t);case 2:(o=e.sent)&&n.addElement(o);case 4:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}());case 4:return e.abrupt("return",n);case 5:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}()},{key:"build",value:function(){var t=Object(o.a)(r.a.mark(function t(n,a){var i,c,s,l,u,d=this;return r.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(i=new Wt(function(t){t.id=n.id,t.name=n.displayName,t.relationshipTypes=d.relationshipTypesFactory.build(a,n.id),t.stageForm=new Vt(function(t){t.id=n.id,t.name=n.displayName,t.description=n.description,t.featureType=e._getFeatureType(n),t.access=n.access,t.addLabel({id:"eventDate",label:n.executionDateLabel||"Incident date"}),t.validationStrategy=n.validationStrategy&&oV(n.validationStrategy)})}),c=i.stageForm,"CUSTOM"!==n.formType||!n.dataEntryForm){t.next=12;break}return t.next=5,this._buildMainSection(n.programStageDataElements);case 5:(s=t.sent).showContainer=!1,c.addSection(s),l=n.dataEntryForm;try{c.customForm=new ht.a(function(e){e.id=l.id,e.data=l.htmlCode})}catch(f){O.a.error(Object(ze.b)(e.CUSTOM_FORM_TEMPLATE_ERROR)({template:l.htmlCode,error:f}))}t.next=23;break;case 12:if(!((p=n.programStageSections)&&Object(et.a)(p)&&p.length>0)){t.next=18;break}return u=e._convertProgramStageDataElementsToObject(n.programStageDataElements),t.next=16,n.programStageSections.asyncForEach(function(){var e=Object(o.a)(r.a.mark(function e(t){return r.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.t0=c,e.next=3,d._buildSection(u,{id:t.id,displayName:t.displayName,dataElements:t.dataElements});case 3:e.t1=e.sent,e.t0.addSection.call(e.t0,e.t1);case 5:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}());case 16:t.next=23;break;case 18:return t.t0=c,t.next=21,this._buildMainSection(n.programStageDataElements);case 21:t.t1=t.sent,t.t0.addSection.call(t.t0,t.t1);case 23:return t.abrupt("return",i);case 24:case"end":return t.stop()}var p},t,this)}));return function(e,n){return t.apply(this,arguments)}}()}],[{key:"_convertProgramStageDataElementsToObject",value:function(e){return e?e.reduce(function(e,t){return e[t.dataElement.id]=t,e},{}):{}}},{key:"_getFeatureType",value:function(e){return e.featureType?ri(e.featureType.toLowerCase()):"None"}}]),e}();jV.CUSTOM_FORM_TEMPLATE_ERROR="Error in custom form template";var IV=jV,CV=function(){function e(t,n,a,r,o,i,c){Object(A.a)(this,e),this.trackedEntityTypeCollection=i,this.cachedCategories=o,this.programStageFactory=new IV(t,n,c),this.enrollmentFactory=new OV(a,t,r,c,i),this.searchGroupFactory=new mV(a,c),this.dataElementFactory=new bV(a,t,c)}return Object(w.a)(e,null,[{key:"_buildCategoryOptions",value:function(e){return e.reduce(function(e,t){return e.set(t.id,new Ke(function(e){e.id=t.id,e.name=t.displayName,e.organisationUnitIds=t.organisationUnitIds,e.access=t.access})),e},new Map)}},{key:"_buildCategories",value:function(t,n){return new Map(t.map(function(t){return[t.id,new Ye(function(a){var r=t.id;a.id=r;var o=n[r];o?(a.name=o.displayName,a.categoryOptions=e._buildCategoryOptions(o.categoryOptions)):(O.a.error(Object(ze.b)("Could not retrieve cachedCategory")({id:r})),a.categoryOptions=new Map)})]}))}}]),Object(w.a)(e,[{key:"_buildCategoryCombination",value:function(t){var n=this;return t&&!t.isDefault&&t.categories&&t.categories.length>0?new qe(function(a){a.name=t.displayName,a.id=t.id,a.categories=e._buildCategories(t.categories,n.cachedCategories)}):null}},{key:"_buildProgramAttributes",value:function(){var e=Object(o.a)(r.a.mark(function e(t){var n,a,i=this;return r.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.map(function(){var e=Object(o.a)(r.a.mark(function e(t){var n;return r.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,i.dataElementFactory.build(t);case 2:return n=e.sent,e.abrupt("return",n);case 4:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}()),e.next=3,Promise.all(n);case 3:return a=e.sent,e.abrupt("return",a);case 5:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}()},{key:"build",value:function(){var t=Object(o.a)(r.a.mark(function t(n){var a,i,c=this;return r.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if("WITHOUT_REGISTRATION"!==n.programType){t.next=8;break}return a=new Ht(function(e){e.id=n.id,e.access=n.access,e.name=n.displayName,e.shortName=n.displayShortName,e.organisationUnits=n.organisationUnits,e.categoryCombination=c._buildCategoryCombination(n.categoryCombo)}),i=n.programStages&&n.programStages[0],t.next=5,this.programStageFactory.build(i,a.id);case 5:a.stage=t.sent,t.next=21;break;case 8:if(a=new Xt(function(e){e.id=n.id,e.access=n.access,e.name=n.displayName,e.shortName=n.displayShortName,e.organisationUnits=n.organisationUnits,e.trackedEntityType=c.trackedEntityTypeCollection.get(n.trackedEntityTypeId)}),!n.programTrackedEntityAttributes){t.next=16;break}return t.next=12,this.searchGroupFactory.build(n.programTrackedEntityAttributes,n.minAttributesRequiredToSearch);case 12:return a.searchGroups=t.sent,t.next=15,this._buildProgramAttributes(n.programTrackedEntityAttributes);case 15:a.attributes=t.sent;case 16:return t.next=18,n.programStages.asyncForEach(function(){var e=Object(o.a)(r.a.mark(function e(t){return r.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.t0=a,e.next=3,c.programStageFactory.build(t,a.id);case 3:e.t1=e.sent,e.t0.addStage.call(e.t0,e.t1);case 5:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}());case 18:return t.next=20,this.enrollmentFactory.build(n,a.searchGroups);case 20:a.enrollment=t.sent;case 21:return t.next=23,e._buildProgramIcon(n.style);case 23:return a.icon=t.sent,t.abrupt("return",a);case 25:case"end":return t.stop()}},t,this)}));return function(e){return t.apply(this,arguments)}}()}],[{key:"_buildProgramIcon",value:function(){var e=Object(o.a)(r.a.mark(function e(){var t,n,a=arguments;return r.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=a.length>0&&void 0!==a[0]?a[0]:{},(n=new Xe).color=t.color||"#e0e0e0",e.next=5,rV(t.icon);case 5:return n.data=e.sent,e.abrupt("return",n);case 7:case"end":return e.stop()}},e)}));return function(){return e.apply(this,arguments)}}()}]),e}(),TV=[{regExp:new RegExp("([^\\w\\d])(and)([^\\w\\d])","gi"),replacement:"$1&&$3"},{regExp:new RegExp("([^\\w\\d])(or)([^\\w\\d])","gi"),replacement:"$1||$3"},{regExp:new RegExp("V{execution_date}","g"),replacement:"V{event_date}"}];function SV(e){return TV.reduce(function(e,t){return e=e.replace(t.regExp,t.replacement)},e)}function RV(e){return e.match(/[A#]{\w+.?\w*}/g)||[]}function kV(e,t){var n,a=(n=e)&&ld()(n)?n.replace(/^[#VCAvca]{/,"").replace(/}$/,""):n,r=a.split(".");return 2===r.length?{id:a,displayName:a,programRuleVariableSourceType:"DATAELEMENT_CURRENT_EVENT",dataElementId:r[1],programId:t}:{id:a,displayName:a,programRuleVariableSourceType:"TEI_ATTRIBUTE",trackedEntityAttributeId:r[0],programId:t}}function NV(e,t,n){(function(e,t){return e.condition.indexOf("V{value_count}")>=0||t.data.indexOf("V{value_count}")>=0})(e,t)&&function(e,t,n){var a=n.reduce(function(e,t,n){var a="d2:count('".concat(t.displayName,"')");return e+=0!==n?" + ".concat(a):"".concat(a)},"");a="(".concat(a,")"),e.condition=e.condition.replace(new RegExp("V{value_count}","g"),a),t.data=t.data.replace(new RegExp("V{value_count}","g"),a)}(e,t,n)}function AV(e,t,n){(function(e,t){return e.condition.indexOf("V{zero_pos_value_count}")>=0||t.data.indexOf("V{zero_pos_value_count}")>=0})(e,t)&&function(e,t,n){var a=n.reduce(function(e,t,n){var a="d2:countifzeropos('".concat(t.displayName,"')");return e+=0!==n?" + ".concat(a):"".concat(a)},"");a="(".concat(a,")"),e.condition=e.condition.replace(new RegExp("V{zero_pos_value_count}","g"),a),t.data=t.data.replace(new RegExp("V{zero_pos_value_count}","g"),a)}(e,t,n)}function wV(e,t){if(!e.displayInForm)return null;var n={id:e.id,content:e.shortName||e.displayName,data:e.expression,programRuleActionType:"DISPLAYKEYVALUEPAIR",location:"indicators"},a={id:e.id,condition:e.filter?e.filter:"true",description:e.description,displayName:e.displayName,programId:e.programId,programRuleActions:[n]},r=function(e,t,n){var a=RV(t.condition),r=RV(e.data),o=a.map(function(e){return kV(e,n)}),i=r.map(function(e){return kV(e,n)});return{variables:[].concat(Object(We.a)(o),Object(We.a)(i)),variableObjectsCurrentExpression:i}}(n,a,t),o=r.variables,i=r.variableObjectsCurrentExpression;return NV(a,n,i),AV(a,n,i),n.data=SV(n.data),a.condition=SV(a.condition),{rule:a,variables:o}}function FV(e,t){return e.getAll(t)}function xV(e,t){return e.getAll(t)}function PV(e,t){return e.getAll(t)}function DV(e,t){return e.getAll(t)}function UV(e,t){return e.getAll(t)}function LV(e,t){return e.getAll(t).then(function(e){return e.reduce(function(e,t){return e[t.id]=t,e},{})})}function MV(){return BV.apply(this,arguments)}function BV(){return(BV=Object(o.a)(r.a.mark(function e(){var t,n,a,o,i,c,s,l;return r.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=MP(),n=FV(t,EP.PROGRAMS),a=xV(t,EP.PROGRAM_RULES_VARIABLES),o=PV(t,EP.PROGRAM_RULES),i=DV(t,EP.PROGRAM_INDICATORS),c=UV(t,EP.RELATIONSHIP_TYPES),s=LV(t,EP.CATEGORIES),e.next=9,Promise.all([n,a,o,i,c,s]);case 9:return l=e.sent,e.abrupt("return",l);case 11:case"end":return e.stop()}},e)}))).apply(this,arguments)}function VV(e){var t=e.reduce(function(e,t){var n=t.programId;return e[n]=e[n]||[],e[n].push(t),e},{});Object.keys(t).forEach(function(e){var n,a=t[e],r=Je.get(e);if(r){var o=(n=e,a.map(function(e){return wV(e,n)}).filter(function(e){return e}).reduce(function(e,t){return e.rules=e.rules||[],e.rules.push(t.rule),e.variables=e.variables?[].concat(Object(We.a)(e.variables),Object(We.a)(t.variables)):t.variables,e},{rules:null,variables:null})),i=o.rules,c=o.variables;i&&r.addProgramRules(i),c&&r.addProgramRuleVariables(c)}})}function GV(e,t,n,a,r,o,i,c){return WV.apply(this,arguments)}function WV(){return(WV=Object(o.a)(r.a.mark(function e(t,n,a,i,c,s,l,u){var d,p,f;return r.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!(t.length<=0)){e.next=2;break}return e.abrupt("return",[]);case 2:return d=new CV(n,a,i,c,s,l,u),p=t.map(function(){var e=Object(o.a)(r.a.mark(function e(t){var n;return r.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,d.build(t);case 2:return n=e.sent,e.abrupt("return",n);case 4:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}()),e.next=6,Promise.all(p);case 6:return f=e.sent,e.abrupt("return",f);case 8:case"end":return e.stop()}},e)}))).apply(this,arguments)}function HV(e,t,n,a){(function(e){return e.sort(function(e,t){return e.name===t.name?0:e.name>t.name?1:-1}),e})(e).forEach(function(e){Je.set(e.id,e)}),t&&function(e){var t=e.reduce(function(e,t){var n=t.programId;return e[n]=e[n]||[],e[n].push(t),e},{});Object.keys(t).forEach(function(e){var n=t[e],a=Je.get(e);a&&(a.programRuleVariables=n)})}(t),n&&function(e){var t=e.reduce(function(e,t){var n=t.programId;return e[n]=e[n]||[],e[n].push(t),e},{});Object.keys(t).forEach(function(e){var n=t[e],a=Je.get(e);if(a){var r=n.filter(function(e){return!e.programStageId}),o=n.filter(function(e){return e.programStageId}).reduce(function(e,t){return e[t.programStageId]=e[t.programStageId]||[],e[t.programStageId].push(t),e},{});a.programRules=r,Object.keys(o).forEach(function(e){var t=o[e],n=a.getStage(e);n&&(n.programRules=t)})}})}(n),a&&VV(a)}function zV(e,t,n,a,r){return KV.apply(this,arguments)}function KV(){return(KV=Object(o.a)(r.a.mark(function e(t,n,a,o,i){var c,s,l,u,d,p,f,m;return r.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,MV();case 2:return c=e.sent,s=Object(ca.a)(c,6),l=s[0],u=s[1],d=s[2],p=s[3],f=s[4],m=s[5],e.next=12,GV(l,n,f,a,o,m,i,t);case 12:HV(e.sent,u,d,p);case 14:case"end":return e.stop()}},e)}))).apply(this,arguments)}function YV(e){return qV.apply(this,arguments)}function qV(){return(qV=Object(o.a)(r.a.mark(function e(t){var n;return r.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=MP(),e.abrupt("return",n.getAll(t));case 2:case"end":return e.stop()}},e)}))).apply(this,arguments)}function XV(e){return ZV.apply(this,arguments)}function ZV(){return(ZV=Object(o.a)(r.a.mark(function e(t){var n;return r.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,YV(t);case 2:n=e.sent,Qt.set(n);case 4:case"end":return e.stop()}},e)}))).apply(this,arguments)}var JV=function(){function e(t,n,a){Object(A.a)(this,e),this.cachedTrackedEntityAttributes=t,this.locale=a,this.optionSetFactory=new sV(n,a)}return Object(w.a)(e,null,[{key:"buildtetFeatureType",value:function(e){return new ut(function(t){t.id="FEATURETYPE_".concat(e),t.name="POINT"===e?c.a.t("Coordinate"):c.a.t("Area"),t.formName=t.name,t.compulsory=!1,t.displayInForms=!0,t.disabled=!1,t.type="POINT"===e?ct.COORDINATE:ct.POLYGON})}}]),Object(w.a)(e,[{key:"_getAttributeTranslation",value:function(e,t){var n=this;if(this.locale){var a=e.find(function(e){return e.property===t&&e.locale===n.locale});return a&&a.value}return null}},{key:"build",value:function(){var t=Object(o.a)(r.a.mark(function t(n){var a,o,i=this;return r.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(a=n.trackedEntityAttributeId&&this.cachedTrackedEntityAttributes.get(n.trackedEntityAttributeId)){t.next=4;break}return O.a.error(Object(ze.b)(e.errorMessages.TRACKED_ENTITY_ATTRIBUTE_NOT_FOUND)({cachedTrackedEntityTypeAttribute:n})),t.abrupt("return",null);case 4:if(o=new ut(function(t){t.id=a.id,t.compulsory=n.mandatory,t.name=i._getAttributeTranslation(a.translations,e.translationPropertyNames.NAME)||a.displayName,t.shortName=i._getAttributeTranslation(a.translations,e.translationPropertyNames.SHORT_NAME)||a.displayShortName,t.formName=i._getAttributeTranslation(a.translations,e.translationPropertyNames.NAME)||a.displayName,t.description=i._getAttributeTranslation(a.translations,e.translationPropertyNames.DESCRIPTION)||a.description,t.displayInForms=!0,t.displayInReports=n.displayInList,t.disabled=!1,t.type=a.valueType}),a.unique&&(o.unique=new lt(function(e){e.scope=a.orgunitScope?st.ORGANISATION_UNIT:st.ENTIRE_SYSTEM,e.onValidate=function(t){var n,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=Object(ze.d)(bd,id)(t,a.valueType);if(r.onGetUnsavedAttributeValues){var c=r.onGetUnsavedAttributeValues(o.id);if(c)if(c.find(function(e){return e===i}))return{valid:!1,data:{attributeValueExistsUnsaved:!0}}}if(e.scope===st.ORGANISATION_UNIT){var s=r.orgUnitId;n=ye().get("trackedEntityInstances",{ou:s,filter:"".concat(o.id,":EQ:").concat(i)})}else n=ye().get("trackedEntityInstances",{ouMode:"ACCESSIBLE",filter:"".concat(o.id,":EQ:").concat(i)});return n.then(function(e){var t=e.trackedEntityInstances&&e.trackedEntityInstances[0]||{},n={id:t.trackedEntityInstance,tetId:t.trackedEntityType};return{valid:0===e.trackedEntityInstances.length,data:n}})},a.pattern&&(e.generatable=!!a.pattern)})),!a.optionSet||!a.optionSet.id){t.next=10;break}return t.next=9,this.optionSetFactory.build(o,a.optionSet.id,null,null,function(e){return e});case 9:o.optionSet=t.sent;case 10:return t.abrupt("return",o);case 11:case"end":return t.stop()}},t,this)}));return function(e){return t.apply(this,arguments)}}()}]),e}();JV.translationPropertyNames={NAME:"NAME",DESCRIPTION:"DESCRIPTION",SHORT_NAME:"SHORT_NAME"},JV.errorMessages={TRACKED_ENTITY_ATTRIBUTE_NOT_FOUND:"TrackedEntityAttributeId missing from trackedEntityTypeAttribute or trackedEntityAttribute not found"};var QV=JV,$V=function(){function e(t,n,a){Object(A.a)(this,e),this.cachedTrackedEntityAttributes=t,this.dataElementFactory=new QV(t,n,a)}return Object(w.a)(e,null,[{key:"_buildSearchGroupElement",value:function(e,t){return new ut(function(n){n.id=e.id,n.name=e.name,n.shortName=e.shortName,n.formName=e.formName,n.description=e.description,n.displayInForms=!0,n.displayInReports=e.displayInReports,n.compulsory=e.compulsory,n.disabled=e.disabled,n.type=t.valueType,n.optionSet=e.optionSet})}},{key:"_buildTetFeatureTypeField",value:function(e){var t=e.featureType;return t&&["POINT","POLYGON"].includes(t)?QV.buildtetFeatureType(t):null}}]),Object(w.a)(e,[{key:"_buildSection",value:function(){var t=Object(o.a)(r.a.mark(function t(n){var a,i,s,l=this;return r.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(a=e._buildTetFeatureTypeField(n),(i=n.trackedEntityTypeAttributes)&&!(i.length<=0)||a){t.next=4;break}return t.abrupt("return",null);case 4:if(s=new mt(function(e){e.id=mt.MAIN_SECTION_ID,e.name=c.a.t("Profile")}),a&&s.addElement(a),!(i&&i.length>0)){t.next=9;break}return t.next=9,i.asyncForEach(function(){var e=Object(o.a)(r.a.mark(function e(t){var n;return r.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,l.dataElementFactory.build(t);case 2:(n=e.sent)&&s.addElement(n);case 4:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}());case 9:return t.abrupt("return",s);case 10:case"end":return t.stop()}},t)}));return function(e){return t.apply(this,arguments)}}()},{key:"_buildFoundation",value:function(){var e=Object(o.a)(r.a.mark(function e(t){var n,a;return r.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=new Vt(function(e){e.name=t.displayName,e.id=t.id}),e.next=3,this._buildSection(t);case 3:return(a=e.sent)&&n.addSection(a),e.abrupt("return",n);case 6:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"_buildInputSearchGroupFoundation",value:function(t,n){var a=this,r=(t.trackedEntityTypeAttributes||[]).reduce(function(e,t){if(!t.trackedEntityAttributeId)return O.a.error(Object(ze.b)("TrackedEntityAttributeId missing from trackedEntityTypeAttribute")({typeTeiAttribute:t})),e;var n=a.cachedTrackedEntityAttributes.get(t.trackedEntityAttributeId);return n?e[n.id]=n:O.a.error(Object(ze.b)("could not retrieve tei attribute")({typeTeiAttribute:t})),e},{}),o=n.searchForm,i=new Vt,c=new mt(function(e){e.id=mt.MAIN_SECTION_ID});return Array.from(o.getSection(mt.MAIN_SECTION_ID).elements.entries()).map(function(e){return e[1]}).forEach(function(t){var n=e._buildSearchGroupElement(t,r[t.id]);n&&c.addElement(n)}),i.addSection(c),i}},{key:"_buildInputSearchGroups",value:function(e,t){var n=this;return t.filter(function(e){return!e.unique}).map(function(t){return new wt(function(a){a.id=t.id,a.minAttributesRequiredToSearch=t.minAttributesRequiredToSearch,a.searchFoundation=n._buildInputSearchGroupFoundation(e,t),a.onSearch=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=t.orgUnitId,a=t.trackedEntityType;return ye().get("trackedEntityInstances/count.json",{ou:n,trackedEntityType:a,ouMode:"ACCESSIBLE",filter:Object.keys(e).filter(function(t){return e[t]||0===e[t]||!1===e[t]}).map(function(t){return"".concat(t,":LIKE:").concat(e[t])})})}})})}},{key:"build",value:function(){var e=Object(o.a)(r.a.mark(function e(t){var n,a,o,i,c=arguments;return r.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=c.length>1&&void 0!==c[1]?c[1]:[],a=c.length>2?c[2]:void 0,e.next=4,this._buildFoundation(t);case 4:return o=e.sent,i=this._buildInputSearchGroups(t,n),e.abrupt("return",new Ft(function(e){e.form=o,e.inputSearchGroups=i,e.trackedEntityType=a}));case 7:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()}]),e}(),eG=function(){function e(t,n,a){Object(A.a)(this,e),this.locale=a,this.dataElementFactory=new QV(t,n,a),this.searchGroupFactory=new mV(t,a),this.teiRegistrationFactory=new $V(t,n,a)}return Object(w.a)(e,[{key:"_getTranslation",value:function(e,t){var n=this;if(this.locale){var a=e.find(function(e){return e.property===t&&e.locale===n.locale});return a&&a.value}return null}},{key:"_buildAttributes",value:function(){var e=Object(o.a)(r.a.mark(function e(t){var n,a,i=this;return r.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.map(function(){var e=Object(o.a)(r.a.mark(function e(t){var n;return r.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,i.dataElementFactory.build(t);case 2:return n=e.sent,e.abrupt("return",n);case 4:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}()),e.next=3,Promise.all(n);case 3:return a=e.sent,e.abrupt("return",a.filter(function(e){return e}));case 5:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}()},{key:"build",value:function(){var t=Object(o.a)(r.a.mark(function t(n){var a,o=this;return r.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(a=new xt(function(t){t.id=n.id,t.name=o._getTranslation(n.translations,e.translationPropertyNames.NAME)||n.displayName}),!n.trackedEntityTypeAttributes){t.next=8;break}return t.next=4,this.searchGroupFactory.build(n.trackedEntityTypeAttributes,n.minAttributesRequiredToSearch);case 4:return a.searchGroups=t.sent,t.next=7,this._buildAttributes(n.trackedEntityTypeAttributes);case 7:a.attributes=t.sent;case 8:return t.next=10,this.teiRegistrationFactory.build(n,a.searchGroups,a);case 10:return a.teiRegistration=t.sent,t.abrupt("return",a);case 12:case"end":return t.stop()}},t,this)}));return function(e){return t.apply(this,arguments)}}()}]),e}();eG.translationPropertyNames={NAME:"NAME",SHORT_NAME:"SHORT_NAME",DESCRIPTION:"DESCRIPTION"};var tG=eG;function nG(e,t,n,a){return aG.apply(this,arguments)}function aG(){return(aG=Object(o.a)(r.a.mark(function e(t,n,a,i){var c;return r.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return c=new tG(n,a,i),e.next=3,Object(We.a)(t.values()).asyncForEach(function(){var e=Object(o.a)(r.a.mark(function e(t){var n;return r.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,c.build(t);case 2:n=e.sent,Zt.set(n.id,n);case 4:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}());case 3:return e.abrupt("return",Zt);case 4:case"end":return e.stop()}},e)}))).apply(this,arguments)}function rG(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];var a=MP(),r=t.map(function(e){return a.getAll(e)});return Promise.all(r).then(function(e){return e.reduce(function(e,n,a){return e[t[a]]=n.reduce(function(e,t){return e.set(t.id,t),e},new Map),e},{})})}function oG(e){return iG.apply(this,arguments)}function iG(){return(iG=Object(o.a)(r.a.mark(function e(t){var n,a,o,i;return r.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,rG(EP.TRACKED_ENTITY_ATTRIBUTES,EP.OPTION_SETS,EP.TRACKED_ENTITY_TYPES);case 2:return n=e.sent,e.next=5,nG(n[EP.TRACKED_ENTITY_TYPES],n[EP.TRACKED_ENTITY_ATTRIBUTES],n[EP.OPTION_SETS],t);case 5:return a=e.sent,o=zV(t,n[EP.OPTION_SETS],n[EP.TRACKED_ENTITY_ATTRIBUTES],n[EP.TRACKED_ENTITY_TYPES],a),i=XV(EP.CONSTANTS),r=n[EP.OPTION_SETS],Jt.set(r),e.next=11,Promise.all([o,i]);case 11:case"end":return e.stop()}var r},e)}))).apply(this,arguments)}function cG(){var e,t=(e={},Object(Ut.a)(e,N.a.dev,O.a.levels.DEBUG),Object(Ut.a)(e,N.a.devDebug,O.a.levels.TRACE),Object(Ut.a)(e,N.a.test,O.a.levels.INFO),Object(Ut.a)(e,N.a.prod,O.a.levels.ERROR),e).production;t||0===t||(t=O.a.levels.ERROR),O.a.setLevel(t)}function sG(){var e=Object({NODE_ENV:"production",PUBLIC_URL:".",REACT_APP_DHIS2_BASE_URL:"..",REACT_APP_DHIS2_AUTHORIZATION:"",REACT_APP_CACHE_VERSION:"6"}),t=e.REACT_APP_DHIS2_BASE_URL,n=e.REACT_APP_DHIS2_AUTHORIZATION,a=e.NODE_ENV,r=t||"";$l.config.baseUrl="".concat(r,"/api"),a!==N.a.prod&&($l.config.headers={"X-Requested-With":"XMLHttpRequest",Authorization:n})}function lG(e){return"en"===e?(l.a.locale(e),Promise.resolve()):new Promise(function(t){n(8455)("./".concat(e)).then(function(){l.a.locale(e),O.a.info("got moment locale config for ".concat(e)),t()}).catch(function(){l.a.locale("en"),O.a.error("could not get moment locale config for ".concat(e)),t()})})}function uG(e,t,a,r){return new Promise(function(o,i){n(8456)("./".concat(e)).then(function(n){var i={dateFnsLocale:n,weekDays:t,weekDaysShort:a,calendarFormatHeaderLong:"dddd D MMM",calendarFormatHeaderShort:"D MMM",selectDatesText:c.a.t("Choose one or more dates..."),selectDateText:c.a.t("Choose a date..."),todayLabelShort:c.a.t("Today"),todayLabelLong:c.a.t("Today"),weekStartsOn:r};O.a.info("got date-fns locale for ".concat(e)),ai.set(i),o()}).catch(function(){O.a.error("could not get date-fns locale config for ".concat(e,", fallback to en")),Promise.resolve().then(n.t.bind(null,368,7)).then(function(e){var n={dateFnsLocale:e,weekDays:t,weekDaysShort:a,calendarFormatHeaderLong:"dddd D MMM",calendarFormatHeaderShort:"D MMM",selectDatesText:c.a.t("Choose one or more dates..."),selectDateText:c.a.t("Choose a date..."),todayLabelShort:c.a.t("Today"),todayLabelLong:c.a.t("Today"),weekStartsOn:r};ai.set(n),o()}).catch(function(){O.a.error("could not get the fallback date-fns locale for ".concat(e)),i()})})})}function dG(e){c.a.changeLanguage(e),document.body.setAttribute("dir",function(e){var t=["ar","fa","ur"],n=t.map(function(e){return"".concat(e,"-")});return t.includes(e)||n.filter(function(t){return e.startsWith(t)}).length>0}(e)?"rtl":"ltr")}function pG(e){return fG.apply(this,arguments)}function fG(){return(fG=Object(o.a)(r.a.mark(function e(t){var n,a,o,i;return r.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=t,e.next=3,lG(n);case 3:return a=l.a.weekdays(),o=l.a.weekdaysShort(),i=l.a.localeData()._week.dow,e.next=8,uG(n,a,o,i);case 8:dG(n);case 9:case"end":return e.stop()}},e)}))).apply(this,arguments)}function mG(e){return hG.apply(this,arguments)}function hG(){return(hG=Object(o.a)(r.a.mark(function e(t){return r.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,$B();case 2:return e.next=4,oG(t);case 4:case"end":return e.stop()}},e)}))).apply(this,arguments)}function bG(){return gG.apply(this,arguments)}function gG(){return(gG=Object(o.a)(r.a.mark(function e(){var t,n,a,o;return r.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return cG(),sG(),e.next=4,Object($l.init)();case 4:return t=e.sent,e.next=7,Object($l.getUserSettings)();case 7:return n=e.sent,Oe(t),e.next=11,DP();case 11:return a=n.keyUiLocale,o=n.keyDbLocale,e.next=15,pG(a);case 15:return e.next=17,mG(o);case 17:case"end":return e.stop()}},e)}))).apply(this,arguments)}function OG(e){var t,n=[(t=e.getState(),t.workingListsUI.main&&t.workingListsUI.main.isLoading?qD():null)].filter(function(e){return e});n.length>0&&e.dispatch(Object(Le.batchActions)(n))}var vG=document.createElement("noscript");vG.setAttribute("id","jss-insertion-point"),document.head.appendChild(vG);var yG=Object(E.createGenerateClassName)(),EG=Object(k.create)(Object(E.jssPreset)());function _G(e,t,n){t.dispatch(aL()),function(e){window.addEventListener("beforeunload",function(){var t=Object(o.a)(r.a.mark(function t(n){var a;return r.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(OG(e),!(e.getState().offline.outbox.length>0)){t.next=5;break}return a="Unsaved events!",n.returnValue=a,t.abrupt("return",a);case 5:return t.abrupt("return",void 0);case 6:case"end":return t.stop()}},t)}));return function(e){return t.apply(this,arguments)}}())}(t),Object(h.render)(m.a.createElement(R.a,{jss:EG,generateClassName:yG},m.a.createElement(Zx,{store:t,history:n})),e)}function jG(){return(jG=Object(o.a)(r.a.mark(function e(t){var n,a,o;return r.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return Object(h.render)(m.a.createElement(T,null),t),e.prev=1,e.next=4,bG();case 4:n=y()(),a=CM(n,function(){return _G(t,a,n)}),e.next=14;break;case 8:e.prev=8,e.t0=e.catch(1),O.a.error(e.t0),o="The application could not be loaded.","production"!==N.a.prod&&(o+=" Please verify that the server is running."),Object(h.render)(m.a.createElement("div",null,o),t);case 14:case"end":return e.stop()}},e,null,[[1,8]])}))).apply(this,arguments)}EG.options.insertionPoint=vG;var IG=document.getElementById("app");IG?function(e){jG.apply(this,arguments)}(IG):O.a.error("html element with id ".concat("app"," is missing in index file"))},87:function(e,t,n){e.exports={coordinateField:"coordinateField_coordinateField__3zVrN",coordinateFieldsHorizontal:"coordinateField_coordinateFieldsHorizontal__3w54M",coordinateFieldsVertical:"coordinateField_coordinateFieldsVertical__2q6gO",mapIcon:"coordinateField_mapIcon__yn4bc",mapIconContainer:"coordinateField_mapIconContainer__3YCPr",mapIconContainerWithMargin:"coordinateField_mapIconContainerWithMargin__HREtB",clearIcon:"coordinateField_clearIcon__3XtXz",clearIconWithMargin:"coordinateField_clearIconWithMargin__1IofR",inputContainer:"coordinateField_inputContainer__2Mv_n",latitudeTextInput:"coordinateField_latitudeTextInput__Pr3tX",longitudeTextInput:"coordinateField_longitudeTextInput__29y4f",dialogActionOuterContainer:"coordinateField_dialogActionOuterContainer__3RF8M",dialogActionInnerContainer:"coordinateField_dialogActionInnerContainer__2zHkx",mapContainer:"coordinateField_mapContainer__3iOhH",leafletContainer:"coordinateField_leafletContainer__2cYXr",dialogContent:"coordinateField_dialogContent__1u80P",buttonsContainerVertical:"coordinateField_buttonsContainerVertical__2KbyO"}},964:function(e,t,n){e.exports={labelContainer:"label_labelContainer__2KYIy",labelContainerVertical:"label_labelContainerVertical__1_ahS"}}},[[6891,257,258]]]);