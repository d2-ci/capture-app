!function(){"use strict";var e={4845:function(e,t,r){var n=r(26517),i=r.n(n);const a=Object.freeze({ASSIGN_VALUE:"ASSIGN",HIDE_FIELD:"HIDEFIELD",SHOW_ERROR:"SHOWERROR",SHOW_WARNING:"SHOWWARNING",SHOW_ERROR_ONCOMPLETE:"ERRORONCOMPLETE",SHOW_WARNING_ONCOMPLETE:"WARNINGONCOMPLETE",HIDE_PROGRAM_STAGE:"HIDEPROGRAMSTAGE",HIDE_SECTION:"HIDESECTION",MAKE_COMPULSORY:"SETMANDATORYFIELD",DISPLAY_TEXT:"DISPLAYTEXT",DISPLAY_KEY_VALUE_PAIR:"DISPLAYKEYVALUEPAIR",HIDE_OPTION_GROUP:"HIDEOPTIONGROUP",HIDE_OPTION:"HIDEOPTION",SHOW_OPTION_GROUP:"SHOWOPTIONGROUP",SCHEDULE_MESSAGE:"SCHEDULEMESSAGE",SEND_MESSAGE:"SENDMESSAGE"}),s="dataElement",o="trackedEntityAttribute",E="dataElementId",l="trackedEntityAttributeId",u={TEXT:"TEXT",MULTI_TEXT:"MULTI_TEXT",LONG_TEXT:"LONG_TEXT",LETTER:"LETTER",PHONE_NUMBER:"PHONE_NUMBER",EMAIL:"EMAIL",BOOLEAN:"BOOLEAN",TRUE_ONLY:"TRUE_ONLY",DATE:"DATE",DATETIME:"DATETIME",TIME:"TIME",NUMBER:"NUMBER",PERCENTAGE:"PERCENTAGE",INTEGER:"INTEGER",INTEGER_POSITIVE:"INTEGER_POSITIVE",INTEGER_NEGATIVE:"INTEGER_NEGATIVE",INTEGER_ZERO_OR_POSITIVE:"INTEGER_ZERO_OR_POSITIVE",USERNAME:"USERNAME",COORDINATE:"COORDINATE",ORGANISATION_UNIT:"ORGANISATION_UNIT",AGE:"AGE",URL:"URL",FILE_RESOURCE:"FILE_RESOURCE",IMAGE:"IMAGE"},c={[u.TEXT]:"convertText",[u.MULTI_TEXT]:"convertMultiText",[u.LONG_TEXT]:"convertLongText",[u.LETTER]:"convertLetter",[u.PHONE_NUMBER]:"convertPhoneNumber",[u.EMAIL]:"convertEmail",[u.BOOLEAN]:"convertBoolean",[u.TRUE_ONLY]:"convertTrueOnly",[u.DATE]:"convertDate",[u.DATETIME]:"convertDateTime",[u.TIME]:"convertTime",[u.NUMBER]:"convertNumber",[u.INTEGER]:"convertInteger",[u.INTEGER_POSITIVE]:"convertIntegerPositive",[u.INTEGER_NEGATIVE]:"convertIntegerNegative",[u.INTEGER_ZERO_OR_POSITIVE]:"convertIntegerZeroOrPositive",[u.PERCENTAGE]:"convertPercentage",[u.URL]:"convertUrl",[u.AGE]:"convertAge",[u.FILE_RESOURCE]:"convertFile",[u.ORGANISATION_UNIT]:"convertOrganisationUnit",[u.IMAGE]:"convertImage",[u.USERNAME]:"convertUserName",[u.COORDINATE]:"convertCoordinate"},d=Object.freeze({WebClient:"WebClient",AndroidClient:"AndroidClient",Server:"Server"});class T{static getName(e,t,r){if(e){if(r===u.MULTI_TEXT){const r=t.split(","),n=e.reduce((e,t)=>r.includes(t.code)?e.concat(t.displayName):e,[]);return 0!==n.length?n.join(","):t}const n=e.find(e=>e.code===t);return n&&n.displayName||t}return t}}const I="#",_="A",O="V",N="C",p="#",A=Object.freeze({ACTIVE:"ACTIVE",COMPLETED:"COMPLETED",VISITED:"VISITED",SCHEDULE:"SCHEDULE",OVERDUE:"OVERDUE",SKIPPED:"SKIPPED"});var R=r(65028);const v=e=>(0,R.A)(e)?isNaN(e)?(i().warn(`rule execution service could not convert ${e} to number`),null):Number(e):e,m=e=>(0,R.A)(e)?"true"===e:e,S=e=>e.toString(),g=(e,t)=>{const r={[u.BOOLEAN]:m,[u.TRUE_ONLY]:m,[u.PERCENTAGE]:S,[u.INTEGER]:v,[u.INTEGER_NEGATIVE]:v,[u.INTEGER_POSITIVE]:v,[u.INTEGER_ZERO_OR_POSITIVE]:v,[u.NUMBER]:v,[u.AGE]:S,[u.TEXT]:S,[u.LONG_TEXT]:S,[u.MULTI_TEXT]:S};return e||0===e||!1===e?r[t]?r[t](e):e:null},f={[u.TEXT]:"",[u.LONG_TEXT]:"",[u.PHONE_NUMBER]:"",[u.EMAIL]:"",[u.BOOLEAN]:!1,[u.TRUE_ONLY]:!1,[u.DATE]:"",[u.DATETIME]:"",[u.TIME]:"",[u.NUMBER]:0,[u.PERCENTAGE]:0,[u.INTEGER]:0,[u.INTEGER_POSITIVE]:0,[u.INTEGER_NEGATIVE]:0,[u.INTEGER_ZERO_OR_POSITIVE]:0,[u.USERNAME]:"",[u.COORDINATE]:"",[u.ORGANISATION_UNIT]:"",[u.AGE]:"",[u.URL]:"",[u.FILE_RESOURCE]:"",[u.IMAGE]:""};function b(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}const P={DATAELEMENT_CURRENT_EVENT:"DATAELEMENT_CURRENT_EVENT",DATAELEMENT_NEWEST_EVENT_PROGRAM_STAGE:"DATAELEMENT_NEWEST_EVENT_PROGRAM_STAGE",DATAELEMENT_NEWEST_EVENT_PROGRAM:"DATAELEMENT_NEWEST_EVENT_PROGRAM",DATAELEMENT_PREVIOUS_EVENT:"DATAELEMENT_PREVIOUS_EVENT"},h={TEI_ATTRIBUTE:"TEI_ATTRIBUTE"},y={...P,...h,CALCULATED_VALUE:"CALCULATED_VALUE"};class D{constructor(e,t,r){b(this,"environment",void 0),b(this,"onProcessValue",void 0),b(this,"mapSourceTypeToGetterFn",void 0),b(this,"defaultValues",void 0),b(this,"structureEvents",void 0),this.environment=r,this.onProcessValue=e,D.dateUtils=t,this.mapSourceTypeToGetterFn={[y.DATAELEMENT_CURRENT_EVENT]:this.getVariableForCurrentEvent,[y.DATAELEMENT_NEWEST_EVENT_PROGRAM]:this.getVariableForNewestEventProgram,[y.DATAELEMENT_NEWEST_EVENT_PROGRAM_STAGE]:this.getVariableForNewestEventProgramStage,[y.DATAELEMENT_PREVIOUS_EVENT]:this.getVariableForPreviousEventProgram,[y.TEI_ATTRIBUTE]:this.getVariableForSelectedEntityAttributes,[y.CALCULATED_VALUE]:this.getVariableForCalculatedValue},this.defaultValues=f,this.structureEvents=((e,t)=>{const r=(r,n)=>e(t(r.occurredAt,u.DATE),t(n.occurredAt,u.DATE))||e(t(r.createdAt,u.DATETIME),t(n.createdAt,u.DATETIME));return(e={},t=[])=>{const n=t.filter(t=>t.occurredAt&&[A.COMPLETED,A.ACTIVE,A.VISITED].includes(t.status)&&t.eventId!==e.eventId);return(e=>{const t=e.reduce((e,t)=>{const r=t.programStageId;return e[r]=e[r]||[],e[r].push(t),e},{});return{all:e,byStage:t}})((Object.keys(e).length?n.concat(e):n).sort(r))}})(t.compareDates,e)}getVariables({programRuleVariables:e,currentEvent:t,otherEvents:r,dataElements:n,selectedEntity:a,trackedEntityAttributes:s,selectedEnrollment:o,selectedOrgUnit:E,optionSets:l,constants:c}){const d={executingEvent:t,eventsContainer:this.structureEvents(t,r),dataElements:n,selectedEntity:a,trackedEntityAttributes:s,selectedEnrollment:o,optionSets:l,selectedOrgUnit:E};return{...{...(null!==e&&void 0!==e?e:[]).reduce((e,t)=>{let r;const a=t.displayName,o=t.programRuleVariableSourceType,E=this.mapSourceTypeToGetterFn[o];return E?(P[o]?r=this.preCheckDataElementSpecificSourceType(t,n):h[o]&&(r=this.preCheckTrackedEntitySpecificSourceType(t,s)),r?(e[a]=r,e):(r=E.bind(this)(t,d),r||P[o]&&n&&(r=this.postGetVariableForDataElementSpecificSourceType(t,n)),r&&(e[a]=r),e)):(i().error(`Unknown programRuleVariableSourceType:${t.programRuleVariableSourceType}`),r=this.buildVariable(null,u.TEXT,{variablePrefix:I,useNameForOptionSet:t.useNameForOptionSet}),e[a]=r,e)},{}),...this.getContextVariables(d)},...this.getConstantVariables(c)}}updateVariable(e,t,r){const n=e.replace("#{","").replace("A{","").replace(/}/g,""),a=r[n];if(a){const{variableType:e}=a,i=null===t?this.defaultValues[e]:g(t,e);r[n]={...a,variableValue:i,hasValue:null!==t,variableEventDate:"",variablePrefix:a.variablePrefix||"#",allValues:[i]}}else i().warn(`Variable ${n} was not defined.`)}buildVariable(e,t,{variablePrefix:r,allValues:n,variableEventDate:i,useNameForOptionSet:a=!1}){return{variableValue:null!==e&&void 0!==e?e:this.defaultValues[t],useCodeForOptionSet:!a,variableType:t||u.TEXT,hasValue:null!==e,variableEventDate:i,variablePrefix:r,allValues:n}}preCheckDataElementSpecificSourceType(e,t){const r=e.dataElementId;return r&&t&&t[r]?null:(i().warn(`Variable id:${e.id} name:${e.displayName} contains an invalid dataelement id (id: ${r||""})`),this.buildVariable(null,u.TEXT,{variablePrefix:I,useNameForOptionSet:e.useNameForOptionSet}))}preCheckTrackedEntitySpecificSourceType(e,t){const r=e.trackedEntityAttributeId;return r&&t&&t[r]?null:(i().warn(`Variable id:${e.id} name:${e.displayName} contains an invalid trackedEntityAttribute id (id: ${r||""})`),this.buildVariable(null,u.TEXT,{variablePrefix:_,useNameForOptionSet:e.useNameForOptionSet}))}postGetVariableForDataElementSpecificSourceType(e,t){const r=t[e.dataElementId];return this.buildVariable(null,r.valueType,{variablePrefix:I,useNameForOptionSet:e.useNameForOptionSet})}getVariableValue(e,t,r,n,i,a){const s=this.onProcessValue(e,t);return null!==s&&n&&i&&i[r]&&i[r].optionSetId?T.getName(a[i[r].optionSetId].options,s,i[r].valueType):s}getVariableForCalculatedValue(e){return this.buildVariable(null,e.valueType,{variablePrefix:p,useNameForOptionSet:e.useNameForOptionSet})}getVariableForSelectedEntityAttributes(e,t){var r;const n=e.trackedEntityAttributeId,i=null===(r=t.trackedEntityAttributes)||void 0===r?void 0:r[n],a=t.selectedEntity?t.selectedEntity[n]:null,s=e.useNameForOptionSet&&i.optionSetId?"TEXT":i.valueType,o=this.getVariableValue(a,s,n,e.useNameForOptionSet,t.trackedEntityAttributes,t.optionSets);return this.buildVariable(o,s,{variablePrefix:_,useNameForOptionSet:e.useNameForOptionSet})}getVariableForCurrentEvent(e,t){var r;const n=e.dataElementId,i=null===(r=t.dataElements)||void 0===r?void 0:r[n],a=t.executingEvent;if(!a)return null;const s=a&&a[n],o=e.useNameForOptionSet&&i.optionSetId?"TEXT":i.valueType,E=this.getVariableValue(s,o,n,e.useNameForOptionSet,t.dataElements,t.optionSets);return this.buildVariable(E,o,{variablePrefix:I,variableEventDate:this.onProcessValue(a.occurredAt,u.DATE),useNameForOptionSet:e.useNameForOptionSet})}getVariableForNewestEventProgramStage(e,t){const r=e.programStageId;if(!r)return i().warn(`Variable id:${e.id} name:${e.displayName} does not have a programstage defined, despite that the variable has source type ${e.programRuleVariableSourceType}`),null;const n=t.eventsContainer&&t.eventsContainer.byStage[r];return n?this.getVariableContainingAllValues(e,t,n):null}getVariableForNewestEventProgram(e,t){const r=t.eventsContainer&&t.eventsContainer.all;return r&&0!==r.length?this.getVariableContainingAllValues(e,t,r):null}getVariableForPreviousEventProgram(e,t){const r=t.eventsContainer&&t.eventsContainer.all;if(!r||0===r.length)return null;const n=t.executingEvent;if(!n)return null;const i=r.findIndex(e=>e.eventId===n.eventId);return i-1<0?null:this.getVariableContainingAllValues(e,t,r.slice(0,i))}getVariableContainingAllValues(e,t,r){var n;const i=e.dataElementId,a=null===(n=t.dataElements)||void 0===n?void 0:n[i],s=e.useNameForOptionSet&&a.optionSetId?"TEXT":a.valueType,o=r.map(r=>this.getVariableValue(r[i],s,i,e.useNameForOptionSet,t.dataElements,t.optionSets)).filter(e=>null!==e),E=[...r].reverse().find(r=>null!==this.getVariableValue(r[i],s,i,e.useNameForOptionSet,t.dataElements,t.optionSets));if(!E)return null;const l=this.getVariableValue(E[i],s,i,e.useNameForOptionSet,t.dataElements,t.optionSets);return this.buildVariable(l,s,{variablePrefix:I,variableEventDate:this.onProcessValue(E.occurredAt,u.DATE),useNameForOptionSet:e.useNameForOptionSet,allValues:o})}buildContextVariable(e,t,r={}){return r.variablePrefix=O,this.buildVariable(this.onProcessValue(e,t),t,r)}buildRawContextVariable(e,t){return this.buildVariable(e,t,{variablePrefix:O})}getContextVariables(e){let t={};return t.environment=this.buildRawContextVariable(this.environment,u.TEXT),t.current_date=this.buildRawContextVariable(D.dateUtils.getToday(),u.DATE),t={...t,...this.getEventContextVariables(e.executingEvent,e.eventsContainer),...this.getEnrollmentContextVariables(e.selectedEnrollment),...this.getOrganisationContextVariables(e.selectedOrgUnit)},t}getEventContextVariables(e,t){const r={};return e&&(r.event_date=this.buildContextVariable(e.occurredAt,u.DATE),r.due_date=this.buildContextVariable(e.scheduledAt,u.DATE),r.completed_date=this.buildContextVariable(e.completedAt,u.DATE),r.event_id=this.buildContextVariable(e.eventId,u.TEXT,{variableEventDate:this.onProcessValue(e.occurredAt,u.DATE)}),r.event_status=this.buildContextVariable(e.status,u.TEXT),r.program_stage_id=this.buildContextVariable(e.programStageId,u.TEXT),r.program_stage_name=this.buildContextVariable(e.programStageName,u.TEXT)),t&&(r.event_count=this.buildRawContextVariable(t.all&&t.all.length||0,u.INTEGER)),r}getEnrollmentContextVariables(e){const t={};return e&&(t.enrollment_date=this.buildContextVariable(e.enrolledAt,u.DATE),t.enrollment_id=this.buildContextVariable(e.enrollmentId,u.TEXT),t.enrollment_count=this.buildRawContextVariable(1,u.INTEGER),t.tei_count=this.buildRawContextVariable(1,u.INTEGER),t.incident_date=this.buildContextVariable(e.occurredAt,u.DATE)),t}getOrganisationContextVariables(e){const t={};return t.orgunit_code=this.buildContextVariable(null===e||void 0===e?void 0:e.code,u.TEXT),t}getConstantVariables(e){return e?e.reduce((e,t)=>(e[t.id]=this.buildVariable(t.value,u.INTEGER,{variablePrefix:N}),e),{}):{}}}b(D,"dateUtils",void 0);const V=e=>t=>({...t,message:e});function L(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}class G{constructor(e){L(this,"converterObject",void 0),this.converterObject=e,this.processValue=this.processValue.bind(this)}processValue(e,t){if(!u[t])return i().warn(G.errorMessages.TYPE_NOT_SUPPORTED),"";const r=c[t];if(!r)return i().warn(V(G.errorMessages.CONVERTER_NOT_FOUND)({type:t})),e;const n=this.converterObject[r]?this.converterObject[r](e):e;return null!==n&&void 0!==n?n:null}}L(G,"errorMessages",{TYPE_NOT_SUPPORTED:"value type not supported",CONVERTER_NOT_FOUND:"converter for type is missing"});const U=["number","boolean"],M=e=>{const t=null!=e?e:"",r=typeof t;return"string"===r?`"${t.replace(/"/g,"'")}"`:U.includes(r)?t.toString():(!1).toString()},C=(e,t)=>{if(!e.includes("{"))return e;const r=(e=>{const t=new RegExp(`(${["d2:hasValue","d2:lastEventDate","d2:count","d2:countIfZeroPos","d2:countIfValue"].join("|")})\\( *([A#CV]{[\\w -_]+})( *, *(([\\d/\\*\\+\\-%. ]+)|'[^']*'|"[^"]*"))* *\\)`,"g");return(e.match(t)||[]).reduce((e,t)=>{const r=t.replace("#{","'").replace("A{","'").replace("C{","'").replace("V{","'").replace("}","'");return e.replace(t,r)},e)})(e);if(!r.includes("{"))return r;return(r.match(/[A#CV]\{[\w -_]+}/g)||[]).reduce((e,r)=>{const n=r.replace("#{","").replace("A{","").replace("C{","").replace("V{","").replace("}",""),a=t[n];return a?e.replace(r,M(a.variableValue)):(s=e,o=n,i().warn(`Expression ${s} contains context variable ${o} \n- but this variable is not defined.`),e.replace(r,M("")));var s,o},r)};function x(e){return new Function(`"use strict";return ${e.replace(/\n/g,"\\n")}`)()}const H=({dhisFunctionsObject:e,applicableDhisFunctions:t},{expression:r,expressionModuloStrings:n},i)=>{const a="d2:",s=t.filter(({name:e})=>n.includes(`${a+e}(`));if(!s.length)return x(r);const o=s.map(({name:e})=>e).join("|"),E=new RegExp(`\\b${a}(?:${o})\\(`,"g"),l=[...r.matchAll(E)],{accExpression:u,currentExpressionIndex:c}=l.reduce(({accExpression:t,currentExpressionIndex:o},E)=>{if(E.index<o)return{accExpression:t,currentExpressionIndex:o};t+=r.substring(o,E.index);const{args:l,closingIndex:u}=((e,t,r)=>{const{argIndexes:n,closingIndex:i}=((e,t,r)=>{let n=t.indexOf("(",r)+1,i=n,a=1;const s=[];for(;n<e.length;n+=1)if("("===t[n])a+=1;else if(")"===t[n]){if(a-=1,0===a){s.push([i,n]);break}}else 1===a&&","===t[n]&&(s.push([i,n]),i=n+1);return{argIndexes:s,closingIndex:n}})(e,t,r);return{args:n.map(([r,n])=>({argument:e.substring(r,n),argumentModuloStrings:t.substring(r,n)})),closingIndex:i}})(r,n,E.index),c=l.map(({argument:t,argumentModuloStrings:r})=>H({dhisFunctionsObject:e,applicableDhisFunctions:s},{expression:t,expressionModuloStrings:r},i)),d=((e,t)=>e.substring(t.length,e.length-1))(E[0],a),T=e[d];if(((e,t)=>{if(e){const r=t.length||0;return"number"===typeof e?r!==e:r<e.min||e.max<r}return!1})(T.parameters,c))i(`${d} was not passed valid arguments`,r),t+="false";else{const e=T.execute(c);t+=M(e)}return{accExpression:t,currentExpressionIndex:u+1}},{accExpression:"",currentExpressionIndex:0});return x(u+r.substring(c,r.length))},w=({expression:e,dhisFunctions:t,variablesHash:r,flags:n={verbose:!1},onError:i,onVerboseLog:a})=>{const s=C(e,r);let o=!1;try{const e=s.replace(/'[^']*'|"[^"]*"/g,e=>" ".repeat(e.length)),r=Object.entries(t).map(([e,t])=>({...t,name:e}));o=H({dhisFunctionsObject:t,applicableDhisFunctions:r},((e,t)=>{const r=t.split(/\n+/g);return{expression:r.reduce(({reducedExpression:e,remainder:t},r)=>({reducedExpression:e+=(t=t.replace(/^\n*/,"")).substring(0,r.length),remainder:t.substring(r.length)}),{reducedExpression:"",remainder:e}).reducedExpression,expressionModuloStrings:r.join("")}})(s,e),i),n.verbose&&a(s,o)}catch(E){i(E.message,s,o)}return o},F={male:1,MALE:1,Male:1,ma:1,m:1,M:1,0:1,false:1},Y={0:[2,2.4,2.8,3.2,3.7,4.2,4.8],1:[2.7,3.2,3.6,4.2,4.8,5.5,6.2],2:[3.4,3.9,4.5,5.1,5.8,6.6,7.5],3:[4,4.5,5.2,5.8,6.6,7.5,8.5],4:[4.4,5,5.7,6.4,7.3,8.2,9.3],5:[4.8,5.4,6.1,6.9,7.8,8.8,10],6:[5.1,5.7,6.5,7.3,8.2,9.3,10.6],7:[5.3,6,6.8,7.6,8.6,9.8,11.1],8:[5.6,6.3,7,7.9,9,10.2,11.6],9:[5.8,6.5,7.3,8.2,9.3,10.5,12],10:[5.9,6.7,7.5,8.5,9.6,10.9,12.4],11:[6.1,6.9,7.7,8.7,9.9,11.2,12.8],12:[6.3,7,7.9,8.9,10.1,11.5,13.1],13:[6.4,7.2,8.1,9.2,10.4,11.8,13.5],14:[6.6,7.4,8.3,9.4,10.6,12.1,13.8],15:[6.7,7.6,8.5,9.6,10.9,12.4,14.1],16:[6.9,7.7,8.7,9.8,11.1,12.6,14.5],17:[7,7.9,8.9,10,11.4,12.9,14.8],18:[7.2,8.1,9.1,10.2,11.6,13.2,15.1],19:[7.3,8.2,9.2,10.4,11.8,13.5,15.4],20:[7.5,8.4,9.4,10.6,12.1,13.7,15.7],21:[7.6,8.6,9.6,10.9,12.3,14,16],22:[7.8,8.7,9.8,11.1,12.5,14.3,16.4],23:[7.9,8.9,10,11.3,12.8,14.6,16.7],24:[8.1,9,10.2,11.5,13,14.8,17],25:[8.2,9.2,10.3,11.7,13.3,15.1,17.3],26:[8.4,9.4,10.5,11.9,13.5,15.4,17.7],27:[8.5,9.5,10.7,12.1,13.7,15.7,18],28:[8.6,9.7,10.9,12.3,14,16,18.3],29:[8.8,9.8,11.1,12.5,14.2,16.2,18.7],30:[8.9,10,11.2,12.7,14.4,16.5,19],31:[9,10.1,11.4,12.9,14.7,16.8,19.3],32:[9.1,10.3,11.6,13.1,14.9,17.1,19.6],33:[9.3,10.4,11.7,13.3,15.1,17.3,20],34:[9.4,10.5,11.9,13.5,15.4,17.6,20.3],35:[9.5,10.7,12,13.7,15.6,17.9,20.6],36:[9.6,10.8,12.2,13.9,15.8,18.1,20.9],37:[9.7,10.9,12.4,14,16,18.4,21.3],38:[9.8,11.1,12.5,14.2,16.3,18.7,21.6],39:[9.9,11.2,12.7,14.4,16.5,19,22],40:[10.1,11.3,12.8,14.6,16.7,19.2,22.3],41:[10.2,11.5,13,14.8,16.9,19.5,22.7],42:[10.3,11.6,13.1,15,17.2,19.8,23],43:[10.4,11.7,13.3,15.2,17.4,20.1,23.4],44:[10.5,11.8,13.4,15.3,17.6,20.4,23.7],45:[10.6,12,13.6,15.5,17.8,20.7,24.1],46:[10.7,12.1,13.7,15.7,18.1,20.9,24.5],47:[10.8,12.2,13.9,15.9,18.3,21.2,24.8],48:[10.9,12.3,14,16.1,18.5,21.5,25.2],49:[11,12.4,14.2,16.3,18.8,21.8,25.5],50:[11.1,12.6,14.3,16.4,19,22.1,25.9],51:[11.2,12.7,14.5,16.6,19.2,22.4,26.3],52:[11.3,12.8,14.6,16.8,19.4,22.6,26.6],53:[11.4,12.9,14.8,17,19.7,22.9,27],54:[11.5,13,14.9,17.2,19.9,23.2,27.4],55:[11.6,13.2,15.1,17.3,20.1,23.5,27.7],56:[11.7,13.3,15.2,17.5,20.3,23.8,28.1],57:[11.8,13.4,15.3,17.7,20.6,24.1,28.5],58:[11.9,13.5,15.5,17.9,20.8,24.4,28.8],59:[12,13.6,15.6,18,21,24.6,29.2],60:[12.1,13.7,15.8,18.2,21.2,24.9,29.5]},k={0:[2.1,2.5,2.9,3.3,3.9,4.4,5],1:[2.9,3.4,3.9,4.5,5.1,5.8,6.6],2:[3.8,4.3,4.9,5.6,6.3,7.1,8],3:[4.4,5,5.7,6.4,7.2,8,9],4:[4.9,5.6,6.2,7,7.8,8.7,9.7],5:[5.3,6,6.7,7.5,8.4,9.3,10.4],6:[5.7,6.4,7.1,7.9,8.8,9.8,10.9],7:[5.9,6.7,7.4,8.3,9.2,10.3,11.4],8:[6.2,6.9,7.7,8.6,9.6,10.7,11.9],9:[6.4,7.1,8,8.9,9.9,11,12.3],10:[6.6,7.4,8.2,9.2,10.2,11.4,12.7],11:[6.8,7.6,8.4,9.4,10.5,11.7,13],12:[6.9,7.7,8.6,9.6,10.8,12,13.3],13:[7.1,7.9,8.8,9.9,11,12.3,13.7],14:[7.2,8.1,9,10.1,11.3,12.6,14],15:[7.4,8.3,9.2,10.3,11.5,12.8,14.3],16:[7.5,8.4,9.4,10.5,11.7,13.1,14.6],17:[7.7,8.6,9.6,10.7,12,13.4,14.9],18:[7.8,8.8,9.8,10.9,12.2,13.7,15.3],19:[8,8.9,10,11.1,12.5,13.9,15.6],20:[8.1,9.1,10.1,11.3,12.7,14.2,15.9],21:[8.2,9.2,10.3,11.5,12.9,14.5,16.2],22:[8.4,9.4,10.5,11.8,13.2,14.7,16.5],23:[8.5,9.5,10.7,12,13.4,15,16.8],24:[8.6,9.7,10.8,12.2,13.6,15.3,17.1],25:[8.8,9.8,11,12.4,13.9,15.5,17.5],26:[8.9,10,11.2,12.5,14.1,15.8,17.8],27:[9,10.1,11.3,12.7,14.3,16.1,18.1],28:[9.1,10.2,11.5,12.9,14.5,16.3,18.4],29:[9.2,10.4,11.7,13.1,14.8,16.6,18.7],30:[9.4,10.5,11.8,13.3,15,16.9,19],31:[9.5,10.7,12,13.5,15.2,17.1,19.3],32:[9.6,10.8,12.1,13.7,15.4,17.4,19.6],33:[9.7,10.9,12.3,13.8,15.6,17.6,19.9],34:[9.8,11,12.4,14,15.8,17.8,20.2],35:[9.9,11.2,12.6,14.2,16,18.1,20.4],36:[10,11.3,12.7,14.3,16.2,18.3,20.7],37:[10.1,11.4,12.9,14.5,16.4,18.6,21],38:[10.2,11.5,13,14.7,16.6,18.8,21.3],39:[10.3,11.6,13.1,14.8,16.8,19,21.6],40:[10.4,11.8,13.3,15,17,19.3,21.9],41:[10.5,11.9,13.4,15.2,17.2,19.5,22.1],42:[10.6,12,13.6,15.3,17.4,19.7,22.4],43:[10.7,12.1,13.7,15.5,17.6,20,22.7],44:[10.8,12.2,13.8,15.7,17.8,20.2,23],45:[10.9,12.4,14,15.8,18,20.5,23.3],46:[11,12.5,14.1,16,18.2,20.7,23.6],47:[11.1,12.6,14.3,16.2,18.4,20.9,23.9],48:[11.2,12.7,14.4,16.3,18.6,21.2,24.2],49:[11.3,12.8,14.5,16.5,18.8,21.4,24.5],50:[11.4,12.9,14.7,16.7,19,21.7,24.8],51:[11.5,13.1,14.8,16.8,19.2,21.9,25.1],52:[11.6,13.2,15,17,19.4,22.2,25.4],53:[11.7,13.3,15.1,17.2,19.6,22.4,25.7],54:[11.8,13.4,15.2,17.3,19.8,22.7,26],55:[11.9,13.5,15.4,17.5,20,22.9,26.3],56:[12,13.6,15.5,17.7,20.2,23.2,26.6],57:[12.1,13.7,15.6,17.8,20.4,23.4,26.9],58:[12.2,13.8,15.8,18,20.6,23.7,27.2],59:[12.3,14,15.9,18.2,20.8,23.9,27.6],60:[12.4,14.1,16,18.3,21,24.2,27.9]},W={45:[1.902,2.066,2.252,2.461,2.698,2.967,3.275],45.5:[1.967,2.138,2.329,2.546,2.791,3.07,3.389],46:[2.033,2.209,2.407,2.631,2.884,3.172,3.502],46.5:[2.098,2.28,2.485,2.716,2.977,3.275,3.616],47:[2.164,2.351,2.562,2.801,3.071,3.378,3.73],47.5:[2.23,2.423,2.641,2.887,3.165,3.482,3.845],48:[2.297,2.497,2.721,2.974,3.261,3.588,3.962],48.5:[2.366,2.571,2.803,3.064,3.359,3.696,4.082],49:[2.437,2.649,2.887,3.156,3.461,3.808,4.205],49.5:[2.511,2.729,2.975,3.252,3.566,3.924,4.334],50:[2.588,2.813,3.066,3.352,3.676,4.045,4.467],50.5:[2.668,2.9,3.161,3.456,3.79,4.171,4.606],51:[2.75,2.99,3.259,3.564,3.908,4.301,4.751],51.5:[2.836,3.084,3.362,3.675,4.031,4.437,4.901],52:[2.925,3.18,3.467,3.791,4.158,4.577,5.056],52.5:[3.017,3.28,3.576,3.91,4.29,4.721,5.216],53:[3.112,3.383,3.688,4.033,4.424,4.87,5.38],53.5:[3.208,3.488,3.803,4.159,4.563,5.022,5.549],54:[3.307,3.596,3.921,4.288,4.704,5.178,5.721],54.5:[3.407,3.705,4.04,4.418,4.847,5.336,5.896],55:[3.508,3.815,4.16,4.55,4.992,5.496,6.073],55.5:[3.611,3.926,4.281,4.683,5.138,5.657,6.251],56:[3.713,4.038,4.403,4.816,5.285,5.818,6.43],56.5:[3.816,4.15,4.526,4.95,5.432,5.98,6.609],57:[3.919,4.262,4.648,5.084,5.579,6.143,6.789],57.5:[4.021,4.373,4.77,5.217,5.725,6.304,6.968],58:[4.124,4.485,4.891,5.351,5.872,6.466,7.146],58.5:[4.226,4.596,5.013,5.483,6.018,6.626,7.324],59:[4.327,4.706,5.133,5.615,6.162,6.786,7.5],59.5:[4.427,4.815,5.252,5.745,6.305,6.944,7.675],60:[4.527,4.923,5.37,5.874,6.447,7.099,7.847],60.5:[4.624,5.03,5.486,6.001,6.586,7.253,8.017],61:[4.721,5.135,5.601,6.127,6.724,7.405,8.185],61.5:[4.817,5.239,5.714,6.251,6.86,7.555,8.351],62:[4.912,5.342,5.826,6.374,6.995,7.703,8.514],62.5:[5.005,5.444,5.937,6.495,7.128,7.849,8.675],63:[5.098,5.544,6.047,6.614,7.259,7.993,8.834],63.5:[5.189,5.644,6.155,6.733,7.388,8.136,8.992],64:[5.28,5.742,6.262,6.85,7.517,8.277,9.148],64.5:[5.37,5.84,6.369,6.966,7.644,8.417,9.302],65:[5.459,5.937,6.474,7.081,7.77,8.555,9.454],65.5:[5.547,6.033,6.578,7.195,7.895,8.692,9.605],66:[5.635,6.128,6.682,7.308,8.018,8.827,9.753],66.5:[5.721,6.221,6.784,7.419,8.139,8.96,9.901],67:[5.807,6.314,6.885,7.529,8.26,9.092,10.046],67.5:[5.892,6.406,6.984,7.638,8.378,9.222,10.189],68:[5.975,6.497,7.083,7.745,8.496,9.351,10.33],68.5:[6.058,6.586,7.18,7.851,8.611,9.478,10.47],69:[6.14,6.675,7.277,7.956,8.726,9.603,10.608],69.5:[6.221,6.763,7.372,8.06,8.84,9.728,10.745],70:[6.302,6.85,7.467,8.163,8.952,9.851,10.88],70.5:[6.382,6.937,7.561,8.265,9.064,9.973,11.014],71:[6.461,7.023,7.654,8.367,9.174,10.094,11.147],71.5:[6.54,7.108,7.747,8.468,9.285,10.215,11.279],72:[6.619,7.193,7.839,8.568,9.394,10.334,11.41],72.5:[6.697,7.278,7.931,8.667,9.502,10.453,11.54],73:[6.774,7.361,8.021,8.766,9.61,10.571,11.669],73.5:[6.851,7.444,8.111,8.864,9.716,10.687,11.797],74:[6.927,7.526,8.2,8.96,9.821,10.801,11.922],74.5:[7.001,7.607,8.287,9.055,9.925,10.915,12.046],75:[7.075,7.687,8.374,9.149,10.027,11.026,12.168],75.5:[7.148,7.766,8.459,9.242,10.128,11.136,12.289],76:[7.221,7.844,8.544,9.334,10.228,11.246,12.408],76.5:[7.293,7.922,8.628,9.425,10.328,11.354,12.527],77:[7.365,7.999,8.712,9.517,10.427,11.463,12.646],77.5:[7.437,8.078,8.797,9.609,10.527,11.572,12.765],78:[7.511,8.157,8.883,9.702,10.628,11.682,12.886],78.5:[7.585,8.237,8.97,9.796,10.731,11.794,13.008],79:[7.66,8.319,9.058,9.892,10.835,11.907,13.132],79.5:[7.737,8.402,9.148,9.989,10.941,12.023,13.26],80:[7.816,8.487,9.24,10.089,11.05,12.142,13.389],80.5:[7.897,8.574,9.335,10.192,11.161,12.264,13.523],81:[7.979,8.663,9.431,10.296,11.276,12.388,13.659],81.5:[8.064,8.755,9.53,10.404,11.393,12.517,13.8],82:[8.15,8.848,9.631,10.514,11.513,12.647,13.943],82.5:[8.238,8.943,9.735,10.626,11.635,12.781,14.09],83:[8.328,9.04,9.84,10.741,11.76,12.918,14.24],83.5:[8.419,9.139,9.947,10.858,11.888,13.058,14.393],84:[8.512,9.24,10.057,10.977,12.017,13.2,14.549],84.5:[8.606,9.342,10.167,11.097,12.149,13.344,14.708],85:[8.702,9.445,10.28,11.22,12.283,13.491,14.869],85.5:[8.798,9.55,10.393,11.344,12.418,13.639,15.033],86:[8.895,9.655,10.508,11.468,12.555,13.789,15.197],86.5:[8.993,9.761,10.623,11.594,12.692,13.94,15.363],87:[9.227,10.015,10.9,11.896,13.024,14.304,15.765],87.5:[9.324,10.121,11.015,12.022,13.161,14.455,15.932],88:[9.421,10.226,11.13,12.148,13.299,14.607,16.099],88.5:[9.518,10.331,11.244,12.273,13.436,14.758,16.266],89:[9.614,10.436,11.358,12.398,13.573,14.909,16.433],89.5:[9.709,10.54,11.472,12.522,13.71,15.059,16.6],90:[9.805,10.644,11.585,12.646,13.846,15.21,16.767],90.5:[9.9,10.747,11.698,12.77,13.983,15.36,16.933],91:[9.994,10.85,11.811,12.894,14.119,15.511,17.1],91.5:[10.089,10.953,11.924,13.018,14.255,15.662,17.267],92:[10.183,11.056,12.037,13.142,14.392,15.813,17.435],92.5:[10.277,11.159,12.149,13.265,14.528,15.964,17.603],93:[10.372,11.262,12.262,13.39,14.665,16.116,17.772],93.5:[10.466,11.366,12.376,13.514,14.803,16.268,17.942],94:[10.561,11.469,12.489,13.639,14.941,16.421,18.112],94.5:[10.656,11.573,12.603,13.765,15.08,16.576,18.284],95:[10.751,11.678,12.718,13.891,15.22,16.731,18.457],95.5:[10.847,11.783,12.833,14.019,15.361,16.887,18.632],96:[10.943,11.888,12.949,14.147,15.502,17.045,18.808],96.5:[11.04,11.994,13.066,14.276,15.646,17.204,18.986],97:[11.137,12.101,13.184,14.406,15.79,17.365,19.166],97.5:[11.236,12.209,13.303,14.538,15.936,17.528,19.349],98:[11.336,12.319,13.424,14.671,16.084,17.693,19.533],98.5:[11.436,12.429,13.546,14.806,16.235,17.861,19.721],99:[11.538,12.542,13.67,14.943,16.387,18.031,19.913],99.5:[11.642,12.655,13.796,15.083,16.542,18.205,20.107],100:[11.747,12.771,13.924,15.225,16.7,18.381,20.305],100.5:[11.854,12.889,14.053,15.369,16.861,18.561,20.507],101:[11.962,13.008,14.186,15.515,17.024,18.743,20.712],101.5:[12.072,13.13,14.32,15.665,17.19,18.93,20.922],102:[12.184,13.253,14.457,15.816,17.36,19.119,21.136],102.5:[12.298,13.379,14.596,15.971,17.532,19.312,21.352],103:[12.414,13.506,14.737,16.128,17.707,19.508,21.574],103.5:[12.531,13.636,14.88,16.287,17.885,19.708,21.799],104:[12.65,13.767,15.026,16.449,18.066,19.911,22.027],104.5:[12.77,13.9,15.173,16.613,18.249,20.117,22.26],105:[12.893,14.035,15.323,16.78,18.436,20.326,22.496],105.5:[13.017,14.173,15.475,16.95,18.626,20.54,22.737],106:[13.143,14.312,15.63,17.122,18.818,20.756,22.982],106.5:[13.271,14.454,15.787,17.297,19.015,20.977,23.231],107:[13.401,14.598,15.947,17.476,19.214,21.202,23.485],107.5:[13.533,14.744,16.11,17.657,19.417,21.43,23.743],108:[13.667,14.892,16.275,17.841,19.623,21.662,24.006],108.5:[13.803,15.043,16.442,18.028,19.833,21.898,24.273],109:[13.942,15.196,16.612,18.217,20.046,22.138,24.544],109.5:[14.081,15.351,16.784,18.41,20.261,22.38,24.819],110:[14.223,15.508,16.959,18.604,20.479,22.626,25.098],110.5:[14.366,15.666,17.135,18.802,20.701,22.876,25.381],111:[14.511,15.827,17.314,19.001,20.924,23.128,25.666],111.5:[14.657,15.989,17.494,19.202,21.151,23.383,25.956],112:[14.804,16.152,17.676,19.406,21.379,23.642,26.249],112.5:[14.953,16.317,17.86,19.612,21.61,23.902,26.545],113:[15.103,16.484,18.045,19.819,21.843,24.165,26.843],113.5:[15.254,16.652,18.232,20.028,22.078,24.43,27.144],114:[15.406,16.82,18.42,20.238,22.315,24.698,27.448],114.5:[15.559,16.99,18.609,20.45,22.553,24.967,27.754],115:[15.712,17.16,18.799,20.663,22.792,25.238,28.061],115.5:[15.866,17.331,18.99,20.877,23.033,25.51,28.371],116:[16.021,17.503,19.181,21.091,23.274,25.783,28.681],116.5:[16.175,17.674,19.373,21.306,23.516,26.057,28.993],117:[16.329,17.846,19.565,21.521,23.759,26.332,29.307],117.5:[16.484,18.018,19.757,21.737,24.002,26.607,29.621],118:[16.639,18.19,19.95,21.953,24.246,26.883,29.935],118.5:[16.794,18.363,20.142,22.169,24.489,27.16,30.25],119:[16.948,18.534,20.334,22.385,24.734,27.437,30.567],119.5:[17.102,18.706,20.527,22.601,24.977,27.714,30.883],120:[17.256,18.878,20.719,22.817,25.222,27.991,31.199]},B={45:[1.877,2.043,2.23,2.441,2.68,2.951,3.261],45.5:[1.942,2.114,2.307,2.524,2.771,3.05,3.37],46:[2.008,2.185,2.384,2.608,2.861,3.149,3.477],46.5:[2.074,2.256,2.461,2.691,2.952,3.248,3.585],47:[2.141,2.328,2.539,2.776,3.043,3.347,3.694],47.5:[2.208,2.401,2.617,2.861,3.136,3.448,3.804],48:[2.277,2.476,2.698,2.948,3.231,3.551,3.916],48.5:[2.349,2.552,2.781,3.038,3.328,3.657,4.031],49:[2.422,2.632,2.867,3.131,3.429,3.766,4.151],49.5:[2.499,2.715,2.956,3.228,3.534,3.881,4.275],50:[2.579,2.801,3.049,3.328,3.642,3.999,4.403],50.5:[2.661,2.889,3.144,3.431,3.754,4.12,4.536],51:[2.746,2.981,3.243,3.538,3.87,4.245,4.672],51.5:[2.834,3.075,3.345,3.648,3.989,4.375,4.813],52:[2.925,3.173,3.451,3.762,4.113,4.509,4.958],52.5:[3.02,3.276,3.561,3.881,4.242,4.649,5.111],53:[3.12,3.383,3.677,4.006,4.377,4.795,5.27],53.5:[3.223,3.494,3.796,4.135,4.517,4.947,5.434],54:[3.33,3.609,3.921,4.269,4.661,5.104,5.605],54.5:[3.44,3.727,4.048,4.407,4.81,5.264,5.779],55:[3.553,3.848,4.178,4.547,4.961,5.428,5.957],55.5:[3.667,3.971,4.31,4.689,5.115,5.595,6.138],56:[3.783,4.095,4.444,4.834,5.271,5.764,6.322],56.5:[3.9,4.221,4.579,4.98,5.429,5.935,6.506],57:[4.017,4.347,4.715,5.126,5.587,6.106,6.692],57.5:[4.135,4.474,4.851,5.272,5.745,6.276,6.877],58:[4.252,4.599,4.986,5.418,5.902,6.447,7.061],58.5:[4.369,4.725,5.121,5.563,6.059,6.616,7.245],59:[4.485,4.849,5.255,5.707,6.214,6.784,7.427],59.5:[4.6,4.973,5.387,5.85,6.368,6.951,7.607],60:[4.713,5.094,5.518,5.991,6.52,7.115,7.785],60.5:[4.824,5.213,5.646,6.128,6.669,7.275,7.959],61:[4.932,5.329,5.771,6.263,6.814,7.433,8.13],61.5:[5.039,5.443,5.893,6.395,6.957,7.587,8.297],62:[5.143,5.555,6.014,6.525,7.097,7.739,8.462],62.5:[5.245,5.665,6.132,6.653,7.235,7.888,8.624],63:[5.346,5.774,6.249,6.779,7.371,8.035,8.784],63.5:[5.445,5.88,6.364,6.903,7.505,8.181,8.942],64:[5.544,5.986,6.478,7.026,7.638,8.325,9.098],64.5:[5.64,6.09,6.59,7.147,7.769,8.467,9.253],65:[5.736,6.193,6.701,7.267,7.899,8.608,9.406],65.5:[5.83,6.295,6.811,7.385,8.028,8.748,9.558],66:[5.924,6.396,6.92,7.503,8.156,8.887,9.71],66.5:[6.017,6.496,7.028,7.621,8.283,9.026,9.861],67:[6.109,6.595,7.135,7.737,8.409,9.163,10.011],67.5:[6.2,6.694,7.242,7.853,8.535,9.3,10.161],68:[6.291,6.791,7.348,7.967,8.66,9.436,10.31],68.5:[6.38,6.888,7.453,8.082,8.784,9.572,10.459],69:[6.47,6.985,7.558,8.196,8.908,9.708,10.607],69.5:[6.559,7.081,7.662,8.309,9.032,9.843,10.756],70:[6.647,7.177,7.766,8.423,9.156,9.979,10.905],70.5:[6.735,7.273,7.87,8.536,9.28,10.114,11.053],71:[6.823,7.368,7.973,8.648,9.402,10.248,11.201],71.5:[6.909,7.462,8.075,8.759,9.524,10.382,11.348],72:[6.995,7.555,8.177,8.87,9.645,10.514,11.493],72.5:[7.08,7.647,8.277,8.979,9.764,10.645,11.637],73:[7.163,7.737,8.375,9.086,9.882,10.774,11.78],73.5:[7.246,7.827,8.473,9.193,9.998,10.902,11.92],74:[7.327,7.915,8.568,9.297,10.113,11.028,12.059],74.5:[7.407,8.002,8.663,9.401,10.226,11.152,12.195],75:[7.486,8.088,8.757,9.503,10.338,11.275,12.33],75.5:[7.565,8.173,8.85,9.604,10.448,11.396,12.464],76:[7.641,8.257,8.94,9.703,10.557,11.515,12.595],76.5:[7.717,8.339,9.03,9.801,10.663,11.632,12.723],77:[7.792,8.42,9.118,9.896,10.768,11.746,12.848],77.5:[7.865,8.499,9.204,9.99,10.87,11.858,12.972],78:[7.938,8.578,9.289,10.083,10.971,11.968,13.092],78.5:[8.01,8.655,9.373,10.174,11.07,12.077,13.211],79:[8.082,8.733,9.457,10.265,11.169,12.184,13.328],79.5:[8.154,8.811,9.541,10.356,11.267,12.291,13.445],80:[8.227,8.89,9.626,10.448,11.367,12.399,13.561],80.5:[8.302,8.97,9.712,10.54,11.467,12.507,13.679],81:[8.379,9.052,9.8,10.635,11.569,12.617,13.798],81.5:[8.457,9.136,9.891,10.732,11.673,12.73,13.92],82:[8.538,9.223,9.984,10.832,11.781,12.845,14.044],82.5:[8.623,9.313,10.08,10.935,11.891,12.964,14.172],83:[8.71,9.406,10.179,11.042,12.005,13.086,14.303],83.5:[8.8,9.503,10.282,11.152,12.123,13.213,14.439],84:[8.894,9.602,10.389,11.265,12.244,13.342,14.578],84.5:[8.99,9.705,10.498,11.382,12.369,13.476,14.721],85:[9.088,9.809,10.61,11.501,12.496,13.612,14.866],85.5:[9.189,9.916,10.723,11.622,12.625,13.75,15.014],86:[9.29,10.024,10.838,11.744,12.756,13.89,15.163],86.5:[9.392,10.133,10.954,11.868,12.888,14.03,15.314],87:[9.637,10.393,11.232,12.164,13.205,14.37,15.677],87.5:[9.738,10.501,11.347,12.287,13.336,14.51,15.828],88:[9.838,10.607,11.46,12.409,13.467,14.65,15.979],88.5:[9.937,10.713,11.573,12.53,13.597,14.79,16.129],89:[10.034,10.817,11.685,12.65,13.725,14.928,16.278],89.5:[10.13,10.92,11.795,12.768,13.853,15.066,16.428],90:[10.226,11.022,11.905,12.886,13.98,15.204,16.576],90.5:[10.32,11.123,12.014,13.004,14.107,15.341,16.725],91:[10.414,11.224,12.123,13.121,14.234,15.478,16.874],91.5:[10.507,11.324,12.231,13.238,14.36,15.615,17.024],92:[10.599,11.424,12.338,13.354,14.487,15.753,17.174],92.5:[10.691,11.523,12.445,13.47,14.613,15.891,17.325],93:[10.782,11.622,12.552,13.587,14.74,16.03,17.477],93.5:[10.873,11.721,12.66,13.704,14.868,16.17,17.63],94:[10.964,11.82,12.768,13.822,14.997,16.311,17.786],94.5:[11.056,11.919,12.876,13.94,15.127,16.454,17.943],95:[11.148,12.02,12.986,14.06,15.258,16.598,18.103],95.5:[11.241,12.121,13.096,14.181,15.391,16.745,18.265],96:[11.334,12.223,13.208,14.304,15.526,16.894,18.43],96.5:[11.428,12.326,13.321,14.428,15.663,17.046,18.599],97:[11.524,12.43,13.436,14.555,15.803,17.201,18.771],97.5:[11.62,12.536,13.552,14.683,15.946,17.359,18.948],98:[11.718,12.644,13.671,14.814,16.09,17.52,19.127],98.5:[11.817,12.752,13.791,14.947,16.238,17.684,19.311],99:[11.917,12.863,13.913,15.082,16.388,17.852,19.498],99.5:[12.018,12.974,14.036,15.219,16.54,18.022,19.688],100:[12.12,13.087,14.161,15.358,16.695,18.195,19.883],100.5:[12.224,13.201,14.288,15.498,16.852,18.371,20.081],101:[12.328,13.317,14.416,15.641,17.012,18.55,20.282],101.5:[12.433,13.433,14.545,15.786,17.173,18.731,20.487],102:[12.539,13.551,14.676,15.932,17.337,18.915,20.694],102.5:[12.647,13.67,14.809,16.08,17.503,19.102,20.904],103:[12.755,13.791,14.943,16.23,17.671,19.291,21.118],103.5:[12.865,13.912,15.079,16.381,17.841,19.482,21.334],104:[12.975,14.035,15.215,16.534,18.013,19.675,21.553],104.5:[13.086,14.159,15.353,16.689,18.186,19.871,21.775],105:[13.198,14.283,15.493,16.845,18.362,20.07,22],105.5:[13.312,14.41,15.634,17.004,18.54,20.271,22.227],106:[13.426,14.537,15.777,17.164,18.721,20.475,22.458],106.5:[13.542,14.667,15.921,17.326,18.903,20.68,22.692],107:[13.658,14.797,16.067,17.489,19.088,20.89,22.93],107.5:[13.776,14.928,16.214,17.655,19.274,21.101,23.17],108:[13.895,15.061,16.363,17.823,19.464,21.316,23.415],108.5:[14.015,15.195,16.514,17.992,19.655,21.533,23.662],109:[14.137,15.332,16.667,18.164,19.85,21.754,23.913],109.5:[14.26,15.47,16.822,18.339,20.047,21.978,24.169],110:[14.385,15.609,16.979,18.516,20.247,22.205,24.428],110.5:[14.511,15.751,17.138,18.695,20.45,22.435,24.69],111:[14.639,15.894,17.298,18.876,20.655,22.668,24.955],111.5:[14.768,16.038,17.461,19.059,20.862,22.903,25.224],112:[14.898,16.184,17.624,19.244,21.071,23.141,25.496],112.5:[15.029,16.331,17.79,19.43,21.282,23.381,25.77],113:[15.162,16.479,17.957,19.618,21.495,23.623,26.047],113.5:[15.296,16.629,18.125,19.808,21.71,23.868,26.325],114:[15.429,16.779,18.294,19.999,21.927,24.114,26.607],114.5:[15.565,16.931,18.464,20.191,22.144,24.362,26.891],115:[15.7,17.083,18.635,20.385,22.364,24.612,27.176],115.5:[15.836,17.236,18.807,20.579,22.584,24.863,27.463],116:[15.974,17.389,18.98,20.774,22.805,25.115,27.752],116.5:[16.111,17.543,19.153,20.97,23.028,25.368,28.042],117:[16.248,17.697,19.327,21.167,23.251,25.623,28.334],117.5:[16.385,17.852,19.501,21.364,23.475,25.879,28.627],118:[16.523,18.006,19.676,21.561,23.699,26.135,28.921],118.5:[16.66,18.161,19.85,21.759,23.924,26.392,29.216],119:[16.798,18.316,20.025,21.957,24.15,26.65,29.512],119.5:[16.935,18.47,20.199,22.155,24.375,26.908,29.81],120:[17.072,18.624,20.374,22.353,24.601,27.167,30.107]},j={0:[43.6,45.4,47.3,49.1,51,52.9,54.7],1:[47.8,49.8,51.7,53.7,55.6,57.6,59.5],2:[51,53,55,57.1,59.1,61.1,63.2],3:[53.5,55.6,57.7,59.8,61.9,64,66.1],4:[55.6,57.8,59.9,62.1,64.3,66.4,68.6],5:[57.4,59.6,61.8,64,66.2,68.5,70.7],6:[58.9,61.2,63.5,65.7,68,70.3,72.5],7:[60.3,62.7,65,67.3,69.6,71.9,74.2],8:[61.7,64,66.4,68.7,71.1,73.5,75.8],9:[62.9,65.3,67.7,70.1,72.6,75,77.4],10:[64.1,66.5,69,71.5,73.9,76.4,78.9],11:[65.2,67.7,70.3,72.8,75.3,77.8,80.3],12:[66.3,68.9,71.4,74,76.6,79.2,81.7],13:[67.3,70,72.6,75.2,77.8,80.5,83.1],14:[68.3,71,73.7,76.4,79.1,81.7,84.4],15:[69.3,72,74.8,77.5,80.2,83,85.7],16:[70.2,73,75.8,78.6,81.4,84.2,87],17:[71.1,74,76.8,79.7,82.5,85.4,88.2],18:[72,74.9,77.8,80.7,83.6,86.5,89.4],19:[72.8,75.8,78.8,81.7,84.7,87.6,90.6],20:[73.7,76.7,79.7,82.7,85.7,88.7,91.7],21:[74.5,77.5,80.6,83.7,86.7,89.8,92.9],22:[75.2,78.4,81.5,84.6,87.7,90.8,94],23:[76,79.2,82.3,85.5,88.7,91.9,95],24:[76.7,80,83.2,86.4,89.6,92.9,96.1],25:[76.8,80,83.3,86.6,89.9,93.1,96.4],26:[77.5,80.8,84.1,87.4,90.8,94.1,97.4],27:[78.1,81.5,84.9,88.3,91.7,95,98.4],28:[78.8,82.2,85.7,89.1,92.5,96,99.4],29:[79.5,82.9,86.4,89.9,93.4,96.9,100.3],30:[80.1,83.6,87.1,90.7,94.2,97.7,101.3],31:[80.7,84.3,87.9,91.4,95,98.6,102.2],32:[81.3,84.9,88.6,92.2,95.8,99.4,103.1],33:[81.9,85.6,89.3,92.9,96.6,100.3,103.9],34:[82.5,86.2,89.9,93.6,97.4,101.1,104.8],35:[83.1,86.8,90.6,94.4,98.1,101.9,105.6],36:[83.6,87.4,91.2,95.1,98.9,102.7,106.5],37:[84.2,88,91.9,95.7,99.6,103.4,107.3],38:[84.7,88.6,92.5,96.4,100.3,104.2,108.1],39:[85.3,89.2,93.1,97.1,101,105,108.9],40:[85.8,89.8,93.8,97.7,101.7,105.7,109.7],41:[86.3,90.4,94.4,98.4,102.4,106.4,110.5],42:[86.8,90.9,95,99,103.1,107.2,111.2],43:[87.4,91.5,95.6,99.7,103.8,107.9,112],44:[87.9,92,96.2,100.3,104.5,108.6,112.7],45:[88.4,92.5,96.7,100.9,105.1,109.3,113.5],46:[88.9,93.1,97.3,101.5,105.8,110,114.2],47:[89.3,93.6,97.9,102.1,106.4,110.7,114.9],48:[89.8,94.1,98.4,102.7,107,111.3,115.7],49:[90.3,94.6,99,103.3,107.7,112,116.4],50:[90.7,95.1,99.5,103.9,108.3,112.7,117.1],51:[91.2,95.6,100.1,104.5,108.9,113.3,117.7],52:[91.7,96.1,100.6,105,109.5,114,118.4],53:[92.1,96.6,101.1,105.6,110.1,114.6,119.1],54:[92.6,97.1,101.6,106.2,110.7,115.2,119.8],55:[93,97.6,102.2,106.7,111.3,115.9,120.4],56:[93.4,98.1,102.7,107.3,111.9,116.5,121.1],57:[93.9,98.5,103.2,107.8,112.5,117.1,121.8],58:[94.3,99,103.7,108.4,113,117.7,122.4],59:[94.7,99.5,104.2,108.9,113.6,118.3,123.1],60:[95.2,99.9,104.7,109.4,114.2,118.9,123.7]},$={0:[44.2,46.1,48,49.9,51.8,53.7,55.6],1:[48.9,50.8,52.8,54.7,56.7,58.6,60.6],2:[52.4,54.4,56.4,58.4,60.4,62.4,64.4],3:[55.3,57.3,59.4,61.4,63.5,65.5,67.6],4:[57.6,59.7,61.8,63.9,66,68,70.1],5:[59.6,61.7,63.8,65.9,68,70.1,72.2],6:[61.2,63.3,65.5,67.6,69.8,71.9,74],7:[62.7,64.8,67,69.2,71.3,73.5,75.7],8:[64,66.2,68.4,70.6,72.8,75,77.2],9:[65.2,67.5,69.7,72,74.2,76.5,78.7],10:[66.4,68.7,71,73.3,75.6,77.9,80.1],11:[67.6,69.9,72.2,74.5,76.9,79.2,81.5],12:[68.6,71,73.4,75.7,78.1,80.5,82.9],13:[69.6,72.1,74.5,76.9,79.3,81.8,84.2],14:[70.6,73.1,75.6,78,80.5,83,85.5],15:[71.6,74.1,76.6,79.1,81.7,84.2,86.7],16:[72.5,75,77.6,80.2,82.8,85.4,88],17:[73.3,76,78.6,81.2,83.9,86.5,89.2],18:[74.2,76.9,79.6,82.3,85,87.7,90.4],19:[75,77.7,80.5,83.2,86,88.8,91.5],20:[75.8,78.6,81.4,84.2,87,89.8,92.6],21:[76.5,79.4,82.3,85.1,88,90.9,93.8],22:[77.2,80.2,83.1,86,89,91.9,94.9],23:[78,81,83.9,86.9,89.9,92.9,95.9],24:[78,81,84.1,87.1,90.2,93.2,96.3],25:[78.6,81.7,84.9,88,91.1,94.2,97.3],26:[79.3,82.5,85.6,88.8,92,95.2,98.3],27:[79.9,83.1,86.4,89.6,92.9,96.1,99.3],28:[80.5,83.8,87.1,90.4,93.7,97,100.3],29:[81.1,84.5,87.8,91.2,94.5,97.9,101.2],30:[81.7,85.1,88.5,91.9,95.3,98.7,102.1],31:[82.3,85.7,89.2,92.7,96.1,99.6,103],32:[82.8,86.4,89.9,93.4,96.9,100.4,103.9],33:[83.4,86.9,90.5,94.1,97.6,101.2,104.8],34:[83.9,87.5,91.1,94.8,98.4,102,105.6],35:[84.4,88.1,91.8,95.4,99.1,102.7,106.4],36:[85,88.7,92.4,96.1,99.8,103.5,107.2],37:[85.5,89.2,93,96.7,100.5,104.2,108],38:[86,89.8,93.6,97.4,101.2,105,108.8],39:[86.5,90.3,94.2,98,101.8,105.7,109.5],40:[87,90.9,94.7,98.6,102.5,106.4,110.3],41:[87.5,91.4,95.3,99.2,103.2,107.1,111],42:[88,91.9,95.9,99.9,103.8,107.8,111.7],43:[88.4,92.4,96.4,100.4,104.5,108.5,112.5],44:[88.9,93,97,101,105.1,109.1,113.2],45:[89.4,93.5,97.5,101.6,105.7,109.8,113.9],46:[89.8,94,98.1,102.2,106.3,110.4,114.6],47:[90.3,94.4,98.6,102.8,106.9,111.1,115.2],48:[90.7,94.9,99.1,103.3,107.5,111.7,115.9],49:[91.2,95.4,99.7,103.9,108.1,112.4,116.6],50:[91.6,95.9,100.2,104.4,108.7,113,117.3],51:[92.1,96.4,100.7,105,109.3,113.6,117.9],52:[92.5,96.9,101.2,105.6,109.9,114.2,118.6],53:[93,97.4,101.7,106.1,110.5,114.9,119.2],54:[93.4,97.8,102.3,106.7,111.1,115.5,119.9],55:[93.9,98.3,102.8,107.2,111.7,116.1,120.6],56:[94.3,98.8,103.3,107.8,112.3,116.7,121.2],57:[94.7,99.3,103.8,108.3,112.8,117.4,121.9],58:[95.2,99.7,104.3,108.9,113.4,118,122.6],59:[95.6,100.2,104.8,109.4,114,118.6,123.2],60:[96.1,100.7,105.3,110,114.6,119.2,123.9]},X=(e,t,r)=>{const n=r[Number(e)];if(t<n[0])return-3.5;if(t>n[6])return 3.5;const i=((e,t)=>{let r,n;for(let i=0;i<7;i++)if(!(e>=t[i]&&(r=i,e>t[i]))){n=i;break}return{lowerLimitIn:r,higherLimitIn:n}})(t,n),a=i.higherLimitIn,s=i.lowerLimitIn,o=n[a]-n[s],E=n[a]-t;return(a-3-(o>0?E/o:0)).toFixed(2)},K=new Map;K.set("GS1_E0_IDENTIFIER","]E0"),K.set("GS1_E1_IDENTIFIER","]E1"),K.set("GS1_E2_IDENTIFIER","]E2"),K.set("GS1_E3_IDENTIFIER","]E3"),K.set("GS1_E4_IDENTIFIER","]E4"),K.set("GS1_I1_IDENTIFIER","]I1"),K.set("GS1_C1_IDENTIFIER","]C1"),K.set("GS1_e0_IDENTIFIER","]e0"),K.set("GS1_e1_IDENTIFIER","]e1"),K.set("GS1_e2_IDENTIFIER","]e2"),K.set("GS1_d2_IDENTIFIER","]d2"),K.set("GS1_Q3_IDENTIFIER","]Q3"),K.set("GS1_J1_IDENTIFIER","]J1"),K.set("GS1_d1_IDENTIFIER","]d1"),K.set("GS1_Q1_IDENTIFIER","]Q1"),K.set("GS1_GROUP_SEPARATOR","\x1d"),K.set("SSCC","00"),K.set("GTIN","01"),K.set("CONTENT","02"),K.set("LOT_NUMBER","10"),K.set("PROD_DATE","11"),K.set("DUE_DATE","12"),K.set("PACK_DATE","13"),K.set("BEST_BEFORE_DATE","15"),K.set("SELL_BY","16"),K.set("EXP_DATE","17"),K.set("VARIANT","20"),K.set("SERIAL_NUMBER","21"),K.set("CPV","22"),K.set("TPX","235"),K.set("ADDITIONAL_ID","240"),K.set("CUSTOMER_PART_NUMBER","241"),K.set("MTO_VARIANT_NUMBER","242"),K.set("PCN","243"),K.set("SECONDARY_SERIAL","250"),K.set("REF_TO_SOURCE","251"),K.set("GDTI","253"),K.set("GLN_EXTENSION_COMPONENT","254"),K.set("GCN","255"),K.set("VAR_COUNT","30"),K.set("NET_WEIGHT_KG","310*"),K.set("LENGTH_M","311*"),K.set("WIDTH_M","312*"),K.set("HEIGHT_M","313*"),K.set("AREA_M2","314*"),K.set("NET_VOLUME_L","315*"),K.set("NET_VOLUME_M3","316*"),K.set("NET_WEIGHT_LB","320*"),K.set("LENGTH_I","321*"),K.set("LENGTH_F","322*"),K.set("LENGTH_Y","323*"),K.set("WIDTH_I","324*"),K.set("WIDTH_F","325*"),K.set("WIDTH_Y","326*"),K.set("HEIGHT_I","327*"),K.set("HEIGHT_F","328*"),K.set("HEIGHT_Y","329*"),K.set("GROSS_WEIGHT_GF","330*"),K.set("LENGTH_M_LOG","331*"),K.set("WIDTH_M_LOG","332*"),K.set("HEIGHT_M_LOG","333*"),K.set("AREA_M2_LOG","334*"),K.set("VOLUME_L_LOG","335*"),K.set("VOLUME_M3_LOG","336*"),K.set("KG_PER_M2","337*"),K.set("GROSS_WHEIGHT_LB","340*"),K.set("LENGTH_I_LOG","341*"),K.set("LENGTH_F_LOG","342*"),K.set("LENGTH_Y_LOG","343*"),K.set("WIDTH_I_LOG","344*"),K.set("WIDTH_F_LOG","345*"),K.set("WIDTH_Y_LOG","346*"),K.set("HEIGHT_I_LOG","347*"),K.set("HEIGHT_F_LOG","348*"),K.set("HEIGHT_Y_LOG","349*"),K.set("AREA_I2","350*"),K.set("AREA_F2","351*"),K.set("AREA_Y2","352*"),K.set("AREA_I2_LOG","353*"),K.set("AREA_F2_LOG","354*"),K.set("AREA_Y2_LOG","355*"),K.set("NET_WEIGHT_T","356*"),K.set("NET_VOLUME_OZ","357*"),K.set("NET_VOLUME_Q","360*"),K.set("NET_VOLUME_G","361*"),K.set("VOLUME_Q_LOG","362*"),K.set("VOLUME_G_LOG","363*"),K.set("VOLUME_I3","364*"),K.set("VOLUME_F3","365*"),K.set("VOLUME_Y3","366*"),K.set("VOLUME_I3_LOG","367*"),K.set("VOLUME_F3_LOG","368*"),K.set("VOLUME_Y3_LOG","369*"),K.set("COUNT","37"),K.set("AMOUNT","390*"),K.set("AMOUNT_ISO","391*"),K.set("PRICE","392*"),K.set("PRICE_ISO","393*"),K.set("PRCNT_OFF","394*"),K.set("PRICE_UOM","395*"),K.set("ORDER_NUMBER","400"),K.set("GINC","401"),K.set("ROUTE","403"),K.set("SHIP_TO_GLOB_LOC","410"),K.set("BILL_TO_LOC","411"),K.set("PURCHASED_FROM","412"),K.set("SHIP_FOR_LOG","413"),K.set("LOC_NUMBER","414"),K.set("PAY_TO","415"),K.set("PROD_SERV_LOC","416"),K.set("PARTY","417"),K.set("SHIP_TO_POST","420"),K.set("SHIP_TO_POST_ISO","421"),K.set("ORIGIN","422"),K.set("COUNTRY_INITIAL_PROCESS","423"),K.set("COUNTRY_PROCESS","424"),K.set("COUNTRY_DISASSEMBLY","425"),K.set("COUNTRY_FULL_PROCESS","426"),K.set("ORIGIN_SUBDIVISION","427"),K.set("SHIP_TO_COMP","4300"),K.set("SHIP_TO_NAME","4301"),K.set("SHIP_TO_ADD1","4302"),K.set("SHIP_TO_ADD2","4303"),K.set("SHIP_TO_SUB","4304"),K.set("SHIP_TO_LOCALITY","4305"),K.set("SHIP_TO_REG","4306"),K.set("SHIP_TO_COUNTRY","4307"),K.set("SHIP_TO_PHONE","4308"),K.set("RTN_TO_COMP","4310"),K.set("RTN_TO_NAME","4311"),K.set("RTN_TO_ADD1","4312"),K.set("RTN_TO_ADD2","4313"),K.set("RTN_TO_SUB","4314"),K.set("RTN_TO_LOCALITY","4315"),K.set("RTN_TO_REG","4316"),K.set("RTN_TO_COUNTRY","4317"),K.set("RTN_TO_POST","4318"),K.set("RTN_TO_PHONE","4319"),K.set("SRV_DESCRIPTION","4320"),K.set("DANGEROUS_GOODS","4321"),K.set("AUTH_LEAV","4322"),K.set("SIG_REQUIRED","4323"),K.set("NBEF_DEL_DT","4324"),K.set("NAFT_DEL_DT","4325"),K.set("REL_DATE","4326"),K.set("NSN","7001"),K.set("MEAT_CUT","7002"),K.set("EXP_TIME","7003"),K.set("ACTIVE_POTENCY","7004"),K.set("CATCH_AREA","7005"),K.set("FIRST_FREEZE_DATE","7006"),K.set("HARVEST_DATE","7007"),K.set("AQUATIC_SPECIES","7008"),K.set("FISHING_GEAR_TYPE","7009"),K.set("PROD_METHID","7010"),K.set("REFURB_LOT","7020"),K.set("FUNC_STAT","7021"),K.set("REV_STAT","7022"),K.set("GIAI_ASSEMBLY","7023"),K.set("PROCESSOR_NUMBER","703*"),K.set("UIC_EXT","7040"),K.set("NHRN_PZN","710"),K.set("NHRN_CIP","711"),K.set("NHRN_CN","712"),K.set("NHRN_DRN","713"),K.set("NHRN_AIM","714"),K.set("CERT_NUMBER","723*"),K.set("PROTOCOL","7240"),K.set("DIMENSIONS","8001"),K.set("CMT_NUMBER","8002"),K.set("GRAI","8003"),K.set("GIAI","8004"),K.set("PRICE_PER_UNIT","8005"),K.set("ITIP","8006"),K.set("IBAN","8007"),K.set("PROD_TIME","8008"),K.set("OPTSEN","8009"),K.set("CPID","8010"),K.set("CPID_SERIAL","8011"),K.set("VERSION","8012"),K.set("GMN","8013"),K.set("GSRN_PROVIDER","8017"),K.set("GSRN_RECIPIENT","8018"),K.set("SRIN","8019"),K.set("REF_NUMBER","8020"),K.set("ITIP_CONTENT","8026"),K.set("COUPON_USA","8110"),K.set("POINTS","8111"),K.set("POSITIVE_OFFER_COUPON_USA","8121"),K.set("PRODUCT_URL","8200"),K.set("AGREEMENT_INTERNAL","90"),K.set("COMPANY_INTERNAL_1","91"),K.set("COMPANY_INTERNAL_2","92"),K.set("COMPANY_INTERNAL_3","93"),K.set("COMPANY_INTERNAL_4","94"),K.set("COMPANY_INTERNAL_5","95"),K.set("COMPANY_INTERNAL_6","96"),K.set("COMPANY_INTERNAL_7","97"),K.set("COMPANY_INTERNAL_8","98"),K.set("COMPANY_INTERNAL_9","99");const Z={[K.get("SSCC")]:20,[K.get("GTIN")]:16,[K.get("CONTENT")]:16,"03":16,"04":18,[K.get("PROD_DATE")]:8,[K.get("DUE_DATE")]:8,[K.get("PACK_DATE")]:8,14:8,[K.get("BEST_BEFORE_DATE")]:8,[K.get("SELL_BY")]:8,[K.get("EXP_DATE")]:8,18:8,19:8,[K.get("VARIANT")]:4,31:10,32:10,33:10,34:10,35:10,36:10,41:16};let z;const Q=e=>{if(e){const t=e.length,r=(e=>{for(let t of K.values()){if(t.endsWith("*")&&(t=t.substring(0,t.length-1)),e.startsWith(t)&&t.endsWith("*"))return e.substring(0,t.length+1);if(e.startsWith(t))return t}return!1})(e);let n=Z[r.substring(0,2)];null==n&&(n=t),z.set(r,e.substring(r.length,n)),Q(e.substring(n))}},q={},J=(e,t)=>{if(t&&t.length>=3){const r=t.substring(0,3);if(K.get("GS1_d2_IDENTIFIER")===r||K.get("GS1_Q3_IDENTIFIER")===r){const r=((e,t)=>{const r=(e=>{switch(e){case"gtin":return"GTIN";case"lot number":case"batch number":return"LOT_NUMBER";case"production date":return"PROD_DATE";case"best before date":return"BEST_BEFORE_DATE";case"expiration date":return"EXP_DATE";case"serial number":return"SERIAL_NUMBER";default:return e}})(e),n=K.get(r);return q[t]?q[t].get(n):(z=new Map,(i=t,i.substring(3)).split(K.get("GS1_GROUP_SEPARATOR")).forEach(e=>{Q(e)}),q[t]=z,z.get(n));var i})(e,t);return r}return"Unsupported GS1 identifier: {gs1Identifier}"}return"Incomplete DataMatrix input"},ee=({dateUtils:e,variablesHash:t,selectedOrgUnit:r,selectedUserRoles:n})=>({ceil:{parameters:1,execute:e=>Math.ceil(e[0])},floor:{parameters:1,execute:e=>Math.floor(e[0])},round:{parameters:{min:1,max:2},execute:e=>{if(e[1]){const t=10**Math.round(e[1]);return Math.round((e[0]+Number.EPSILON)*t)/t}return Math.round(e[0])}},modulus:{parameters:2,execute:e=>Number(e[0])%Number(e[1])},zing:{parameters:1,execute:e=>{const t=e[0];return t<0?0:t}},oizp:{parameters:1,execute:e=>e[0]<0?0:1},concatenate:{execute:e=>e.join("")},daysBetween:{parameters:2,execute:t=>e.daysBetween(t[0],t[1])},weeksBetween:{parameters:2,execute:t=>e.weeksBetween(t[0],t[1])},monthsBetween:{parameters:2,execute:t=>e.monthsBetween(t[0],t[1])},yearsBetween:{parameters:2,execute:t=>e.yearsBetween(t[0],t[1])},addDays:{parameters:2,execute:t=>{const r=t[0],n=t[1];return e.addDays(r,n)}},count:{parameters:1,execute:e=>{var r,n;const a=e[0],s=t[a];return s?s.hasValue?null!==(r=null===(n=s.allValues)||void 0===n?void 0:n.length)&&void 0!==r?r:1:0:(i().warn(`could not find variable to count: ${a}`),0)}},countIfValue:{parameters:2,execute:e=>{const r=e[0],n=t[r];if(!n)return i().warn(`could not find variable to countIfValue: ${r}`),0;if(!n.hasValue)return 0;const a=e[1];return(n.allValues||[n.variableValue]).reduce((e,t)=>t===a?e+1:e,0)}},countIfZeroPos:{parameters:1,execute:()=>(i().warn("countIfZeroPos not implemented yet"),0)},hasValue:{parameters:1,execute:e=>{const r=e[0],n=t[r];return n?n.hasValue:(i().warn(`could not find variable to check if has value: ${r}`),!1)}},validatePattern:{parameters:2,execute:e=>{const t=e[0].toString(),r=e[1],n=new RegExp(r,"g"),i=t.match(n);let a=!1;return null!==i&&t===i[0]&&(a=!0),a}},left:{parameters:2,execute:e=>{const t=String(e[0]),r=t.length<e[1]?t.length:e[1];return t.substring(0,r)}},right:{parameters:2,execute:e=>{const t=String(e[0]),r=t.length<e[1]?t.length:e[1];return t.substring(t.length-r,t.length)}},substring:{parameters:3,execute:e=>{const t=String(e[0]),r=t.length<e[1]-1?-1:e[1],n=t.length<e[2]?-1:e[2];return r<0||n<0?"":t.substring(r,n)}},split:{parameters:3,execute:e=>{const t=String(e[0]).split(e[1]);let r="";return t.length>e[2]&&(r=t[e[2]]),r}},length:{parameters:1,execute:e=>String(e[0]).length},inOrgUnitGroup:{parameters:1,execute:e=>{const t=e[0],n=r&&r.groups||[];return Boolean(n.find(e=>e.id===t||e.code===t))}},hasUserRole:{parameters:1,execute:e=>{const t=e[0];return n.includes(t)}},zScoreWFA:{parameters:3,execute:e=>((e,t,r)=>{let n=Y;return 1===F[r]&&(n=k),X(Math.round(e),t,n)})(e[0],e[1],e[2])},zScoreHFA:{parameters:3,execute:e=>((e,t,r)=>{let n=j;return 1===F[r]&&(n=$),X(Math.round(e),t,n)})(e[0],e[1],e[2])},zScoreWFH:{parameters:3,execute:e=>((e,t,r)=>{let n=W;return 1===F[r]&&(n=B),X(Math.round(2*e)/2,t,n)})(e[0],e[1],e[2])},extractDataMatrixValue:{parameters:2,execute:e=>J(e[0],e[1])},lastEventDate:{parameters:1,execute:e=>{const r=e[0],n=t[r];return n?n.variableEventDate?n.variableEventDate:(i().warn(`no last event date found for variable: ${r}`),""):(i().warn(`could not find variable to check last event date: ${r}`),"")}},addControlDigits:{parameters:1,execute:e=>{const t=e[0],r=t.split("");let n=0,a=0;if(r&&r.length<10){let e=0;const t=r.length,s=[3,7,6,1,8,9,4,5,2];for(let n=0;n<t;n++)e+=parseInt(r[n],10)*s[n];n=e%11,r.push(n);const o=[5,4,3,2,7,6,5,4,3,2];let E=0;for(let n=0;n<t+1;n++)E+=parseInt(r[n],10)*o[n];a=E%11,10===n&&(i().warn("First control digit became 10, replacing with 0"),n=0),10===a&&(i().warn("Second control digit became 10, replacing with 0"),a=0)}else i().warn(`Base number not well formed(${r.length} digits): ${t}`);return t+n+a}},checkControlDigits:{parameters:1,execute:e=>(i().warn("checkControlDigits not implemented yet"),e[0])},multiTextContains:{parameters:2,execute:e=>(i().warn("multiTextContains not implemented yet"),e[0])},condition:{parameters:3,execute:a=>{const s=ee({dateUtils:e,variablesHash:t,selectedOrgUnit:r,selectedUserRoles:n});return w({expression:a[0],dhisFunctions:s,variablesHash:t,onError:()=>i().error(`Evaluation of d2:condition expression ${a[0]} failed`),onVerboseLog:()=>{}})?a[1]:a[2]}}}),te=Object.freeze({[s]:({dataElementId:e,dataElements:t})=>{if(e&&t&&t[e]){const r=t[e];return{name:r.name,valueType:r.valueType}}return null},[o]:({trackedEntityAttributeId:e,trackedEntityAttributes:t})=>{if(e&&t&&t[e]){const r=t[e];return{name:r.displayFormName||r.displayName,valueType:r.valueType}}return null}}),re=e=>e||(0===e?0:"");function ne(e){const t=[E,l];function r(e,r){return t.filter(t=>e[t]).map(t=>{const n=r();return n.id=e[t],n.targetDataType=t===E?s:o,n})}function n(e,t){const n=r(e,()=>({type:t,message:`${e.displayContent||""} ${re(e.data)}`}));return 0!==n.length?n:{type:t,id:"general"}}function u(e,t){const r=n(e,t);return Array.isArray(r)||(r.warning={id:e.id,message:`${e.displayContent||""} ${re(e.data)}`}),r}function d(e,t){const r=n(e,t);return Array.isArray(r)||(r.error={id:e.id,message:`${e.displayContent||""} ${re(e.data)}`}),r}function T(t,r,n){const s=function(t,r){let n;if(t||0===t||!1===t){const a=c[r],s=e[a];if(!a||!s)return i().warn(V("converter for valueType is missing")({valueType:r})),"";n=s(t)}else n=t;return n}(g(t.data,r.valueType),r.valueType);return{type:a.ASSIGN_VALUE,id:r.id,value:s,targetDataType:n}}const I={[a.ASSIGN_VALUE]:function(e,t,r){const n=[];return t&&e.dataElementId&&t[e.dataElementId]&&n.push(T(e,t[e.dataElementId],s)),r&&e.trackedEntityAttributeId&&r[e.trackedEntityAttributeId]&&n.push(T(e,r[e.trackedEntityAttributeId],o)),n},[a.HIDE_FIELD]:function(e,t,n,i,s){return(({outputEffects:e,formValues:t,dataElementId:r,trackedEntityAttributeId:n,dataElements:i,trackedEntityAttributes:a,onProcessValue:s})=>e.reduce((e,o)=>{if(t&&0!==Object.keys(t).length&&o.targetDataType){const E=t[o.id],l=te[o.targetDataType]({dataElementId:r,trackedEntityAttributeId:n,dataElements:i,trackedEntityAttributes:a});if(l){const{valueType:t,name:r}=l;if(null!=(s&&s(E,t)))return[...e,{...o,hadValue:!0,name:r}]}return[...e,o]}return[...e,o]},[]))({outputEffects:r(e,()=>({type:a.HIDE_FIELD,content:e.content})),formValues:i,dataElementId:e.dataElementId,trackedEntityAttributeId:e.trackedEntityAttributeId,dataElements:t,trackedEntityAttributes:n,onProcessValue:s})},[a.SHOW_ERROR]:function(e){return d(e,a.SHOW_ERROR)},[a.SHOW_WARNING]:function(e){return u(e,a.SHOW_WARNING)},[a.SHOW_ERROR_ONCOMPLETE]:function(e){return d(e,a.SHOW_ERROR_ONCOMPLETE)},[a.SHOW_WARNING_ONCOMPLETE]:function(e){return u(e,a.SHOW_WARNING_ONCOMPLETE)},[a.HIDE_PROGRAM_STAGE]:function(e){return e.programStageId?{type:a.HIDE_PROGRAM_STAGE,id:e.programStageId}:null},[a.HIDE_SECTION]:function(e){return e.programStageSectionId?{type:a.HIDE_SECTION,id:e.programStageSectionId}:null},[a.MAKE_COMPULSORY]:function(e){return r(e,()=>({type:a.MAKE_COMPULSORY}))},[a.DISPLAY_TEXT]:function(e){const t=e.displayContent||"";return{type:a.DISPLAY_TEXT,id:e.location,displayText:{id:e.id,message:`${t} ${re(e.data)}`,...e.style}}},[a.DISPLAY_KEY_VALUE_PAIR]:function(e){const t=void 0!==e.data?e.data:"";return{type:a.DISPLAY_KEY_VALUE_PAIR,id:e.location,displayKeyValuePair:{id:e.id,key:e.displayContent,value:"number"===typeof t?(r=t,isNaN(r)||r===1/0?"":String(r)):String(t),...e.style}};var r},[a.HIDE_OPTION_GROUP]:function(e){return r(e,()=>({type:a.HIDE_OPTION_GROUP,optionGroupId:e.optionGroupId}))},[a.HIDE_OPTION]:function(e){return r(e,()=>({type:a.HIDE_OPTION,optionId:e.optionId}))},[a.SHOW_OPTION_GROUP]:function(e){return r(e,()=>({type:a.SHOW_OPTION_GROUP,optionGroupId:e.optionGroupId}))}};return function({effects:e,dataElements:t,trackedEntityAttributes:r,formValues:n,onProcessValue:i}){return e.filter(({action:e})=>I[e]).flatMap(e=>I[e.action](e,t,r,n,i)).filter(e=>e)}}function ie(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}class ae{constructor(e,t,r,n,i){ie(this,"inputConverter",void 0),ie(this,"outputConverter",void 0),ie(this,"valueProcessor",void 0),ie(this,"variableService",void 0),ie(this,"dateUtils",void 0),ie(this,"userRoles",void 0),ie(this,"flags",void 0),this.inputConverter=e,this.outputConverter=t,this.valueProcessor=new G(e),this.variableService=new D(this.valueProcessor.processValue,r,n),this.dateUtils=r,this.flags=null!==i&&void 0!==i?i:{verbose:!1}}getProgramRuleEffects({programRulesContainer:{programRules:e,programRuleVariables:t,constants:r},currentEvent:n,otherEvents:s,dataElements:o,trackedEntityAttributes:E,selectedEntity:l,selectedEnrollment:u,selectedOrgUnit:c,selectedUserRoles:d,optionSets:T}){const I=this.variableService.getVariables({programRuleVariables:t,currentEvent:null!==n&&void 0!==n?n:void 0,otherEvents:null!==s&&void 0!==s?s:void 0,dataElements:o,selectedEntity:l,trackedEntityAttributes:E,selectedEnrollment:u,selectedOrgUnit:c,optionSets:T,constants:r}),_=ee({dateUtils:this.dateUtils,variablesHash:I,selectedOrgUnit:c,selectedUserRoles:null!==d&&void 0!==d?d:this.userRoles});if(!e)return[];const O=e.sort((e,t)=>e.priority||t.priority?e.priority?t.priority?e.priority-t.priority:-1:1:0).flatMap(e=>{let t=!1;const{condition:r}=e;r?t=w({expression:r,dhisFunctions:_,variablesHash:I,flags:this.flags,onError:(t,n,a)=>i().error(`Expression with rule id: ${e.id} could not be run. Original condition was: ${r} - Evaluation ended up as: ${n} - Result of evaluation was: ${null===a||void 0===a?void 0:a.toString()} - error message: ${t}`),onVerboseLog:(t,n)=>console.log(`Expression with rule id: ${e.id} was run. Original condition was: ${r} - Evaluation ended up as: ${t} - Result of evaluation was: ${null===n||void 0===n?void 0:n.toString()}`)}):i().warn(`Rule id:'${e.id}' and name:'${e.displayName}' had no condition specified. Please check rule configuration.`);let n=[];return t&&(n=e.programRuleActions.map(({data:e,programRuleActionType:t,id:r,location:n,dataElementId:s,trackedEntityAttributeId:o,programStageId:E,programStageSectionId:l,optionGroupId:u,optionId:c,content:d,displayContent:T,style:O,name:N})=>{let p;return e&&(p=w({expression:e,dhisFunctions:_,variablesHash:I,flags:this.flags,onError:(t,n,a)=>i().error(`Expression with action id: action:${r} could not be run. Original condition was: ${e} - Evaluation ended up as:${n} - Result of evaluation was: ${null===a||void 0===a?void 0:a.toString()} - Error message:${t}`),onVerboseLog:(t,n)=>console.log(`Expression with action id: action:${r} was run. Original condition was: ${e} - Evaluation ended up as: ${t} - Result of evaluation was: ${null===n||void 0===n?void 0:n.toString()}`)})),t===a.ASSIGN_VALUE&&d&&this.variableService.updateVariable(d,p,I),{data:p,id:r,location:n,action:t,dataElementId:s,trackedEntityAttributeId:o,programStageId:E,programStageSectionId:l,optionGroupId:u,optionId:c,content:d,displayContent:T,style:O,name:N}})),n}).filter(e=>e);return ne(this.outputConverter)({effects:O,dataElements:o,trackedEntityAttributes:E,formValues:{...l,...n},onProcessValue:this.valueProcessor.processValue})}setSelectedUserRoles(e){this.userRoles=e}setFlags(e){this.flags=e}getFlags(){return this.flags}}var se=r(75468),oe=r(25375);const Ee="DATA_ELEMENT",le="TRACKED_ENTITY_ATTRIBUTE",ue="UNKNOWN",ce=Object.freeze({ASSIGN_VALUE:"ASSIGN",HIDE_FIELD:"HIDEFIELD",SHOW_ERROR:"SHOWERROR",SHOW_WARNING:"SHOWWARNING",SHOW_ERROR_ONCOMPLETE:"ERRORONCOMPLETE",SHOW_WARNING_ONCOMPLETE:"WARNINGONCOMPLETE",HIDE_PROGRAM_STAGE:"HIDEPROGRAMSTAGE",HIDE_SECTION:"HIDESECTION",MAKE_COMPULSORY:"SETMANDATORYFIELD",DISPLAY_TEXT:"DISPLAYTEXT",DISPLAY_KEY_VALUE_PAIR:"DISPLAYKEYVALUEPAIR",HIDE_OPTION_GROUP:"HIDEOPTIONGROUP",HIDE_OPTION:"HIDEOPTION",SHOW_OPTION_GROUP:"SHOWOPTIONGROUP",SCHEDULE_MESSAGE:"SCHEDULEMESSAGE",SEND_MESSAGE:"SENDMESSAGE"}),de=(Object.freeze({WebClient:"WebClient",AndroidClient:"AndroidClient",Server:"Server"}),Object.freeze({ACTIVE:"ACTIVE",COMPLETED:"COMPLETED",VISITED:"VISITED",SCHEDULE:"SCHEDULE",OVERDUE:"OVERDUE",SKIPPED:"SKIPPED"}),{TEXT:"TEXT",MULTI_TEXT:"MULTI_TEXT",LONG_TEXT:"LONG_TEXT",LETTER:"LETTER",PHONE_NUMBER:"PHONE_NUMBER",EMAIL:"EMAIL",BOOLEAN:"BOOLEAN",TRUE_ONLY:"TRUE_ONLY",DATE:"DATE",DATETIME:"DATETIME",TIME:"TIME",NUMBER:"NUMBER",PERCENTAGE:"PERCENTAGE",INTEGER:"INTEGER",INTEGER_POSITIVE:"INTEGER_POSITIVE",INTEGER_NEGATIVE:"INTEGER_NEGATIVE",INTEGER_ZERO_OR_POSITIVE:"INTEGER_ZERO_OR_POSITIVE",USERNAME:"USERNAME",COORDINATE:"COORDINATE",ORGANISATION_UNIT:"ORGANISATION_UNIT",AGE:"AGE",URL:"URL",FILE_RESOURCE:"FILE_RESOURCE",IMAGE:"IMAGE"}),Te={[de.TEXT]:"convertText",[de.MULTI_TEXT]:"convertMultiText",[de.LONG_TEXT]:"convertLongText",[de.LETTER]:"convertLetter",[de.PHONE_NUMBER]:"convertPhoneNumber",[de.EMAIL]:"convertEmail",[de.BOOLEAN]:"convertBoolean",[de.TRUE_ONLY]:"convertTrueOnly",[de.DATE]:"convertDate",[de.DATETIME]:"convertDateTime",[de.TIME]:"convertTime",[de.NUMBER]:"convertNumber",[de.INTEGER]:"convertInteger",[de.INTEGER_POSITIVE]:"convertIntegerPositive",[de.INTEGER_NEGATIVE]:"convertIntegerNegative",[de.INTEGER_ZERO_OR_POSITIVE]:"convertIntegerZeroOrPositive",[de.PERCENTAGE]:"convertPercentage",[de.URL]:"convertUrl",[de.AGE]:"convertAge",[de.FILE_RESOURCE]:"convertFile",[de.ORGANISATION_UNIT]:"convertOrganisationUnit",[de.IMAGE]:"convertImage",[de.USERNAME]:"convertUserName",[de.COORDINATE]:"convertCoordinate"},Ie="dataElement",_e="trackedEntityAttribute";function Oe(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}class Ne{constructor(e){Oe(this,"converterObject",void 0),Oe(this,"processValue",(e,t)=>{if(!de[t])return i().warn(Ne.errorMessages.TYPE_NOT_SUPPORTED),"";const r=Te[t];if(!r)return i().warn((n=Ne.errorMessages.CONVERTER_NOT_FOUND,e=>({...e,message:n}))({type:t})),e;var n;const a=this.converterObject[r]?this.converterObject[r](e):e;return null!==a&&void 0!==a?a:null}),this.converterObject=e,this.processValue=this.processValue.bind(this)}}function pe(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}Oe(Ne,"errorMessages",{TYPE_NOT_SUPPORTED:"value type not supported",CONVERTER_NOT_FOUND:"converter for type is missing"});const Ae={DATAELEMENT_CURRENT_EVENT:"DATAELEMENT_CURRENT_EVENT",DATAELEMENT_NEWEST_EVENT_PROGRAM_STAGE:"DATAELEMENT_NEWEST_EVENT_PROGRAM_STAGE",DATAELEMENT_NEWEST_EVENT_PROGRAM:"DATAELEMENT_NEWEST_EVENT_PROGRAM",DATAELEMENT_PREVIOUS_EVENT:"DATAELEMENT_PREVIOUS_EVENT"},Re={TEI_ATTRIBUTE:"TEI_ATTRIBUTE"},ve={...Ae,...Re,CALCULATED_VALUE:"CALCULATED_VALUE"},me={[ve.DATAELEMENT_CURRENT_EVENT]:e=>e.dataElementId,[ve.DATAELEMENT_NEWEST_EVENT_PROGRAM]:e=>e.dataElementId,[ve.DATAELEMENT_NEWEST_EVENT_PROGRAM_STAGE]:e=>e.dataElementId,[ve.DATAELEMENT_PREVIOUS_EVENT]:e=>e.dataElementId,[ve.TEI_ATTRIBUTE]:e=>e.trackedEntityAttributeId,[ve.CALCULATED_VALUE]:()=>""},Se=new Set(["eventId","programId","programStageId","programStageName","orgUnitId","trackedEntityInstanceId","enrollmentId","enrollmentStatus","status","occurredAt","createdAt","scheduledAt","completedAt"]),ge={[de.BOOLEAN]:se.sj.BOOLEAN,[de.TRUE_ONLY]:se.sj.BOOLEAN,[de.DATE]:se.sj.DATE,[de.DATETIME]:se.sj.DATE,[de.AGE]:se.sj.DATE,[de.INTEGER]:se.sj.NUMERIC,[de.INTEGER_POSITIVE]:se.sj.NUMERIC,[de.INTEGER_NEGATIVE]:se.sj.NUMERIC,[de.INTEGER_ZERO_OR_POSITIVE]:se.sj.NUMERIC,[de.NUMBER]:se.sj.NUMERIC,[de.PERCENTAGE]:se.sj.NUMERIC},fe=e=>{if(e.programRuleActionType===ce.ASSIGN_VALUE)return(e=>{const{data:t,programRuleActionType:r,dataElementId:n,trackedEntityAttributeId:i,content:a}=e,s=[],o=e=>{s.push(new se.Eg(t,r,e))};return n&&o(new Map([["field",n],["attributeType",Ee]])),i&&o(new Map([["field",i],["attributeType",le]])),a&&o(new Map([["content",a],["attributeType",ue]])),s})(e);const{data:t,programRuleActionType:r,...n}=e;return new se.Eg(t,r,new Map(Object.keys(n).map(e=>[e,n[e]])))},be=e=>{const{condition:t,programRuleActions:r,id:n,displayName:i,programStageId:a,priority:s}=e;return new se.au(t,r.flatMap(fe),n,i,a,s)},Pe=e=>new se.c$(e.displayName,e.code);class he{constructor(e,t,r,n,i){pe(this,"processValue",void 0),pe(this,"dataElements",void 0),pe(this,"trackedEntityAttributes",void 0),pe(this,"optionSets",void 0),pe(this,"kotlinOptionSets",void 0),pe(this,"selectedOrgUnit",void 0),pe(this,"toLocalDate",(e,t=null)=>e?oe.yc.parse(this.processValue(e,de.DATE)):t),pe(this,"convertDataElementValue",(e,t)=>{var r;return this.convertDataValue(t,null===(r=this.dataElements[e])||void 0===r?void 0:r.valueType)}),pe(this,"convertTrackedEntityAttributeValue",(e,t)=>{var r;return this.convertDataValue(t,null===(r=this.trackedEntityAttributes[e])||void 0===r?void 0:r.valueType)}),pe(this,"convertDataValue",(e,t)=>String(t?this.processValue(e,t):e)),pe(this,"convertEvent",e=>{const{eventId:t,programStageId:r,programStageName:n,status:i,occurredAt:a,createdAt:s,scheduledAt:o,completedAt:E}=e,l=a?oe.MW.parse(a):null,u=s?oe.MW.parse(s):oe.MW.now(),c=Object.keys(e).filter(e=>!Se.has(e)).filter(t=>{var r;return null!==(null!==(r=e[t])&&void 0!==r?r:null)}).map(t=>new se.IX(t,this.convertDataElementValue(t,e[t])));return new se.Oh(t||"",r||"",n||"",i?se.j[i]:se.j.ACTIVE,l,u,this.toLocalDate(o),this.toLocalDate(E),this.selectedOrgUnit.id,this.selectedOrgUnit.code,c)}),pe(this,"convertRuleVariable",e=>{const{programRuleVariableSourceType:t,displayName:r,useNameForOptionSet:n,valueType:i,programStageId:a}=e,s=me[t]?t:"CALCULATED_VALUE",o=me[s](e);return new se.yo(se.Vj[s],r,!n,this.getOptionSet(o,s),o,ge[i]||se.sj.TEXT,a)}),pe(this,"buildEnrollment",({selectedEnrollment:e,selectedEntity:t})=>{const{enrollmentId:r,enrolledAt:n,occurredAt:i,programName:a,enrollmentStatus:s}=e,o=t?Object.keys(t).filter(e=>{var r;return null!==(null!==(r=t[e])&&void 0!==r?r:null)}).map(e=>new se.cW(e,this.convertTrackedEntityAttributeValue(e,t[e]))):[],E=e=>this.toLocalDate(e,oe.yc.now());return new se.Et(r,a||"",E(i),E(n),s?se.bz[s]:se.bz.ACTIVE,this.selectedOrgUnit.id,this.selectedOrgUnit.code,o)}),pe(this,"buildRuleEngineContext",({programRulesContainer:e,selectedUserRoles:t})=>{const{programRules:r,programRuleVariables:n,constants:i}=e;return new se.P8(r?r.map(be):[],n?n.map(this.convertRuleVariable):[],(({selectedOrgUnit:e,selectedUserRoles:t})=>{const r=e.id,n=e.groups.reduce((e,t)=>(t.code&&e.set(t.code,[r]),e.set(t.id,[r]),e),new Map);return n.set("USER",t||[]),n})({selectedOrgUnit:this.selectedOrgUnit,selectedUserRoles:t}),i?(e=>e.reduce((e,t)=>(e.set(t.displayName,t.value),e),new Map))(i):new Map)}),this.processValue=new Ne(e).processValue,this.dataElements=t||{},this.trackedEntityAttributes=r||{},this.optionSets=n,this.kotlinOptionSets={},this.selectedOrgUnit=i}convertOptionSet(e){return e&&this.optionSets[e]?(this.kotlinOptionSets[e]||(this.kotlinOptionSets[e]=this.optionSets[e].options.map(Pe)),this.kotlinOptionSets[e]):[]}getOptionSet(e,t){var r,n;return Ae[t]?this.convertOptionSet(null===(r=this.dataElements[e])||void 0===r?void 0:r.optionSetId):Re[t]?this.convertOptionSet(null===(n=this.trackedEntityAttributes[e])||void 0===n?void 0:n.optionSetId):[]}}const ye=e=>(0,R.A)(e)?isNaN(e)?(i().warn(`rule execution service could not convert ${e} to number`),null):Number(e):e,De=e=>(0,R.A)(e)?"true"===e:e,Ve=e=>e.toString(),Le=e=>e||(0===e?0:""),Ge=Object.freeze({[Ie]:({dataElementId:e,dataElements:t})=>{const r=e&&(null===t||void 0===t?void 0:t[e]);return r?{name:r.name,valueType:r.valueType}:null},[_e]:({trackedEntityAttributeId:e,trackedEntityAttributes:t})=>{const r=e&&(null===t||void 0===t?void 0:t[e]);return r?{name:r.displayFormName||r.displayName,valueType:r.valueType}:null}}),Ue=[(e,t)=>e.dataElementId?{id:e.dataElementId,type:t,targetDataType:Ie}:null,(e,t)=>e.trackedEntityAttributeId?{id:e.trackedEntityAttributeId,type:t,targetDataType:_e}:null],Me=(e,t)=>Ue.map(r=>r(e,t)).filter(e=>null!==e),Ce=(e,t)=>e.map(e=>({id:e.id,type:e.type,targetDataType:e.targetDataType,message:t})),xe=(e,t)=>{const r=`${e.displayContent||""} ${Le(e.data)}`,n=Me(e,t);return 0!==n.length?Ce(n,r):((e,t,r)=>[{id:"general",type:t,warning:{id:e,message:r}}])(e.id,t,r)},He=(e,t)=>{const r=`${e.displayContent||""} ${Le(e.data)}`,n=Me(e,t);return 0!==n.length?Ce(n,r):((e,t,r)=>[{id:"general",type:t,error:{id:e,message:r}}])(e.id,t,r)};function we(e){function t(t,r,n){const a=((e,t)=>{const r={[de.BOOLEAN]:De,[de.TRUE_ONLY]:De,[de.PERCENTAGE]:Ve,[de.INTEGER]:ye,[de.INTEGER_NEGATIVE]:ye,[de.INTEGER_POSITIVE]:ye,[de.INTEGER_ZERO_OR_POSITIVE]:ye,[de.NUMBER]:ye,[de.AGE]:Ve,[de.TEXT]:Ve,[de.LONG_TEXT]:Ve,[de.MULTI_TEXT]:Ve};return e||0===e||!1===e?r[t]?r[t](e):e:null})(t,r.valueType),s=function(t,r){let n;if(t||0===t||!1===t){const s=Te[r],o=e[s];if(!s||!o)return i().warn((a="converter for valueType is missing",e=>({...e,message:a}))({valueType:r})),"";n=o(t)}else n=t;var a;return n}(a,r.valueType);return{type:ce.ASSIGN_VALUE,id:r.id,value:s,targetDataType:n}}const r={[ce.ASSIGN_VALUE]:function(e,r,n){if(e.attributeType===Ee){if(e.field&&null!==r&&void 0!==r&&r[e.field])return[t(e.data,r[e.field],Ie)]}else if(e.attributeType===le&&e.field&&null!==n&&void 0!==n&&n[e.field])return[t(e.data,n[e.field],_e)];return[]},[ce.HIDE_FIELD]:function(e,t,r,n,i){return(({outputEffects:e,formValues:t,dataElementId:r,trackedEntityAttributeId:n,dataElements:i,trackedEntityAttributes:a,onProcessValue:s})=>e.reduce((e,o)=>{if(t&&0!==Object.keys(t).length&&o.targetDataType){const E=t[o.id],l=Ge[o.targetDataType]({dataElementId:r,trackedEntityAttributeId:n,dataElements:i,trackedEntityAttributes:a});if(l){const{valueType:t,name:r}=l;if(null!=s(E,t))return[...e,{...o,hadValue:!0,name:r}]}return[...e,o]}return[...e,o]},[]))({outputEffects:Me(e,ce.HIDE_FIELD).map(t=>({...t,...e.content?{content:e.content}:{}})),formValues:n,dataElementId:e.dataElementId,trackedEntityAttributeId:e.trackedEntityAttributeId,dataElements:t,trackedEntityAttributes:r,onProcessValue:i})},[ce.SHOW_ERROR]:function(e){return He(e,ce.SHOW_ERROR)},[ce.SHOW_WARNING]:function(e){return xe(e,ce.SHOW_WARNING)},[ce.SHOW_ERROR_ONCOMPLETE]:function(e){return He(e,ce.SHOW_ERROR_ONCOMPLETE)},[ce.SHOW_WARNING_ONCOMPLETE]:function(e){return xe(e,ce.SHOW_WARNING_ONCOMPLETE)},[ce.HIDE_PROGRAM_STAGE]:function(e){return e.programStageId?{type:ce.HIDE_PROGRAM_STAGE,id:e.programStageId}:null},[ce.HIDE_SECTION]:function(e){return e.programStageSectionId?{type:ce.HIDE_SECTION,id:e.programStageSectionId}:null},[ce.MAKE_COMPULSORY]:function(e){return Me(e,ce.MAKE_COMPULSORY)},[ce.DISPLAY_TEXT]:function(e){const t=e.displayContent||"";return{type:ce.DISPLAY_TEXT,id:e.location,displayText:{id:e.id,message:`${t} ${Le(e.data)}`,...e.style}}},[ce.DISPLAY_KEY_VALUE_PAIR]:function(e){const t=void 0!==e.data?e.data:"";return{type:ce.DISPLAY_KEY_VALUE_PAIR,id:e.location,displayKeyValuePair:{id:e.id,key:e.displayContent,value:"number"===typeof t?(r=t,isNaN(r)||r===1/0?"":String(r)):String(t),...e.style}};var r},[ce.HIDE_OPTION_GROUP]:function(e){return Me(e,ce.HIDE_OPTION_GROUP).map(t=>({...t,optionGroupId:e.optionGroupId}))},[ce.HIDE_OPTION]:function(e){return Me(e,ce.HIDE_OPTION).map(t=>({...t,optionId:e.optionId}))},[ce.SHOW_OPTION_GROUP]:function(e){return Me(e,ce.SHOW_OPTION_GROUP).map(t=>({...t,optionGroupId:e.optionGroupId}))}};return function({effects:e,dataElements:t,trackedEntityAttributes:n,formValues:i,onProcessValue:a}){return e.filter(({action:e})=>r[e]).flatMap(e=>r[e.action](e,t,n,i,a)).filter(Boolean)}}function Fe(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}class Ye{constructor(e,t,r){Fe(this,"inputConverter",void 0),Fe(this,"outputConverter",void 0),Fe(this,"valueProcessor",void 0),Fe(this,"userRoles",void 0),Fe(this,"flags",void 0),this.inputConverter=e,this.outputConverter=t,this.valueProcessor=new Ne(e),this.flags=null!==r&&void 0!==r?r:{verbose:!1}}getProgramRuleEffects({programRulesContainer:e,currentEvent:t,otherEvents:r,dataElements:n,trackedEntityAttributes:i,selectedEntity:a,selectedEnrollment:s,selectedOrgUnit:o,selectedUserRoles:E,optionSets:l}){if(!e.programRules||!o||!t&&!s)return[];const u=new he(this.inputConverter,n,i,l,o),c=u.buildRuleEngineContext({programRulesContainer:e,selectedUserRoles:E||this.userRoles}),d=s?u.buildEnrollment({selectedEnrollment:s,selectedEntity:a}):null,T=r?r.map(u.convertEvent):[],I=new se.ar(this.flags.verbose||!1),_=(t?I.evaluateEvent(u.convertEvent(t),d,T,c):I.evaluateEnrollment(d,T,c)).map(e=>({...Object.fromEntries(e.ruleAction.values),action:e.ruleAction.type,data:e.data}));return we(this.outputConverter)({effects:_,dataElements:n,trackedEntityAttributes:i,formValues:{...a,...t},onProcessValue:this.valueProcessor.processValue})}setSelectedUserRoles(e){this.userRoles=e}setFlags(e){this.flags=e}getFlags(){return this.flags}}var ke=r(74161),We=r.n(ke);const Be=e=>e||null,je=e=>"number"===typeof e?e:null,$e=e=>e?e.name:null,Xe={convertText:Be,convertMultiText:Be,convertLongText:Be,convertLetter:Be,convertPhoneNumber:Be,convertEmail:Be,convertBoolean:e=>e||!1===e?e:null,convertTrueOnly:e=>e||null,convertDate:e=>{if(!e)return null;const t=We()(e);return t.locale("en"),t.format("YYYY-MM-DD")},convertDateTime:Be,convertTime:Be,convertNumber:je,convertUnitInterval:je,convertPercentage:je,convertInteger:je,convertIntegerPositive:je,convertIntegerNegative:je,convertIntegerZeroOrPositive:je,convertTrackerAssociate:e=>(i().warn("convertTrackerAssociate not implemented",e),null),convertUserName:Be,convertCoordinate:e=>e&&e.latitude&&e.longitude?`[${e.latitude},${e.longitude}]`:null,convertOrganisationUnit:$e,convertAge:e=>Xe.convertDate(e),convertUrl:Be,convertFile:$e,convertImage:$e};r(38301);new Map,new Map;function Ke(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}new class{constructor(){Ke(this,"_optionSets",void 0),this._optionSets={}}set(e){e.forEach((e,t)=>{this._optionSets[t]=e})}get(){return this._optionSets}};function Ze(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}new class{constructor(){Ze(this,"_constants",void 0)}set(e){this._constants=e}get(){return this._constants}};function ze(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}const Qe=new class{constructor(){ze(this,"_systemSettings",void 0)}set(e){this._systemSettings=e}get(){return this._systemSettings}};r(41632);function qe(e){const t=Qe.get().dateFormat;return e.format(t)}const Je="YYYY-MM-DD",et={convertText:e=>e,convertMultiText:e=>[...new Set(e.split(","))].join(","),convertLongText:e=>e,convertLetter:e=>e,convertPhoneNumber:e=>e,convertEmail:e=>e,convertBoolean:e=>e?"true":"false",convertTrueOnly:e=>e?"true":"false",convertDate:e=>qe(We()(e,Je)),convertDateTime:e=>{const t=We()(e);return{date:qe(t),time:t.format("HH:mm")}},convertTime:e=>e,convertNumber:e=>e.toString(),convertUnitInterval:e=>e.toString(),convertPercentage:e=>e.toString(),convertInteger:e=>e.toString(),convertIntegerPositive:e=>e.toString(),convertIntegerNegative:e=>e.toString(),convertIntegerZeroOrPositive:e=>e.toString(),convertTrackerAssociate:e=>(i().warn("convertTrackerAssociate not implemented",e),""),convertUserName:e=>(i().warn("convertUserName not implemented",e),""),convertCoordinate:e=>{const t=e.trim(),r=t.substring(1,t.length-1).split(",");return{latitude:Number(r[0]),longitude:Number(r[1])}},convertOrganisationUnit:e=>(i().warn("convertOrganisationUnit not implemented",e),""),convertAge:e=>{const t=We()(),r=We()(e,Je),n=t.diff(r,"years");r.add(n,"years");const i=t.diff(r,"months");r.add(i,"months");const a=t.diff(r,"days");return{date:qe(We()(e,Je)),years:n.toString(),months:i.toString(),days:a.toString()}},convertUrl:e=>e,convertFile:e=>(i().warn("convertFile not implemented",e),""),convertImage:e=>(i().warn("convertImage not implemented",e),"")},tt=/^\d{4}-\d{2}-\d{2}$/g;function rt(e){return tt.lastIndex=0,e&&tt.test(e)}function nt(e){return We()(e,"YYYY-MM-DD")}function it(e){return function(e,t="YYYY-MM-DD"){return e.clone().locale("en").format(t)}(e)}function at(e,t,r){const n=nt(t);return nt(r).diff(n,e)}const st={getToday:()=>it(We()()),daysBetween:(e,t)=>rt(e)&&rt(t)?at("days",e,t):null,weeksBetween:(e,t)=>rt(e)&&rt(t)?at("weeks",e,t):null,monthsBetween:(e,t)=>rt(e)&&rt(t)?at("months",e,t):null,yearsBetween:(e,t)=>rt(e)&&rt(t)?at("years",e,t):null,addDays:(e,t)=>{if(!rt(e))return null;return it(nt(e).add(t,"days"))},compareDates:(e,t)=>(e?We()(e).valueOf():Number.MAX_SAFE_INTEGER)-(t?We()(t).valueOf():Number.MAX_SAFE_INTEGER)};let ot;const Et=()=>new Ye(Xe,et),lt=()=>{console.log("Using capture rule engine"),ot=new ae(Xe,et,st,d.WebClient)},ut=()=>{console.log("Using kotlin rule engine"),ot=Et()},ct="new",dt="old",Tt=()=>ot||Et(),It={initRulesEngine:({version:e,userRoles:t,useKotlinAsFallback:r})=>{((e,t,r)=>{e===ct?ut():e===dt?lt():r?ut():lt(),ot.setSelectedUserRoles(t.map(({id:e})=>e))})(e,t,r)},setSelectedUserRoles:e=>{Tt().setSelectedUserRoles(e)},setFlags:e=>{Tt().setFlags(e)},getProgramRuleEffects:({executionId:e,rulesEngineInput:t})=>{const r=Tt().getProgramRuleEffects(t);postMessage({executionEnvironment:t.executionEnvironment||"",executionId:e,effects:r})}};onmessage=e=>{const{queryMethod:t,queryArguments:r}=e.data;It[t](r)}}},t={};function r(n){var i=t[n];if(void 0!==i)return i.exports;var a=t[n]={id:n,loaded:!1,exports:{}};return e[n].call(a.exports,a,a.exports,r),a.loaded=!0,a.exports}r.m=e,r.x=function(){var e=r.O(void 0,[4879,7786],function(){return r(4845)});return e=r.O(e)},function(){var e=[];r.O=function(t,n,i,a){if(!n){var s=1/0;for(u=0;u<e.length;u++){n=e[u][0],i=e[u][1],a=e[u][2];for(var o=!0,E=0;E<n.length;E++)(!1&a||s>=a)&&Object.keys(r.O).every(function(e){return r.O[e](n[E])})?n.splice(E--,1):(o=!1,a<s&&(s=a));if(o){e.splice(u--,1);var l=i();void 0!==l&&(t=l)}}return t}a=a||0;for(var u=e.length;u>0&&e[u-1][2]>a;u--)e[u]=e[u-1];e[u]=[n,i,a]}}(),r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,{a:t}),t},r.d=function(e,t){for(var n in t)r.o(t,n)&&!r.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},r.f={},r.e=function(e){return Promise.all(Object.keys(r.f).reduce(function(t,n){return r.f[n](e,t),t},[]))},r.u=function(e){return"static/js/"+e+"."+{4879:"4dce04c3",7786:"77da2e2a"}[e]+".chunk.js"},r.miniCssF=function(e){},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.nmd=function(e){return e.paths=[],e.children||(e.children=[]),e},r.p="./",function(){var e={4845:1};r.f.i=function(t,n){e[t]||importScripts(r.p+r.u(t))};var t=self.webpackChunk_dhis2_app_shell=self.webpackChunk_dhis2_app_shell||[],n=t.push.bind(t);t.push=function(t){var i=t[0],a=t[1],s=t[2];for(var o in a)r.o(a,o)&&(r.m[o]=a[o]);for(s&&s(r);i.length;)e[i.pop()]=1;n(t)}}(),function(){var e=r.x;r.x=function(){return Promise.all([r.e(4879),r.e(7786)]).then(e)}}();r.x()}();